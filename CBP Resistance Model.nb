(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    107164,       2730]
NotebookOptionsPosition[    103943,       2623]
NotebookOutlinePosition[    104472,       2642]
CellTagsIndexPosition[    104429,       2639]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6858785098524837`*^9, 3.685878512794094*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6858785098524837`*^9, 3.685878512794094*^9}},
 ExpressionUUID -> "01c422d8-83fb-4ad5-9a5d-5aa78bbe9113"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CARBAPENEM RESISTANCE MODEL",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.7005872688200474`*^9, 3.700587274570282*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Data",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.700586955166306*^9, 3.700586956688905*^9}, {
  3.700586999864338*^9, 3.700586999895615*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Preparing Directory",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7005868421634493`*^9, 3.700586844493045*^9}}],

Cell["\<\
Clear all variables. Set directory and change setting such that when it \
closes it closes all outputs.\
\>", "Text",
 CellChangeTimes->{{3.6864016594282627`*^9, 3.6864016983437967`*^9}, {
  3.6864017385595016`*^9, 3.6864017467278137`*^9}, {3.7005783616134434`*^9, 
  3.700578363379423*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "Code",
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"NotebookEventActions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
        RowBox[{"FrontEndExecute", "[", 
         RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
         "]"}]}], "}"}]}]}], "]"}], ";"}], "Code"]}], "Input",
 CellChangeTimes->{{3.686401706812792*^9, 3.6864017521197643`*^9}, 
   3.686403149219241*^9, {3.686504717864292*^9, 3.686504722791524*^9}, {
   3.700578365301522*^9, 3.7005783714796133`*^9}, {3.7005784918705196`*^9, 
   3.7005784924955854`*^9}},
 ExpressionUUID -> "947cde04-da7c-4abf-a430-eb3841611396"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Load Data",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586818794753*^9, 3.7005868197322516`*^9}, {
  3.7005873521608763`*^9, 3.700587352176503*^9}}],

Cell["\<\
Reading country data on consumption and resistance and assigning them to \
appropriate variables.\
\>", "Text",
 CellChangeTimes->{3.686400603032765*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"countryname", "=", "\"\<US_DDD\>\""}], ";"}], " "}], 
  "Code"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<DataSheet_cddep.xlsx\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Data\>\"", ",", "countryname"}], "}"}]}], "]"}]}], ";"}], 
  "Code"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"years", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"tt", " ", "=", " ", 
     RowBox[{"Length", "[", "years", "]"}]}], ";"}], " "}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"nop", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "-", "5"}], ")"}], "/", "2"}]}],
     ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"#", " ", "of", " ", "pathogens"}], "*)"}]}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"isolates", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", 
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "-", "4"}], ";;", "2"}], "]"}], 
     "]"}]}], ";"}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"resistance", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"3", ";;", 
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "-", "4"}], ";;", "2"}], "]"}], 
     "]"}]}], ";"}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"rfreq", " ", "=", 
    RowBox[{"resistance", "/", "isolates"}]}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"cbpcon", " ", "=", "  ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"CBP", " ", "consumption", " ", "data"}], "*)"}]}], "Code"], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpp", 
    StyleBox[" ", "Code"], 
    StyleBox["=", "Code"], 
    StyleBox[" ", "Code"], 
    StyleBox[
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", 
        RowBox[{"1", ";;", "nop"}]}], "]"}], "]"}], "Code"]}], 
   StyleBox[";", "Code"]}], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CBP", " ", "consumption", " ", "for", " ", 
      RowBox[{"pathogens", ":", " ", "KP"}]}], ",", " ", "PA", ",", " ", "AB",
      ",", " ", 
     RowBox[{"EA", "/", "C"}]}], "*)"}], "Code"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbppneu", " ", "=", " ", 
    RowBox[{"cbpcon", "*", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"CBP", " ", "consumption", " ", "for", " ", "pneumonia"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"cbp", " ", "=", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"cbpcon", "*", 
        RowBox[{"cbpp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}]}], ";"}], 
  "Code"]}], "Input",
 CellChangeTimes->{{3.686422034696558*^9, 3.6864220688839083`*^9}, {
   3.686422244390477*^9, 3.686422257854924*^9}, {3.6864223170828114`*^9, 
   3.6864223431908817`*^9}, 3.6864948657783527`*^9, {3.686495706144705*^9, 
   3.686495706998027*^9}, {3.686497157777652*^9, 3.686497176663332*^9}, {
   3.686500722352275*^9, 3.6865007839598494`*^9}, {3.6865008234158993`*^9, 
   3.686500860558977*^9}, {3.686500895439396*^9, 3.6865009047916603`*^9}, {
   3.686501132914021*^9, 3.6865011961896877`*^9}, {3.686502039475134*^9, 
   3.686502053471085*^9}, 3.686504820987131*^9, {3.686504927512206*^9, 
   3.68650493323075*^9}, {3.686505663500307*^9, 3.686505834942637*^9}, {
   3.686506221505989*^9, 3.686506233253963*^9}, 3.6865062638755836`*^9, {
   3.686506304950383*^9, 3.6865063857051888`*^9}, {3.686506464729933*^9, 
   3.686506570268374*^9}, {3.686507885056096*^9, 3.686507925091408*^9}, 
   3.68650806648864*^9, {3.686508132562462*^9, 3.686508159468111*^9}, {
   3.6865082387863083`*^9, 3.686508289413818*^9}, {3.686593508533208*^9, 
   3.686593578249978*^9}, {3.686670822461113*^9, 3.686670846265149*^9}, 
   3.686671020176771*^9, {3.686671058093039*^9, 3.686671058348937*^9}, {
   3.686671195039489*^9, 3.686671197287084*^9}, {3.686672205273057*^9, 
   3.686672265615234*^9}, {3.686672313935074*^9, 3.686672315030695*^9}, {
   3.690514968752684*^9, 3.6905149711878157`*^9}, {3.6905151605791454`*^9, 
   3.6905151977141056`*^9}, {3.6905490426059213`*^9, 
   3.6905490710575967`*^9}, {3.6905491666256824`*^9, 3.69054916762508*^9}, {
   3.690560008801766*^9, 3.690560021440817*^9}, {3.693235488416274*^9, 
   3.693235488880404*^9}, {3.693237503430167*^9, 3.693237504912262*^9}, {
   3.693242514519369*^9, 3.693242533218896*^9}, {3.69324278229449*^9, 
   3.6932427827305317`*^9}, {3.69324331082885*^9, 3.693243311380581*^9}, {
   3.694794944107407*^9, 3.6947949456275787`*^9}, 3.694869444462384*^9, {
   3.69486947773489*^9, 3.6948694780468807`*^9}, {3.696613845884832*^9, 
   3.69661384630057*^9}, 3.6966142251356783`*^9, {3.696614267163052*^9, 
   3.696614268931164*^9}, {3.696614336734581*^9, 3.69661436742657*^9}, {
   3.6966143989830647`*^9, 3.6966144011982822`*^9}, {3.696614476914295*^9, 
   3.696614477617947*^9}, {3.696614523998536*^9, 3.696614524365843*^9}, {
   3.6966149875383883`*^9, 3.69661502321297*^9}, {3.696615101388283*^9, 
   3.69661512177125*^9}, {3.6966152518805857`*^9, 3.696615261003038*^9}, {
   3.696615389139082*^9, 3.696615395235524*^9}, {3.696615597886518*^9, 
   3.696615598926401*^9}, {3.696615815221848*^9, 3.696615816637291*^9}, {
   3.696616322068841*^9, 3.696616323151634*^9}, {3.6968731019011183`*^9, 
   3.696873102132331*^9}, {3.696873474263825*^9, 3.696873474894909*^9}, {
   3.696873750270289*^9, 3.6968737506538773`*^9}, {3.696952191029182*^9, 
   3.696952192165349*^9}, {3.6969525040529337`*^9, 3.69695250910539*^9}, {
   3.696952959626371*^9, 3.696952960785913*^9}, {3.696954591424856*^9, 
   3.696954592264494*^9}, {3.69695474259662*^9, 3.696954751834024*^9}, {
   3.696954829844029*^9, 3.696954858941578*^9}, {3.696959711253429*^9, 
   3.6969597124892597`*^9}, {3.696960225982828*^9, 3.696960229688342*^9}, {
   3.6974636430928164`*^9, 3.69746364475207*^9}, 3.6974636990330257`*^9, {
   3.69746572261734*^9, 3.6974657303934927`*^9}, {3.697466319707209*^9, 
   3.6974663208109493`*^9}, {3.699979819323583*^9, 3.699979824749195*^9}, {
   3.6999798994047337`*^9, 3.699979971399865*^9}, 3.700577857699892*^9, {
   3.700580301187483*^9, 3.7005803061567545`*^9}, {3.700580352344078*^9, 
   3.7005804332667875`*^9}, {3.700587356480831*^9, 3.7005873808606195`*^9}, {
   3.7014286067933145`*^9, 3.701428607337329*^9}, {3.701537183106104*^9, 
   3.7015371983584056`*^9}, {3.701537245629196*^9, 3.701537248154693*^9}, {
   3.70260425302969*^9, 3.70260437300688*^9}, {3.7026044312816687`*^9, 
   3.7026044319707756`*^9}},
 ExpressionUUID -> "163af784-7490-4e8e-95c8-284f538d9d5f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model ", "Section",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.686400307952888*^9, 3.6864004084403467`*^9}, {
   3.686400489920883*^9, 3.686400491960532*^9}, 3.7005870090415688`*^9, 
   3.701429412245363*^9}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Parameters & Model Structure",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586719444282*^9, 3.700586729715373*^9}, {
  3.700586791459395*^9, 3.7005867927406187`*^9}}],

Cell[TextData[{
 StyleBox["r(t)", "Text",
  FontWeight->"Bold"],
 StyleBox[" = frequency of resistance\n", "Text"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "s"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the sensitive strain\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "r"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the resistance strain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["k", "r"]}], TraditionalForm]]],
 " < ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "s"], ")"}], TraditionalForm]]],
 "\n",
 StyleBox["\[Theta]",
  FontWeight->"Bold"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["k", "r"], "-", 
     SubscriptBox["k", "s"]}], "<", " ", "0"}], TraditionalForm]]],
 " \n",
 StyleBox["a =",
  FontWeight->"Bold"],
 " CBP consumption (DDD)"
}], "Text",
 CellChangeTimes->{{3.686400499649311*^9, 3.68640052600694*^9}, {
   3.6864005718225193`*^9, 3.686400575021463*^9}, {3.68736386207417*^9, 
   3.687363862074381*^9}, 3.6905491725333633`*^9, {3.690722553178647*^9, 
   3.69072257128833*^9}, {3.690722611632101*^9, 3.6907226192004843`*^9}, 
   3.696614487562492*^9, {3.696954774986088*^9, 3.696954776429123*^9}, {
   3.699978618851925*^9, 3.69997862542444*^9}, {3.700578555451971*^9, 
   3.700578559628787*^9}, {3.700578612001893*^9, 3.700578612705063*^9}, {
   3.7005806236313753`*^9, 3.700580635401388*^9}, {3.7005806769712067`*^9, 
   3.7005809518298016`*^9}, {3.7005811924601393`*^9, 
   3.7005812164615297`*^9}, {3.702216322838592*^9, 3.702216326755948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"r", "[", 
      RowBox[{"t_", ",", "r0_", ",", "ks_", ",", "\[Theta]_"}], "]"}],
     FontWeight->"Plain"], 
    StyleBox[":=",
     FontWeight->"Plain"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"ks", "*", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"\[Theta]", "*", "t"}]}], ")"}]], " "}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"ks", "*", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", " ", 
         RowBox[{"\[Theta]", "*", "t"}]}], ")"}]], "  "}]]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.683030762976203*^9, 3.6830307646226077`*^9}, {
   3.683030892090124*^9, 3.6830309083188725`*^9}, {3.6830309721242533`*^9, 
   3.683030993984562*^9}, {3.6830311371186757`*^9, 3.6830311451555557`*^9}, {
   3.683031934623186*^9, 3.6830319364931593`*^9}, {3.683032013522828*^9, 
   3.683032065758599*^9}, {3.6830346542453313`*^9, 3.68303465754213*^9}, {
   3.6830363241484847`*^9, 3.683036329938362*^9}, {3.6830365276454496`*^9, 
   3.683036530676465*^9}, 3.6830367497782087`*^9, {3.683041381379426*^9, 
   3.683041393024686*^9}, {3.6830421349464197`*^9, 3.683042139599684*^9}, {
   3.6830447788287015`*^9, 3.683044779606695*^9}, {3.683045184458967*^9, 
   3.6830452004752617`*^9}, {3.6852083241401463`*^9, 3.685208331594561*^9}, {
   3.685208507957798*^9, 3.685208565997737*^9}, 3.6852094721246767`*^9, {
   3.685209903141817*^9, 3.6852099398500347`*^9}, {3.6852099889580927`*^9, 
   3.685210058891021*^9}, {3.6852103080680428`*^9, 3.685210309237547*^9}, {
   3.685210371854425*^9, 3.685210380461464*^9}, {3.685210428797523*^9, 
   3.6852105257382507`*^9}, {3.6852105754249763`*^9, 3.6852105928533*^9}, {
   3.6852107253971167`*^9, 3.685210739728479*^9}, {3.685211129911818*^9, 
   3.685211139176404*^9}, {3.68521175723141*^9, 3.6852117935313168`*^9}, {
   3.6852123574632883`*^9, 3.685212368014336*^9}, {3.685279366491384*^9, 
   3.685279382363071*^9}, {3.685279416295306*^9, 3.685279429839871*^9}, 
   3.6852808275142384`*^9, {3.6853860677425203`*^9, 3.6853861678062687`*^9}, {
   3.685386259499681*^9, 3.685386260403224*^9}, {3.685881879376438*^9, 
   3.68588188788455*^9}, {3.685882144512109*^9, 3.685882211247509*^9}, {
   3.685882264975534*^9, 3.6858823048645563`*^9}, {3.6863259609700985`*^9, 
   3.68632602143394*^9}, {3.6863261123987613`*^9, 3.6863261127132187`*^9}, {
   3.6863261459947433`*^9, 3.686326158772418*^9}, {3.6863300988135977`*^9, 
   3.6863301392487526`*^9}, {3.6863301968103313`*^9, 
   3.6863302455048313`*^9}, {3.686330295179199*^9, 3.686330312060356*^9}, {
   3.6863310425150905`*^9, 3.686331077920039*^9}, {3.6863311592705336`*^9, 
   3.686331161351984*^9}, {3.686331196844039*^9, 3.6863312002829003`*^9}, {
   3.6863316074494753`*^9, 3.68633161191486*^9}, {3.6863316677333975`*^9, 
   3.6863316752266045`*^9}, {3.686331756685466*^9, 3.6863317652227015`*^9}, {
   3.6863318579611225`*^9, 3.6863318604224625`*^9}, {3.6863320284264183`*^9, 
   3.6863320896920385`*^9}, {3.6863333970093203`*^9, 3.686333468722809*^9}, {
   3.686333527818489*^9, 3.686333530257064*^9}, {3.686333585882146*^9, 
   3.6863335937595434`*^9}, {3.6863337944358063`*^9, 
   3.6863338012252955`*^9}, {3.686333860129887*^9, 3.686333926127783*^9}, {
   3.686334541041381*^9, 3.6863345432302294`*^9}, {3.6863346050474234`*^9, 
   3.6863346194036174`*^9}, {3.6863350339422607`*^9, 
   3.6863350402439137`*^9}, {3.686396824312439*^9, 3.686396830206884*^9}, {
   3.68639728852584*^9, 3.686397385676342*^9}, {3.6863974219206467`*^9, 
   3.686397591467824*^9}, {3.6863977467434483`*^9, 3.686397856243059*^9}, {
   3.6863979037596188`*^9, 3.686398009617909*^9}, {3.686398049831843*^9, 
   3.686398058770108*^9}, {3.68639915087844*^9, 3.686399168049336*^9}, {
   3.686399538546379*^9, 3.686399540314131*^9}, 3.6864005110851316`*^9, 
   3.686400581816401*^9, {3.6864006197723083`*^9, 3.686400620244726*^9}, {
   3.686401869966902*^9, 3.686401900676633*^9}, {3.6864032479875317`*^9, 
   3.6864032930076036`*^9}, {3.6864112529344683`*^9, 3.686411262755252*^9}, {
   3.6864112967508183`*^9, 3.686411330746829*^9}, {3.686412024717753*^9, 
   3.686412049333313*^9}, 3.6864123304368677`*^9, {3.686412473817891*^9, 
   3.686412485495213*^9}, {3.686412529906288*^9, 3.686412535342702*^9}, 
   3.686413143077464*^9, {3.686413922349515*^9, 3.6864139332766542`*^9}, {
   3.686414054550778*^9, 3.68641405601223*^9}, {3.686414101545352*^9, 
   3.686414169219296*^9}, {3.6864142432310667`*^9, 3.686414273315958*^9}, {
   3.686414369325341*^9, 3.686414388826579*^9}, {3.6864144199682903`*^9, 
   3.686414447742525*^9}, {3.686414613494096*^9, 3.686414779850452*^9}, {
   3.686414811798102*^9, 3.686414906928382*^9}, {3.686415062398457*^9, 
   3.686415134968748*^9}, {3.686415560254722*^9, 3.686415665538151*^9}, {
   3.686418321121459*^9, 3.686418334972437*^9}, {3.686508624478046*^9, 
   3.686508632277608*^9}, 3.68650871497578*^9, {3.6866710450891523`*^9, 
   3.686671051229025*^9}, {3.6866716077238398`*^9, 3.6866716968985*^9}, {
   3.686671727131069*^9, 3.6866717297824497`*^9}, {3.686672280091339*^9, 
   3.68667229406674*^9}, {3.6869386960631742`*^9, 3.686938708012053*^9}, {
   3.690514877200051*^9, 3.6905148892161407`*^9}, {3.690721514268401*^9, 
   3.690721571699773*^9}, 3.696616035925852*^9, {3.6975661826500597`*^9, 
   3.6975661924568453`*^9}, {3.697566564484868*^9, 3.697566577524445*^9}, {
   3.69997860542073*^9, 3.699978631025688*^9}, {3.699978671234418*^9, 
   3.699978743381155*^9}, 3.6999787843122373`*^9, {3.6999788740181875`*^9, 
   3.699978892479066*^9}, {3.699978953924489*^9, 3.699978998636625*^9}, {
   3.699979481328476*^9, 3.699979524287679*^9}, {3.6999797618961906`*^9, 
   3.6999797636369605`*^9}, {3.700577837888285*^9, 3.7005778452831726`*^9}, {
   3.700577896592633*^9, 3.700577898123874*^9}, {3.700577982561618*^9, 
   3.7005779859363604`*^9}, 3.700580714849549*^9, {3.700580866866892*^9, 
   3.7005808755221605`*^9}, {3.7005809652484455`*^9, 3.700581054510634*^9}, {
   3.700581143420582*^9, 3.700581158726591*^9}, {3.7005812221988354`*^9, 
   3.700581224699131*^9}, {3.7005813900782413`*^9, 3.7005814812173157`*^9}, 
   3.700581594578314*^9, {3.7005817018893595`*^9, 3.7005817331728625`*^9}, {
   3.70058236481491*^9, 3.7005823685675287`*^9}, {3.7005824573051863`*^9, 
   3.7005824598974485`*^9}, {3.7005825333408175`*^9, 3.700582536338009*^9}, {
   3.7016103449359617`*^9, 3.701610389366672*^9}},
 ExpressionUUID -> "ebe5f114-8fd3-4fd7-94a0-8f75b8068d13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Likelihood",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7005867405346403`*^9, 3.700586744228055*^9}, {
  3.701427711022795*^9, 3.701427711163434*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Lik", "[", 
    RowBox[{"r0_", ",", "ks_", ",", "\[Theta]_"}], "]"}],
   FontWeight->"Plain"], 
  StyleBox[":=",
   FontWeight->"Plain"], 
  StyleBox[" ",
   FontWeight->"Plain"], 
  RowBox[{"Total", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"iso", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"resis", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"Log", "[", 
        RowBox[{"r", "[", 
         RowBox[{
          RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", "\[Theta]"}], 
         "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"iso", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "-", 
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", 
         RowBox[{"r", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", "\[Theta]"}], 
          "]"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.6830433753306084`*^9}, {3.6830453841421323`*^9, 3.683045385373238*^9}, {
   3.683286539007884*^9, 3.6832865413676167`*^9}, {3.683286571723649*^9, 
   3.6832865735875263`*^9}, {3.6833012740307302`*^9, 
   3.6833013690917635`*^9}, {3.6833024062245913`*^9, 
   3.6833024065060987`*^9}, {3.683303978402192*^9, 3.683303988908411*^9}, {
   3.6833125533026915`*^9, 3.683312560807563*^9}, {3.6833810185649223`*^9, 
   3.6833810198201427`*^9}, {3.6839950164754915`*^9, 3.683995016631748*^9}, {
   3.683995107610061*^9, 3.683995109400138*^9}, {3.684761387233347*^9, 
   3.684761387411523*^9}, {3.685208646552435*^9, 3.685208664904273*^9}, {
   3.685210100038281*^9, 3.685210133317401*^9}, {3.685210612196949*^9, 
   3.685210625376943*^9}, {3.685279459724468*^9, 3.685279483526725*^9}, {
   3.6852807998799334`*^9, 3.6852808089832907`*^9}, {3.685281067274529*^9, 
   3.685281077298399*^9}, {3.68528125115583*^9, 3.685281261013719*^9}, {
   3.6852814331275053`*^9, 3.685281440604895*^9}, {3.685386193320956*^9, 
   3.685386207936881*^9}, {3.686325830517469*^9, 3.686325855990289*^9}, {
   3.6863316529251328`*^9, 3.68633165301976*^9}, {3.686331705422717*^9, 
   3.6863317460069585`*^9}, 3.686331790557254*^9, {3.6863340940272284`*^9, 
   3.6863340949404917`*^9}, 3.6864009082517033`*^9, 3.6864009507187*^9, {
   3.686401046619935*^9, 3.686401063283523*^9}, 3.686401104899159*^9, {
   3.68640350491506*^9, 3.6864035654181747`*^9}, {3.686415534611898*^9, 
   3.6864155467485037`*^9}, {3.6864157341890497`*^9, 
   3.6864157348122463`*^9}, {3.6864183840374823`*^9, 3.686418412399835*^9}, {
   3.686508351245968*^9, 3.686508378709692*^9}, {3.6865086384692287`*^9, 
   3.686508647192649*^9}, 3.686508721860381*^9, {3.69051493172359*^9, 
   3.690514960196232*^9}, {3.69072157779605*^9, 3.6907216007279577`*^9}, {
   3.697566200365423*^9, 3.697566212973073*^9}, {3.69997901078512*^9, 
   3.6999790631544333`*^9}, {3.699979531465004*^9, 3.699979539438403*^9}, {
   3.6999797425870667`*^9, 3.6999797443087587`*^9}, {3.7005810704350834`*^9, 
   3.7005810755460377`*^9}, {3.7005811209205437`*^9, 
   3.7005811290410414`*^9}, {3.700581304665578*^9, 3.700581331077982*^9}, {
   3.700581746040372*^9, 3.7005817902595863`*^9}, {3.7005820577108154`*^9, 
   3.7005820645214376`*^9}, 3.7005856756577263`*^9, {3.701536147947562*^9, 
   3.701536161931431*^9}, {3.7015393894383755`*^9, 3.701539413765788*^9}, 
   3.7016171706320457`*^9, {3.7025935736528687`*^9, 3.702593582321974*^9}},
 ExpressionUUID -> "be7d0cfe-df37-408d-ac55-5e320828eca2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model Fitting",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586762450125*^9, 3.70058676485663*^9}, {
  3.700587072272579*^9, 3.7005870740416794`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", "max"}], ";", " ", 
  RowBox[{"fks", "=", "max"}], ";", " ", 
  RowBox[{"f\[Theta]", "=", "max"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      StyleBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"max", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"f\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], "=", 
        RowBox[{"NMaximize", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lik", "[", 
             RowBox[{"r0", ",", "ks", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"0", "<", "r0", "<", "1"}], ",", 
            RowBox[{"\[Theta]", "<", 
             RowBox[{"-", "0.1"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r0", ",", "ks", ",", "\[Theta]"}], "}"}], ",", " ", 
          RowBox[{"MaxIterations", "\[Rule]", "100000"}]}], "]"}]}],
       FontWeight->"Plain"]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fr0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fks", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fks", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f\[Theta]", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f\[Theta]", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"create", " ", "table", " ", "of", " ", "fitted", " ", "values"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "max", "}"}], ",", 
     RowBox[{"{", "fr0", "}"}], ",", 
     RowBox[{"{", "fks", "}"}], ",", 
     RowBox[{"{", "f\[Theta]", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings1", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"params", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<KP\>\"", ",", "\"\<PA\>\"", ",", "\"\<AB\>\"", ",", 
       "\"\<EA/C\>\""}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings2", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Prepend", ",", 
     RowBox[{"{", 
      RowBox[{"headings1", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\>\"", ",", "\"\<Likelihood\>\"", ",", "\"\<r0\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(k\), \(s\)]\)\>\"", ",", 
         "\"\<\[Theta]\>\""}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Grid", "[", 
   RowBox[{"headings2", ",", 
    RowBox[{"Frame", "\[Rule]", " ", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz1tImgEABWAprKdQknrYpVFEhiNqIVG0DKvV0GqlI6i5jUXyF9i6GAnG
hjQKinWPqNwoq1mkEEWLJu2SAx+ywgJpiBtWK9O/q40Qq23/+R8OH+flwIku
r5HIgxgMRiwVuEVEVsX1kMKiMXYNjDJljEN1w8NJuPDz6RJ8k8k0Q8J4lcCl
7Bjl8qH+XJoKZRpSAFMGNLmwgpORB236VTHdnV/z4ZLOqYSeziEVTNYLt0W9
pFB7Yab1hamIfErpeGUlrB6ZqYbvsyOUUGF43gTFZ8O089d2E9z5/mMN3tDy
3PAl03sGA+ySAHztd/2Dfo4jrAA7U6Xh0CzLaYT+9eBX8IvAr4G/7WQrPJgK
tEPbzYZ+eFLSoYWjKR9px4Jb9HBB8mAePtHpFmFto8QKF8scG/CiWbENH5sO
92BWWpUHxs4lHcG3rJVL6Lh1N74Q/XYOrWHXqYXr0sF3cHbfLHpEyVrlimFI
3d9vnj5S+NkXsgyNvEQLLH6mtkK+urXLS+nKC+2GRXL3BBS1ndBa64+n4YfT
F59gjO/XJiTS3bT3Kwy8qH7q1501WmO25R78k2pLhv8B5Ys03Q==
  "],
 ExpressionUUID -> "eccb0fde-28f5-4a39-bf59-111f011ccd44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Sampling and Bayesian Melding",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.702592423985393*^9, 3.702592427235752*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Functions",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.7025924476799994`*^9, 3.702592449523942*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"loglik", "[", 
     RowBox[{"r0_", ",", "ks_"}], "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", 
            RowBox[{"-", "0.1"}]}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "[", 
            RowBox[{
             RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", 
             RowBox[{"-", "0.1"}]}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"theta", " ", "fixed", " ", "at"}], " ", "-", "0.1"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fonGrid", "[", 
    RowBox[{"x_", ",", "y_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "m", ",", "fvals"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fvals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "m", "}"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"preallocate", " ", "fvals"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"fvals", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"y", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "fvals"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"x", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
    RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"y", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
    RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "f", " ", "is", " ", "a", " ", "scalar", " ", "function", " ", "of", " ", 
    "two", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"fvals", " ", "is", " ", "a", " ", "m"}], "-", "by", "-", 
     RowBox[{"n", " ", "matirx", " ", "where", " ", 
      RowBox[{"fvals", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "=", 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", 
      RowBox[{"y", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repeat", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"n_Integer", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"Sequence", "@@", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"m", ",", "n"}], "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.702212683239119*^9, 3.7022126862151327`*^9}, {
   3.702212732383494*^9, 3.702212776298992*^9}, {3.702212941922406*^9, 
   3.702213009546727*^9}, {3.7022130397508373`*^9, 3.702213071586981*^9}, {
   3.702213192706868*^9, 3.702213194550742*^9}, {3.7022136105741663`*^9, 
   3.702213611089116*^9}, {3.702221180021676*^9, 3.70222119417346*^9}, {
   3.7022971549358997`*^9, 3.702297155736002*^9}, {3.702297221260055*^9, 
   3.70229722141407*^9}, {3.702297269679932*^9, 3.702297269895307*^9}, {
   3.702297512902986*^9, 3.7022975130708237`*^9}, {3.7022975635228*^9, 
   3.702297563706696*^9}, 3.702303308232937*^9, {3.702303358643429*^9, 
   3.702303371304614*^9}, {3.702407962401205*^9, 3.702407963409082*^9}, {
   3.702408002693084*^9, 3.702408003621046*^9}, {3.7025930292053375`*^9, 
   3.7025930436846395`*^9}, {3.702593961593078*^9, 3.7025939651559706`*^9}, {
   3.7025940143204927`*^9, 3.702594017393057*^9}, 3.7025941042804675`*^9, {
   3.7025942995577106`*^9, 3.702594302051184*^9}, {3.70259439260927*^9, 
   3.7025943995418406`*^9}, {3.7025947238850594`*^9, 3.702594734760413*^9}, 
   3.7025950736428127`*^9},
 ExpressionUUID -> "88cc9e8e-3a82-4482-a950-9cc1c878fd35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Initialization for parameter estimates and plots",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{
  3.7024059374388638`*^9, 3.702407959905129*^9, 3.702408000724612*^9, {
   3.702408041080536*^9, 3.702408076599719*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"r0f", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"r0", " ", "fits"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ksf", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"k_s", " ", "fits"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lf", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"likelihood", " ", "values"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotD", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", "data", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotM", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", "model", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotS", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"status", " ", "quo", " ", "projections"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotP", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"intervention", " ", "projections"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nif", " ", "=", " ", "0.1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "noise", " ", "around", " ", "mle", " ", "values", " ", "for", " ", 
    "bayesian", " ", "melding", " ", "prior"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "parameter", " ", "values", " ", "randomly", " ", "selected"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", "1000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"#", " ", "weighted", " ", "samples"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7024082569761457`*^9, 3.702408266207646*^9}, {
  3.702408343115411*^9, 3.702408488975521*^9}, {3.7025946704704533`*^9, 
  3.702594717290625*^9}, {3.702600890732836*^9, 3.702600890998296*^9}},
 ExpressionUUID -> "2e920cbd-7737-491b-b330-b23ad3d954e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Bayesian melding for each pathogen",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.702408283660355*^9, 3.702408321599058*^9}, {
   3.702410509476049*^9, 3.7024105239317827`*^9}, 3.7025924747499237`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iso", " ", "=", " ", 
      RowBox[{"isolates", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"resis", " ", "=", " ", 
      RowBox[{"resistance", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"cbp", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0b", " ", "=", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "nif"}], ")"}], "*", 
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "nif"}], ")"}], "*", 
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "n"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{"values", " ", "for", " ", "r0"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ksb", " ", "=", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "nif"}], ")"}], "*", 
           RowBox[{"fks", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "nif"}], ")"}], "*", 
           RowBox[{"fks", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "n"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{"values", " ", "for", " ", "k_s"}], "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"lik", " ", "=", " ", 
      RowBox[{"fonGrid", "[", 
       RowBox[{"r0b", ",", "ksb", ",", "loglik"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Calculates", " ", "a", " ", "matrix", " ", "of", " ", "loglikelihood",
         " ", "values", " ", "for", " ", "r0"}], ",", " ", 
       RowBox[{"k_s", " ", "values"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"likb", " ", "=", " ", 
      RowBox[{"Exp", "[", "lik", "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Exponential", " ", "to", " ", "get", " ", "likelihood"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"likb", "/", 
       RowBox[{"Total", "[", 
        RowBox[{"Total", "[", "likb", "]"}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "weights", " ", "based", " ", "on", " ", 
       "likelihood"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"likv", " ", "=", " ", 
      RowBox[{
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"likb", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"n", "*", "n"}]}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
      "Flatten", " ", "the", " ", "likelihood", " ", "to", " ", "get", " ", 
       "a", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"wv", " ", "=", " ", 
      RowBox[{
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"w", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"n", "*", "n"}]}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
      "Flatten", " ", "the", " ", "weights", " ", "to", " ", "get", " ", "a", 
       " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r0v", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"repeat", "[", 
         RowBox[{
          RowBox[{"r0b", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "n"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Resize", " ", "x", " ", "to", " ", "match", " ", "size", " ", "of", 
       " ", "likelihood", " ", "vector", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "repeat", " ", "1", "st", " ", "term", " ", "of", " ", "r0", " ", 
          "vector", " ", "n", " ", "times"}], ",", " ", 
         RowBox[{
         "then", " ", "2", "nd", " ", "term", " ", "n", " ", "times"}], ",", 
         " ", 
         RowBox[{"etc", "."}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ksv", " ", "=", " ", 
      RowBox[{"PadRight", "[", 
       RowBox[{"ksb", ",", 
        RowBox[{"n", "*", "n"}], ",", "ksb"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Resize", " ", "y", " ", "to", " ", "match", " ", "size", " ", "of", 
       " ", "likelihood", " ", "vector", " ", 
       RowBox[{"(", 
        RowBox[{"repeat", " ", "ks", " ", "vector", " ", "n", " ", "times"}], 
        ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ind", " ", "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"wv", "\[Rule]", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "^", "2"}], "]"}]}], ",", "m"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Choose", " ", "m", " ", "indices", " ", "from", " ", "1", " ", "to", 
       " ", 
       RowBox[{"n", "^", "2"}], " ", "based", " ", "on", " ", "weights", 
       RowBox[{"(", 
        RowBox[{
        "importance", " ", "sampling", " ", "with", " ", "replacement"}], 
        ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r0v", " ", "=", " ", 
      RowBox[{"r0v", "[", 
       RowBox[{"[", "ind", "]"}], "]"}]}], ";", 
     RowBox[{"ksv", " ", "=", " ", 
      RowBox[{"ksv", "[", 
       RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
     RowBox[{"likv", " ", "=", " ", 
      RowBox[{"likv", "[", 
       RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Get", " ", "posterior", " ", "parameters", " ", 
       RowBox[{"(", 
        RowBox[{"r0v", ",", "ksv"}], ")"}], " ", "and", " ", "likelihood", 
       " ", 
       RowBox[{"(", "likv", ")"}], " ", "based", " ", "on", " ", "melding"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ord", " ", "=", " ", 
      RowBox[{"Ordering", "[", "ind", "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "sort", " ", "the", " ", "likelihood", " ", "values", " ", "in", " ", 
       "order", " ", "to", " ", "get", " ", "confidence", " ", "intervals"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r0v", " ", "=", " ", 
      RowBox[{"r0v", "[", 
       RowBox[{"[", "ord", "]"}], "]"}]}], ";", " ", 
     RowBox[{"ksv", "=", 
      RowBox[{"ksv", "[", 
       RowBox[{"[", "ord", "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Order", " ", "parameters", " ", "in", " ", "the", " ", "same", " ", 
       "order", " ", "as", " ", "sorted", " ", "likelihoods"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"r0CI", " ", "=", 
      RowBox[{"r0v", "[", 
       RowBox[{"[", 
        RowBox[{"50", ";;", "1000"}], "]"}], "]"}]}], ";", 
     RowBox[{"ksCI", "=", 
      RowBox[{"ksv", "[", 
       RowBox[{"[", 
        RowBox[{"50", ";;", "1000"}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Take", " ", "the", " ", "parameters", " ", "corresponding", " ", "95", 
       "%", " ", "confidence", " ", "interval", " ", "of", " ", 
       "likelihoods"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r0f", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "r0CI"}], ";", " ", 
     RowBox[{
      RowBox[{"ksf", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", "ksCI"}], ";"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "Assign", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ", 
    "each", " ", "pathogens"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.702213085206161*^9, 3.7022130910461597`*^9}, {
   3.702213242497711*^9, 3.702213365697401*^9}, {3.702213422953679*^9, 
   3.702213477292939*^9}, {3.702213521753269*^9, 3.702213524804967*^9}, {
   3.702213556768837*^9, 3.702213582672481*^9}, {3.7022136314092712`*^9, 
   3.70221365245243*^9}, {3.70221452594149*^9, 3.7022145568976917`*^9}, {
   3.702214596469501*^9, 3.702214643929315*^9}, {3.702214743890162*^9, 
   3.702214772772786*^9}, {3.7022159578055067`*^9, 3.702215992345421*^9}, {
   3.702216384715893*^9, 3.702216468511726*^9}, {3.7022212185686398`*^9, 
   3.702221219649168*^9}, 3.702227690016165*^9, {3.702228184346311*^9, 
   3.702228265734083*^9}, {3.702232762931981*^9, 3.702232767724331*^9}, {
   3.702232926003491*^9, 3.702233040788165*^9}, {3.702297068084367*^9, 
   3.702297168036446*^9}, {3.702303376632094*^9, 3.702303385612136*^9}, {
   3.702303972506579*^9, 3.702303977594195*^9}, {3.702320989116581*^9, 
   3.702321010111902*^9}, 3.70232108199686*^9, {3.702321115008659*^9, 
   3.7023211673086243`*^9}, {3.7023214705632*^9, 3.70232166710699*^9}, {
   3.702321799631673*^9, 3.702321801102396*^9}, {3.702321897274564*^9, 
   3.702321899306859*^9}, {3.70232315196726*^9, 3.702323163354329*^9}, {
   3.7023232757065353`*^9, 3.702323297185672*^9}, {3.702384853229362*^9, 
   3.7023848533728523`*^9}, {3.702385012421068*^9, 3.70238501267686*^9}, {
   3.702385049496627*^9, 3.702385049632351*^9}, {3.702385259924115*^9, 
   3.702385260020009*^9}, {3.702386682651862*^9, 3.702386682772114*^9}, {
   3.7023868387958*^9, 3.702386838907045*^9}, {3.702386880255397*^9, 
   3.702386880374984*^9}, {3.702386982854719*^9, 3.702386982926188*^9}, {
   3.702401315877528*^9, 3.70240131662119*^9}, {3.7024030323879337`*^9, 
   3.702403033316182*^9}, {3.702403066256227*^9, 3.702403066323863*^9}, {
   3.702403098895918*^9, 3.702403099031457*^9}, {3.7024032442277946`*^9, 
   3.7024032503392878`*^9}, {3.702403416894806*^9, 3.702403428034679*^9}, {
   3.7024045641874437`*^9, 3.702404584471945*^9}, 3.702404730195898*^9, {
   3.702404834891159*^9, 3.702404865694994*^9}, {3.702405111310614*^9, 
   3.702405117137938*^9}, {3.70240548864151*^9, 3.702405509021366*^9}, {
   3.702405626455765*^9, 3.702405628692748*^9}, {3.7024057355759077`*^9, 
   3.702405757488584*^9}, {3.702405926684291*^9, 3.70240593361585*^9}, 
   3.7024059733405724`*^9, {3.702406051847333*^9, 3.7024060554312143`*^9}, {
   3.702406168519135*^9, 3.702406177238905*^9}, {3.702406309506442*^9, 
   3.702406353999366*^9}, {3.702406399210183*^9, 3.702406414959035*^9}, {
   3.7024066280390882`*^9, 3.702406635893631*^9}, 3.702406668499001*^9, {
   3.70240678337252*^9, 3.702406911739341*^9}, {3.702407074771019*^9, 
   3.702407075548867*^9}, {3.70240772665248*^9, 3.70240781734237*^9}, 
   3.702408050794153*^9, {3.7024080815328217`*^9, 3.702408254097418*^9}, 
   3.7024083355148067`*^9, {3.702408491923511*^9, 3.702408515974907*^9}, {
   3.702408550179139*^9, 3.702408613274899*^9}, 3.702408665722334*^9, {
   3.702408725009778*^9, 3.702408804305491*^9}, {3.7024088371940002`*^9, 
   3.70240892827332*^9}, {3.702408971790017*^9, 3.702408973925147*^9}, {
   3.702409012124255*^9, 3.702409073253428*^9}, {3.702409139888706*^9, 
   3.7024091966210623`*^9}, {3.702409236832713*^9, 3.7024092616688423`*^9}, {
   3.70240932778806*^9, 3.702409388664703*^9}, {3.702409796093885*^9, 
   3.702409805135612*^9}, 3.702592476953209*^9, 3.702594778781792*^9, {
   3.702594866685436*^9, 3.702594999561063*^9}, {3.7025959063252535`*^9, 
   3.7025959177102737`*^9}, {3.702596474407205*^9, 3.702596483266099*^9}, {
   3.702598294671201*^9, 3.702598294790061*^9}, {3.7025983409832964`*^9, 
   3.7025983422245584`*^9}, {3.702598378278716*^9, 3.7025984199052324`*^9}, {
   3.7025988318325233`*^9, 3.7025988374521275`*^9}, {3.7025990574535713`*^9, 
   3.702599067529561*^9}, {3.702599299765601*^9, 3.702599307183911*^9}, {
   3.7025993507059383`*^9, 3.70259935655302*^9}, {3.7025995625848694`*^9, 
   3.7025995837709713`*^9}, {3.7025996535979137`*^9, 3.702599712002676*^9}, {
   3.702599821305484*^9, 3.7025998433070784`*^9}, {3.7026001048662925`*^9, 
   3.7026003497909474`*^9}, {3.7026003872893248`*^9, 3.702600468815406*^9}, {
   3.7026006311880016`*^9, 3.702600635502041*^9}, {3.702600745459869*^9, 
   3.702600784955394*^9}, {3.7026008880604773`*^9, 3.70260089417774*^9}, {
   3.7026045453624277`*^9, 3.70260456288484*^9}, {3.7026486059681063`*^9, 
   3.7026486090501013`*^9}},
 ExpressionUUID -> "8e46c2ca-b297-47c8-9ea8-88aa2fec681e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model fit plots",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.702409840887231*^9, 3.7024098536540403`*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "tt"}], "]"}]}], ";"}], " "}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathogens", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Klebsiella pneumoniae\>\"", ",", "\"\<Acinetobacter baumanii\>\"", 
      ",", "\"\<Pseudomonas aeruginosa\>\"", ",", 
      "\"\<Enterobacter aerogenes/cloacae\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nos", " ", "=", " ", 
    RowBox[{"Length", "[", 
     RowBox[{"r0f", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"#", " ", "of", " ", "samples"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["rbay",
     FontWeight->"Bold"], 
    StyleBox[" ",
     FontWeight->"Plain"], 
    StyleBox["=",
     FontWeight->"Plain"], 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nos", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", "initialize", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox["For",
   FontWeight->"Bold"], 
  StyleBox["[",
   FontWeight->"Bold"], 
  RowBox[{
   StyleBox[
    RowBox[{"i", "=", "1"}],
    FontWeight->"Bold"], 
   StyleBox[",",
    FontWeight->"Bold"], 
   RowBox[{
    StyleBox["i",
     FontWeight->"Bold"], 
    StyleBox["\[LessEqual]",
     FontWeight->"Bold"], " ", "nop"}], 
   StyleBox[",",
    FontWeight->"Bold"], 
   StyleBox[
    RowBox[{"i", "++"}],
    FontWeight->"Bold"], 
   StyleBox[",",
    FontWeight->"Bold"], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{
     StyleBox["r0s",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"r0f", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", 
    RowBox[{"kss", " ", "=", " ", 
     RowBox[{"ksf", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"sampled", " ", "r0", " ", "and", " ", "ks", " ", "parameters"}],
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{"res", " ", "=", " ", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"years", ",", 
        RowBox[{"rfreq", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}]}], ";", " ", 
    RowBox[{
     StyleBox["(*",
      FontWeight->"Plain"], 
     RowBox[{"resistance", " ", "frequency", " ", "data"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", "nos"}], ",", 
      RowBox[{"j", "++"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"iso", "=", 
         RowBox[{"isolates", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{
         StyleBox["resis",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["=",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         RowBox[{"resistance", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"a", " ", "=", " ", 
         RowBox[{"cbp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"rbay", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"k", ",", 
             RowBox[{"r0s", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"kss", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"-", "0.1"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "tt"}], "}"}]}], "]"}]}]}], "}"}]}], 
     "]"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
      " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rm", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"rbay", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "r"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", "tt"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"rM", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"rbay", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "r"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", "15"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "find", " ", "min", " ", "and", " ", "max", " ", "parameter", " ", 
      "sets"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rfill", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"rm", ",", "rM"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rfit", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"rfill", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotD", "[", 
      RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"res", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotM", "[", 
      RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"rfit", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"pathogens", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}]}], ";"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.702409813193028*^9, {3.702409859199143*^9, 3.702409903520693*^9}, {
   3.7024099757211637`*^9, 3.7024100165853167`*^9}, {3.702410052412945*^9, 
   3.702410091736423*^9}, {3.70241012705923*^9, 3.7024101518903418`*^9}, {
   3.7024260716442165`*^9, 3.7024260942685614`*^9}, {3.702426392615986*^9, 
   3.70242639577573*^9}, {3.702430473744401*^9, 3.7024304747267165`*^9}, {
   3.7024311476478205`*^9, 3.7024311674616966`*^9}, {3.7024312206210165`*^9, 
   3.7024312505955276`*^9}, {3.702431338623353*^9, 3.702431372124758*^9}, {
   3.7024314226539345`*^9, 3.70243144287173*^9}, {3.702431496994196*^9, 
   3.7024314976105585`*^9}, {3.702432228440519*^9, 3.702432337872447*^9}, {
   3.7025920252199173`*^9, 3.7025920313177357`*^9}, {3.702592099550153*^9, 
   3.7025921081981564`*^9}, {3.7025998640561094`*^9, 3.7026000541887283`*^9}, 
   3.7026009324121423`*^9, {3.702601052674551*^9, 3.7026011504759274`*^9}, {
   3.7026013446241903`*^9, 3.702601420393962*^9}, {3.702601626644082*^9, 
   3.702601627612935*^9}, {3.7026017308797626`*^9, 3.7026017321711955`*^9}, {
   3.702601958414353*^9, 3.702601979662551*^9}, {3.702602087217601*^9, 
   3.702602168560034*^9}, {3.702602250380328*^9, 3.70260235868782*^9}, {
   3.7026024626604433`*^9, 3.702602481489368*^9}, {3.7026025685627365`*^9, 
   3.702602579815821*^9}, {3.7026026197903976`*^9, 3.7026026871619167`*^9}, {
   3.702648599647121*^9, 3.7026486009295745`*^9}},
 ExpressionUUID -> "d9e4c014-30ea-45eb-9af4-d8d18697c3ac"]
}, Open  ]],

Cell[TextData[StyleBox["Model projections",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.702410180634329*^9, 3.7024101967250853`*^9}, {
  3.7026076117862835`*^9, 3.7026076129675007`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Status quo:",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.702603534491868*^9, 3.702603549660469*^9}}],

Cell["\<\
Scenario A: Maintain most recent consumption levels until 2030
Scenario B: Maintain linear trend of increasing consumption levels until 2030\
\>", "Text",
 CellChangeTimes->{{3.702603627180174*^9, 3.702603634955613*^9}, {
  3.7026039258761435`*^9, 3.7026039471902885`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ti", "=", "2017"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"projections", " ", "begin", " ", "at", " ", "year", " ", 
    SubscriptBox["t", "i"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tfS", "=", "2030"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "model", " ", "projections", " ", "of", " ", "status", " ", "quo", " ", 
    "until", " ", "year", " ", "tf"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cbpdata", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"years", ",", "cbppneu"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lm", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"LinearModelFit", "[", 
     RowBox[{"cbpdata", ",", "y", ",", "y"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cbpmodelfit", "[", "y_", "]"}], ":=", "lm"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    StyleBox["A",
     FontWeight->"Bold"], ":", " ", 
    RowBox[{
    "maintain", " ", "most", " ", "recent", " ", "consumption", " ", "level", 
     " ", "until", " ", "ti", " ", 
     RowBox[{"(", 
      RowBox[{"pneumonia", ",", " ", 
       RowBox[{"all", " ", "pathogens"}]}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cA", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"cbppneu", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], ",", 
      RowBox[{"Round", "[", 
       RowBox[{"ti", "-", 
        RowBox[{"years", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], " ", ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "project", " ", "status", " ", "quo", " ", "until", " ", "intervention", 
    " ", "start", " ", "date"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cSA", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"cA", ",", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"cbppneu", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", 
        RowBox[{"Round", "[", 
         RowBox[{"tfS", "-", "ti"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     StyleBox["C",
      FontVariations->{"Underline"->True}], "onsumption"}], ",", " ", 
    RowBox[{
     RowBox[{
      StyleBox["S",
       FontVariations->{"Underline"->True}], "tatus", " ", "Quo"}], "-", " ", 
     RowBox[{"scenario", " ", 
      StyleBox["A",
       FontVariations->{"Underline"->True}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"B", ":", 
    RowBox[{
    "maintain", " ", "linear", " ", "trend", " ", "of", " ", "increasing", 
     " ", "consumption", " ", "until", " ", "ti", " ", 
     RowBox[{"(", 
      RowBox[{"pneumonia", ",", " ", 
       RowBox[{"all", " ", "pathogens"}]}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cB", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "+", "1"}], ",", "ti"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cSB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cB", ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"ti", "+", "1"}], ",", "tfS"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7024101570563507`*^9, {3.702410218390636*^9, 3.702410362817946*^9}, {
   3.702410394869886*^9, 3.7024103970699472`*^9}, {3.7024104362820168`*^9, 
   3.702410444877763*^9}, {3.702410485033464*^9, 3.702410497966292*^9}, {
   3.7024106015437107`*^9, 3.702410687478723*^9}, 3.702410887353681*^9, {
   3.7024109658707323`*^9, 3.702410969317919*^9}, {3.7024261213503265`*^9, 
   3.7024261280905967`*^9}, {3.7024263725653534`*^9, 3.702426380245617*^9}, {
   3.702426457971155*^9, 3.7024264932668233`*^9}, {3.7024293872030387`*^9, 
   3.7024293931895275`*^9}, {3.702429462175844*^9, 3.70242946525767*^9}, {
   3.702430121492141*^9, 3.7024301671103873`*^9}, {3.7024302762387476`*^9, 
   3.702430288760964*^9}, {3.702602720366373*^9, 3.702602840125661*^9}, {
   3.7026031465353184`*^9, 3.7026031474650335`*^9}, {3.7026033972780867`*^9, 
   3.702603406298466*^9}, {3.702603490064167*^9, 3.7026035425465*^9}, {
   3.702603748914621*^9, 3.7026037557344093`*^9}, {3.7026038357954664`*^9, 
   3.70260402405709*^9}, {3.7026040635506363`*^9, 3.7026040924832597`*^9}, {
   3.702604127092943*^9, 3.7026041436324997`*^9}, {3.702604195469359*^9, 
   3.7026042206680965`*^9}, {3.702604385083973*^9, 3.702604385083973*^9}, {
   3.702604452109454*^9, 3.7026044572336707`*^9}, {3.7026046644178343`*^9, 
   3.702604782323124*^9}, {3.702604815451456*^9, 3.7026049122899776`*^9}, {
   3.7026049493220153`*^9, 3.702605312436839*^9}, {3.7026053451891856`*^9, 
   3.70260537120267*^9}, {3.702605464011903*^9, 3.7026056898665967`*^9}, {
   3.7026057558689847`*^9, 3.702605785897622*^9}, {3.7026062910970287`*^9, 
   3.702606301584321*^9}, {3.7026064336795626`*^9, 3.7026064641264615`*^9}, {
   3.70260649762007*^9, 3.702606699432031*^9}, {3.702606797353369*^9, 
   3.7026068212107677`*^9}, {3.702607015743698*^9, 3.7026070490893416`*^9}, {
   3.702607080595648*^9, 3.702607470013959*^9}, {3.702607534730098*^9, 
   3.7026075542134647`*^9}, {3.702607587115961*^9, 3.7026075902529755`*^9}, {
   3.7026081191675706`*^9, 3.702608131015749*^9}, {3.70260853580128*^9, 
   3.702608536075663*^9}, {3.7026107463054285`*^9, 3.702610746664848*^9}, 
   3.7026485641432457`*^9, {3.702650904753705*^9, 3.702650913644171*^9}},
 ExpressionUUID -> "a0c0b461-cf24-49a7-b2d1-dfdb7c4a7d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Interventions:",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7026076005569897`*^9, 3.7026076041278887`*^9}}],

Cell[TextData[{
 StyleBox["1. Antimicrobial Restrictions:",
  FontWeight->"Bold"],
 " \n(1) immediate, full restriction on consumption at ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "i"], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "; \n(2) full restriction on consumption by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "f"], ";"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " \n(3) immediate reduction to z% of consumption at ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "i"], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ";\n(4) reduction to z% of consumption by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "f"], ";"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " "
}], "Text",
 CellChangeTimes->{{3.7026076267843113`*^9, 3.702607816958927*^9}, {
  3.7026079018122835`*^9, 3.7026079026848927`*^9}, {3.702607964994547*^9, 
  3.7026080206713915`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"int1", "=", "4"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"#", " ", "of", " ", "interventions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z1", "=", 
   RowBox[{"{", 
    RowBox[{"0.95", ",", "0.95", ",", "0.22", ",", "0.22"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf1", "=", 
   RowBox[{"{", 
    RowBox[{"2018", ",", "2020", ",", "2018", ",", "2020"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iyears1", "=", 
    RowBox[{"tf1", "-", "ti"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Under", " ", "Status", " ", "Quo", " ", "A", " ", "until", " ", "2017"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c1A", "=", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "int1", ",", "Null"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", "int1"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"proj1A", "=", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"cA", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"z1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"cA", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"cA", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "/", 
           RowBox[{"iyears1", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c1A", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{"cA", ",", "proj1A", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"proj1A", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", 
           RowBox[{"tfS", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tf1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ")"}]}]}], "]"}]}],
         "]"}]}]}]}], "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Matrix", " ", "of", " ", "consumption", " ", "values", " ", "up", " ", 
     "to", " ", "the", " ", "year", " ", "2030", " ", "for", " ", 
     "intervention", " ", "1", " ", 
     RowBox[{"(", 
      RowBox[{"Antimicrobial", " ", "Restrictions"}], ")"}]}], ";", " ", 
    RowBox[{"status", " ", "quo", " ", "A", " ", 
     RowBox[{"(", 
      RowBox[{"constant", " ", "consumption", " ", "to", " ", "2017"}], 
      ")"}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Under", " ", "Status", " ", "Quo", " ", "B", " ", "until", " ", "2017"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c1B", "=", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "int1", ",", "Null"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", "int1"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"proj1B", "=", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"cB", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"z1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"cB", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"cB", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "/", 
           RowBox[{"iyears1", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c1B", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{"cB", ",", "proj1B", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"proj1B", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", 
           RowBox[{"tfS", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tf1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ")"}]}]}], "]"}]}],
         "]"}]}]}]}], "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Matrix", " ", "of", " ", "consumption", " ", "values", " ", "up", " ", 
     "to", " ", "the", " ", "year", " ", "2030", " ", "for", " ", 
     "intervention", " ", "1", " ", 
     RowBox[{"(", 
      RowBox[{"Antimicrobial", " ", "Restrictions"}], ")"}]}], ";", " ", 
    RowBox[{"status", " ", "quo", " ", "B", " ", 
     RowBox[{"(", 
      RowBox[{"constant", " ", "consumption", " ", "to", " ", "2017"}], 
      ")"}]}]}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7026078478093996`*^9, 3.7026079384935355`*^9}, {
   3.7026080092056417`*^9, 3.702608105834629*^9}, {3.7026081760728483`*^9, 
   3.702608219451664*^9}, {3.7026082597971225`*^9, 3.7026083289659023`*^9}, {
   3.702608363840145*^9, 3.7026083648402553`*^9}, {3.7026083969265842`*^9, 
   3.7026084268595705`*^9}, {3.702608464558751*^9, 3.702608794761808*^9}, 
   3.702608879519632*^9, {3.702608925107469*^9, 3.7026089587519765`*^9}, {
   3.7026090045055113`*^9, 3.702609305347724*^9}, {3.7026093755043054`*^9, 
   3.7026094020365*^9}, {3.702609447459673*^9, 3.70260952879064*^9}, {
   3.7026095823546534`*^9, 3.7026097998743625`*^9}, {3.7026098525053244`*^9, 
   3.7026100268956666`*^9}, {3.7026100802435637`*^9, 
   3.7026101064187307`*^9}, {3.7026102027734065`*^9, 
   3.7026102648811903`*^9}, {3.702610365328326*^9, 3.702610365578352*^9}, {
   3.702610403196272*^9, 3.702610472134322*^9}, {3.70264858817552*^9, 
   3.7026485938158765`*^9}, {3.7026506874012394`*^9, 
   3.7026506936764393`*^9}, {3.702650886243085*^9, 3.702650892926223*^9}}],

Cell[TextData[{
 StyleBox["2. Vaccine: ",
  FontWeight->"Bold"],
 "reductions in incidence lead to reduced consumption of CBPs"
}], "Text",
 CellChangeTimes->{{3.7026101034441676`*^9, 3.7026101261087875`*^9}, {
  3.7026101731484923`*^9, 3.7026101921973925`*^9}, {3.702610310297309*^9, 
  3.7026103162693353`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"z2", "=", "0.0957"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf2", "=", "2022"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iyears2", "=", 
    RowBox[{"tf2", "-", "ti"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Under", " ", "Status", " ", "Quo", " ", "A", " ", "until", " ", "2017"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proj2A", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"cA", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], ",", 
     RowBox[{"z2", "*", 
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z2", "-", "1"}], ")"}], "/", "iyears2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c2A", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"cA", ",", "proj2A", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"proj2A", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", 
        RowBox[{"tfS", "-", 
         RowBox[{"(", 
          RowBox[{"tf2", "+", "1"}], ")"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Under", " ", "Status", " ", "Quo", " ", "B", " ", "until", " ", "2017"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proj2B", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"cA", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], ",", 
     RowBox[{"z2", "*", 
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z2", "-", "1"}], ")"}], "/", "iyears2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2B", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cA", ",", "proj2B", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"proj2B", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"tfS", "-", 
        RowBox[{"(", 
         RowBox[{"tf2", "+", "1"}], ")"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.702610193180517*^9, 3.702610197631713*^9}, {
  3.7026102944428177`*^9, 3.702610397609417*^9}, {3.7026104464434843`*^9, 
  3.7026105360576835`*^9}, {3.702610581780468*^9, 3.702610600849235*^9}}],

Cell[TextData[{
 StyleBox["3. Hand Washing:  ",
  FontWeight->"Bold"],
 "reductions in incidence lead to reduced consumption of CBPs "
}], "Text",
 CellChangeTimes->{{3.7026105593507423`*^9, 3.702610579413301*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"z3", "=", "0.07"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf3", "=", "2020"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iyears3", "=", 
    RowBox[{"tf3", "-", "ti"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Under", " ", "Status", " ", "Quo", " ", "A", " ", "until", " ", "2017"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proj3A", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"cA", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], ",", 
     RowBox[{"z3", "*", 
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z3", "-", "1"}], ")"}], "/", "iyears3"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c3A", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"cA", ",", "proj3A", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"proj3A", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", 
        RowBox[{"tfS", "-", 
         RowBox[{"(", 
          RowBox[{"tf3", "+", "1"}], ")"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Under", " ", "Status", " ", "Quo", " ", "B", " ", "until", " ", "2017"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proj3B", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"cA", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], ",", 
     RowBox[{"z3", "*", 
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"cA", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z3", "-", "1"}], ")"}], "/", "iyears3"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2B", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cA", ",", "proj3B", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"proj3B", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"tfS", "-", 
        RowBox[{"(", 
         RowBox[{"tf3", "+", "1"}], ")"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7026105801361184`*^9, 3.7026106463160715`*^9}, 
   3.7026512503051186`*^9}],

Cell[BoxData[{
 RowBox[{"Dimensions", "[", 
  RowBox[{"r0f", "[", 
   RowBox[{"[", "1", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", "nos"}], "Input",
 CellChangeTimes->{{3.7026513400668583`*^9, 3.702651366888471*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tyears", "=", 
    RowBox[{"tfS", "-", 
     RowBox[{"years", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "\[IndentingNewLine]", 
   RowBox[{"nyears", "=", 
    RowBox[{"tyears", "-", "tt"}]}]}]}]], "Input",
 CellChangeTimes->{{3.702651461193322*^9, 3.7026514757267685`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Project Resistance Frequency",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.702650753249956*^9, 3.7026507666123652`*^9}, {
  3.702651226037007*^9, 3.7026512274247108`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"projections", " ", "1", "A"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tyears", "=", 
     RowBox[{"tfS", "-", 
      RowBox[{"years", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nyears", "=", 
     RowBox[{"tyears", "-", "tt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rp1A", "=", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "nos", ",", "Null"}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "initialize", " ", "resistance", " ", "frequency", " ", "vector", " ", 
      "for", " ", "projections"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"plot1A", "=", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"l", " ", "is", " ", "intervention", " ", "#"}], ",", " ", 
     RowBox[{"i", " ", "is", " ", "pathogen", " ", "#"}], ",", " ", 
     RowBox[{"j", " ", "is", " ", "parameter", " ", "sample", " ", "#"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"nop", "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r0p", "=", 
        RowBox[{"r0f", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
       RowBox[{"ksp", "=", 
        RowBox[{"ksf", "[", "i", "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "parameter", " ", "sets", " ", "for", " ", "each", " ", "pathogen"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "consumption", " ", "vector", " ", "for", " ", "pathogen", " ", 
          "l"}], ",", " ", 
         RowBox[{"intervention", " ", "i", " ", 
          RowBox[{"(", 
           RowBox[{"projection", " ", "years", " ", "only"}], ")"}]}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nos"}], ",", " ", 
         RowBox[{"j", "++"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iso", "=", 
            RowBox[{"isolates", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            StyleBox["resis",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            StyleBox["=",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            RowBox[{"resistance", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"a", "=", 
            RowBox[{"c1A", "[", 
             RowBox[{"[", "l", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"rp1A", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"k", ",", 
                RowBox[{"r0p", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"ksp", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"-", "0.1"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "tt", ",", 
                RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"rm", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"rp1A", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "r"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", "tt"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"rM", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"rp1A", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "r"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", "15"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "find", " ", "min", " ", "and", " ", "max", " ", "parameter", " ", 
         "sets"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rfill", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"rm", ",", "rM"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rfit", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"years", ",", 
             RowBox[{"rfill", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plot1A", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"rfit", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", "\[Rule]", 
             RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.702610551381768*^9, {3.702610685435268*^9, 3.7026106917646465`*^9}, {
   3.7026480238850737`*^9, 3.702648089471554*^9}, {3.7026481237490444`*^9, 
   3.702648133046878*^9}, {3.702648208328927*^9, 3.7026482524866276`*^9}, {
   3.7026485073585434`*^9, 3.7026485271962624`*^9}, {3.702648574018855*^9, 
   3.7026485838093414`*^9}, {3.702648614140617*^9, 3.702648685756343*^9}, {
   3.7026487158725977`*^9, 3.702648721925932*^9}, {3.7026489571137047`*^9, 
   3.702649051892696*^9}, {3.702649156379258*^9, 3.702649267112368*^9}, {
   3.7026493004238524`*^9, 3.702649332910256*^9}, {3.7026494511396694`*^9, 
   3.7026495011728272`*^9}, {3.7026495417652435`*^9, 
   3.7026497614392233`*^9}, {3.7026499171895247`*^9, 3.702649933237446*^9}, {
   3.7026499774710674`*^9, 3.702650041655858*^9}, {3.702650123663436*^9, 
   3.7026501724239225`*^9}, {3.7026502122583675`*^9, 3.702650212570901*^9}, {
   3.7026502497259398`*^9, 3.7026503002537622`*^9}, {3.7026505181798267`*^9, 
   3.7026505185859528`*^9}, {3.7026507854855385`*^9, 
   3.7026508606836815`*^9}, {3.7026509234601793`*^9, 
   3.7026509270650644`*^9}, {3.702651010658308*^9, 3.702651013136376*^9}, 
   3.702651056535714*^9, {3.7026510922593565`*^9, 3.7026510957690907`*^9}, {
   3.702651446290641*^9, 3.7026514813060827`*^9}, {3.7026519582006865`*^9, 
   3.70265195888826*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Show plots",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.702410754612309*^9, 3.7024107573070602`*^9}}],

Cell[BoxData[{
 RowBox[{"plots", " ", "=", 
  RowBox[{"Panel", "[", 
   RowBox[{
    RowBox[{"GraphicsGrid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"plotM", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"plotD", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"plotS", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"plotP", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"plotM", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"plotD", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"plotS", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"plotP", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesOrigin", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"2000", ",", "0.05"}], "}"}]}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"plotM", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"plotD", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"plotS", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"plotP", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"plotM", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"plotD", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"plotS", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"plotP", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<95% confidence interval of model fit and projections\>\"", ",", 
        "\"\<Panel\>\"", ",", "32", ",", 
        RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Rotate", "[", 
         RowBox[{"\"\<Resistance frequency\>\"", ",", 
          RowBox[{"90", " ", "Degree"}]}], "]"}], ",", "\"\<Panel\>\"", ",", 
        "32", ",", 
        RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Years\>\"", ",", "\"\<Panel\>\"", ",", "32", ",", 
        RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Top", ",", "Center"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Left", ",", "Center"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", "Center"}], "}"}]}], "}"}], ",", 
    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
    RowBox[{"Background", "\[Rule]", "White"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<test.png\>\"", ",", "plots"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.702407870457457*^9, {3.7024248406466923`*^9, 3.702425175347551*^9}, {
   3.702425945909051*^9, 3.702426004912137*^9}, {3.702427421515868*^9, 
   3.7024274558517714`*^9}, {3.702427486284043*^9, 3.7024275824191093`*^9}, {
   3.7024276263168*^9, 3.702427715560113*^9}, {3.702427748535629*^9, 
   3.7024277518682117`*^9}, {3.702427870675129*^9, 3.7024278752066483`*^9}, {
   3.702427908102473*^9, 3.702427937725103*^9}, {3.7024279681150503`*^9, 
   3.7024280470823584`*^9}, {3.702428096138521*^9, 3.7024281635034637`*^9}, {
   3.702428194076641*^9, 3.7024282365377474`*^9}, {3.7024284276501617`*^9, 
   3.7024285345698442`*^9}, {3.7024287126011314`*^9, 
   3.7024287517714176`*^9}, {3.7024287966754894`*^9, 3.702428799345875*^9}, {
   3.7024291627971797`*^9, 3.702429188752822*^9}, {3.7024293149599457`*^9, 
   3.702429362972146*^9}, {3.702429470849602*^9, 3.7024295031878643`*^9}, {
   3.7024295811711235`*^9, 3.7024295905754395`*^9}, {3.702429637656077*^9, 
   3.702429644484815*^9}, {3.7024297385128016`*^9, 3.702429743987793*^9}, {
   3.702429790612954*^9, 3.7024298113467045`*^9}, {3.702430351995313*^9, 
   3.7024303641922092`*^9}, {3.7024303952954717`*^9, 3.70243043580497*^9}, {
   3.70243152124923*^9, 3.7024315724123297`*^9}, {3.7024316465214443`*^9, 
   3.7024316663737264`*^9}, 3.7024318095117598`*^9, {3.7024318425123625`*^9, 
   3.702431843053169*^9}, {3.7024318931153374`*^9, 3.702432025890111*^9}, {
   3.7024324067391715`*^9, 3.7024324552833986`*^9}, {3.7024325236477146`*^9, 
   3.7024325273519754`*^9}, {3.702432565792087*^9, 3.702432579781447*^9}, {
   3.7025923534255238`*^9, 3.7025923545819073`*^9}, 3.7025925054702463`*^9},
 ExpressionUUID -> "e293dcdf-d160-4ce2-8cd4-42e92e4e113d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Economic & Health Outcomes", "Section",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.690562109558098*^9, 3.6905621416045623`*^9}, {
  3.701082714608655*^9, 3.7010827159534655`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Mortality",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7010886838931*^9, 3.7010886847229905`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ipneu", "=", "5610000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"pneumonia", " ", "incidence"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ipp", "=", 
    RowBox[{"cbpp", "*", "ipneu"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"pneumonia", " ", "incidence", " ", "by", " ", "pathogen"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "carbapenem", " ", "prescription", " ", "breakdown", " ", "for", " ", 
    "KPC"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kp", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"20", "/", "105"}], ",", 
      RowBox[{"19", "/", "105"}], ",", 
      RowBox[{"29", "/", "105"}], ",", 
      RowBox[{"35", "/", "105"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"carbapenem", " ", "monotherapy"}], ",", " ", 
    RowBox[{"carbapenem", " ", "combination", " ", "therapy"}], ",", " ", 
    RowBox[{"sparing", " ", "mono"}], ",", " ", 
    RowBox[{"sparing", " ", "combo"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"associated", " ", "mortality", " ", "rates"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rkpm", "=", 
    RowBox[{"{", 
     RowBox[{"0.467", ",", "0.278", ",", "0.467", ",", "0.304"}], "}"}]}], 
   ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"carbapenem", " ", "monotherapy"}], ",", " ", 
    RowBox[{"carbapenem", " ", "combination", " ", "therapy"}], ",", " ", 
    RowBox[{"sparing", " ", "mono"}], ",", " ", 
    RowBox[{"sparing", " ", "combo"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "susceptible", " ", "mortality", " ", "rates", " ", "dummy", " ", 
    "variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"skpm", "=", 
   RowBox[{"{", 
    RowBox[{"0.234", ",", "0.234", ",", "0.234", ",", "0.234"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6905640689811068`*^9, 3.690564169126623*^9}, {
   3.690564205920001*^9, 3.69056420667701*^9}, {3.6905642588438544`*^9, 
   3.690564259878296*^9}, {3.690564354027442*^9, 3.6905643545589314`*^9}, {
   3.690567382490943*^9, 3.690567383425419*^9}, 3.7010883537250657`*^9, {
   3.7010883959482737`*^9, 3.701088488843342*^9}, {3.7010887364728775`*^9, 
   3.7010887708904915`*^9}, 3.702604423794283*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"kp", " ", "#", " ", "of", " ", "deaths"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kpdeath", "[", "r_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"kp", "*", "rkpm"}], "]"}], "*", "r"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"kp", "*", "skpm"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "*", 
      RowBox[{"ipp", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"kpdeath", ",", 
      RowBox[{"{", 
       RowBox[{"y", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], "-", 
    RowBox[{"Apply", "[", 
     RowBox[{"kpdeath", ",", 
      RowBox[{"{", 
       RowBox[{"z", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.6905643558343077`*^9, {3.6905645831312065`*^9, 3.6905645834186225`*^9}, {
   3.690564669958626*^9, 3.6905647036683707`*^9}, 3.6905654014415364`*^9, {
   3.690566010906129*^9, 3.690566121870158*^9}, {3.690567227071777*^9, 
   3.6905672294268804`*^9}, {3.690567270075879*^9, 3.69056733109328*^9}, 
   3.6905673726988688`*^9, {3.690567531909567*^9, 3.690567535960597*^9}, {
   3.690567617802348*^9, 3.6905676226627173`*^9}, {3.690567659472659*^9, 
   3.6905678667966757`*^9}, {3.6905678993213234`*^9, 3.690568013445161*^9}, {
   3.690568044171843*^9, 3.6905680570815325`*^9}, {3.690568114031455*^9, 
   3.6905681516997414`*^9}, {3.6905682561215563`*^9, 
   3.6905683958425474`*^9}, {3.690568439773518*^9, 3.690568471547411*^9}, {
   3.690568501972911*^9, 3.6905685416642284`*^9}, 3.6906318035740347`*^9, 
   3.701088496036179*^9, {3.7010885399581594`*^9, 3.7010885420969496`*^9}, {
   3.7010885732060738`*^9, 3.701088617636736*^9}, {3.701088656088112*^9, 
   3.7010886658629875`*^9}, {3.7010887065616207`*^9, 3.701088776338897*^9}, {
   3.7014271866728544`*^9, 3.701427198829024*^9}, {3.701428065041217*^9, 
   3.701428080372735*^9}, {3.701693624369575*^9, 3.701693652488504*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Length of Stay",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.701088691462549*^9, 3.7010886927430353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Length", " ", "of", " ", "stay"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rlos", "=", "5"}], ";"}], " ", 
   RowBox[{"(*", "resistant", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slos", "=", "2"}], ";"}], " ", 
   RowBox[{"(*", "sensitive", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wardcost", "=", "2877"}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"general", " ", "ward", " ", 
     RowBox[{"cost", "/", "day"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.690568673291799*^9, {3.690569371042401*^9, 3.690569533836542*^9}, {
   3.6905695987106423`*^9, 3.69056964252656*^9}, {3.690569686167656*^9, 
   3.690569968998891*^9}, {3.6905700762239404`*^9, 3.690570076484902*^9}, {
   3.6905701552747154`*^9, 3.6905701707303476`*^9}, {3.6905703126397924`*^9, 
   3.690570334732709*^9}, 3.7010886950338507`*^9, {3.7010887851027923`*^9, 
   3.7010889078414125`*^9}, {3.70108897456002*^9, 3.701088979809692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"kp", " ", "general", " ", "ward", " ", "costs"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kplos", "[", "r_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ipp", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", "wardcost", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rlos", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"kp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "r"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"kp", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "+", 
               RowBox[{"kp", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], 
        "+", 
        RowBox[{"(", 
         RowBox[{"slos", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"kp", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"kp", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "r"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"kp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}]}], ")"}]}], 
         ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Apply", "[", 
    RowBox[{"kplos", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"z", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.690568673291799*^9, {3.690569371042401*^9, 3.690569533836542*^9}, {
   3.6905695987106423`*^9, 3.69056964252656*^9}, {3.690569686167656*^9, 
   3.690569968998891*^9}, {3.6905700762239404`*^9, 3.690570076484902*^9}, {
   3.6905701552747154`*^9, 3.6905701707303476`*^9}, {3.6905703126397924`*^9, 
   3.690570334732709*^9}, 3.7010886950338507`*^9, {3.7010887851027923`*^9, 
   3.7010889078414125`*^9}, {3.70108897456002*^9, 3.7010889911602945`*^9}, {
   3.701427202874569*^9, 3.701427220814145*^9}, {3.7014281698058524`*^9, 
   3.7014281947769437`*^9}}]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{958, 1108},
WindowMargins->{{-1927, Automatic}, {-12, Automatic}},
SpellingDictionaries->{"CorrectWords"->{"quo"}},
Magnification:>1.05 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 94, 1, 32, "Input"],
Cell[655, 23, 153, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[833, 29, 153, 2, 106, "Title"],
Cell[CellGroupData[{
Cell[1011, 35, 179, 3, 72, "Section"],
Cell[CellGroupData[{
Cell[1215, 42, 150, 2, 51, "Subsection"],
Cell[1368, 46, 301, 6, 31, "Text"],
Cell[1672, 54, 1018, 24, 99, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2727, 83, 191, 3, 51, "Subsection"],
Cell[2921, 88, 163, 4, 31, "Text"],
Cell[3087, 94, 7569, 178, 297, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10705, 278, 245, 4, 72, "Section"],
Cell[CellGroupData[{
Cell[10975, 286, 208, 3, 51, "Subsection"],
Cell[11186, 291, 1613, 47, 117, "Text"],
Cell[12802, 340, 6937, 113, 83, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19776, 458, 190, 3, 51, "Subsection"],
Cell[19969, 463, 5273, 98, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25279, 566, 192, 3, 51, "Subsection"],
Cell[25474, 571, 5167, 146, 385, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30678, 722, 158, 2, 51, "Subsection"],
Cell[CellGroupData[{
Cell[30861, 728, 143, 2, 41, "Subsubsection"],
Cell[31007, 732, 5497, 137, 385, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36541, 874, 255, 4, 41, "Subsubsection"],
Cell[36799, 880, 2767, 81, 253, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39603, 966, 242, 3, 41, "Subsubsection"],
Cell[39848, 971, 12478, 267, 693, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52363, 1243, 149, 2, 41, "Subsubsection"],
Cell[52515, 1247, 8316, 228, 473, "Input"]
}, Open  ]],
Cell[60846, 1478, 204, 3, 41, "Subsubsection"],
Cell[CellGroupData[{
Cell[61075, 1485, 144, 2, 35, "Subsubsection"],
Cell[61222, 1489, 283, 5, 52, "Text"],
Cell[61508, 1496, 5766, 141, 341, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67311, 1642, 151, 2, 41, "Subsubsection"],
Cell[67465, 1646, 983, 31, 113, "Text"],
Cell[68451, 1679, 6617, 178, 473, "Input"],
Cell[75071, 1859, 313, 7, 32, "Text"],
Cell[75387, 1868, 2740, 85, 275, "Input"],
Cell[78130, 1955, 214, 5, 32, "Text"],
Cell[78347, 1962, 2597, 84, 253, "Input"],
Cell[80947, 2048, 220, 5, 55, "Input"],
Cell[81170, 2055, 382, 9, 99, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81589, 2069, 214, 3, 41, "Subsubsection"],
Cell[81806, 2074, 7423, 180, 451, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89266, 2259, 144, 2, 41, "Subsubsection"],
Cell[89413, 2263, 5434, 118, 319, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94920, 2389, 214, 3, 82, "Title"],
Cell[CellGroupData[{
Cell[95159, 2396, 138, 2, 51, "Subsection"],
Cell[95300, 2400, 2461, 63, 319, "Input"],
Cell[97764, 2465, 2226, 49, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100027, 2519, 145, 2, 51, "Subsection"],
Cell[100175, 2523, 1021, 22, 121, "Input"],
Cell[101199, 2547, 2716, 72, 143, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

