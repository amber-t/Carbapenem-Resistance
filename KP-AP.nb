(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     76057,       1882]
NotebookOptionsPosition[     73994,       1817]
NotebookOutlinePosition[     74451,       1835]
CellTagsIndexPosition[     74408,       1832]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6858785098524837`*^9, 3.685878512794094*^9}}],

Cell[TextData[StyleBox["Carbapenem Resistance", "Subchapter",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.6768904540863285`*^9, 3.676890461169381*^9}, {
   3.683030854794117*^9, 3.6830308835865154`*^9}, {3.683032131761671*^9, 
   3.683032133824201*^9}, 3.683032438777007*^9, {3.683035168869869*^9, 
   3.683035172546686*^9}, {3.683287309412829*^9, 3.6832873106672077`*^9}, {
   3.6863992281172647`*^9, 3.686399241089357*^9}}],

Cell[TextData[{
 StyleBox["Objective:", "Text",
  FontWeight->"Bold"],
 StyleBox[" Whereas a clear correlation exists between consumption of \
antibiotics and the evolution of resistance in microbial communities, the \
effect of reduction of usage is less clear. To project the future frequency \
of carbapenem resistance, based on yearly surveillance data and consumption \
data. A population genetic model was adapted to retrospectively estimate the \
relationship between evolutionary fitness of carbapenem resistance and \
carbapenem consumption.", "Text"]
}], "Text",
 CellChangeTimes->{{3.686399249057722*^9, 3.686399276853971*^9}, {
  3.68640031740476*^9, 3.6864003205371933`*^9}}],

Cell[CellGroupData[{

Cell["Preparing Directory", "Subsubsection",
 CellChangeTimes->{{3.686401629971394*^9, 3.686401650260293*^9}}],

Cell["\<\
Clear all variables. Set directory and change setting such that when it \
closes it closes all outputs.\
\>", "Text",
 CellChangeTimes->{{3.6864016594282627`*^9, 3.6864016983437967`*^9}, {
  3.6864017385595016`*^9, 3.6864017467278137`*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
    RowBox[{"NotebookEventActions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
       RowBox[{"FrontEndExecute", "[", 
        RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
        "]"}]}], "}"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.686401706812792*^9, 3.6864017521197643`*^9}, 
   3.686403149219241*^9, {3.686504717864292*^9, 3.686504722791524*^9}}],

Cell[TextData[StyleBox["Load Data", "Subsubsection"]], "Text",
 CellChangeTimes->{{3.686399554635956*^9, 3.686399562635787*^9}, {
  3.68639960807939*^9, 3.686399611300261*^9}, {3.686399676077423*^9, 
  3.6863997876749487`*^9}, {3.686400427521208*^9, 3.686400441241124*^9}, {
  3.686400593600422*^9, 3.6864005966806297`*^9}}],

Cell["\<\
Reading country data on consumption and resistance and assigning them to \
appropriate variables.\
\>", "Text",
 CellChangeTimes->{3.686400603032765*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"countryname", "=", "\"\<United States\>\""}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<DataSheet_cddep.xlsx\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "countryname"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"years", " ", "=", " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", " ", "=", " ", 
   RowBox[{"Length", "[", "years", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nop", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", "data", "]"}], "-", "4"}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isolates", " ", "=", " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{
       RowBox[{"Length", "[", "data", "]"}], "-", "3"}], ";;", "2"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resistance", " ", "=", " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"3", ";;", 
      RowBox[{
       RowBox[{"Length", "[", "data", "]"}], "-", "3"}], ";;", "2"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rfreq", " ", "=", 
   RowBox[{"resistance", "/", "isolates"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"carbcons", " ", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
    "0.0106", ",", "0.0126", ",", "0.0154", ",", "0.0159", ",", "0.0172", ",",
      "0.019", ",", "0.0211", ",", "0.0221", ",", "0.024", ",", "0.0254", ",",
      "0.0261", ",", "0.0275", ",", "0.0281"}], "}"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "3"}], "]"}], "]"}], "/", "100"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conbreak", " ", "=", " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", "2"}], ",", 
      RowBox[{"1", ";;", "nop"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cardiv", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"carbcons", "*", 
      RowBox[{"conbreak", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.686422034696558*^9, 3.6864220688839083`*^9}, {
   3.686422244390477*^9, 3.686422257854924*^9}, {3.6864223170828114`*^9, 
   3.6864223431908817`*^9}, 3.6864948657783527`*^9, {3.686495706144705*^9, 
   3.686495706998027*^9}, {3.686497157777652*^9, 3.686497176663332*^9}, {
   3.686500722352275*^9, 3.6865007839598494`*^9}, {3.6865008234158993`*^9, 
   3.686500860558977*^9}, {3.686500895439396*^9, 3.6865009047916603`*^9}, {
   3.686501132914021*^9, 3.6865011961896877`*^9}, {3.686502039475134*^9, 
   3.686502053471085*^9}, 3.686504820987131*^9, {3.686504927512206*^9, 
   3.68650493323075*^9}, {3.686505663500307*^9, 3.686505834942637*^9}, {
   3.686506221505989*^9, 3.686506233253963*^9}, 3.6865062638755836`*^9, {
   3.686506304950383*^9, 3.6865063857051888`*^9}, {3.686506464729933*^9, 
   3.686506570268374*^9}, {3.686507885056096*^9, 3.686507925091408*^9}, 
   3.68650806648864*^9, {3.686508132562462*^9, 3.686508159468111*^9}, {
   3.6865082387863083`*^9, 3.686508289413818*^9}, {3.686593508533208*^9, 
   3.686593578249978*^9}, {3.686670822461113*^9, 3.686670846265149*^9}, 
   3.686671020176771*^9, {3.686671058093039*^9, 3.686671058348937*^9}, {
   3.686671195039489*^9, 3.686671197287084*^9}, {3.686672205273057*^9, 
   3.686672265615234*^9}, {3.686672313935074*^9, 3.686672315030695*^9}, {
   3.690514968752684*^9, 3.6905149711878157`*^9}, {3.6905151605791454`*^9, 
   3.6905151977141056`*^9}, {3.6905490426059213`*^9, 
   3.6905490710575967`*^9}, {3.6905491666256824`*^9, 3.69054916762508*^9}, {
   3.690560008801766*^9, 3.690560021440817*^9}, {3.693235488416274*^9, 
   3.693235488880404*^9}, {3.693237503430167*^9, 3.693237504912262*^9}, {
   3.693242514519369*^9, 3.693242533218896*^9}, {3.69324278229449*^9, 
   3.6932427827305317`*^9}, {3.69324331082885*^9, 3.693243311380581*^9}, {
   3.694794944107407*^9, 3.6947949456275787`*^9}, 3.694869444462384*^9, {
   3.69486947773489*^9, 3.6948694780468807`*^9}, {3.696613845884832*^9, 
   3.69661384630057*^9}, 3.6966142251356783`*^9, {3.696614267163052*^9, 
   3.696614268931164*^9}, {3.696614336734581*^9, 3.69661436742657*^9}, {
   3.6966143989830647`*^9, 3.6966144011982822`*^9}, {3.696614476914295*^9, 
   3.696614477617947*^9}, {3.696614523998536*^9, 3.696614524365843*^9}, {
   3.6966149875383883`*^9, 3.69661502321297*^9}, {3.696615101388283*^9, 
   3.69661512177125*^9}, {3.6966152518805857`*^9, 3.696615261003038*^9}, {
   3.696615389139082*^9, 3.696615395235524*^9}, {3.696615597886518*^9, 
   3.696615598926401*^9}, {3.696615815221848*^9, 3.696615816637291*^9}, {
   3.696616322068841*^9, 3.696616323151634*^9}, {3.6968731019011183`*^9, 
   3.696873102132331*^9}, {3.696873474263825*^9, 3.696873474894909*^9}, {
   3.696873750270289*^9, 3.6968737506538773`*^9}, {3.696952191029182*^9, 
   3.696952192165349*^9}, {3.6969525040529337`*^9, 3.69695250910539*^9}, {
   3.696952959626371*^9, 3.696952960785913*^9}, {3.696954591424856*^9, 
   3.696954592264494*^9}, {3.69695474259662*^9, 3.696954751834024*^9}, {
   3.696954829844029*^9, 3.696954858941578*^9}, {3.696959711253429*^9, 
   3.6969597124892597`*^9}, {3.696960225982828*^9, 3.696960229688342*^9}, {
   3.6974636430928164`*^9, 3.69746364475207*^9}, 3.6974636990330257`*^9, {
   3.69746572261734*^9, 3.6974657303934927`*^9}, {3.697466319707209*^9, 
   3.6974663208109493`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
  "carbcons", "\[IndentingNewLine]", "conbreak", "\[IndentingNewLine]", 
   "cardiv", "\[IndentingNewLine]", "rfreq", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.696613592869452*^9, 3.69661361470903*^9}, {
   3.696613687480694*^9, 3.696613692492528*^9}, {3.6966137841051826`*^9, 
   3.696613795492876*^9}, {3.6966138277127666`*^9, 3.696613839504655*^9}, {
   3.696613882040421*^9, 3.696613890496236*^9}, {3.696614369626803*^9, 
   3.696614392586976*^9}, {3.696614646861409*^9, 3.696614671985115*^9}, {
   3.696615137012138*^9, 3.696615270467286*^9}, 3.6969546045468063`*^9, {
   3.697466520166296*^9, 3.6974665223342743`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model ", "Subsubsection",
 CellChangeTimes->{{3.686400307952888*^9, 3.6864004084403467`*^9}, {
  3.686400489920883*^9, 3.686400491960532*^9}}],

Cell[TextData[{
 StyleBox["Derivation:", "Text",
  FontWeight->"Bold"],
 StyleBox[" ", "Text"],
 StyleBox["We fit the historical selection to consumption via a \
deterministic, continuous-time haploid model of the frequency of resistance. \
See, for reference: 1) Hartl, Daniel L., Andrew G. Clark, and Andrew G. \
Clark. Principles of population genetics. Vol. 116. Sunderland: Sinauer \
associates, 1997", "Text",
  FontWeight->"Plain"],
 StyleBox["\[LongDash]base population genetic model", "Text",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["; 2) Nielsen, K. M., & Townsend, J. P. (2004). Monitoring and \
modeling horizontal gene transfer. Nature biotechnology, 22(9), 1110-1114", 
  "Text",
  FontWeight->"Plain"],
 StyleBox["\[LongDash]relation of base model to novel DNA such as \
antimicrobial resistance elements", "Text",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["; and 3) Johnsen, P. J., Townsend, J. P., B\[OSlash]hn, T., \
Simonsen, G. S., Sundsfjord, A., & Nielsen, K. M. (2011). Retrospective \
evidence for a biological cost of vancomycin resistance determinants in the \
absence of glycopeptide selective pressures. Journal of antimicrobial \
chemotherapy, 66(3), 608-610 \[LongDash]", "Text",
  FontWeight->"Plain"],
 StyleBox["application of base model to project future vancomycin resistance \
after ban of use", "Text",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[". \n", "Text",
  FontWeight->"Plain"],
 Cell[BoxData[
  StyleBox[
   RowBox[{
   "The", " ", "functional", " ", "form", " ", "of", " ", "the", " ", "model",
     " ", "is", " ", 
    RowBox[{
     RowBox[{"e", "^", "m"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Subscript", "[", 
         RowBox[{"r", ",", " ", "0"}], "]"}]}], " ", "-", " ", "1", " ", "+", 
       " ", 
       RowBox[{"e", "^", "m"}]}], ")"}]}]}],
   FontWeight->"Bold"]], "Input",
  FontWeight->"Plain"],
 "\[LineSeparator]",
 StyleBox["\n", "Text",
  FontWeight->"Plain"]
}], "Text",
 CellChangeTimes->{{3.686400499649311*^9, 3.68640052600694*^9}, {
   3.6864005718225193`*^9, 3.686400575021463*^9}, {3.68736386207417*^9, 
   3.687363862074381*^9}, 3.6905491725333633`*^9, {3.690722553178647*^9, 
   3.69072257128833*^9}, {3.690722611632101*^9, 3.6907226192004843`*^9}, 
   3.696614487562492*^9, {3.696954774986088*^9, 3.696954776429123*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"t_", ",", "r0_", ",", "a_", ",", "b_", ",", "c_"}], "]"}], " ",
      ":=", " ", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"c", "*", 
            RowBox[{"cn", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}], "*", "t"}]}], ")"}]], " "}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"c", "*", 
            RowBox[{"cn", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}], "*", "t"}]}], ")"}]], " "}]]}], 
    " ", ";"}],
   FontWeight->"Plain"], 
  StyleBox[" ",
   FontWeight->"Plain"], 
  RowBox[{
   StyleBox["(*",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     StyleBox[
      FractionBox[
       StyleBox["dA",
        FontWeight->"Plain"], "dt"],
      FontWeight->"Plain"], 
     StyleBox["=",
      FontWeight->"Plain"], 
     StyleBox[" ",
      FontWeight->"Plain"], 
     RowBox[{
      RowBox[{
       SubscriptBox[
        StyleBox["R",
         FontWeight->"Plain"], "C"], 
       StyleBox["CA",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      StyleBox["+",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubscriptBox[
        StyleBox["R",
         FontWeight->"Plain"], "N"], "A"}]}]}], 
    StyleBox[",",
     FontWeight->"Plain"], 
    StyleBox[" ",
     FontWeight->"Plain"], 
    RowBox[{
     StyleBox[
      FractionBox[
       StyleBox["dB",
        FontWeight->"Plain"], "dt"],
      FontWeight->"Plain"], 
     StyleBox["=",
      FontWeight->"Plain"], 
     StyleBox[" ",
      FontWeight->"Plain"], 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox[
         StyleBox["N",
          FontWeight->"Plain"], "C"], 
        StyleBox["CB",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["+",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{
        SubscriptBox[
         StyleBox["N",
          FontWeight->"Plain"], "N"], "B"}]}], 
      StyleBox["=",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{
        RowBox[{">", " ", "m"}], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           StyleBox["a",
            FontWeight->"Plain"], 
           StyleBox[" ",
            FontWeight->"Plain"], 
           RowBox[{
            SubsuperscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "t"], 
            RowBox[{
             SubscriptBox["p", "t"], 
             SubscriptBox["C", "t"]}]}]}], " ", "+", " ", 
          RowBox[{"bt", " ", "and", "  ", "a"}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox[
           StyleBox["R",
            FontWeight->"Plain"], "C"], "-", 
          SubscriptBox["N", "C"]}]}]}],
       FontWeight->"Plain"]}]}], 
    StyleBox[",",
     FontWeight->"Plain"], 
    StyleBox[" ",
     FontWeight->"Plain"], 
    StyleBox[
     RowBox[{"b", "=", 
      RowBox[{
       SubscriptBox["R", "N"], "-", 
       SubscriptBox["N", "N"]}]}],
     FontWeight->"Plain"]}], 
   StyleBox["*)",
    FontWeight->"Plain"]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.683030762976203*^9, 3.6830307646226077`*^9}, {
   3.683030892090124*^9, 3.6830309083188725`*^9}, {3.6830309721242533`*^9, 
   3.683030993984562*^9}, {3.6830311371186757`*^9, 3.6830311451555557`*^9}, {
   3.683031934623186*^9, 3.6830319364931593`*^9}, {3.683032013522828*^9, 
   3.683032065758599*^9}, {3.6830346542453313`*^9, 3.68303465754213*^9}, {
   3.6830363241484847`*^9, 3.683036329938362*^9}, {3.6830365276454496`*^9, 
   3.683036530676465*^9}, 3.6830367497782087`*^9, {3.683041381379426*^9, 
   3.683041393024686*^9}, {3.6830421349464197`*^9, 3.683042139599684*^9}, {
   3.6830447788287015`*^9, 3.683044779606695*^9}, {3.683045184458967*^9, 
   3.6830452004752617`*^9}, {3.6852083241401463`*^9, 3.685208331594561*^9}, {
   3.685208507957798*^9, 3.685208565997737*^9}, 3.6852094721246767`*^9, {
   3.685209903141817*^9, 3.6852099398500347`*^9}, {3.6852099889580927`*^9, 
   3.685210058891021*^9}, {3.6852103080680428`*^9, 3.685210309237547*^9}, {
   3.685210371854425*^9, 3.685210380461464*^9}, {3.685210428797523*^9, 
   3.6852105257382507`*^9}, {3.6852105754249763`*^9, 3.6852105928533*^9}, {
   3.6852107253971167`*^9, 3.685210739728479*^9}, {3.685211129911818*^9, 
   3.685211139176404*^9}, {3.68521175723141*^9, 3.6852117935313168`*^9}, {
   3.6852123574632883`*^9, 3.685212368014336*^9}, {3.685279366491384*^9, 
   3.685279382363071*^9}, {3.685279416295306*^9, 3.685279429839871*^9}, 
   3.6852808275142384`*^9, {3.6853860677425203`*^9, 3.6853861678062687`*^9}, {
   3.685386259499681*^9, 3.685386260403224*^9}, {3.685881879376438*^9, 
   3.68588188788455*^9}, {3.685882144512109*^9, 3.685882211247509*^9}, {
   3.685882264975534*^9, 3.6858823048645563`*^9}, {3.6863259609700985`*^9, 
   3.68632602143394*^9}, {3.6863261123987613`*^9, 3.6863261127132187`*^9}, {
   3.6863261459947433`*^9, 3.686326158772418*^9}, {3.6863300988135977`*^9, 
   3.6863301392487526`*^9}, {3.6863301968103313`*^9, 
   3.6863302455048313`*^9}, {3.686330295179199*^9, 3.686330312060356*^9}, {
   3.6863310425150905`*^9, 3.686331077920039*^9}, {3.6863311592705336`*^9, 
   3.686331161351984*^9}, {3.686331196844039*^9, 3.6863312002829003`*^9}, {
   3.6863316074494753`*^9, 3.68633161191486*^9}, {3.6863316677333975`*^9, 
   3.6863316752266045`*^9}, {3.686331756685466*^9, 3.6863317652227015`*^9}, {
   3.6863318579611225`*^9, 3.6863318604224625`*^9}, {3.6863320284264183`*^9, 
   3.6863320896920385`*^9}, {3.6863333970093203`*^9, 3.686333468722809*^9}, {
   3.686333527818489*^9, 3.686333530257064*^9}, {3.686333585882146*^9, 
   3.6863335937595434`*^9}, {3.6863337944358063`*^9, 
   3.6863338012252955`*^9}, {3.686333860129887*^9, 3.686333926127783*^9}, {
   3.686334541041381*^9, 3.6863345432302294`*^9}, {3.6863346050474234`*^9, 
   3.6863346194036174`*^9}, {3.6863350339422607`*^9, 
   3.6863350402439137`*^9}, {3.686396824312439*^9, 3.686396830206884*^9}, {
   3.68639728852584*^9, 3.686397385676342*^9}, {3.6863974219206467`*^9, 
   3.686397591467824*^9}, {3.6863977467434483`*^9, 3.686397856243059*^9}, {
   3.6863979037596188`*^9, 3.686398009617909*^9}, {3.686398049831843*^9, 
   3.686398058770108*^9}, {3.68639915087844*^9, 3.686399168049336*^9}, {
   3.686399538546379*^9, 3.686399540314131*^9}, 3.6864005110851316`*^9, 
   3.686400581816401*^9, {3.6864006197723083`*^9, 3.686400620244726*^9}, {
   3.686401869966902*^9, 3.686401900676633*^9}, {3.6864032479875317`*^9, 
   3.6864032930076036`*^9}, {3.6864112529344683`*^9, 3.686411262755252*^9}, {
   3.6864112967508183`*^9, 3.686411330746829*^9}, {3.686412024717753*^9, 
   3.686412049333313*^9}, 3.6864123304368677`*^9, {3.686412473817891*^9, 
   3.686412485495213*^9}, {3.686412529906288*^9, 3.686412535342702*^9}, 
   3.686413143077464*^9, {3.686413922349515*^9, 3.6864139332766542`*^9}, {
   3.686414054550778*^9, 3.68641405601223*^9}, {3.686414101545352*^9, 
   3.686414169219296*^9}, {3.6864142432310667`*^9, 3.686414273315958*^9}, {
   3.686414369325341*^9, 3.686414388826579*^9}, {3.6864144199682903`*^9, 
   3.686414447742525*^9}, {3.686414613494096*^9, 3.686414779850452*^9}, {
   3.686414811798102*^9, 3.686414906928382*^9}, {3.686415062398457*^9, 
   3.686415134968748*^9}, {3.686415560254722*^9, 3.686415665538151*^9}, {
   3.686418321121459*^9, 3.686418334972437*^9}, {3.686508624478046*^9, 
   3.686508632277608*^9}, 3.68650871497578*^9, {3.6866710450891523`*^9, 
   3.686671051229025*^9}, {3.6866716077238398`*^9, 3.6866716968985*^9}, {
   3.686671727131069*^9, 3.6866717297824497`*^9}, {3.686672280091339*^9, 
   3.68667229406674*^9}, {3.6869386960631742`*^9, 3.686938708012053*^9}, {
   3.690514877200051*^9, 3.6905148892161407`*^9}, {3.690721514268401*^9, 
   3.690721571699773*^9}, 3.696616035925852*^9, {3.6975661826500597`*^9, 
   3.6975661924568453`*^9}, {3.697566564484868*^9, 3.697566577524445*^9}}],

Cell[TextData[Cell[BoxData[Cell[TextData[{
  StyleBox["Note:",
   FontWeight->"Bold"],
  StyleBox[
  " The likelihood function used here will additionally be improved from that \
used in the preliminary model above. Because surveillance is conducted by \
sampling and testing for resistance, likelihood can be quantified under \
better distributional assumptions, with greater accuracy and precision. \
Instead of the observed frequencies of resistance (which are not certain), \
likelihood can be calculated based on the observed cases of resistant (",
   FontWeight->"Plain"],
  StyleBox["UKResistance, ",
   FontWeight->"Plain",
   FontSlant->"Italic"],
  StyleBox["above) vs. non-resistant (",
   FontWeight->"Plain"],
  StyleBox["UKIsolates",
   FontWeight->"Plain",
   FontSlant->"Italic"],
  StyleBox[" \[Dash] ",
   FontWeight->"Plain"],
  StyleBox["UKResistance",
   FontWeight->"Plain",
   FontSlant->"Italic"],
  StyleBox[
  ", above) measured by surveillance\[LongDash]see for instance, Johnsen, P. \
J., Townsend, J. P., B\[OSlash]hn, T., Simonsen, G. S., Sundsfjord, A., & \
Nielsen, K. M. (2011). Retrospective evidence for a biological cost of \
vancomycin resistance determinants in the absence of glycopeptide selective \
pressures. Journal of antimicrobial chemotherapy, 66(3), 608-610.",
   FontWeight->"Plain"]
 }], "WolframAlphaShort",
  CellChangeTimes->{{3.683289726057184*^9, 3.683289961266238*^9}, {
   3.683290062090114*^9, 3.6832901235745173`*^9}, {3.683290162800928*^9, 
   3.683290243023469*^9}, {3.683290380014368*^9, 
   3.6832903934151173`*^9}}]], "Input"]], "Text",
 CellChangeTimes->{{3.686399395663114*^9, 3.686399413356991*^9}}],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"Lik", "[", 
     RowBox[{"r0_", ",", "a_", ",", "b_", ",", "c_"}], "]"}], ":=", " ", 
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "r0", ",", "a", ",", "b", ",", 
            "c"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "[", 
            RowBox[{
             RowBox[{"j", "-", "1"}], ",", "r0", ",", "a", ",", "b", ",", 
             "c"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]"}],
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.6830433753306084`*^9}, {3.6830453841421323`*^9, 3.683045385373238*^9}, {
   3.683286539007884*^9, 3.6832865413676167`*^9}, {3.683286571723649*^9, 
   3.6832865735875263`*^9}, {3.6833012740307302`*^9, 
   3.6833013690917635`*^9}, {3.6833024062245913`*^9, 
   3.6833024065060987`*^9}, {3.683303978402192*^9, 3.683303988908411*^9}, {
   3.6833125533026915`*^9, 3.683312560807563*^9}, {3.6833810185649223`*^9, 
   3.6833810198201427`*^9}, {3.6839950164754915`*^9, 3.683995016631748*^9}, {
   3.683995107610061*^9, 3.683995109400138*^9}, {3.684761387233347*^9, 
   3.684761387411523*^9}, {3.685208646552435*^9, 3.685208664904273*^9}, {
   3.685210100038281*^9, 3.685210133317401*^9}, {3.685210612196949*^9, 
   3.685210625376943*^9}, {3.685279459724468*^9, 3.685279483526725*^9}, {
   3.6852807998799334`*^9, 3.6852808089832907`*^9}, {3.685281067274529*^9, 
   3.685281077298399*^9}, {3.68528125115583*^9, 3.685281261013719*^9}, {
   3.6852814331275053`*^9, 3.685281440604895*^9}, {3.685386193320956*^9, 
   3.685386207936881*^9}, {3.686325830517469*^9, 3.686325855990289*^9}, {
   3.6863316529251328`*^9, 3.68633165301976*^9}, {3.686331705422717*^9, 
   3.6863317460069585`*^9}, 3.686331790557254*^9, {3.6863340940272284`*^9, 
   3.6863340949404917`*^9}, 3.6864009082517033`*^9, 3.6864009507187*^9, {
   3.686401046619935*^9, 3.686401063283523*^9}, 3.686401104899159*^9, {
   3.68640350491506*^9, 3.6864035654181747`*^9}, {3.686415534611898*^9, 
   3.6864155467485037`*^9}, {3.6864157341890497`*^9, 
   3.6864157348122463`*^9}, {3.6864183840374823`*^9, 3.686418412399835*^9}, {
   3.686508351245968*^9, 3.686508378709692*^9}, {3.6865086384692287`*^9, 
   3.686508647192649*^9}, 3.686508721860381*^9, {3.69051493172359*^9, 
   3.690514960196232*^9}, {3.69072157779605*^9, 3.6907216007279577`*^9}, {
   3.697566200365423*^9, 3.697566212973073*^9}}],

Cell[BoxData["`"], "Input",
 CellChangeTimes->{3.6968731245116463`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.696872487242713*^9, 3.696872541203751*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model Fitting", "Subsubsection",
 CellChangeTimes->{{3.686401119713789*^9, 3.686401123097458*^9}}],

Cell["\<\
Using NMaximize function to optimize the likelihood function defined above.\
\>", "Text",
 CellChangeTimes->{{3.686401132349853*^9, 3.686401159001874*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", "max"}], ";", " ", 
  RowBox[{"fa", "=", "max"}], ";", " ", 
  RowBox[{"fb", " ", "=", " ", "max"}], ";", " ", 
  RowBox[{"fc", " ", "=", " ", "max"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"iso", "=", 
      RowBox[{"isolates", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{
      StyleBox["resis",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      StyleBox["=",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{"resistance", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"cn", " ", "=", " ", 
      RowBox[{"cardiv", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"max", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"fa", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"fb", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"fc", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}],
       FontWeight->"Plain"], 
      StyleBox["=",
       FontWeight->"Plain"], 
      RowBox[{
       StyleBox["NMaximize",
        FontWeight->"Plain"], 
       StyleBox["[",
        FontWeight->"Plain"], 
       RowBox[{
        RowBox[{
         StyleBox["{",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox[
           RowBox[{"Lik", "[", 
            RowBox[{"r0", ",", "a", ",", "b", ",", "c"}], "]"}],
           FontWeight->"Plain"], 
          StyleBox[",",
           FontWeight->"Plain"], 
          RowBox[{
           StyleBox["0",
            FontWeight->"Plain"], 
           StyleBox["<",
            FontWeight->"Plain"], 
           StyleBox[" ",
            FontWeight->"Plain"], 
           StyleBox["r0",
            FontWeight->"Plain"], 
           StyleBox["<",
            FontWeight->"Plain"], " ", "1"}], ",", " ", 
          RowBox[{"0", "<=", "a", "<=", "0.91"}], ",", 
          RowBox[{"b", ">", "0.3"}], ",", 
          RowBox[{"c", ">", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         StyleBox[
          RowBox[{"r0", ",", "a", ",", "b", ",", "c"}],
          FontWeight->"Plain"], 
         StyleBox["}",
          FontWeight->"Plain"]}], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox[" ",
         FontWeight->"Plain"], 
        StyleBox[
         RowBox[{"MaxIterations", "\[Rule]", "100000"}],
         FontWeight->"Plain"]}], 
       StyleBox["]",
        FontWeight->"Plain"]}]}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", "max", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mfr0", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fr0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"mfa", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fa", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"mfb", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fb", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"mfc", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fc", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6833025719707384`*^9, {3.683302654728984*^9, 3.6833026918074894`*^9}, {
   3.683305381726717*^9, 3.683305382733526*^9}, {3.683305436320718*^9, 
   3.6833055620353374`*^9}, {3.68330569242245*^9, 3.6833057132553678`*^9}, {
   3.683305747381054*^9, 3.6833057503116927`*^9}, {3.6833057893957443`*^9, 
   3.6833057936091614`*^9}, {3.6833058313911486`*^9, 
   3.6833058475402813`*^9}, {3.683306174610812*^9, 3.683306356287518*^9}, {
   3.6833064096304584`*^9, 3.683306418368615*^9}, 3.683308229068428*^9, {
   3.68331049567001*^9, 3.683310530465453*^9}, {3.6833121806373806`*^9, 
   3.6833122089168105`*^9}, {3.6839945508275404`*^9, 
   3.6839945514879313`*^9}, {3.68399458354732*^9, 3.683994586141165*^9}, {
   3.68399467756606*^9, 3.6839946804575405`*^9}, {3.6847657623742933`*^9, 
   3.6847657769199963`*^9}, {3.685208694397087*^9, 3.6852087190811453`*^9}, {
   3.6852089163484287`*^9, 3.6852089290874367`*^9}, {3.685209028107484*^9, 
   3.685209044407055*^9}, {3.685209098938697*^9, 3.685209105686788*^9}, {
   3.685210146423298*^9, 3.6852101769304667`*^9}, {3.685210217493876*^9, 
   3.6852102177735643`*^9}, {3.685211154104813*^9, 3.685211155200183*^9}, {
   3.6852794925639477`*^9, 3.6852795436708727`*^9}, {3.68538621490376*^9, 
   3.685386285395104*^9}, {3.6863258799353366`*^9, 3.6863258892813773`*^9}, {
   3.6863267438615155`*^9, 3.68632674567607*^9}, {3.6863268213850822`*^9, 
   3.6863268852814226`*^9}, {3.6863271531580153`*^9, 
   3.6863271549280853`*^9}, {3.6863274942160964`*^9, 
   3.6863275055762005`*^9}, {3.6863276909064236`*^9, 
   3.6863276919003115`*^9}, {3.6863311035677137`*^9, 3.6863311041007805`*^9}, 
   3.6863312100746512`*^9, {3.686332213173594*^9, 3.686332219766636*^9}, {
   3.686332288539258*^9, 3.6863322916707416`*^9}, {3.6863323742896943`*^9, 
   3.6863323763528147`*^9}, {3.686332535999138*^9, 3.6863325364696045`*^9}, {
   3.6863328389396343`*^9, 3.6863328538567348`*^9}, {3.6863340512605286`*^9, 
   3.6863341262454143`*^9}, {3.686334256316369*^9, 3.686334260695503*^9}, {
   3.686334297066564*^9, 3.686334313032831*^9}, {3.686334392704074*^9, 
   3.6863344581701326`*^9}, {3.6863345641270533`*^9, 
   3.6863345673110623`*^9}, {3.6863346948760877`*^9, 3.686334705669067*^9}, {
   3.6863350709309587`*^9, 3.6863350751470585`*^9}, {3.6864010466426973`*^9, 
   3.686401046660309*^9}, {3.6864021540806217`*^9, 3.686402220989675*^9}, {
   3.686402385905265*^9, 3.686402423908308*^9}, {3.68640259922742*^9, 
   3.686402601386867*^9}, {3.68641846013568*^9, 3.686418484425543*^9}, {
   3.686420584671588*^9, 3.686420611417824*^9}, {3.686508533189612*^9, 
   3.686508586444343*^9}, {3.686508973779498*^9, 3.686508989839095*^9}, {
   3.686509048272788*^9, 3.686509087019269*^9}, {3.686509136238736*^9, 
   3.6865091486185513`*^9}, {3.686509191484441*^9, 3.686509199962942*^9}, {
   3.686509603749239*^9, 3.6865096145848503`*^9}, {3.686509661877747*^9, 
   3.68650971642094*^9}, {3.686510302686512*^9, 3.686510303674869*^9}, 
   3.6865107206294937`*^9, {3.6865120278611526`*^9, 3.68651202902903*^9}, {
   3.686668908318336*^9, 3.686668911853633*^9}, {3.68666906153791*^9, 
   3.686669062633191*^9}, {3.686671104117733*^9, 3.6866711204006157`*^9}, {
   3.686671231708642*^9, 3.686671232683566*^9}, {3.6866723319238377`*^9, 
   3.686672348258445*^9}, {3.686938519269362*^9, 3.686938520420583*^9}, {
   3.686938767464815*^9, 3.686938807690836*^9}, {3.686939133534691*^9, 
   3.686939159882051*^9}, {3.6905149858609276`*^9, 3.690515040811924*^9}, {
   3.690722412300894*^9, 3.690722460608832*^9}, {3.690722634280573*^9, 
   3.690722634788412*^9}, {3.69072268064813*^9, 3.6907227000136023`*^9}, {
   3.690722734984833*^9, 3.6907227373204813`*^9}, {3.6907255880424967`*^9, 
   3.690725589386343*^9}, 3.6932425540079727`*^9, {3.693242587052081*^9, 
   3.693242602843704*^9}, {3.694869273396377*^9, 3.694869275724114*^9}, {
   3.696614243001739*^9, 3.6966142467681313`*^9}, {3.696952976227284*^9, 
   3.696952976542747*^9}, 3.696953098614564*^9, {3.697566223589239*^9, 
   3.697566273477468*^9}, {3.698064179503949*^9, 3.698064181351211*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.696872672273963*^9, 3.696872676941894*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xa", " ", "=", " ", "0.91"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lik3d", "[", 
   RowBox[{"r0_", ",", "b_"}], "]"}], ":=", " ", 
  RowBox[{"Total", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"iso", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"resis", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"Log", "[", 
        RowBox[{"r", "[", 
         RowBox[{
          RowBox[{"j", "-", "1"}], ",", "r0", ",", "xa", ",", "b"}], "]"}], 
        "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"iso", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "-", 
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", 
         RowBox[{"r", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "r0", ",", "xa", ",", "b"}], "]"}]}],
         "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Lik3d", "[", 
     RowBox[{"r0", ",", "b"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"r0", ",", "0.1", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "0", ",", 
     RowBox[{"2", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "9"}], ")"}]}]}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "500"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Lik3d", "[", 
  RowBox[{"0.1455876594993976", ",", "0.7285736892567878"}], "]"}]}], "Input",\

 CellChangeTimes->{{3.6968726864258633`*^9, 3.696872868925477*^9}, {
   3.696872918311491*^9, 3.696872932489163*^9}, {3.696872973145712*^9, 
   3.6968730025846987`*^9}, {3.69687306494888*^9, 3.6968730788290462`*^9}, {
   3.6968732089720488`*^9, 3.696873247648004*^9}, {3.696873309772121*^9, 
   3.6968733918188343`*^9}, {3.696873644766986*^9, 3.696873710070834*^9}, {
   3.696873818110589*^9, 3.696873888261737*^9}, {3.696873920504801*^9, 
   3.6968739396074867`*^9}, {3.696873992794509*^9, 3.696874066953162*^9}, 
   3.696952211838982*^9, 3.6969525340022163`*^9, {3.696954635957345*^9, 
   3.69695464487538*^9}, {3.696958700470869*^9, 3.696958747029974*^9}, {
   3.696958961308363*^9, 3.6969589630495996`*^9}, {3.6969589959351273`*^9, 
   3.696959044005939*^9}, {3.69695908036973*^9, 3.6969591114535437`*^9}, {
   3.69695916724533*^9, 3.6969591857049828`*^9}, {3.696959225662043*^9, 
   3.696959263222268*^9}, {3.696959301240635*^9, 3.6969593804589987`*^9}, {
   3.6969594427042418`*^9, 3.696959456583235*^9}, {3.696959544277278*^9, 
   3.696959556879772*^9}, {3.6969595889486647`*^9, 3.696959673825019*^9}, {
   3.6969597489652576`*^9, 3.696959836176895*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plots", "Subsubsection",
 CellChangeTimes->{{3.6864019318300753`*^9, 3.68640193261397*^9}}],

Cell["\<\
Putting together observed and fitted data together for plotting.\
\>", "Text",
 CellChangeTimes->{{3.686401955977994*^9, 3.686401961490378*^9}, {
  3.686402269675462*^9, 3.686402301627858*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "tt"}], "]"}]}], ";"}], " "}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"res", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"years", ",", 
         RowBox[{"rfreq", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{
   StyleBox["(*",
    FontWeight->"Plain"], 
   RowBox[{"resistance", " ", "frequency", " ", "data"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"cn", " ", "=", " ", 
       RowBox[{"cardiv", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"j", ",", 
           RowBox[{"mfr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfa", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfb", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfc", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}]}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fit", " ", "=", "  ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"years", ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.683301416115432*^9, {3.68330283169864*^9, 3.683302993239018*^9}, {
   3.6833055910794373`*^9, 3.683305636170422*^9}, {3.6833060530293636`*^9, 
   3.6833060632715893`*^9}, {3.6833061142942333`*^9, 
   3.6833061227687674`*^9}, {3.6833063897605376`*^9, 
   3.6833063986934624`*^9}, {3.683308080002949*^9, 3.683308086552434*^9}, {
   3.683308506387912*^9, 3.6833085480807533`*^9}, {3.683308648991184*^9, 
   3.6833086520620613`*^9}, {3.6833086926488714`*^9, 
   3.6833086935110874`*^9}, {3.6833087964396143`*^9, 
   3.6833087982845883`*^9}, {3.6833088393199663`*^9, 
   3.6833088647096834`*^9}, {3.683308899388898*^9, 3.683308914020029*^9}, {
   3.683308985722557*^9, 3.6833090053830585`*^9}, {3.683309065087839*^9, 
   3.6833091018819323`*^9}, {3.683309257098646*^9, 3.683309287030099*^9}, 
   3.6833093257983055`*^9, {3.6833093700122876`*^9, 3.6833093789610586`*^9}, {
   3.683309417684349*^9, 3.683309476007949*^9}, 3.683309945564055*^9, {
   3.6833105665320864`*^9, 3.683310577583398*^9}, {3.6833121895816307`*^9, 
   3.6833122200850763`*^9}, 3.6833809394104614`*^9, {3.683994701083577*^9, 
   3.6839947027780976`*^9}, {3.6839949270869927`*^9, 
   3.6839949407653046`*^9}, {3.6839950439577026`*^9, 3.683995047008658*^9}, {
   3.6839951158716307`*^9, 3.6839951160120826`*^9}, {3.685280905458349*^9, 
   3.685280922295274*^9}, {3.6852812713416033`*^9, 3.685281271589242*^9}, {
   3.685281350521371*^9, 3.685281351481029*^9}, {3.685281446701007*^9, 
   3.685281448020803*^9}, {3.68528148668111*^9, 3.685281487544265*^9}, {
   3.685386488940509*^9, 3.6853865024012413`*^9}, {3.685386577962832*^9, 
   3.685386617220278*^9}, {3.6853866490015383`*^9, 3.6853866724672203`*^9}, {
   3.685386818298174*^9, 3.685386871427639*^9}, {3.685883511343244*^9, 
   3.685883537119133*^9}, 3.685883582491582*^9, {3.6863261931737995`*^9, 
   3.686326219150547*^9}, {3.686401046814313*^9, 3.686401046817287*^9}, {
   3.686402047733604*^9, 3.6864020986534443`*^9}, {3.68640214391778*^9, 
   3.6864021445809097`*^9}, {3.68640230775854*^9, 3.686402343989243*^9}, {
   3.686402445607501*^9, 3.686402582786208*^9}, {3.686402623002123*^9, 
   3.6864026372983227`*^9}, {3.686403710691243*^9, 3.6864037111730623`*^9}, {
   3.68641316084488*^9, 3.6864131786003036`*^9}, {3.68641877598636*^9, 
   3.686418799661862*^9}, {3.686419204532628*^9, 3.686419226142386*^9}, {
   3.686419259131887*^9, 3.686419259810073*^9}, {3.686419305110569*^9, 
   3.686419307970595*^9}, {3.686510588849517*^9, 3.686510700305969*^9}, {
   3.6865109190252237`*^9, 3.686510946164277*^9}, {3.686511685430202*^9, 
   3.686511686286436*^9}, 3.686512039853277*^9, {3.6865868610353813`*^9, 
   3.686586861883483*^9}, {3.686592896868075*^9, 3.6865929138798637`*^9}, 
   3.686593233682899*^9, {3.686593488437748*^9, 3.686593492277429*^9}, 
   3.686593643209486*^9, {3.686672399074642*^9, 3.686672399666*^9}, {
   3.690515080526602*^9, 3.690515080668233*^9}, {3.690723163686688*^9, 
   3.6907231692631474`*^9}, 3.6966143123194103`*^9, {3.697566437624357*^9, 
   3.697566457660091*^9}}],

Cell["Show plots", "Text",
 CellChangeTimes->{{3.686402657524583*^9, 3.686402683445462*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotD", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", "\"\<Resitance frequency\>\"", "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotM", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Thick"}], "}"}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", "\"\<Model fit\>\"", "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"plotD", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"plotM", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (KP)\>\""}]}], "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"plotD", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"plotM", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (PA)\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"plotD", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", 
   RowBox[{"plotM", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (AB)\>\""}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6865118533926163`*^9, 3.686511915888537*^9}, {
  3.6865119612087297`*^9, 3.686511982996516*^9}, {3.686512049161594*^9, 
  3.6865122383680773`*^9}, {3.686589506759753*^9, 3.6865895091916323`*^9}, {
  3.686589553861794*^9, 3.68658955485121*^9}, {3.686589821754445*^9, 
  3.686589853334154*^9}, {3.686589895602083*^9, 3.686589898265753*^9}, {
  3.686590402119738*^9, 3.6865904612873087`*^9}, {3.6932384593743677`*^9, 
  3.693238461502447*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.686512220743477*^9, 3.686512469694191*^9}, {
   3.686590470767819*^9, 3.686590514102783*^9}, {3.686590551602852*^9, 
   3.686590564735014*^9}, {3.6865906007631493`*^9, 3.686590628310752*^9}, {
   3.6865916669518023`*^9, 3.686591668655192*^9}, {3.686672431295786*^9, 
   3.6866724339498863`*^9}, 3.693238456708403*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projections", "Subsubsection",
 CellChangeTimes->{{3.6865809162848587`*^9, 3.686580932773919*^9}}],

Cell["\<\
We project the impact of reduction in carbapenem consumption on the \
antibiotic resistance frequencies in pathogens considered.
\
\>", "Text",
 CellChangeTimes->{{3.6865809558597803`*^9, 3.686581068283208*^9}, {
   3.686581248418756*^9, 3.6865812492826223`*^9}, {3.686581406122053*^9, 
   3.686581423705621*^9}, {3.68658158065337*^9, 3.686581625833177*^9}, 
   3.686672745520751*^9, 3.6907249739142303`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"curcarb", " ", "=", " ", 
    RowBox[{"carbcons", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"current", " ", "carbapenem", " ", "consumption"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"py", " ", "=", "2030"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projection", " ", "till", " ", "year", " ", "py"}], "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"npy", " ", "=", " ", 
   RowBox[{"py", " ", "-", 
    RowBox[{"years", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyears", " ", "=", " ", 
    RowBox[{"Range", "[", " ", 
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], ",", "py"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Status", " ", "Quo", " ", "consumtions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projSQ", " ", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"curcarb", ",", 
      RowBox[{"Round", "[", "npy", "]"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "maintaining", " ", "current", " ", "carbapenem", " ", "consumption", " ", 
    "levels"}], "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"carbconSQ", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"carbcons", ",", "projSQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cardivSQ", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"carbconSQ", "*", 
      RowBox[{"conbreak", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tcSQ", " ", "=", " ", 
    RowBox[{"cardivSQ", "/", "pc"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Total", " ", "antibiotics", " ", "prescribed", " ", "for", " ", 
    "bacterial", " ", 
    RowBox[{"pneumonia", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffSQ", " ", "=", " ", 
    RowBox[{"tcSQ", "-", "cardivSQ"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Intervention", " ", "consumtions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intv", " ", "=", " ", "0.4"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "reducing", " ", "current", " ", "carbapenem", " ", "consumption", " ", 
    "by", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "intv"}], ")"}], " ", "%", " ", "in", " ", "next", " ",
     "npy", " ", "years", " ", "linearly"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "sparing", " ", 
     RowBox[{"(", 
      RowBox[{"0", " ", "immediately"}], ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"set", " ", "approach"}], " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"for", " ", "sparing", " ", 
      RowBox[{"(", 
       RowBox[{"0", " ", "after", " ", "npy", " ", "years"}], ")"}]}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"set", " ", "approach"}], " ", "=", " ", "1"}], ";", " ", 
     RowBox[{"for", " ", "stewardship", " ", 
      RowBox[{"(", 
       RowBox[{
       "immediate", " ", "reduction", " ", "based", " ", "on", " ", "intv"}], 
       ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"set", " ", "approach"}], " ", "=", " ", "2"}], ";", " ", 
     RowBox[{"for", " ", "stewardship", " ", 
      RowBox[{"(", 
       RowBox[{
       "linear", " ", "reduction", " ", "to", " ", "the", " ", "level", " ", 
        "described", " ", "by", " ", "intv"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"set", " ", "approach"}], " ", "=", " ", "3"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"approach", " ", "=", " ", "1"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"approach", "\[Equal]", "0"}], ",", " ", 
   RowBox[{"projI", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Round", "[", "npy", "]"}]}], "]"}]}], ",", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"approach", "\[Equal]", "1"}], ",", 
     RowBox[{"projI", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"curcarb", ",", "0", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "*", 
         RowBox[{"curcarb", "/", 
          RowBox[{"(", 
           RowBox[{"npy", "-", "1"}], ")"}]}]}]}], "]"}]}], ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"approach", "\[Equal]", "2"}], ",", " ", 
       RowBox[{"projI", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"intv", "*", "curcarb"}], ",", 
          RowBox[{"Round", "[", "npy", "]"}]}], "]"}]}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"approach", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{"projI", " ", "=", " ", 
          RowBox[{"Range", "[", 
           RowBox[{"curcarb", ",", 
            RowBox[{"intv", "*", "curcarb"}], ",", 
            RowBox[{"curcarb", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intv", "-", "1"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"npy", "-", "1"}], ")"}]}]}]}], "]"}]}]}], "]"}]}], 
      "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"projI", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"projI", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"curcarb", ",", 
       RowBox[{"intv", "*", "curcarb"}], ",", 
       RowBox[{"curcarb", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"intv", "-", "1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"npy", "-", "1"}], ")"}]}]}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"carbconI", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"carbcons", ",", " ", "projI"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cardivI", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"carbconI", "*", 
      RowBox[{"conbreak", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tcI", " ", "=", " ", 
    RowBox[{"cardivSQ", "/", "pc"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Total", " ", "antibiotics", " ", "prescribed", " ", "for", " ", 
    "bacterial", " ", 
    RowBox[{"pneumonia", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffI", " ", "=", " ", 
    RowBox[{"tcI", "-", "cardivI"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Status", " ", "Quo", " ", "resistances"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"cn", " ", "=", " ", 
       RowBox[{"cardivSQ", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"df", " ", "=", 
       RowBox[{"diffSQ", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"j", ",", 
           RowBox[{"mfr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfa", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfb", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "tt", ",", 
           RowBox[{"tt", "+", "npy"}]}], "}"}]}], "]"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prrSQ", " ", "=", "  ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"pyears", ",", 
         RowBox[{"y", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Intervention", " ", "resistances"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"cn", " ", "=", " ", 
       RowBox[{"cardivI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"df", " ", "=", 
       RowBox[{"diffI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"j", ",", 
           RowBox[{"mfr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfa", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfb", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "tt", ",", 
           RowBox[{"tt", "+", "npy"}]}], "}"}]}], "]"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prrI", " ", "=", "  ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"pyears", ",", 
        RowBox[{"z", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686581690639391*^9, 3.686581692682914*^9}, {
   3.6865845283200493`*^9, 3.68658464361509*^9}, {3.686584825544402*^9, 
   3.686585222982565*^9}, {3.686585372725803*^9, 3.6865854662237453`*^9}, {
   3.68658550150427*^9, 3.686585569472267*^9}, {3.686585599880947*^9, 
   3.68658575892006*^9}, {3.686585802292082*^9, 3.686586160074435*^9}, {
   3.686586237312742*^9, 3.68658629656588*^9}, {3.686586696628215*^9, 
   3.6865867037801647`*^9}, {3.686586742467943*^9, 3.686586815188048*^9}, 
   3.6865868968961353`*^9, {3.686587785846178*^9, 3.686587786815857*^9}, {
   3.6865878992781677`*^9, 3.6865878998146477`*^9}, {3.686589322005342*^9, 
   3.6865893558208017`*^9}, {3.686589428876717*^9, 3.686589428972386*^9}, {
   3.686591257393601*^9, 3.6865912810725813`*^9}, {3.686593662737206*^9, 
   3.6865936659489594`*^9}, {3.6866700740147867`*^9, 3.686670117434482*^9}, {
   3.68667253363557*^9, 3.6866725768898373`*^9}, {3.686672624241622*^9, 
   3.686672700085044*^9}, {3.68667282285349*^9, 3.686672851705336*^9}, {
   3.68667402398144*^9, 3.686674024156755*^9}, {3.686674156785902*^9, 
   3.686674173992827*^9}, {3.686677981137723*^9, 3.686677981291198*^9}, {
   3.6905152558431525`*^9, 3.6905152616479993`*^9}, {3.690560052252635*^9, 
   3.69056005249806*^9}, {3.690562286998247*^9, 3.690562321050914*^9}, {
   3.69056237085006*^9, 3.6905623857432775`*^9}, 3.690650101348329*^9, {
   3.690650726564806*^9, 3.690650739223259*^9}, {3.6907289454148703`*^9, 
   3.690728968386346*^9}, {3.690729811643052*^9, 3.690729813698566*^9}, {
   3.690730235136895*^9, 3.6907302352890997`*^9}, {3.690730268345949*^9, 
   3.690730277537841*^9}, {3.694871052233786*^9, 3.694871058591963*^9}, {
   3.6948712303978977`*^9, 3.6948712476848087`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotPSQ", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prrSQ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Thick", ",", "Dashed"}], "}"}], "}"}]}], 
       ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", "\"\<Status Quo projection\>\"", "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotPI", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prrI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Gray", ",", "Thick", ",", "Dashed"}], "}"}], "}"}]}], ",", 
       
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", "\"\<Intervention projection\>\"", "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"plotD", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"plotM", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"plotPSQ", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"plotPI", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (\!\(\*
StyleBox[\"Klebsiella\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"pneumoniae\",
FontSlant->\"Italic\"]\))\>\""}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Year\>\"", ",", "\"\<Resistance Frequency\>\""}], 
      "}"}]}]}], "]"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"plotD", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"plotM", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"plotPSQ", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"plotPI", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (\!\(\*
StyleBox[\"Pseudomonas\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"aeruginosa\",
FontSlant->\"Italic\"]\))\>\""}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Year\>\"", ",", "\"\<Resistance Frequency\>\""}], "}"}]}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"plotD", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"plotM", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"plotPSQ", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"plotPI", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (\!\(\*
StyleBox[\"Acinetobacter\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"baumannii\",
FontSlant->\"Italic\"]\))\>\""}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Year\>\"", ",", "\"\<Resistance Frequency\>\""}], 
      "}"}]}]}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{" "}]}], "Input",
 CellChangeTimes->{{3.686587937558057*^9, 3.686587961419046*^9}, {
   3.686588179709711*^9, 3.6865882596183434`*^9}, {3.6865882979308367`*^9, 
   3.6865883394523563`*^9}, {3.686588439880148*^9, 3.686588451095933*^9}, {
   3.6865885422886953`*^9, 3.686588555624104*^9}, {3.6865887679077663`*^9, 
   3.686588773426806*^9}, {3.686589124098528*^9, 3.686589198421474*^9}, {
   3.6865892606856813`*^9, 3.686589276641006*^9}, {3.686589575767303*^9, 
   3.686589595651207*^9}, 3.68658963161555*^9, {3.686589732247347*^9, 
   3.686589781242526*^9}, {3.686589915654055*^9, 3.686589918221846*^9}, {
   3.6865899562503347`*^9, 3.686589974149357*^9}, {3.686590097036729*^9, 
   3.6865901967288437`*^9}, {3.6865903076214733`*^9, 3.68659032330002*^9}, {
   3.686590370623966*^9, 3.6865903832441*^9}, {3.686590658539597*^9, 
   3.686590715425766*^9}, {3.686590770683248*^9, 3.686590830986142*^9}, {
   3.686591020529317*^9, 3.6865911017008*^9}, {3.686591384984725*^9, 
   3.686591479683935*^9}, {3.68659158251563*^9, 3.686591656670409*^9}, {
   3.6865917317317457`*^9, 3.68659173738848*^9}, {3.6865920165196733`*^9, 
   3.686592024623201*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6905618463348274`*^9, 3.690561848740586*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Economic & Health Outcomes", "Title",
 CellChangeTimes->{{3.690562109558098*^9, 3.6905621416045623`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"guhkpcount", "=", "351"}], ";", "\[IndentingNewLine]", 
   RowBox[{"guhcrecount", "=", "599"}], ";", "\[IndentingNewLine]", 
   RowBox[{"guhcrudeincidence", "=", 
    RowBox[{"2.93", "/", "100000"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"guhpneumonia", "=", "0.029"}], ";", "\[IndentingNewLine]", 
   RowBox[{"USpop2013", "=", " ", "316500000"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"kprescount", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"guhkpcount", "/", "guhcrecount"}], ")"}], "*", 
     RowBox[{"(", "guhcrudeincidence", ")"}], "*", 
     RowBox[{"(", "guhpneumonia", ")"}], " ", "*", " ", 
     RowBox[{"(", "USpop2013", ")"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"kppatientcount", "=", 
    RowBox[{"kprescount", "/", 
     RowBox[{"rbasecase", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6905621474194403`*^9, 3.690562199741237*^9}, 
   3.690562391327428*^9, 3.690562426252327*^9, {3.690562892796214*^9, 
   3.690562977680258*^9}, {3.690563008922055*^9, 3.690563010147026*^9}, {
   3.6905630540015154`*^9, 3.6905631112987223`*^9}, {3.690563150303508*^9, 
   3.6905632548311257`*^9}, {3.6905633243947716`*^9, 3.690563337293866*^9}, {
   3.69056344097649*^9, 3.690563450462659*^9}, {3.690563922733819*^9, 
   3.6905640825909495`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"anevlaviscapinc", "=", "5610000"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "community", " ", "acquired", " ", "pneumonia", " ", "infections", " ", 
     "only"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"patientnum", "=", 
     RowBox[{"conbreak", "*", "anevlaviscapinc"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6905640689811068`*^9, 3.690564169126623*^9}, {
  3.690564205920001*^9, 3.69056420667701*^9}, {3.6905642588438544`*^9, 
  3.690564259878296*^9}, {3.690564354027442*^9, 3.6905643545589314`*^9}, {
  3.690567382490943*^9, 3.690567383425419*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "carbapenem", " ", "prescription", " ", "breakdown", " ", "for", " ", 
    "KPC"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"leekp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"20", "/", "105"}], ",", 
       RowBox[{"19", "/", "105"}], ",", 
       RowBox[{"29", "/", "105"}], ",", 
       RowBox[{"35", "/", "105"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"carbapenem", " ", "mono"}], ",", " ", 
     RowBox[{"carbapenem", " ", "combo"}], ",", " ", 
     RowBox[{"sparing", " ", "mono"}], ",", " ", 
     RowBox[{"sparing", " ", "combo"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"associated", " ", "mortality", " ", "rates"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rkpmortality", "=", 
     RowBox[{"{", 
      RowBox[{"0.467", ",", "0.278", ",", "0.467", ",", "0.304"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "susceptible", " ", "mortality", " ", "rates", " ", "dummy", " ", 
     "variables"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"skpmortality", "=", 
     RowBox[{"{", 
      RowBox[{"0.234", ",", "0.234", ",", "0.234", ",", "0.234"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"kp", " ", "#", " ", "of", " ", "deaths"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kpdeath", "[", "r_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"leekp", "*", "rkpmortality"}], "]"}], "*", "r"}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"leekp", "*", "skpmortality"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "*", 
      RowBox[{"patientnum", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Apply", "[", 
    RowBox[{"kpdeath", ",", 
     RowBox[{"{", 
      RowBox[{"rbasecase", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.6905643558343077`*^9, {3.6905645831312065`*^9, 3.6905645834186225`*^9}, {
   3.690564669958626*^9, 3.6905647036683707`*^9}, 3.6905654014415364`*^9, {
   3.690566010906129*^9, 3.690566121870158*^9}, {3.690567227071777*^9, 
   3.6905672294268804`*^9}, {3.690567270075879*^9, 3.69056733109328*^9}, 
   3.6905673726988688`*^9, {3.690567531909567*^9, 3.690567535960597*^9}, {
   3.690567617802348*^9, 3.6905676226627173`*^9}, {3.690567659472659*^9, 
   3.6905678667966757`*^9}, {3.6905678993213234`*^9, 3.690568013445161*^9}, {
   3.690568044171843*^9, 3.6905680570815325`*^9}, {3.690568114031455*^9, 
   3.6905681516997414`*^9}, {3.6905682561215563`*^9, 
   3.6905683958425474`*^9}, {3.690568439773518*^9, 3.690568471547411*^9}, {
   3.690568501972911*^9, 3.6905685416642284`*^9}, 3.6906318035740347`*^9}],

Cell[, "Input"]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{1861, 1176},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 94, 1, 38, "Input"],
Cell[655, 23, 434, 6, 60, "Text"],
Cell[1092, 31, 688, 12, 95, "Text"],
Cell[CellGroupData[{
Cell[1805, 47, 110, 1, 44, "Subsubsection"],
Cell[1918, 50, 250, 5, 40, "Text"],
Cell[2171, 57, 792, 19, 107, "Input"],
Cell[2966, 78, 324, 4, 46, "Text"],
Cell[3293, 84, 163, 4, 40, "Text"],
Cell[3459, 90, 6100, 134, 395, "Input"],
Cell[9562, 226, 749, 12, 217, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10348, 243, 148, 2, 44, "Subsubsection"],
Cell[10499, 247, 2386, 57, 231, "Text"],
Cell[12888, 306, 8603, 203, 109, "Input"],
Cell[21494, 511, 1665, 36, 153, "Text"],
Cell[23162, 549, 4650, 87, 93, "Input"],
Cell[27815, 638, 71, 1, 38, "Input"],
Cell[27889, 641, 92, 1, 38, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28018, 647, 104, 1, 44, "Subsubsection"],
Cell[28125, 650, 165, 3, 40, "Text"],
Cell[28293, 655, 8496, 198, 334, "Input"],
Cell[36792, 855, 92, 1, 38, "Input"],
Cell[36887, 858, 3085, 75, 155, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40009, 938, 97, 1, 44, "Subsubsection"],
Cell[40109, 941, 203, 4, 40, "Text"],
Cell[40315, 947, 5769, 130, 244, "Input"],
Cell[46087, 1079, 92, 1, 40, "Text"],
Cell[46182, 1082, 3056, 78, 230, "Input"],
Cell[49241, 1162, 366, 5, 38, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49644, 1172, 104, 1, 44, "Subsubsection"],
Cell[49751, 1175, 418, 8, 67, "Text"],
Cell[50172, 1185, 12931, 357, 1128, "Input"],
Cell[63106, 1544, 5407, 135, 408, "Input"],
Cell[68516, 1681, 94, 1, 38, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68647, 1687, 111, 1, 116, "Title"],
Cell[68761, 1690, 1427, 28, 232, "Input"],
Cell[70191, 1720, 668, 15, 93, "Input"],
Cell[70862, 1737, 3098, 75, 364, "Input"],
Cell[73963, 1814, 15, 0, 751, "Input"]
}, Open  ]]
}
]
*)

