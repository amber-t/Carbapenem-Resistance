(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    176958,       4182]
NotebookOptionsPosition[    173139,       4055]
NotebookOutlinePosition[    173699,       4075]
CellTagsIndexPosition[    173656,       4072]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6858785098524837`*^9, 3.685878512794094*^9}},
 ExpressionUUID -> "01c422d8-83fb-4ad5-9a5d-5aa78bbe9113"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["SEPSIS: MODEL FIT",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.7005872688200474`*^9, 3.700587274570282*^9}, {
  3.7188410276281157`*^9, 3.718841040872573*^9}, {3.7201979535797777`*^9, 
  3.720197955570175*^9}, {3.7207986070862846`*^9, 3.72079860971653*^9}, {
  3.7208009872096796`*^9, 3.7208009881158366`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Data",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.700586955166306*^9, 3.700586956688905*^9}, {
  3.700586999864338*^9, 3.700586999895615*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Preparing Directory",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7005868421634493`*^9, 3.700586844493045*^9}}],

Cell["\<\
Clear all variables. Set directory and change setting such that when it \
closes it closes all outputs.\
\>", "Text",
 CellChangeTimes->{{3.6864016594282627`*^9, 3.6864016983437967`*^9}, {
  3.6864017385595016`*^9, 3.6864017467278137`*^9}, {3.7005783616134434`*^9, 
  3.700578363379423*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "Code",
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["SetDirectory", "Code"], 
   StyleBox["[", "Code"], 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  StyleBox[";", "Code"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"NotebookEventActions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
        RowBox[{"FrontEndExecute", "[", 
         RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
         "]"}]}], "}"}]}]}], "]"}], ";"}], "Code"]}], "Input",
 CellChangeTimes->{{3.686401706812792*^9, 3.6864017521197643`*^9}, 
   3.686403149219241*^9, {3.686504717864292*^9, 3.686504722791524*^9}, {
   3.700578365301522*^9, 3.7005783714796133`*^9}, {3.7005784918705196`*^9, 
   3.7005784924955854`*^9}, 3.718035742047043*^9, {3.718841224288909*^9, 
   3.718841230958413*^9}, {3.718841355222883*^9, 3.7188414238070726`*^9}, {
   3.718841461764323*^9, 3.7188414909630756`*^9}},
 ExpressionUUID -> "947cde04-da7c-4abf-a430-eb3841611396"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Load Data",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586818794753*^9, 3.7005868197322516`*^9}, {
  3.7005873521608763`*^9, 3.700587352176503*^9}}],

Cell["\<\
Reading country data on consumption and resistance and assigning them to \
appropriate variables.\
\>", "Text",
 CellChangeTimes->{3.686400603032765*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"MODEL", " ", "DATA"}], "*)"}], "Code"], 
  StyleBox["\n", "Code"], 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Datasheet_combined.xlsx\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Data\>\"", ",", "\"\<Sepsis_model\>\""}], "}"}]}], 
       "]"}]}], ";"}], "Code"], 
   StyleBox[" ", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"import", " ", "data"}], "*)"}], "Code"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], "Code"], 
   StyleBox[" ", "Code"], "\[IndentingNewLine]", 
   StyleBox["\n", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
     "data", " ", "for", " ", "model", " ", "fit", " ", "and", " ", 
      "projections"}], "*)"}], "Code"], 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{
     StyleBox["dataM", "Code"], 
     StyleBox["=", "Code"], 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "17"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"years", " ", "=", " ", 
      RowBox[{"dataM", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "Code"], 
   StyleBox[" ", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"years", " ", "of", " ", "available", " ", "data"}], "*)"}], 
    "Code"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"tt", " ", "=", " ", 
      RowBox[{"Length", "[", "years", "]"}]}], ";"}], "Code"], 
   StyleBox["  ", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"#", " ", "years", " ", "of", " ", "available", " ", "data"}], 
     "*)"}], "Code"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"nop", " ", "=", " ", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"dataM", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "Code"], 
   StyleBox[" ", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"#", " ", "of", " ", "pathogens"}], "*)"}], "Code"], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"isolates", " ", "=", " ", 
      RowBox[{"dataM", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", 
         RowBox[{
          RowBox[{"2", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
     ";"}], "Code"], 
   StyleBox[" ", "Code"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"resistance", " ", "=", " ", 
      RowBox[{"dataM", "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", 
         RowBox[{
          RowBox[{"2", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
     ";"}], "Code"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     StyleBox["rfreq", "Code"], 
     StyleBox[" ", "Code"], 
     StyleBox["=", "Code"], 
     RowBox[{
      RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
       RowBox[{"resistance", "/", "isolates"}], "]"}], "/.", 
      RowBox[{"Indeterminate", "\[Rule]", " ", "0"}]}]}], ";"}], 
   StyleBox[" ", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"resistance", " ", "frequency"}], "*)"}], "Code"], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pathogens", "=", 
     RowBox[{
      RowBox[{"dataM", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", "*", "nop"}], "+", "3"}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "nop"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"pathogen", " ", "headers"}], "*)"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"carbcons", " ", "=", "  ", 
      RowBox[{"dataM", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", "*", "nop"}], "+", "4"}], "]"}], "]"}]}], ";"}], "Code"], 
   StyleBox[" ", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"CBP", " ", "consumption", " ", 
       RowBox[{"(", "DDDs", ")"}]}], ":", " ", "total"}], "*)"}], "Code"], 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{
     StyleBox["inapp", "Code"], 
     StyleBox[" ", "Code"], 
     StyleBox["=", "Code"], 
     StyleBox[" ", "Code"], 
     RowBox[{
      RowBox[{
       StyleBox["dataM", "Code"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", "*", "nop"}], "+", "6"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
   StyleBox["\n", "Code"], 
   StyleBox[
    RowBox[{
     RowBox[{"conbreak", " ", "=", " ", 
      RowBox[{"dataM", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", "nop"}], "+", "7"}], ";;", 
         RowBox[{
          RowBox[{"3", "*", "nop"}], "+", "6"}]}], "]"}], "]"}]}], ";"}], 
    "Code"], 
   StyleBox[" ", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
     "breakdown", " ", "of", " ", "disease", " ", "by", " ", "pathogen"}], 
     "*)"}], "Code"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prev", "=", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", "prevalence", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cbpp", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", "*", "nop"}], "+", "5"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "CBP", " ", "prescribed", " ", "to", " ", "that", " ", "diagnosis"}], 
    "*)"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"cbp", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"cbpp", "*", "inapp", "*", "carbcons", "*", 
         RowBox[{"conbreak", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], "Code"], 
   StyleBox["\n", "Code"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"CBP", " ", 
      RowBox[{"consumption", ":", " ", 
       RowBox[{"by", " ", "indication", " ", "and", " ", "pathogen"}]}]}], 
     "*)"}], "Code"], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "data", " ", "for", " ", "economic", " ", "and", " ", "health", " ", 
     "outcomes"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataE", "=", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"18", ";;"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stw", " ", "=", " ", 
     RowBox[{
      RowBox[{"dataE", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"reduction", " ", "in", " ", "inappropriate", " ", "therapy"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dataE", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dataE", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"cbp", " ", "R"}], ",", " ", 
     RowBox[{"cbp", " ", "S"}], ",", " ", 
     RowBox[{"alt", " ", "therapy"}]}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.686422034696558*^9, 3.6864220688839083`*^9}, {
   3.686422244390477*^9, 3.686422257854924*^9}, {3.6864223170828114`*^9, 
   3.6864223431908817`*^9}, 3.6864948657783527`*^9, {3.686495706144705*^9, 
   3.686495706998027*^9}, {3.686497157777652*^9, 3.686497176663332*^9}, {
   3.686500722352275*^9, 3.6865007839598494`*^9}, {3.6865008234158993`*^9, 
   3.686500860558977*^9}, {3.686500895439396*^9, 3.6865009047916603`*^9}, {
   3.686501132914021*^9, 3.6865011961896877`*^9}, {3.686502039475134*^9, 
   3.686502053471085*^9}, 3.686504820987131*^9, {3.686504927512206*^9, 
   3.68650493323075*^9}, {3.686505663500307*^9, 3.686505834942637*^9}, {
   3.686506221505989*^9, 3.686506233253963*^9}, 3.6865062638755836`*^9, {
   3.686506304950383*^9, 3.6865063857051888`*^9}, {3.686506464729933*^9, 
   3.686506570268374*^9}, {3.686507885056096*^9, 3.686507925091408*^9}, 
   3.68650806648864*^9, {3.686508132562462*^9, 3.686508159468111*^9}, {
   3.6865082387863083`*^9, 3.686508289413818*^9}, {3.686593508533208*^9, 
   3.686593578249978*^9}, {3.686670822461113*^9, 3.686670846265149*^9}, 
   3.686671020176771*^9, {3.686671058093039*^9, 3.686671058348937*^9}, {
   3.686671195039489*^9, 3.686671197287084*^9}, {3.686672205273057*^9, 
   3.686672265615234*^9}, {3.686672313935074*^9, 3.686672315030695*^9}, {
   3.690514968752684*^9, 3.6905149711878157`*^9}, {3.6905151605791454`*^9, 
   3.6905151977141056`*^9}, {3.6905490426059213`*^9, 
   3.6905490710575967`*^9}, {3.6905491666256824`*^9, 3.69054916762508*^9}, {
   3.690560008801766*^9, 3.690560021440817*^9}, {3.693235488416274*^9, 
   3.693235488880404*^9}, {3.693237503430167*^9, 3.693237504912262*^9}, {
   3.693242514519369*^9, 3.693242533218896*^9}, {3.69324278229449*^9, 
   3.6932427827305317`*^9}, {3.69324331082885*^9, 3.693243311380581*^9}, {
   3.694794944107407*^9, 3.6947949456275787`*^9}, 3.694869444462384*^9, {
   3.69486947773489*^9, 3.6948694780468807`*^9}, {3.696613845884832*^9, 
   3.69661384630057*^9}, 3.6966142251356783`*^9, {3.696614267163052*^9, 
   3.696614268931164*^9}, {3.696614336734581*^9, 3.69661436742657*^9}, {
   3.6966143989830647`*^9, 3.6966144011982822`*^9}, {3.696614476914295*^9, 
   3.696614477617947*^9}, {3.696614523998536*^9, 3.696614524365843*^9}, {
   3.6966149875383883`*^9, 3.69661502321297*^9}, {3.696615101388283*^9, 
   3.69661512177125*^9}, {3.6966152518805857`*^9, 3.696615261003038*^9}, {
   3.696615389139082*^9, 3.696615395235524*^9}, {3.696615597886518*^9, 
   3.696615598926401*^9}, {3.696615815221848*^9, 3.696615816637291*^9}, {
   3.696616322068841*^9, 3.696616323151634*^9}, {3.6968731019011183`*^9, 
   3.696873102132331*^9}, {3.696873474263825*^9, 3.696873474894909*^9}, {
   3.696873750270289*^9, 3.6968737506538773`*^9}, {3.696952191029182*^9, 
   3.696952192165349*^9}, {3.6969525040529337`*^9, 3.69695250910539*^9}, {
   3.696952959626371*^9, 3.696952960785913*^9}, {3.696954591424856*^9, 
   3.696954592264494*^9}, {3.69695474259662*^9, 3.696954751834024*^9}, {
   3.696954829844029*^9, 3.696954858941578*^9}, {3.696959711253429*^9, 
   3.6969597124892597`*^9}, {3.696960225982828*^9, 3.696960229688342*^9}, {
   3.6974636430928164`*^9, 3.69746364475207*^9}, 3.6974636990330257`*^9, {
   3.69746572261734*^9, 3.6974657303934927`*^9}, {3.697466319707209*^9, 
   3.6974663208109493`*^9}, {3.699979819323583*^9, 3.699979824749195*^9}, {
   3.6999798994047337`*^9, 3.699979971399865*^9}, 3.700577857699892*^9, {
   3.700580301187483*^9, 3.7005803061567545`*^9}, {3.700580352344078*^9, 
   3.7005804332667875`*^9}, {3.700587356480831*^9, 3.7005873808606195`*^9}, {
   3.7014286067933145`*^9, 3.701428607337329*^9}, {3.701537183106104*^9, 
   3.7015371983584056`*^9}, {3.701537245629196*^9, 3.701537248154693*^9}, {
   3.7033434311097727`*^9, 3.703343437835854*^9}, {3.703505176641322*^9, 
   3.7035051788060784`*^9}, {3.703505326064638*^9, 3.7035053362004156`*^9}, {
   3.7035053790724077`*^9, 3.70350549006406*^9}, {3.703519398604677*^9, 
   3.703519432043036*^9}, {3.703519484955608*^9, 3.7035194851477613`*^9}, {
   3.7036029675366874`*^9, 3.7036029699555335`*^9}, {3.7041953951420145`*^9, 
   3.704195436240984*^9}, {3.7041954683610396`*^9, 3.7041955278418465`*^9}, {
   3.7041955732057734`*^9, 3.704195573330967*^9}, {3.704195640102418*^9, 
   3.7041956401959877`*^9}, 3.704195724703086*^9, {3.704195764869725*^9, 
   3.7041957937993608`*^9}, {3.704196032654626*^9, 3.704196036186615*^9}, {
   3.704196293670497*^9, 3.7041963168059745`*^9}, 3.7181247286556635`*^9, {
   3.7185479302107954`*^9, 3.718547930636095*^9}, {3.718726023153342*^9, 
   3.7187261228702497`*^9}, {3.718726179293728*^9, 3.718726184661331*^9}, {
   3.7187262163678045`*^9, 3.7187262167273273`*^9}, {3.7187292301088905`*^9, 
   3.718729231954373*^9}, 3.7187295838901253`*^9, {3.718730125091565*^9, 
   3.718730132625313*^9}, {3.7187304258212843`*^9, 3.7187304259463053`*^9}, {
   3.71873062095632*^9, 3.7187307197747135`*^9}, {3.7187308396265497`*^9, 
   3.7187308413967557`*^9}, {3.718730914974766*^9, 3.7187309183377433`*^9}, {
   3.7187309514840517`*^9, 3.7187309537718887`*^9}, {3.7187310113847795`*^9, 
   3.7187311372892237`*^9}, {3.7188268942806444`*^9, 3.718826895218213*^9}, {
   3.7188273209485097`*^9, 3.7188273215198584`*^9}, {3.718827355753003*^9, 
   3.7188274138674693`*^9}, {3.7188285615747223`*^9, 3.718828561715214*^9}, {
   3.718837931353737*^9, 3.7188379318905697`*^9}, {3.7201979700775166`*^9, 
   3.7201980014920006`*^9}, {3.7201986686680145`*^9, 3.720198698529197*^9}, {
   3.720198863811266*^9, 3.720198869435609*^9}, {3.720199355762143*^9, 
   3.7201993659002624`*^9}, {3.7202029908373814`*^9, 3.720202992526834*^9}, {
   3.720203264912648*^9, 3.720203285482752*^9}, {3.7207974836146517`*^9, 
   3.7207974888040757`*^9}, {3.7207975516245885`*^9, 3.720797563722108*^9}, {
   3.720797862144657*^9, 3.720797870097934*^9}, {3.72079800291986*^9, 
   3.720798011375171*^9}, {3.7207980594992423`*^9, 3.7207980884771147`*^9}, {
   3.7207982991987953`*^9, 3.720798356873657*^9}, {3.720798646408083*^9, 
   3.720798646595476*^9}, {3.720799338017191*^9, 3.7207994259224586`*^9}, {
   3.7207994877841616`*^9, 3.7207995160842814`*^9}, {3.720799594230219*^9, 
   3.7207995984353533`*^9}, {3.720800531401991*^9, 3.720800535086769*^9}, {
   3.7208005878468804`*^9, 3.7208006003169403`*^9}, {3.7208011781162987`*^9, 
   3.720801178663396*^9}, 3.720801309585631*^9},
 ExpressionUUID -> "163af784-7490-4e8e-95c8-284f538d9d5f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model ", "Section",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.686400307952888*^9, 3.6864004084403467`*^9}, {
   3.686400489920883*^9, 3.686400491960532*^9}, 3.7005870090415688`*^9, 
   3.701429412245363*^9, {3.7035194899587927`*^9, 3.703519491726164*^9}, {
   3.7035241365553827`*^9, 3.7035241365731897`*^9}, {3.703602876186926*^9, 
   3.7036028769526424`*^9}, {3.7040410783324747`*^9, 3.7040410788569627`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Parameters & Model Structure",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586719444282*^9, 3.700586729715373*^9}, {
  3.700586791459395*^9, 3.7005867927406187`*^9}}],

Cell[TextData[{
 StyleBox["r(t)", "Text",
  FontWeight->"Bold"],
 StyleBox[" = frequency of resistance\n", "Text"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "s"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the sensitive strain\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "r"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the resistance strain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["k", "r"]}], TraditionalForm]]],
 " < ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "s"], ")"}], TraditionalForm]]],
 "\n",
 StyleBox["\[Theta]",
  FontWeight->"Bold"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["k", "r"], "-", 
     SubscriptBox["k", "s"]}], "<", " ", "0"}], TraditionalForm]]],
 " \n",
 StyleBox["a =",
  FontWeight->"Bold"],
 " CBP consumption (DDD)"
}], "Text",
 CellChangeTimes->{{3.686400499649311*^9, 3.68640052600694*^9}, {
   3.6864005718225193`*^9, 3.686400575021463*^9}, {3.68736386207417*^9, 
   3.687363862074381*^9}, 3.6905491725333633`*^9, {3.690722553178647*^9, 
   3.69072257128833*^9}, {3.690722611632101*^9, 3.6907226192004843`*^9}, 
   3.696614487562492*^9, {3.696954774986088*^9, 3.696954776429123*^9}, {
   3.699978618851925*^9, 3.69997862542444*^9}, {3.700578555451971*^9, 
   3.700578559628787*^9}, {3.700578612001893*^9, 3.700578612705063*^9}, {
   3.7005806236313753`*^9, 3.700580635401388*^9}, {3.7005806769712067`*^9, 
   3.7005809518298016`*^9}, {3.7005811924601393`*^9, 
   3.7005812164615297`*^9}, {3.702216322838592*^9, 3.702216326755948*^9}, 
   3.7208085761662025`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"r", "[", 
      RowBox[{"t_", ",", "r0_", ",", "ks_", ",", "\[Theta]_"}], "]"}],
     FontWeight->"Plain"], 
    StyleBox[":=",
     FontWeight->"Plain"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"ks", "*", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"\[Theta]", "*", "t"}]}], ")"}]], " "}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"ks", "*", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", " ", 
         RowBox[{"\[Theta]", "*", "t"}]}], ")"}]], "  "}]]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.683030762976203*^9, 3.6830307646226077`*^9}, {
   3.683030892090124*^9, 3.6830309083188725`*^9}, {3.6830309721242533`*^9, 
   3.683030993984562*^9}, {3.6830311371186757`*^9, 3.6830311451555557`*^9}, {
   3.683031934623186*^9, 3.6830319364931593`*^9}, {3.683032013522828*^9, 
   3.683032065758599*^9}, {3.6830346542453313`*^9, 3.68303465754213*^9}, {
   3.6830363241484847`*^9, 3.683036329938362*^9}, {3.6830365276454496`*^9, 
   3.683036530676465*^9}, 3.6830367497782087`*^9, {3.683041381379426*^9, 
   3.683041393024686*^9}, {3.6830421349464197`*^9, 3.683042139599684*^9}, {
   3.6830447788287015`*^9, 3.683044779606695*^9}, {3.683045184458967*^9, 
   3.6830452004752617`*^9}, {3.6852083241401463`*^9, 3.685208331594561*^9}, {
   3.685208507957798*^9, 3.685208565997737*^9}, 3.6852094721246767`*^9, {
   3.685209903141817*^9, 3.6852099398500347`*^9}, {3.6852099889580927`*^9, 
   3.685210058891021*^9}, {3.6852103080680428`*^9, 3.685210309237547*^9}, {
   3.685210371854425*^9, 3.685210380461464*^9}, {3.685210428797523*^9, 
   3.6852105257382507`*^9}, {3.6852105754249763`*^9, 3.6852105928533*^9}, {
   3.6852107253971167`*^9, 3.685210739728479*^9}, {3.685211129911818*^9, 
   3.685211139176404*^9}, {3.68521175723141*^9, 3.6852117935313168`*^9}, {
   3.6852123574632883`*^9, 3.685212368014336*^9}, {3.685279366491384*^9, 
   3.685279382363071*^9}, {3.685279416295306*^9, 3.685279429839871*^9}, 
   3.6852808275142384`*^9, {3.6853860677425203`*^9, 3.6853861678062687`*^9}, {
   3.685386259499681*^9, 3.685386260403224*^9}, {3.685881879376438*^9, 
   3.68588188788455*^9}, {3.685882144512109*^9, 3.685882211247509*^9}, {
   3.685882264975534*^9, 3.6858823048645563`*^9}, {3.6863259609700985`*^9, 
   3.68632602143394*^9}, {3.6863261123987613`*^9, 3.6863261127132187`*^9}, {
   3.6863261459947433`*^9, 3.686326158772418*^9}, {3.6863300988135977`*^9, 
   3.6863301392487526`*^9}, {3.6863301968103313`*^9, 
   3.6863302455048313`*^9}, {3.686330295179199*^9, 3.686330312060356*^9}, {
   3.6863310425150905`*^9, 3.686331077920039*^9}, {3.6863311592705336`*^9, 
   3.686331161351984*^9}, {3.686331196844039*^9, 3.6863312002829003`*^9}, {
   3.6863316074494753`*^9, 3.68633161191486*^9}, {3.6863316677333975`*^9, 
   3.6863316752266045`*^9}, {3.686331756685466*^9, 3.6863317652227015`*^9}, {
   3.6863318579611225`*^9, 3.6863318604224625`*^9}, {3.6863320284264183`*^9, 
   3.6863320896920385`*^9}, {3.6863333970093203`*^9, 3.686333468722809*^9}, {
   3.686333527818489*^9, 3.686333530257064*^9}, {3.686333585882146*^9, 
   3.6863335937595434`*^9}, {3.6863337944358063`*^9, 
   3.6863338012252955`*^9}, {3.686333860129887*^9, 3.686333926127783*^9}, {
   3.686334541041381*^9, 3.6863345432302294`*^9}, {3.6863346050474234`*^9, 
   3.6863346194036174`*^9}, {3.6863350339422607`*^9, 
   3.6863350402439137`*^9}, {3.686396824312439*^9, 3.686396830206884*^9}, {
   3.68639728852584*^9, 3.686397385676342*^9}, {3.6863974219206467`*^9, 
   3.686397591467824*^9}, {3.6863977467434483`*^9, 3.686397856243059*^9}, {
   3.6863979037596188`*^9, 3.686398009617909*^9}, {3.686398049831843*^9, 
   3.686398058770108*^9}, {3.68639915087844*^9, 3.686399168049336*^9}, {
   3.686399538546379*^9, 3.686399540314131*^9}, 3.6864005110851316`*^9, 
   3.686400581816401*^9, {3.6864006197723083`*^9, 3.686400620244726*^9}, {
   3.686401869966902*^9, 3.686401900676633*^9}, {3.6864032479875317`*^9, 
   3.6864032930076036`*^9}, {3.6864112529344683`*^9, 3.686411262755252*^9}, {
   3.6864112967508183`*^9, 3.686411330746829*^9}, {3.686412024717753*^9, 
   3.686412049333313*^9}, 3.6864123304368677`*^9, {3.686412473817891*^9, 
   3.686412485495213*^9}, {3.686412529906288*^9, 3.686412535342702*^9}, 
   3.686413143077464*^9, {3.686413922349515*^9, 3.6864139332766542`*^9}, {
   3.686414054550778*^9, 3.68641405601223*^9}, {3.686414101545352*^9, 
   3.686414169219296*^9}, {3.6864142432310667`*^9, 3.686414273315958*^9}, {
   3.686414369325341*^9, 3.686414388826579*^9}, {3.6864144199682903`*^9, 
   3.686414447742525*^9}, {3.686414613494096*^9, 3.686414779850452*^9}, {
   3.686414811798102*^9, 3.686414906928382*^9}, {3.686415062398457*^9, 
   3.686415134968748*^9}, {3.686415560254722*^9, 3.686415665538151*^9}, {
   3.686418321121459*^9, 3.686418334972437*^9}, {3.686508624478046*^9, 
   3.686508632277608*^9}, 3.68650871497578*^9, {3.6866710450891523`*^9, 
   3.686671051229025*^9}, {3.6866716077238398`*^9, 3.6866716968985*^9}, {
   3.686671727131069*^9, 3.6866717297824497`*^9}, {3.686672280091339*^9, 
   3.68667229406674*^9}, {3.6869386960631742`*^9, 3.686938708012053*^9}, {
   3.690514877200051*^9, 3.6905148892161407`*^9}, {3.690721514268401*^9, 
   3.690721571699773*^9}, 3.696616035925852*^9, {3.6975661826500597`*^9, 
   3.6975661924568453`*^9}, {3.697566564484868*^9, 3.697566577524445*^9}, {
   3.69997860542073*^9, 3.699978631025688*^9}, {3.699978671234418*^9, 
   3.699978743381155*^9}, 3.6999787843122373`*^9, {3.6999788740181875`*^9, 
   3.699978892479066*^9}, {3.699978953924489*^9, 3.699978998636625*^9}, {
   3.699979481328476*^9, 3.699979524287679*^9}, {3.6999797618961906`*^9, 
   3.6999797636369605`*^9}, {3.700577837888285*^9, 3.7005778452831726`*^9}, {
   3.700577896592633*^9, 3.700577898123874*^9}, {3.700577982561618*^9, 
   3.7005779859363604`*^9}, 3.700580714849549*^9, {3.700580866866892*^9, 
   3.7005808755221605`*^9}, {3.7005809652484455`*^9, 3.700581054510634*^9}, {
   3.700581143420582*^9, 3.700581158726591*^9}, {3.7005812221988354`*^9, 
   3.700581224699131*^9}, {3.7005813900782413`*^9, 3.7005814812173157`*^9}, 
   3.700581594578314*^9, {3.7005817018893595`*^9, 3.7005817331728625`*^9}, {
   3.70058236481491*^9, 3.7005823685675287`*^9}, {3.7005824573051863`*^9, 
   3.7005824598974485`*^9}, {3.7005825333408175`*^9, 3.700582536338009*^9}, {
   3.7016103449359617`*^9, 3.701610389366672*^9}},
 ExpressionUUID -> "ebe5f114-8fd3-4fd7-94a0-8f75b8068d13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Likelihood",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7005867405346403`*^9, 3.700586744228055*^9}, {
  3.701427711022795*^9, 3.701427711163434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"Lik", "[", 
     RowBox[{"r0_", ",", "ks_"}], "]"}],
    FontWeight->"Plain"], 
   StyleBox[":=",
    FontWeight->"Plain"], 
   RowBox[{"Total", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"iso", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"resis", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"resis", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"r", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", "\[Theta]"}], 
          "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"iso", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"resis", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", "\[Theta]"}], 
           "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.6830433753306084`*^9}, {3.6830453841421323`*^9, 3.683045385373238*^9}, {
   3.683286539007884*^9, 3.6832865413676167`*^9}, {3.683286571723649*^9, 
   3.6832865735875263`*^9}, {3.6833012740307302`*^9, 
   3.6833013690917635`*^9}, {3.6833024062245913`*^9, 
   3.6833024065060987`*^9}, {3.683303978402192*^9, 3.683303988908411*^9}, {
   3.6833125533026915`*^9, 3.683312560807563*^9}, {3.6833810185649223`*^9, 
   3.6833810198201427`*^9}, {3.6839950164754915`*^9, 3.683995016631748*^9}, {
   3.683995107610061*^9, 3.683995109400138*^9}, {3.684761387233347*^9, 
   3.684761387411523*^9}, {3.685208646552435*^9, 3.685208664904273*^9}, {
   3.685210100038281*^9, 3.685210133317401*^9}, {3.685210612196949*^9, 
   3.685210625376943*^9}, {3.685279459724468*^9, 3.685279483526725*^9}, {
   3.6852807998799334`*^9, 3.6852808089832907`*^9}, {3.685281067274529*^9, 
   3.685281077298399*^9}, {3.68528125115583*^9, 3.685281261013719*^9}, {
   3.6852814331275053`*^9, 3.685281440604895*^9}, {3.685386193320956*^9, 
   3.685386207936881*^9}, {3.686325830517469*^9, 3.686325855990289*^9}, {
   3.6863316529251328`*^9, 3.68633165301976*^9}, {3.686331705422717*^9, 
   3.6863317460069585`*^9}, 3.686331790557254*^9, {3.6863340940272284`*^9, 
   3.6863340949404917`*^9}, 3.6864009082517033`*^9, 3.6864009507187*^9, {
   3.686401046619935*^9, 3.686401063283523*^9}, 3.686401104899159*^9, {
   3.68640350491506*^9, 3.6864035654181747`*^9}, {3.686415534611898*^9, 
   3.6864155467485037`*^9}, {3.6864157341890497`*^9, 
   3.6864157348122463`*^9}, {3.6864183840374823`*^9, 3.686418412399835*^9}, {
   3.686508351245968*^9, 3.686508378709692*^9}, {3.6865086384692287`*^9, 
   3.686508647192649*^9}, 3.686508721860381*^9, {3.69051493172359*^9, 
   3.690514960196232*^9}, {3.69072157779605*^9, 3.6907216007279577`*^9}, {
   3.697566200365423*^9, 3.697566212973073*^9}, {3.69997901078512*^9, 
   3.6999790631544333`*^9}, {3.699979531465004*^9, 3.699979539438403*^9}, {
   3.6999797425870667`*^9, 3.6999797443087587`*^9}, {3.7005810704350834`*^9, 
   3.7005810755460377`*^9}, {3.7005811209205437`*^9, 
   3.7005811290410414`*^9}, {3.700581304665578*^9, 3.700581331077982*^9}, {
   3.700581746040372*^9, 3.7005817902595863`*^9}, {3.7005820577108154`*^9, 
   3.7005820645214376`*^9}, 3.7005856756577263`*^9, {3.701536147947562*^9, 
   3.701536161931431*^9}, {3.7015393894383755`*^9, 3.701539413765788*^9}, 
   3.7016171706320457`*^9, {3.7035061592215977`*^9, 3.703506183516965*^9}, {
   3.713279783945352*^9, 3.7132797926577587`*^9}, {3.7132798770183024`*^9, 
   3.71327987783165*^9}, {3.718125141405435*^9, 3.71812519660054*^9}, {
   3.718125235310938*^9, 3.7181252384242845`*^9}, {3.7181265119449854`*^9, 
   3.718126555903311*^9}, {3.718126699975524*^9, 3.7181267039662027`*^9}, {
   3.7181268615178146`*^9, 3.718126881493331*^9}, {3.7181269324211035`*^9, 
   3.7181269361965384`*^9}, {3.7181270260468144`*^9, 3.718127029795314*^9}, {
   3.718640281338396*^9, 3.7186403214661517`*^9}, {3.7186403644282513`*^9, 
   3.7186403671309547`*^9}, {3.7187088536965327`*^9, 3.718708854024693*^9}, {
   3.718729625541978*^9, 3.718729628746538*^9}, {3.718729989917593*^9, 
   3.718729990630373*^9}, {3.7201984858460436`*^9, 3.720198499834219*^9}, {
   3.7208085658818665`*^9, 3.7208085876657853`*^9}, {3.7208086852589865`*^9, 
   3.7208086868983192`*^9}},
 ExpressionUUID -> "be7d0cfe-df37-408d-ac55-5e320828eca2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model Fitting",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586762450125*^9, 3.70058676485663*^9}, {
   3.700587072272579*^9, 3.7005870740416794`*^9}, 3.714151770237274*^9, 
   3.718730005614851*^9}],

Cell[TextData[{
 "Fit ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["r", "0"], " ", "and", " ", 
    SubscriptBox["k", "s"], " "}], TraditionalForm]]],
 "using a binomial maximum likelihood function. Fix \[Theta] based on \
literature. "
}], "Text",
 CellChangeTimes->{{3.703505727447111*^9, 3.7035057866848*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "=", 
    RowBox[{"-", "0.02"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Di", " ", "Luca"}], ",", " ", "2017"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", "max"}], ";", " ", 
  RowBox[{"fks", "=", "max"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      StyleBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"max", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], "=", 
        RowBox[{"NMaximize", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lik", "[", 
             RowBox[{"r0", ",", "ks"}], "]"}], ",", 
            RowBox[{"0", "<", "r0", "<", "1"}], ",", " ", 
            RowBox[{"ks", ">", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r0", ",", "ks"}], "}"}], ",", " ", 
          RowBox[{"MaxIterations", "\[Rule]", "100000"}]}], "]"}]}],
       FontWeight->"Plain"]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fr0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fks", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fks", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"create", " ", "table", " ", "of", " ", "fitted", " ", "values"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "max", "}"}], ",", 
     RowBox[{"{", "fr0", "}"}], ",", 
     RowBox[{"{", "fks", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings1", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"params", ",", "pathogens"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings2", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Prepend", ",", 
     RowBox[{"{", 
      RowBox[{"headings1", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\>\"", ",", "\"\<Likelihood\>\"", ",", "\"\<r0\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(k\), \(s\)]\)\>\""}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Grid", "[", 
   RowBox[{"headings2", ",", 
    RowBox[{"Frame", "\[Rule]", " ", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.699979080700176*^9, 3.6999791285198135`*^9}, {
   3.6999795459289694`*^9, 3.6999795782642183`*^9}, {3.6999797469333143`*^9, 
   3.699979792164003*^9}, {3.699980655896045*^9, 3.6999807052383485`*^9}, {
   3.6999807386234922`*^9, 3.699980791359419*^9}, {3.6999808520183363`*^9, 
   3.699980857908617*^9}, {3.699980894395363*^9, 3.699980901995653*^9}, {
   3.699981214894743*^9, 3.699981244798695*^9}, {3.7005780580515375`*^9, 
   3.700578062092603*^9}, {3.7005811797204523`*^9, 3.700581187269937*^9}, {
   3.700581229488211*^9, 3.7005812726645036`*^9}, {3.7005813389896755`*^9, 
   3.7005813408419547`*^9}, {3.7005818466872196`*^9, 
   3.7005819987739115`*^9}, {3.7005822013314333`*^9, 3.700582287313163*^9}, {
   3.7005823546895723`*^9, 3.7005823990303335`*^9}, {3.7005825108149376`*^9, 
   3.7005825468018093`*^9}, {3.700583346136323*^9, 3.7005834001190147`*^9}, {
   3.700583431757659*^9, 3.7005834793698597`*^9}, {3.7005835118331184`*^9, 
   3.700583587628395*^9}, {3.700583644416862*^9, 3.700583645662918*^9}, {
   3.7005837321566935`*^9, 3.7005838421663465`*^9}, {3.7005838770509467`*^9, 
   3.7005840265769577`*^9}, {3.700584078823574*^9, 3.7005842033909864`*^9}, {
   3.700584239397745*^9, 3.7005842672882395`*^9}, {3.7005842975217457`*^9, 
   3.700584414314398*^9}, {3.700584769347272*^9, 3.700584770128607*^9}, {
   3.7005856949027915`*^9, 3.70058570076023*^9}, {3.7005870940906606`*^9, 
   3.7005870972436595`*^9}, {3.701427719951297*^9, 3.701427720217131*^9}, {
   3.701427761473959*^9, 3.701427803824013*^9}, {3.7014293722024174`*^9, 
   3.701429376227524*^9}, {3.7014295432311172`*^9, 3.701429543485509*^9}, {
   3.701429591451513*^9, 3.7014297070606256`*^9}, {3.701429910967057*^9, 
   3.7014299112260013`*^9}, {3.7015350613559856`*^9, 
   3.7015350624100776`*^9}, {3.7015351181957607`*^9, 
   3.7015351265069523`*^9}, {3.7033435416495123`*^9, 3.7033435444982157`*^9}, 
   3.703344913956914*^9, {3.703505648855173*^9, 3.703505692219559*^9}, {
   3.7035058029294133`*^9, 3.703505860689376*^9}, {3.703506296099897*^9, 
   3.7035063002073135`*^9}, {3.703524147348421*^9, 3.70352414930751*^9}, {
   3.7035248323526907`*^9, 3.7035248342670765`*^9}, 3.7035248733335547`*^9, 
   3.7035249640151196`*^9, {3.7036038737836237`*^9, 3.703603875319255*^9}, {
   3.7036086530928545`*^9, 3.7036086544593906`*^9}, {3.7036087014543476`*^9, 
   3.703608704175104*^9}, {3.703610055503646*^9, 3.7036100556286716`*^9}, {
   3.703610115648935*^9, 3.703610117549713*^9}, {3.703610158594226*^9, 
   3.7036101616058965`*^9}, {3.7036102451512833`*^9, 3.703610245401309*^9}, {
   3.7036103163292437`*^9, 3.703610316500459*^9}, {3.7036104516970577`*^9, 
   3.7036104521603866`*^9}, 3.7039414065616455`*^9, {3.7039429291565056`*^9, 
   3.703942929898025*^9}, {3.7039454848217554`*^9, 3.7039454852126107`*^9}, {
   3.7039456432733736`*^9, 3.70394564503203*^9}, {3.703945687429302*^9, 
   3.7039456888089523`*^9}, {3.7041981783075266`*^9, 3.704198179229902*^9}, {
   3.7041984388929377`*^9, 3.704198440629492*^9}, {3.7132798103674827`*^9, 
   3.7132798109456377`*^9}, {3.7132798812323017`*^9, 3.713279881404348*^9}, 
   3.718828326221363*^9, {3.7188285252355976`*^9, 3.7188285315739574`*^9}, {
   3.720809458591077*^9, 3.7208094594052415`*^9}},
 ExpressionUUID -> "eccb0fde-28f5-4a39-bf59-111f011ccd44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Sampling and Bayesian Melding",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.703505907825551*^9, 3.70350591757016*^9}, {
  3.703517237174137*^9, 3.7035172372069798`*^9}, {3.7141491720993824`*^9, 
  3.714149172127963*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Functions",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.7035059520524473`*^9, 3.7035059530259547`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fonGrid", "[", 
    RowBox[{"x_", ",", "y_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "m", ",", "fvals"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fvals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "m", "}"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"preallocate", " ", "fvals"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"fvals", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"y", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "fvals"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"x", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
    RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"y", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
    RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "f", " ", "is", " ", "a", " ", "scalar", " ", "function", " ", "of", " ", 
    "two", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"fvals", " ", "is", " ", "an", " ", "m"}], "-", "by", "-", 
     RowBox[{"n", " ", "matirx", " ", "where", " ", 
      RowBox[{"fVals", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "=", 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", 
      RowBox[{"y", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repeat", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"n_Integer", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"Sequence", "@@", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"m", ",", "n"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.702212683239119*^9, 3.7022126862151327`*^9}, {
   3.702212732383494*^9, 3.702212776298992*^9}, {3.702212941922406*^9, 
   3.702213009546727*^9}, {3.7022130397508373`*^9, 3.702213071586981*^9}, {
   3.702213192706868*^9, 3.702213194550742*^9}, {3.7022136105741663`*^9, 
   3.702213611089116*^9}, {3.702221180021676*^9, 3.70222119417346*^9}, {
   3.7022971549358997`*^9, 3.702297155736002*^9}, {3.702297221260055*^9, 
   3.70229722141407*^9}, {3.702297269679932*^9, 3.702297269895307*^9}, {
   3.702297512902986*^9, 3.7022975130708237`*^9}, {3.7022975635228*^9, 
   3.702297563706696*^9}, 3.702303308232937*^9, {3.702303358643429*^9, 
   3.702303371304614*^9}, {3.702407962401205*^9, 3.702407963409082*^9}, {
   3.702408002693084*^9, 3.702408003621046*^9}, {3.703344996367432*^9, 
   3.7033450041765223`*^9}, {3.703506010920048*^9, 3.7035060229937377`*^9}, {
   3.703524886188547*^9, 3.703524892006974*^9}, {3.7036101951520205`*^9, 
   3.703610202048828*^9}, {3.713279523091601*^9, 3.7132795269358807`*^9}, {
   3.713280005935954*^9, 3.7132800087325726`*^9}},
 ExpressionUUID -> "88cc9e8e-3a82-4482-a950-9cc1c878fd35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Initialization for parameter estimates and plots",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{
  3.7024059374388638`*^9, 3.702407959905129*^9, 3.702408000724612*^9, {
   3.702408041080536*^9, 3.702408076599719*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"r0T", " ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ksT", " ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotD", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", "data", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotM", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"model", " ", "fit"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nif", " ", "=", " ", "0.1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "noise", " ", "around", " ", "mle", " ", "values", " ", "for", " ", 
    "bayesian", " ", "melding", " ", "prior"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nb", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "parameter", " ", "values", " ", "randomly", " ",
     "selected", " ", "for", " ", "Bayesian", " ", "melding", " ", "step"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sb", "=", "1000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "weighted", " ", "samples", " ", "for", " ", 
    "Bayesian", " ", "melding", " ", "step"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7024082569761457`*^9, 3.702408266207646*^9}, {
   3.702408343115411*^9, 3.702408488975521*^9}, {3.7035060352029147`*^9, 
   3.703506150524708*^9}, {3.703506193776966*^9, 3.703506211460781*^9}, {
   3.7035062701954436`*^9, 3.7035062772825317`*^9}, 3.703506401432895*^9, {
   3.7035066025745726`*^9, 3.7035066163041906`*^9}, 3.7035073352029247`*^9, {
   3.7039414368707027`*^9, 3.7039414381468353`*^9}, {3.704203094089471*^9, 
   3.7042031032386603`*^9}, {3.70420322467133*^9, 3.7042032256723127`*^9}, {
   3.7042159823253794`*^9, 3.7042159827363496`*^9}},
 ExpressionUUID -> "2e920cbd-7737-491b-b330-b23ad3d954e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Bayesian melding for each pathogen",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.702408283660355*^9, 3.702408321599058*^9}, {
  3.702410509476049*^9, 3.7024105239317827`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", "nop"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iso", " ", "=", " ", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resis", " ", "=", " ", 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Take", " ", "nb", " ", "samples", " ", "for", " ", 
        SubscriptBox["r", "0"], " ", "and", " ", 
        SubscriptBox["k", "s"]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"r0s", " ", "=", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "nif"}], ")"}], "*", 
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "nif"}], ")"}], "*", 
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "nb"}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["r", "0"], " ", "samples"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"kss", " ", "=", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "nif"}], ")"}], "*", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "nif"}], ")"}], "*", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "nb"}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["k", "s"], " ", "samples"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lik", " ", "=", " ", 
       RowBox[{"fonGrid", "[", 
        RowBox[{"r0s", ",", "kss", ",", "Lik"}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Calculates", " ", "a", " ", "matrix", " ", "of", " ", 
         "loglikelihood", " ", "values", " ", "for", " ", 
         SubscriptBox["r", "0"]}], ",", " ", 
        RowBox[{
         SubscriptBox["k", "s"], " ", "values"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ls", " ", "=", " ", 
       RowBox[{"Exp", "[", "lik", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"Exponential", " ", "to", " ", "get", " ", "likelihood"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"w", " ", "=", " ", 
       RowBox[{"ls", "/", 
        RowBox[{"Total", "[", 
         RowBox[{"Total", "[", "ls", "]"}], "]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "weights", " ", "for", " ", "likelihood"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"lb", " ", "=", 
       RowBox[{
        RowBox[{"ArrayReshape", "[", 
         RowBox[{"ls", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"nb", "^", "2"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Flatten", " ", "the", " ", "likelihood", " ", "to", " ", "get", " ", 
        "a", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"wb", " ", "=", " ", 
       RowBox[{
        RowBox[{"ArrayReshape", "[", 
         RowBox[{"w", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"nb", "^", "2"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Flatten", " ", "the", " ", "weights", " ", "to", " ", "get", " ", "a",
         " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r0b", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"repeat", "[", 
          RowBox[{
           RowBox[{"r0s", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "nb"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Resize", " ", "r0", " ", "to", " ", "match", " ", "likelihood", " ", 
         RowBox[{"vector", ":", " ", 
          RowBox[{
          "repeat", " ", "1", "st", " ", "term", " ", "of", " ", "r0", " ", 
           "vector", " ", "n", " ", "times"}]}]}], ",", " ", 
        RowBox[{"then", " ", "2", "nd", " ", "term", " ", "n", " ", "times"}],
         ",", " ", 
        RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ksb", " ", "=", " ", 
       RowBox[{"PadRight", "[", 
        RowBox[{"kss", ",", 
         RowBox[{"nb", "^", "2"}], ",", "kss"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Resize", " ", "ks", " ", "to", " ", "match", " ", "size", " ", "of", 
        " ", "likelihood", " ", 
        RowBox[{"vector", ":", " ", 
         RowBox[{
         "repeat", " ", "ks", " ", "vector", " ", "n", " ", "times"}]}]}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ind", " ", "=", " ", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{
         RowBox[{"wb", "\[Rule]", 
          RowBox[{"Range", "[", 
           RowBox[{"nb", "^", "2"}], "]"}]}], ",", "sb"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Choose", " ", "mb", " ", "indices", " ", "from", " ", "1", " ", "to", 
        " ", 
        RowBox[{"nb", "^", "2"}], " ", "based", " ", "on", " ", "weights", 
        RowBox[{"(", 
         RowBox[{
         "importance", " ", "sampling", " ", "with", " ", "replacement"}], 
         ")"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"r0b", " ", "=", " ", 
       RowBox[{"r0b", "[", 
        RowBox[{"[", "ind", "]"}], "]"}]}], ";", 
      RowBox[{"ksb", " ", "=", " ", 
       RowBox[{"ksb", "[", 
        RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
      RowBox[{"lb", " ", "=", " ", 
       RowBox[{"lb", "[", 
        RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"Get", " ", "posterior", " ", "parameters", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r0", "v"], ",", 
          SubscriptBox["ks", "v"]}], ")"}], " ", "and", " ", "likelihood", 
        " ", 
        RowBox[{"(", 
         SubscriptBox["l", "v"], ")"}], " ", "based", " ", "on", " ", 
        "melding"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"od", " ", "=", " ", 
       RowBox[{"Ordering", "[", "lb", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "sort", " ", "the", " ", "likelihood", " ", "values", " ", "in", " ", 
        "order", " ", "to", " ", "get", " ", "confidence", " ", "intervals"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r0T", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"r0b", "[", 
        RowBox[{"[", "od", "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"ksT", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"ksb", "[", 
        RowBox[{"[", "od", "]"}], "]"}]}]}]}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Order", " ", "parameters", " ", "in", " ", "the", " ", "same", " ", 
    "order", " ", "as", " ", "sorted", " ", "likelihoods"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.702213085206161*^9, 3.7022130910461597`*^9}, {
   3.702213242497711*^9, 3.702213365697401*^9}, {3.702213422953679*^9, 
   3.702213477292939*^9}, {3.702213521753269*^9, 3.702213524804967*^9}, {
   3.702213556768837*^9, 3.702213582672481*^9}, {3.7022136314092712`*^9, 
   3.70221365245243*^9}, {3.70221452594149*^9, 3.7022145568976917`*^9}, {
   3.702214596469501*^9, 3.702214643929315*^9}, {3.702214743890162*^9, 
   3.702214772772786*^9}, {3.7022159578055067`*^9, 3.702215992345421*^9}, {
   3.702216384715893*^9, 3.702216468511726*^9}, {3.7022212185686398`*^9, 
   3.702221219649168*^9}, 3.702227690016165*^9, {3.702228184346311*^9, 
   3.702228265734083*^9}, {3.702232762931981*^9, 3.702232767724331*^9}, {
   3.702232926003491*^9, 3.702233040788165*^9}, {3.702297068084367*^9, 
   3.702297168036446*^9}, {3.702303376632094*^9, 3.702303385612136*^9}, {
   3.702303972506579*^9, 3.702303977594195*^9}, {3.702320989116581*^9, 
   3.702321010111902*^9}, 3.70232108199686*^9, {3.702321115008659*^9, 
   3.7023211673086243`*^9}, {3.7023214705632*^9, 3.70232166710699*^9}, {
   3.702321799631673*^9, 3.702321801102396*^9}, {3.702321897274564*^9, 
   3.702321899306859*^9}, {3.70232315196726*^9, 3.702323163354329*^9}, {
   3.7023232757065353`*^9, 3.702323297185672*^9}, {3.702384853229362*^9, 
   3.7023848533728523`*^9}, {3.702385012421068*^9, 3.70238501267686*^9}, {
   3.702385049496627*^9, 3.702385049632351*^9}, {3.702385259924115*^9, 
   3.702385260020009*^9}, {3.702386682651862*^9, 3.702386682772114*^9}, {
   3.7023868387958*^9, 3.702386838907045*^9}, {3.702386880255397*^9, 
   3.702386880374984*^9}, {3.702386982854719*^9, 3.702386982926188*^9}, {
   3.702401315877528*^9, 3.70240131662119*^9}, {3.7024030323879337`*^9, 
   3.702403033316182*^9}, {3.702403066256227*^9, 3.702403066323863*^9}, {
   3.702403098895918*^9, 3.702403099031457*^9}, {3.7024032442277946`*^9, 
   3.7024032503392878`*^9}, {3.702403416894806*^9, 3.702403428034679*^9}, {
   3.7024045641874437`*^9, 3.702404584471945*^9}, 3.702404730195898*^9, {
   3.702404834891159*^9, 3.702404865694994*^9}, {3.702405111310614*^9, 
   3.702405117137938*^9}, {3.70240548864151*^9, 3.702405509021366*^9}, {
   3.702405626455765*^9, 3.702405628692748*^9}, {3.7024057355759077`*^9, 
   3.702405757488584*^9}, {3.702405926684291*^9, 3.70240593361585*^9}, 
   3.7024059733405724`*^9, {3.702406051847333*^9, 3.7024060554312143`*^9}, {
   3.702406168519135*^9, 3.702406177238905*^9}, {3.702406309506442*^9, 
   3.702406353999366*^9}, {3.702406399210183*^9, 3.702406414959035*^9}, {
   3.7024066280390882`*^9, 3.702406635893631*^9}, 3.702406668499001*^9, {
   3.70240678337252*^9, 3.702406911739341*^9}, {3.702407074771019*^9, 
   3.702407075548867*^9}, {3.70240772665248*^9, 3.70240781734237*^9}, 
   3.702408050794153*^9, {3.7024080815328217`*^9, 3.702408254097418*^9}, 
   3.7024083355148067`*^9, {3.702408491923511*^9, 3.702408515974907*^9}, {
   3.702408550179139*^9, 3.702408613274899*^9}, 3.702408665722334*^9, {
   3.702408725009778*^9, 3.702408804305491*^9}, {3.7024088371940002`*^9, 
   3.70240892827332*^9}, {3.702408971790017*^9, 3.702408973925147*^9}, {
   3.702409012124255*^9, 3.702409073253428*^9}, {3.702409139888706*^9, 
   3.7024091966210623`*^9}, {3.702409236832713*^9, 3.7024092616688423`*^9}, {
   3.70240932778806*^9, 3.702409388664703*^9}, {3.702409796093885*^9, 
   3.702409805135612*^9}, 3.703505979075016*^9, {3.703506333300953*^9, 
   3.703506445601673*^9}, {3.7035066193341255`*^9, 3.7035069872736635`*^9}, {
   3.703507019956253*^9, 3.7035072727357817`*^9}, {3.7035073609324703`*^9, 
   3.7035073624633493`*^9}, {3.703517306467251*^9, 3.703517310849083*^9}, {
   3.7035192771647353`*^9, 3.703519277328511*^9}, 3.7042027153154707`*^9, {
   3.7042028708649664`*^9, 3.704202896809804*^9}, {3.7042030652955346`*^9, 
   3.7042031194883347`*^9}, {3.704203209028186*^9, 3.704203222698798*^9}, 
   3.704203348104335*^9, 3.7042038339109683`*^9, {3.704209882568907*^9, 
   3.704209884061839*^9}, {3.704209953879178*^9, 3.704209959134246*^9}, {
   3.7042100237585497`*^9, 3.7042100258080425`*^9}, {3.7042101322802916`*^9, 
   3.704210147512648*^9}, {3.704210860938739*^9, 3.7042108619577665`*^9}, {
   3.704211541876624*^9, 3.7042115715077343`*^9}, 3.704211674149534*^9, 
   3.704211765678898*^9, {3.704211865289325*^9, 3.704211891497982*^9}, {
   3.704212662198522*^9, 3.7042126648387003`*^9}, {3.7042148679452066`*^9, 
   3.7042148701747704`*^9}, {3.704215799147096*^9, 3.704215799614151*^9}, {
   3.7042162700765667`*^9, 3.7042162763825583`*^9}, {3.7042163568754053`*^9, 
   3.704216393769023*^9}, {3.7132795351025047`*^9, 3.7132795355086393`*^9}},
 ExpressionUUID -> "8e46c2ca-b297-47c8-9ea8-88aa2fec681e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Plots and Projections",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7035094794637623`*^9, 3.7035094869978647`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model fit plots",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.702409840887231*^9, 3.7024098536540403`*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "tt"}], "]"}]}], ";"}], " "}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathogens", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Pseudomonas aeruginosa\>\"", ",", "\"\<Acinetobacter baumanii\>\"", 
      ",", "\"\<Klebsiella pneumoniae\>\"", ",", 
      "\"\<Streptococcus pneumoniae\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nos", "=", 
    RowBox[{"0.95", "*", "sb"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "95", "%", " ", "CI", " ", "parameters", " ", 
    "sampled"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rm", 
    StyleBox["=",
     FontWeight->"Plain"], 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"Null", ",", 
      RowBox[{"{", 
       RowBox[{"nop", ",", "sb"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "initialize", " ", "resistance", " ", "from", " ", "model", " ", 
    "output"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rmbest", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"best", " ", "fit"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmin", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", 
     RowBox[{"{", 
      RowBox[{"nop", ",", "15"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"rmax", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", 
     RowBox[{"{", 
      RowBox[{"nop", ",", "15"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rfit", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"res", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"Null", ",", " ", "nop"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"resistance", " ", "frequency", " ", "data"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7042124888034286`*^9, 3.7042124904079866`*^9}, {
   3.7042130365602093`*^9, 3.70421303902295*^9}, 3.704216659979287*^9, {
   3.710131300248993*^9, 3.7101313463239717`*^9}, {3.713280663228312*^9, 
   3.7132806795007477`*^9}, 3.713280765331024*^9, {3.713280908239417*^9, 
   3.7132809184004097`*^9}, {3.713287021063232*^9, 3.713287022814436*^9}, {
   3.718548283632123*^9, 3.718548301015505*^9}, {3.718841886037856*^9, 
   3.7188418892415047`*^9}, {3.718844616409049*^9, 3.7188446228036523`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    StyleBox["For",
     FontWeight->"Bold"], 
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox[
      RowBox[{"i", "=", "1"}],
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"i", "\[LessEqual]", "nop"}],
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"i", "++"}],
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Bold"], 
     StyleBox["\[IndentingNewLine]",
      FontWeight->"Bold"], 
     RowBox[{
      RowBox[{
       StyleBox["r0p",
        FontWeight->"Bold"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       RowBox[{"r0T", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", 
      RowBox[{"ksp", " ", "=", " ", 
       RowBox[{"ksT", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "save", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ", 
        "each", " ", "pathogen"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"rfreq", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}]}], ";", " ", 
      RowBox[{
       StyleBox["(*",
        FontWeight->"Plain"], 
       RowBox[{"resistance", " ", "frequency", " ", "data"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "sb"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"iso", "=", 
           RowBox[{"isolates", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           StyleBox["resis",
            FontWeight->"Plain"], 
           StyleBox[" ",
            FontWeight->"Plain"], 
           StyleBox["=",
            FontWeight->"Plain"], 
           StyleBox[" ",
            FontWeight->"Plain"], 
           RowBox[{"resistance", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"a", " ", "=", " ", 
           RowBox[{"cbp", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rm", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"k", ",", 
               RowBox[{"r0p", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"ksp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "tt"}], "}"}]}], "]"}]}]}], "}"}]}],
        "]"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
        " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rmbest", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"k", ",", 
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"fks", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "tt"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "model", " ", "output", " ", "under", " ", "best", " ", "fit"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rmin", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"rm", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"51", ";;", "1000"}], ",", "r"}], "]"}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", "tt"}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"rmax", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"rm", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"51", ";;", "1000"}], ",", "r"}], "]"}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", "tt"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "find", " ", "min", " ", "and", " ", "max", " ", "parameter", " ", 
        "sets"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rfill", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rmin", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"rmax", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rfit", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{"years", ",", 
            RowBox[{"rfill", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotD", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"years", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotM", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rfit", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "]"}]}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", "14", "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"pathogens", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "Italic", ",", "16"}], 
           "]"}]}], ",", 
         RowBox[{"Filling", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", "\[Rule]", 
            RowBox[{"{", "2", "}"}]}], "}"}]}], " ", ",", 
         RowBox[{"AxesOrigin", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"years", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
      ";"}]}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.702409813193028*^9, {3.702409859199143*^9, 3.702409903520693*^9}, {
   3.7024099757211637`*^9, 3.7024100165853167`*^9}, {3.702410052412945*^9, 
   3.702410091736423*^9}, {3.70241012705923*^9, 3.7024101518903418`*^9}, {
   3.7024260716442165`*^9, 3.7024260942685614`*^9}, {3.702426392615986*^9, 
   3.70242639577573*^9}, {3.702430473744401*^9, 3.7024304747267165`*^9}, {
   3.7024311476478205`*^9, 3.7024311674616966`*^9}, {3.7024312206210165`*^9, 
   3.7024312505955276`*^9}, {3.702431338623353*^9, 3.702431372124758*^9}, {
   3.7024314226539345`*^9, 3.70243144287173*^9}, {3.702431496994196*^9, 
   3.7024314976105585`*^9}, {3.702432228440519*^9, 3.702432337872447*^9}, {
   3.702660778109158*^9, 3.70266084934487*^9}, 3.702661064393134*^9, {
   3.703343597972722*^9, 3.7033436162981863`*^9}, {3.703343742712735*^9, 
   3.7033437554094515`*^9}, {3.703344360279479*^9, 3.703344374346529*^9}, {
   3.703344592528922*^9, 3.7033446335516334`*^9}, {3.7033446680323277`*^9, 
   3.7033446702773995`*^9}, 3.7033449684091015`*^9, {3.703345259885541*^9, 
   3.703345266316799*^9}, {3.703345339928297*^9, 3.7033453427186265`*^9}, {
   3.7033455486774673`*^9, 3.7033455515313025`*^9}, {3.7035074365409737`*^9, 
   3.7035075106033773`*^9}, {3.703507551466607*^9, 3.703507690067774*^9}, {
   3.703507720761755*^9, 3.7035078605722303`*^9}, {3.7035081547826505`*^9, 
   3.7035081565701885`*^9}, {3.7035143235522575`*^9, 3.70351435640691*^9}, {
   3.703514424184278*^9, 3.703514518038206*^9}, {3.7035146023202944`*^9, 
   3.703514615910864*^9}, 3.703515682104601*^9, {3.703515753701329*^9, 
   3.703515766466067*^9}, {3.703515938247336*^9, 3.703515938958087*^9}, {
   3.7035160841558743`*^9, 3.7035160845725155`*^9}, {3.7035163597113175`*^9, 
   3.7035163634001207`*^9}, {3.703518981658929*^9, 3.7035189943285203`*^9}, {
   3.7035190804316063`*^9, 3.7035191775957713`*^9}, {3.7035243773905354`*^9, 
   3.703524379273585*^9}, {3.703944990510111*^9, 3.703944993917447*^9}, {
   3.7042027454350915`*^9, 3.7042027907245493`*^9}, {3.704202907682955*^9, 
   3.7042029102055416`*^9}, 3.70420295366803*^9, {3.7042031276251893`*^9, 
   3.7042031300427227`*^9}, {3.704203353359421*^9, 3.7042033555165234`*^9}, {
   3.7042033989486923`*^9, 3.7042034180168676`*^9}, {3.704203452379017*^9, 
   3.704203454741359*^9}, {3.7042036510728674`*^9, 3.7042037549081755`*^9}, {
   3.7042038050462685`*^9, 3.704203806094046*^9}, {3.704203916655631*^9, 
   3.704203925473811*^9}, {3.7042039729986973`*^9, 3.7042040218393393`*^9}, {
   3.704204063970898*^9, 3.7042041430892544`*^9}, {3.70420734466286*^9, 
   3.7042073527489777`*^9}, {3.7042080825541067`*^9, 
   3.7042080908711443`*^9}, {3.704208265162795*^9, 3.7042082865558376`*^9}, {
   3.70420894516242*^9, 3.7042089754193416`*^9}, {3.7042093440673137`*^9, 
   3.7042093548654876`*^9}, {3.70420977136106*^9, 3.7042097732860537`*^9}, {
   3.704209832213515*^9, 3.7042098437261667`*^9}, {3.704211987162278*^9, 
   3.704212047713853*^9}, {3.7042121237335234`*^9, 3.7042121243605947`*^9}, {
   3.7042122502302036`*^9, 3.7042122534973145`*^9}, {3.7042123275272036`*^9, 
   3.7042123786978025`*^9}, {3.7042124186336327`*^9, 3.7042124209495955`*^9}, 
   3.7042124742274513`*^9, {3.7042125043815756`*^9, 3.704212511843959*^9}, {
   3.704212570559016*^9, 3.7042126337849526`*^9}, 3.704214621168783*^9, {
   3.7042159364051743`*^9, 3.7042159642853346`*^9}, 3.704216596263071*^9, {
   3.7042169267681756`*^9, 3.7042169307324734`*^9}, 3.704216968545945*^9, {
   3.710131294753098*^9, 3.7101312964061785`*^9}, {3.7101313413496294`*^9, 
   3.7101313587961855`*^9}, {3.7132807045448456`*^9, 3.713280707349801*^9}, {
   3.7132807412143555`*^9, 3.713280773194997*^9}, {3.713280865736297*^9, 
   3.7132808993183594`*^9}, {3.713280942893676*^9, 3.7132809433624773`*^9}, {
   3.7132870000694995`*^9, 3.7132870420194454`*^9}, {3.7185482744526873`*^9, 
   3.7185482818975244`*^9}, {3.7185484358670473`*^9, 3.718548437398637*^9}, {
   3.7188446089493685`*^9, 3.7188446132743373`*^9}, 3.7188467067909665`*^9, {
   3.7188865995277195`*^9, 3.718886600042897*^9}},
 ExpressionUUID -> "d9e4c014-30ea-45eb-9af4-d8d18697c3ac"]
}, Open  ]],

Cell[TextData[StyleBox["Model projections",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.702410180634329*^9, 3.7024101967250853`*^9}, {
  3.7035081660991926`*^9, 3.7035081694556847`*^9}},
 ExpressionUUID -> "9a589496-1e26-4fcf-8c91-975423636b8e"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Status quo:",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.703508588435497*^9, 3.7035085961604033`*^9}}],

Cell[TextData[{
 "1. Maintain most recent consumption levels until end of projections ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["t", "f"]}], TraditionalForm]]],
 "); \n2. Maintain linear trend of increasing consumption levels until end of \
projections ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["t", "f"]}], TraditionalForm]]],
 ")."
}], "Text",
 CellChangeTimes->{{3.703508618504487*^9, 3.70350870246686*^9}, {
  3.7035087755311627`*^9, 3.703508783329441*^9}, {3.703508931440913*^9, 
  3.70350893332882*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ti", "=", 
    RowBox[{
     RowBox[{"years", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "+", "1"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projections", " ", "begin", " ", "at", " ", "year", " ", 
    SubscriptBox["t", "i"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tf", " ", "=", "2035"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projection", " ", "until", " ", "year", " ", 
    SubscriptBox["t", "f"]}], "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyears", " ", "=", " ", 
    RowBox[{"Range", "[", " ", 
     RowBox[{"ti", ",", "tf"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "vector", " ", "of", " ", "years", " ", "from", " ", "ti", " ", "to", " ", 
    "tf"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nyears", " ", "=", " ", 
    RowBox[{"Length", "[", "pyears", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "of", " ", "years", " ", "to", " ", "project", " ", "across"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbp0", " ", "=", " ", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"carbcons", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "current", " ", "CBP", " ", "consumption", " ", "for", " ", "pneumonia", 
    " ", 
    RowBox[{"(", 
     RowBox[{"all", " ", "pathogens"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projSQ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", "nyears"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cbpSQ", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"projSQ", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7024101570563507`*^9, {3.702410218390636*^9, 3.702410362817946*^9}, {
   3.702410394869886*^9, 3.7024103970699472`*^9}, {3.7024104362820168`*^9, 
   3.702410444877763*^9}, {3.702410485033464*^9, 3.702410497966292*^9}, {
   3.7024106015437107`*^9, 3.702410687478723*^9}, 3.702410887353681*^9, {
   3.7024109658707323`*^9, 3.702410969317919*^9}, {3.7024261213503265`*^9, 
   3.7024261280905967`*^9}, {3.7024263725653534`*^9, 3.702426380245617*^9}, {
   3.702426457971155*^9, 3.7024264932668233`*^9}, {3.7024293872030387`*^9, 
   3.7024293931895275`*^9}, {3.702429462175844*^9, 3.70242946525767*^9}, {
   3.702430121492141*^9, 3.7024301671103873`*^9}, {3.7024302762387476`*^9, 
   3.702430288760964*^9}, {3.702644820122126*^9, 3.702644895701531*^9}, 
   3.702644943830612*^9, 3.702645089788928*^9, {3.7026451707843*^9, 
   3.70264526906386*^9}, {3.702646860223049*^9, 3.702646868962504*^9}, {
   3.702649139296464*^9, 3.702649320466694*^9}, {3.702649365182232*^9, 
   3.702649404887587*^9}, {3.702651111455793*^9, 3.7026511124499407`*^9}, {
   3.7026511597468357`*^9, 3.702651164081389*^9}, {3.702651196198786*^9, 
   3.702651197694605*^9}, {3.702651273522381*^9, 3.702651376152687*^9}, {
   3.702651418053768*^9, 3.702651443400633*^9}, 3.702652454145401*^9, {
   3.7026525127209053`*^9, 3.702652515601593*^9}, 3.702652548364834*^9, {
   3.702652608636973*^9, 3.702652657849235*^9}, {3.702653096817143*^9, 
   3.702653125610446*^9}, {3.702653749523258*^9, 3.702653750928804*^9}, {
   3.702653950929109*^9, 3.702653951679988*^9}, {3.702654039324127*^9, 
   3.702654039419592*^9}, {3.7026543363477087`*^9, 3.702654341882617*^9}, {
   3.7026545090261793`*^9, 3.7026545134917192`*^9}, {3.702654545342651*^9, 
   3.702654545558536*^9}, {3.702654608693609*^9, 3.702654619161729*^9}, {
   3.702654668682192*^9, 3.702654671385303*^9}, {3.702654727962429*^9, 
   3.7026547324014072`*^9}, {3.702654776069682*^9, 3.702654787369268*^9}, {
   3.7026548624498568`*^9, 3.702654867864908*^9}, {3.70265639087677*^9, 
   3.702656394099745*^9}, {3.7026564282281523`*^9, 3.702656545027399*^9}, {
   3.7026565898351803`*^9, 3.702656628453731*^9}, {3.702656668626183*^9, 
   3.7026566753049593`*^9}, {3.702656819101117*^9, 3.70265682103613*^9}, {
   3.7026569967323914`*^9, 3.702657008143818*^9}, {3.7026571246398993`*^9, 
   3.702657126487445*^9}, {3.702657371432023*^9, 3.702657425054729*^9}, {
   3.7026576846030293`*^9, 3.7026576856582727`*^9}, {3.7026608953323927`*^9, 
   3.7026609089441843`*^9}, 3.702661089124311*^9, {3.702661204048341*^9, 
   3.702661205391203*^9}, {3.702661284675581*^9, 3.702661291750792*^9}, {
   3.7026613428193283`*^9, 3.702661349627429*^9}, {3.702661379802754*^9, 
   3.702661380058751*^9}, {3.7033456056961913`*^9, 3.70334561000235*^9}, {
   3.7033458050779953`*^9, 3.7033458083271484`*^9}, {3.7033459913971276`*^9, 
   3.7033459939106092`*^9}, {3.7033461681953135`*^9, 
   3.7033461712910085`*^9}, {3.7033463567537875`*^9, 
   3.7033463572654247`*^9}, {3.7035082338264885`*^9, 
   3.7035082471470747`*^9}, {3.7035087059971313`*^9, 3.703508734307201*^9}, {
   3.7035087669185963`*^9, 3.7035087692494555`*^9}, {3.703508805421707*^9, 
   3.703508839820469*^9}, {3.7035088853377066`*^9, 3.7035090491735573`*^9}, {
   3.7035091583001184`*^9, 3.7035091686386347`*^9}, {3.703509602488188*^9, 
   3.703509602707128*^9}, {3.703509656145857*^9, 3.703509657959392*^9}, {
   3.703509720346399*^9, 3.7035097520558357`*^9}, {3.7035136434461355`*^9, 
   3.703513644255722*^9}, {3.703515324001593*^9, 3.703515324190832*^9}, {
   3.7035153572111883`*^9, 3.7035153710902896`*^9}, {3.7035160023508244`*^9, 
   3.7035160105050383`*^9}, {3.703517141670616*^9, 3.703517142985299*^9}, {
   3.70351738400301*^9, 3.703517404497833*^9}, {3.703517456846857*^9, 
   3.70351745704605*^9}, {3.7035175648886843`*^9, 3.7035175650573587`*^9}, {
   3.7035176152258997`*^9, 3.703517615449293*^9}, {3.703518215269558*^9, 
   3.703518216913766*^9}, {3.703524715096772*^9, 3.7035247324833183`*^9}, {
   3.704196230212077*^9, 3.7041962380707293`*^9}, {3.7041963209995203`*^9, 
   3.704196321425269*^9}, {3.7041964119609237`*^9, 3.704196452236375*^9}, {
   3.7041964974847107`*^9, 3.7041965084028883`*^9}, {3.7141466287897124`*^9, 
   3.7141466352042933`*^9}, {3.718829196351863*^9, 3.718829253465877*^9}, {
   3.7188293469290233`*^9, 3.718829364498951*^9}, {3.718829422805379*^9, 
   3.7188294994078255`*^9}, {3.7188402620911055`*^9, 
   3.7188402624192715`*^9}, {3.7207950472392936`*^9, 3.720795047364275*^9}},
 ExpressionUUID -> "a0c0b461-cf24-49a7-b2d1-dfdb7c4a7d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Interventions:",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.703509177309683*^9, 3.7035091785015554`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sy", "=", "2018"}], ";", " ", 
   RowBox[{"ey", "=", "2020"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"start", " ", "of", " ", "intervention"}], ",", " ", 
    RowBox[{
    "year", " ", "of", " ", "achieving", " ", "full", " ", "reduction"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sqyears", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"ti", ",", 
      RowBox[{"sy", "-", "1"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "status", " ", "quo", " ", "years", " ", "prior", " ", "to", " ", 
    "intervention", " ", "start"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ncy", "=", 
    RowBox[{"Length", "[", "sqyears", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "sq", " ", "years", " ", "before", " ", "beginning", " ", 
    "intervention"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"niy", "=", 
    RowBox[{"ey", "-", "sy", "+", "1"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "intervention", " ", "years", " ", "prior", " ", "to", " ", 
    "reaching", " ", "full", " ", "reduction"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projI", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", "ncy"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"cbp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "stw"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"cbp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "*", "stw"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"niy", "-", "1"}], ")"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cbp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "stw"}], ")"}]}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{"nyears", "-", "ncy", "-", "niy"}], "]"}]}], "]"}]}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cbpI", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"projI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7024101570563507`*^9, {3.702410218390636*^9, 3.702410362817946*^9}, {
   3.702410394869886*^9, 3.7024103970699472`*^9}, {3.7024104362820168`*^9, 
   3.702410444877763*^9}, {3.702410485033464*^9, 3.702410497966292*^9}, {
   3.7024106015437107`*^9, 3.702410687478723*^9}, 3.702410887353681*^9, {
   3.7024109658707323`*^9, 3.702410969317919*^9}, {3.7024261213503265`*^9, 
   3.7024261280905967`*^9}, {3.7024263725653534`*^9, 3.702426380245617*^9}, {
   3.702426457971155*^9, 3.7024264932668233`*^9}, {3.7024293872030387`*^9, 
   3.7024293931895275`*^9}, {3.702429462175844*^9, 3.70242946525767*^9}, {
   3.702430121492141*^9, 3.7024301671103873`*^9}, {3.7024302762387476`*^9, 
   3.702430288760964*^9}, {3.702644820122126*^9, 3.702644895701531*^9}, 
   3.702644943830612*^9, 3.702645089788928*^9, {3.7026451707843*^9, 
   3.70264526906386*^9}, {3.702646860223049*^9, 3.702646868962504*^9}, {
   3.702649139296464*^9, 3.702649320466694*^9}, {3.702649365182232*^9, 
   3.702649404887587*^9}, {3.702651111455793*^9, 3.7026511124499407`*^9}, {
   3.7026511597468357`*^9, 3.702651164081389*^9}, {3.702651196198786*^9, 
   3.702651197694605*^9}, {3.702651273522381*^9, 3.702651376152687*^9}, {
   3.702651418053768*^9, 3.702651443400633*^9}, 3.702652454145401*^9, {
   3.7026525127209053`*^9, 3.702652515601593*^9}, 3.702652548364834*^9, {
   3.702652608636973*^9, 3.702652657849235*^9}, {3.702653096817143*^9, 
   3.702653125610446*^9}, {3.702653749523258*^9, 3.702653750928804*^9}, {
   3.702653950929109*^9, 3.702653951679988*^9}, {3.702654039324127*^9, 
   3.702654039419592*^9}, {3.7026543363477087`*^9, 3.702654341882617*^9}, {
   3.7026545090261793`*^9, 3.7026545134917192`*^9}, {3.702654545342651*^9, 
   3.702654545558536*^9}, {3.702654608693609*^9, 3.702654619161729*^9}, {
   3.702654668682192*^9, 3.702654671385303*^9}, {3.702654727962429*^9, 
   3.7026547324014072`*^9}, {3.702654776069682*^9, 3.702654787369268*^9}, {
   3.7026548624498568`*^9, 3.702654867864908*^9}, {3.70265639087677*^9, 
   3.702656394099745*^9}, {3.7026564282281523`*^9, 3.702656545027399*^9}, {
   3.7026565898351803`*^9, 3.702656628453731*^9}, {3.702656668626183*^9, 
   3.7026566753049593`*^9}, {3.702656819101117*^9, 3.70265682103613*^9}, {
   3.7026569967323914`*^9, 3.702657008143818*^9}, {3.7026571246398993`*^9, 
   3.702657126487445*^9}, {3.702657371432023*^9, 3.702657425054729*^9}, {
   3.7026576846030293`*^9, 3.7026576856582727`*^9}, {3.7026608953323927`*^9, 
   3.7026609089441843`*^9}, 3.702661089124311*^9, {3.702661204048341*^9, 
   3.702661205391203*^9}, {3.702661284675581*^9, 3.702661291750792*^9}, {
   3.7026613428193283`*^9, 3.702661349627429*^9}, {3.702661379802754*^9, 
   3.702661380058751*^9}, {3.7033456056961913`*^9, 3.70334561000235*^9}, {
   3.7033458050779953`*^9, 3.7033458083271484`*^9}, {3.7033459913971276`*^9, 
   3.7033459939106092`*^9}, {3.7033461681953135`*^9, 
   3.7033461712910085`*^9}, {3.7033463567537875`*^9, 
   3.7033463572654247`*^9}, {3.7035082338264885`*^9, 
   3.7035082471470747`*^9}, {3.7035087059971313`*^9, 3.703508734307201*^9}, {
   3.7035087669185963`*^9, 3.7035087692494555`*^9}, {3.703508805421707*^9, 
   3.703508839820469*^9}, {3.7035088853377066`*^9, 3.7035090491735573`*^9}, {
   3.7035091583001184`*^9, 3.7035091686386347`*^9}, {3.7035107380975866`*^9, 
   3.703510739164034*^9}, {3.703510930848754*^9, 3.70351099149683*^9}, {
   3.7035136106172495`*^9, 3.703513610754774*^9}, {3.703513742363851*^9, 
   3.7035137425128*^9}, {3.7035138143541393`*^9, 3.703513815425207*^9}, {
   3.70351386887615*^9, 3.703513965248187*^9}, {3.7035140660487466`*^9, 
   3.703514066580064*^9}, {3.7035152373321915`*^9, 3.703515308408615*^9}, {
   3.7035153419441814`*^9, 3.7035153851112537`*^9}, {3.703524283585355*^9, 
   3.7035242840850816`*^9}, {3.703524725073661*^9, 3.7035247251961956`*^9}, {
   3.7039377407464848`*^9, 3.7039377436080956`*^9}, {3.703943020524397*^9, 
   3.703943078199394*^9}, 3.703943316828333*^9, {3.7039434295423536`*^9, 
   3.7039434310270224`*^9}, {3.703943462979719*^9, 3.703943488672473*^9}, 
   3.703945122440321*^9, {3.7041965367300167`*^9, 3.7041965417697525`*^9}, {
   3.7136482204296927`*^9, 3.7136482270947514`*^9}, {3.7136483402910395`*^9, 
   3.713648359484461*^9}, 3.7136495073740664`*^9, {3.7188297222228003`*^9, 
   3.7188297356890836`*^9}, {3.718829781732129*^9, 3.7188297858617077`*^9}, {
   3.718829855297886*^9, 3.7188300088240232`*^9}, {3.7188300554791975`*^9, 
   3.7188300609921503`*^9}, {3.718838228521333*^9, 3.718838316562482*^9}, {
   3.718838457366002*^9, 3.7188385128141403`*^9}, {3.718838794705413*^9, 
   3.7188388078677073`*^9}, {3.7188388674465785`*^9, 3.718838942702777*^9}, {
   3.718839110692155*^9, 3.718839197853115*^9}, {3.718839255890061*^9, 
   3.718839289920641*^9}, {3.7188393265504537`*^9, 3.7188393359606256`*^9}, {
   3.718839428929613*^9, 3.7188394982783527`*^9}, {3.718839555483637*^9, 
   3.7188397015672064`*^9}, {3.718839738862632*^9, 3.7188397390657396`*^9}, {
   3.7188399622012606`*^9, 3.718839970257415*^9}, {3.7188400231418943`*^9, 
   3.7188400363880043`*^9}, {3.718840095531454*^9, 3.7188400976085405`*^9}, {
   3.7188402012199483`*^9, 3.718840201672966*^9}, {3.718840239664407*^9, 
   3.71884025961497*^9}, {3.7202011712667074`*^9, 3.7202012208637094`*^9}, 
   3.7202050826450586`*^9, {3.72020997735411*^9, 3.720209978495145*^9}, {
   3.72079802721357*^9, 3.7207980442093744`*^9}, {3.720799331657584*^9, 
   3.7207993327603874`*^9}},
 ExpressionUUID -> "a0c0b461-cf24-49a7-b2d1-dfdb7c4a7d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Projected resistance frequencies:",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7035155045659313`*^9, 3.7035155225031085`*^9}, 
   3.7035158752769194`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"initalize", " ", "stored", " ", "values"}], "*)"}],
   FontWeight->"Bold"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["rSQ",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "sb"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "status", " ", "quo"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQbest", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "SQ", " ", "with", " ",
      "best", " ", "fit"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQm", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";", 
    RowBox[{"rSQM", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "4"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"min", " ", "and", " ", "max"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitS", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"uncertainty", " ", "band"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rI", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "sb"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "intervention"}], 
    "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     StyleBox["rIbest",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"best", " ", "fit"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     StyleBox["rIm",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Plain"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";", " ", 
    RowBox[{"rIM", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"min", " ", "and", " ", "max", " ", "resistance", " ", "values"}],
     "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{
     StyleBox["fitI",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"uncertainty", " ", "band"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"intialize", " ", "plots"}], "*)"}],
    FontWeight->"Bold"], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{"ploty", "=", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"years", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", "tf"}], "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{"plotS", "  ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"status", " ", "quo", " ", "projections"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotI", "  ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"intervention", " ", "projections"}], "*)"}], "\n", 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{"(*", 
    RowBox[{"status", " ", "quo", " ", "projections"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     StyleBox["For",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{"i", "=", "1"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["i",
        FontWeight->"Bold"], 
       StyleBox["\[LessEqual]",
        FontWeight->"Bold"], " ", 
       StyleBox["nop",
        FontWeight->"Bold"]}], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"i", "++"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"(*", 
        RowBox[{"#", " ", "pathogens"}], "*)"}],
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox["r0p",
         FontWeight->"Bold"], 
        StyleBox[" ",
         FontWeight->"Bold"], 
        StyleBox["=",
         FontWeight->"Bold"], 
        RowBox[{"r0T", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"ksp", " ", "=", " ", 
        RowBox[{"ksT", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "save", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ",
          "each", " ", "pathogen"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", "sb"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iso", "=", 
            RowBox[{"isolates", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            StyleBox["resis",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            StyleBox["=",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            RowBox[{"resistance", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"a", " ", "=", " ", 
            RowBox[{"cbpSQ", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"rSQ", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"k", ",", 
                RowBox[{"r0p", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                RowBox[{"ksp", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "\[Theta]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "tt", ",", 
                RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rSQm", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"rSQ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"51", ";;", "1000"}], ",", "r"}], "]"}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"nyears", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"rSQM", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"rSQ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"51", ";;", "1000"}], ",", "r"}], "]"}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"nyears", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
         " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rSQbest", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"k", ",", 
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "tt", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rSQfill", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rSQm", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"rSQM", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fitS", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"ploty", ",", 
             RowBox[{
              RowBox[{"rSQfill", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"plotS", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fitS", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "]"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", "\[Rule]", 
             RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"years", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
       ";"}]}], "]"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"SQ", " ", "plots", " ", "per", " ", "pathogen"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"intervention", " ", "projections"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     StyleBox["For",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{"i", "=", "1"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["i",
        FontWeight->"Bold"], 
       StyleBox["\[LessEqual]",
        FontWeight->"Bold"], " ", 
       StyleBox["nop",
        FontWeight->"Bold"]}], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"i", "++"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"(*", 
        RowBox[{"#", " ", "pathogens"}], "*)"}],
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox["r0p",
         FontWeight->"Bold"], 
        StyleBox[" ",
         FontWeight->"Bold"], 
        StyleBox["=",
         FontWeight->"Bold"], 
        RowBox[{"r0T", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"ksp", " ", "=", " ", 
        RowBox[{"ksT", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "save", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ",
          "each", " ", "pathogen"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", "sb"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iso", "=", 
            RowBox[{"isolates", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            StyleBox["resis",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            StyleBox["=",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            RowBox[{"resistance", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"a", " ", "=", " ", 
            RowBox[{"cbpI", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"rI", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"k", ",", 
                RowBox[{"r0p", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                RowBox[{"ksp", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "\[Theta]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "tt", ",", 
                RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rIm", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"rI", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"51", ";;", "1000"}], ",", "r"}], "]"}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"nyears", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"rIM", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"rI", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"51", ";;", "1000"}], ",", "r"}], "]"}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"nyears", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
         " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rIbest", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"k", ",", 
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "tt", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rIfill", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rIm", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"rIM", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fitI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"ploty", ",", 
             RowBox[{
              RowBox[{"rIfill", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"plotI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fitI", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.3", ",", "0.5", ",", "0.75"}], "]"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", "\[Rule]", 
             RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"years", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
       ";"}]}], "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.702656624595193*^9, 3.70265663463831*^9}, 
   3.7033447831113815`*^9, {3.7033449849882936`*^9, 3.7033449870707026`*^9}, {
   3.703515451649769*^9, 3.703515473290518*^9}, {3.7035155595203905`*^9, 
   3.703515685082728*^9}, {3.7035157432515965`*^9, 3.703515802176572*^9}, {
   3.7035159176168036`*^9, 3.7035159337037663`*^9}, {3.7035160501219788`*^9, 
   3.7035161139656773`*^9}, {3.7035161532168655`*^9, 3.70351620668676*^9}, {
   3.703516280376177*^9, 3.703516428656685*^9}, {3.703516497435608*^9, 
   3.7035164983504086`*^9}, {3.7035165309561834`*^9, 3.703516688172882*^9}, {
   3.703516769137375*^9, 3.703516828218351*^9}, {3.703517181626542*^9, 
   3.703517189108159*^9}, {3.703518444926235*^9, 3.7035184483422613`*^9}, {
   3.703518517615677*^9, 3.703518608012863*^9}, {3.7035186747767005`*^9, 
   3.7035187115422773`*^9}, {3.70351903666362*^9, 3.7035190699702806`*^9}, {
   3.70351911265419*^9, 3.7035191429602427`*^9}, {3.7035243858521786`*^9, 
   3.703524391647381*^9}, {3.7036037301810565`*^9, 3.703603742905409*^9}, {
   3.7036038213900967`*^9, 3.7036038561558275`*^9}, 3.703941183431985*^9, 
   3.7039422896846323`*^9, 3.703943483913226*^9, {3.7039452360363064`*^9, 
   3.7039452643340855`*^9}, 3.703945365860498*^9, {3.703947024971072*^9, 
   3.7039470263667407`*^9}, {3.7040338656944685`*^9, 3.704033884342639*^9}, {
   3.7042077184093065`*^9, 3.7042077193302183`*^9}, {3.7042077541226187`*^9, 
   3.704207768917225*^9}, {3.7042080345634203`*^9, 3.70420806400382*^9}, {
   3.7042081952744865`*^9, 3.7042082346858187`*^9}, 3.70420845637644*^9, {
   3.7042085503847275`*^9, 3.7042085516613026`*^9}, {3.7042086228821497`*^9, 
   3.7042086259920063`*^9}, {3.704208696037682*^9, 3.7042087087808523`*^9}, {
   3.704208785355607*^9, 3.7042088270032454`*^9}, {3.704212867152712*^9, 
   3.704212932676712*^9}, {3.7042130487576513`*^9, 3.7042130767047434`*^9}, {
   3.7042131943976526`*^9, 3.7042131961367793`*^9}, {3.7042137405002265`*^9, 
   3.704213760004231*^9}, {3.7042138375787573`*^9, 3.704213845834399*^9}, {
   3.7042139206490345`*^9, 3.7042139972932615`*^9}, {3.7042140916551704`*^9, 
   3.704214101039055*^9}, {3.7101328824617715`*^9, 3.7101328907375593`*^9}, {
   3.7132809828702126`*^9, 3.713281021486581*^9}, {3.713286973901414*^9, 
   3.7132869935900702`*^9}, {3.713287052666051*^9, 3.7132871144919367`*^9}, {
   3.7188303634394875`*^9, 3.7188303638349323`*^9}, {3.718830492463052*^9, 
   3.7188305166489286`*^9}, {3.7188305754065027`*^9, 
   3.7188305980326777`*^9}, {3.7188371116830025`*^9, 3.71883711225224*^9}, {
   3.718837236731703*^9, 3.7188372369969234`*^9}, {3.7188373288940926`*^9, 
   3.7188373550973196`*^9}, {3.718838044820858*^9, 3.7188380475086484`*^9}, {
   3.7188383883239055`*^9, 3.718838440994768*^9}, {3.7188390552601795`*^9, 
   3.7188390847987757`*^9}, {3.718844378069232*^9, 3.7188444569821467`*^9}, {
   3.718846713876641*^9, 3.718846720530072*^9}},
 ExpressionUUID -> "eeb0ea7c-db8d-434c-8af1-fba84a2341bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Projected Plots",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.703515824438591*^9, 3.7035158726627064`*^9}, 
   3.7039424466471357`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotsb", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", " ", "nop"}], ",", " ", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{
    RowBox[{"plotsb", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"plotM", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"plotD", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"plotS", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"plotI", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "plotsb", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<sepsis model plots.pdf\>\"", ",", "plotsb"}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.702407870457457*^9, {3.7024248406466923`*^9, 3.702425175347551*^9}, {
   3.702425945909051*^9, 3.702426004912137*^9}, {3.702427421515868*^9, 
   3.7024274558517714`*^9}, {3.702427486284043*^9, 3.7024275824191093`*^9}, {
   3.7024276263168*^9, 3.702427715560113*^9}, {3.702427748535629*^9, 
   3.7024277518682117`*^9}, {3.702427870675129*^9, 3.7024278752066483`*^9}, {
   3.702427908102473*^9, 3.702427937725103*^9}, {3.7024279681150503`*^9, 
   3.7024280470823584`*^9}, {3.702428096138521*^9, 3.7024281635034637`*^9}, {
   3.702428194076641*^9, 3.7024282365377474`*^9}, {3.7024284276501617`*^9, 
   3.7024285345698442`*^9}, {3.7024287126011314`*^9, 
   3.7024287517714176`*^9}, {3.7024287966754894`*^9, 3.702428799345875*^9}, {
   3.7024291627971797`*^9, 3.702429188752822*^9}, {3.7024293149599457`*^9, 
   3.702429362972146*^9}, {3.702429470849602*^9, 3.7024295031878643`*^9}, {
   3.7024295811711235`*^9, 3.7024295905754395`*^9}, {3.702429637656077*^9, 
   3.702429644484815*^9}, {3.7024297385128016`*^9, 3.702429743987793*^9}, {
   3.702429790612954*^9, 3.7024298113467045`*^9}, {3.702430351995313*^9, 
   3.7024303641922092`*^9}, {3.7024303952954717`*^9, 3.70243043580497*^9}, {
   3.70243152124923*^9, 3.7024315724123297`*^9}, {3.7024316465214443`*^9, 
   3.7024316663737264`*^9}, 3.7024318095117598`*^9, {3.7024318425123625`*^9, 
   3.702431843053169*^9}, {3.7024318931153374`*^9, 3.702432025890111*^9}, {
   3.7024324067391715`*^9, 3.7024324552833986`*^9}, {3.7024325236477146`*^9, 
   3.7024325273519754`*^9}, {3.702432565792087*^9, 3.702432579781447*^9}, {
   3.702653141421315*^9, 3.702653340519669*^9}, {3.702653836950541*^9, 
   3.702653881154426*^9}, {3.702653930010499*^9, 3.702653930121722*^9}, {
   3.702653960974854*^9, 3.7026539886096687`*^9}, {3.702654703707715*^9, 
   3.702654743215666*^9}, {3.7026547983200006`*^9, 3.702654828986767*^9}, {
   3.7026548813636503`*^9, 3.70265490093046*^9}, {3.702656551897674*^9, 
   3.7026565522405033`*^9}, {3.702660970024069*^9, 3.702661004431554*^9}, {
   3.702661111268489*^9, 3.7026611838034678`*^9}, {3.7026612528233557`*^9, 
   3.70266127757127*^9}, {3.70266130900733*^9, 3.7026613273557*^9}, {
   3.70266140549081*^9, 3.7026614078432903`*^9}, {3.70266145995835*^9, 
   3.70266146399852*^9}, {3.702726367050666*^9, 3.7027263756931677`*^9}, {
   3.7033444973180904`*^9, 3.703344503376297*^9}, {3.7033445648014855`*^9, 
   3.7033445835992775`*^9}, {3.703345160683509*^9, 3.7033451663141155`*^9}, {
   3.703345216247076*^9, 3.703345254000185*^9}, {3.7033453055613375`*^9, 
   3.7033453322704515`*^9}, {3.7033455069148197`*^9, 
   3.7033455352267556`*^9}, {3.7033456283212767`*^9, 
   3.7033456689376497`*^9}, {3.7033458186462755`*^9, 
   3.7033459744766707`*^9}, {3.703346129568878*^9, 3.7033461503802004`*^9}, {
   3.703346254688214*^9, 3.7033462629316206`*^9}, {3.703346369772493*^9, 
   3.703346388754492*^9}, {3.703346489901452*^9, 3.7033464906843596`*^9}, {
   3.703504990815522*^9, 3.703504992862009*^9}, {3.7035187167927237`*^9, 
   3.7035187178586063`*^9}, {3.7035187615575533`*^9, 
   3.7035188042339067`*^9}, {3.7036102873478975`*^9, 
   3.7036102908197927`*^9}, {3.703942295040556*^9, 3.7039423028356504`*^9}, {
   3.7039423344662037`*^9, 3.703942409872303*^9}, {3.7039424855185337`*^9, 
   3.703942797119769*^9}, {3.7039428311486692`*^9, 3.7039428502447453`*^9}, {
   3.703944790038698*^9, 3.7039448321450825`*^9}, {3.7039448933233776`*^9, 
   3.703944970794406*^9}, {3.703945005777646*^9, 3.703945092598867*^9}, {
   3.703945302092024*^9, 3.7039453022170687`*^9}, {3.703945524497073*^9, 
   3.7039455450469*^9}, {3.703954548322132*^9, 3.703954604951898*^9}, {
   3.710129810301406*^9, 3.7101298278201823`*^9}, {3.7101299849463654`*^9, 
   3.710130010204197*^9}, 3.710130501347456*^9, {3.7101332571550727`*^9, 
   3.710133262372559*^9}, 3.7101345429009256`*^9, {3.7101363159632416`*^9, 
   3.710136324663267*^9}, {3.7101370332164*^9, 3.7101370336879807`*^9}, {
   3.710137095705262*^9, 3.710137157813202*^9}, {3.713648376291336*^9, 
   3.713648380871111*^9}, {3.7188289271036415`*^9, 3.718828927477979*^9}, {
   3.7188306392265763`*^9, 3.718830790572982*^9}, {3.718830844134308*^9, 
   3.7188308731081142`*^9}, {3.7188376901765647`*^9, 3.718837728671163*^9}, {
   3.7188377663825254`*^9, 3.7188377951392393`*^9}, {3.718840551277587*^9, 
   3.71884059911822*^9}, {3.7188428339721413`*^9, 3.718842903918372*^9}, {
   3.7188429374771323`*^9, 3.718842939634454*^9}, {3.7202055402143555`*^9, 
   3.720205554832141*^9}, {3.7207950269678583`*^9, 3.720795034555273*^9}, {
   3.720798717067232*^9, 3.7207987172547765`*^9}, {3.720801208023903*^9, 
   3.720801208498192*^9}, {3.7208017197793484`*^9, 3.7208017239587555`*^9}, {
   3.72080862348701*^9, 3.720808634323804*^9}},
 ExpressionUUID -> "e293dcdf-d160-4ce2-8cd4-42e92e4e113d"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"New", " ", "Plots"}], "-", " ", 
     RowBox[{"No", " ", "uncertainty"}]}], "*)"}],
   FontWeight->"Bold"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mf", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"rmbest", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"model", " ", "fit", " ", "data", " ", 
     RowBox[{"w", "/", " ", "years"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sqf", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"ploty", ",", 
          RowBox[{"rSQbest", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"status", " ", "quo", " ", "data", " ", 
     RowBox[{"w", "/", " ", "years"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sqdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"mf", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{"sqf", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"data", " ", "to", " ", "plot"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotSQf", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"sqdata", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "Year"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "Resistance"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "Thick"}], "}"}]}], 
         ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"pathogens", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "Italic", ",", "16"}], 
           "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"years", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yminSQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"rmbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"rIbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", "0.05"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "where", " ", "to", " ", "put", " ", "the", " ", "x", " ", "axis"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"if", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ploty", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"rIbest", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"intervention", " ", "fit", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotIf", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"if", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "Year"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "Resistance"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", "Thick", "}"}]}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"years", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710129843098933*^9, 3.710129869479068*^9}, {
   3.710129937265671*^9, 3.710129937518232*^9}, {3.710129971477062*^9, 
   3.7101299723124313`*^9}, {3.7101300143836107`*^9, 3.710130017440318*^9}, {
   3.7101302303794155`*^9, 3.710130298515348*^9}, {3.710130330280644*^9, 
   3.710130342677846*^9}, {3.710130395742999*^9, 3.7101305895077686`*^9}, {
   3.7101306379666805`*^9, 3.7101306412741175`*^9}, {3.710130684715993*^9, 
   3.7101308301362305`*^9}, {3.7101308853848705`*^9, 
   3.7101309462501526`*^9}, {3.710131020081371*^9, 3.710131031781757*^9}, {
   3.710131067763107*^9, 3.71013108460911*^9}, {3.71013112044154*^9, 
   3.710131192239709*^9}, {3.7101312233782916`*^9, 3.7101312325449643`*^9}, {
   3.710131380447784*^9, 3.7101313952534037`*^9}, {3.710131541100562*^9, 
   3.7101315833101654`*^9}, {3.710132043159299*^9, 3.710132088174046*^9}, {
   3.710132332450718*^9, 3.7101323852880926`*^9}, {3.710132418694731*^9, 
   3.710132450513915*^9}, {3.7101325515847206`*^9, 3.7101326240294733`*^9}, {
   3.710133382770731*^9, 3.710133555924535*^9}, {3.7101352188005137`*^9, 
   3.710135260558482*^9}, {3.7101353176883802`*^9, 3.710135317852728*^9}, {
   3.7101353953013344`*^9, 3.710135427727297*^9}, {3.710135505883997*^9, 
   3.7101355178338547`*^9}, {3.710135555135951*^9, 3.710135752475633*^9}, {
   3.710135812006016*^9, 3.7101358295430965`*^9}, {3.710135909864919*^9, 
   3.7101359253388186`*^9}, 3.710135974111394*^9, {3.7101360584027653`*^9, 
   3.7101361479087076`*^9}, {3.710136246708397*^9, 3.7101362790402565`*^9}, {
   3.710136396954301*^9, 3.71013645901952*^9}, {3.710136494475462*^9, 
   3.7101365645525007`*^9}, {3.7101366290058985`*^9, 3.710136653877407*^9}, {
   3.710136831955473*^9, 3.7101368375696316`*^9}, {3.713287337585284*^9, 
   3.7132874909334364`*^9}, {3.713287558130066*^9, 3.713287693030659*^9}, {
   3.7132881566606646`*^9, 3.713288181786834*^9}, {3.7132882446365795`*^9, 
   3.7132882596323223`*^9}, {3.713288303894538*^9, 3.713288304410183*^9}, {
   3.713449670643365*^9, 3.713449673971837*^9}, {3.7134497162387447`*^9, 
   3.7134497175513678`*^9}, {3.7134498130042267`*^9, 
   3.7134498206820536`*^9}, {3.7134517566871157`*^9, 
   3.7134518019531484`*^9}, {3.7136484047406716`*^9, 3.713648406139782*^9}, {
   3.713648446849163*^9, 3.713648446994519*^9}, {3.7141417364777107`*^9, 
   3.7141417946947374`*^9}, {3.7141418520274744`*^9, 3.714141852548082*^9}, {
   3.7202041052795954`*^9, 3.7202041686794057`*^9}, {3.720204201789138*^9, 
   3.720204270740743*^9}, {3.7202044483293557`*^9, 3.720204506403052*^9}, 
   3.7202055706293373`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Create", " ", "graphics", " ", "grid"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotsF", "=", 
    RowBox[{"Panel", "[", 
     RowBox[{
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"plotD", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"plotSQf", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"plotIf", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"AxesStyle", "->", 
               RowBox[{"Directive", "[", "14", "]"}]}], ",", 
              RowBox[{"AxesOrigin", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"2000", ",", "0"}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"plotD", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"plotSQf", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"plotIf", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"Axes", "\[Rule]", "True"}], ",", 
              RowBox[{"AxesStyle", "->", 
               RowBox[{"Directive", "[", "14", "]"}]}], ",", 
              RowBox[{"AxesOrigin", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2000", ",", "0"}], "}"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"plotD", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"plotSQf", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"plotIf", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"AxesStyle", "->", 
              RowBox[{"Directive", "[", "14", "]"}]}], ",", 
             RowBox[{"AxesOrigin", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"2000", ",", "0"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "}"}]}], "}"}],
         ",", 
        RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Resistance Frequency Projections with Various \
Interventions\>\"", ",", "\"\<Panel\>\"", ",", "24", ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Rotate", "[", 
           RowBox[{"\"\<Resistance frequency\>\"", ",", 
            RowBox[{"90", " ", "Degree"}]}], "]"}], ",", "\"\<Panel\>\"", ",",
           "18", ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Year\>\"", ",", "\"\<Panel\>\"", ",", "18", ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Top", ",", "Center"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Left", ",", "Center"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bottom", ",", "Center"}], "}"}]}], "}"}], ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<sepsis model plots best fit.pdf\>\"", ",", "plotsF"}], 
      "]"}], ";"}], "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.710134550631424*^9, 3.7101345508025093`*^9}, {
   3.7101346494403253`*^9, 3.7101347098159847`*^9}, {3.710134852652776*^9, 
   3.7101348967464705`*^9}, {3.710135015779894*^9, 3.7101351630771456`*^9}, {
   3.710135853013935*^9, 3.710135875683272*^9}, 3.7101365865500383`*^9, {
   3.7101366195784883`*^9, 3.7101366203977127`*^9}, {3.7101367194806457`*^9, 
   3.710136767802492*^9}, {3.710136811642031*^9, 3.7101368248720937`*^9}, {
   3.7101368562719545`*^9, 3.710136940102995*^9}, {3.710136984791905*^9, 
   3.710136987223076*^9}, {3.7101370191896744`*^9, 3.710137067271117*^9}, {
   3.7101371632236595`*^9, 3.710137166891849*^9}, {3.7134496781597786`*^9, 
   3.7134496840311375`*^9}, {3.7134497261561856`*^9, 3.713449828377678*^9}, {
   3.713458926075856*^9, 3.7134589352579384`*^9}, {3.7141417852525463`*^9, 
   3.71414180386353*^9}, {3.7141418701414566`*^9, 3.7141418787516212`*^9}, {
   3.7150880859151325`*^9, 3.7150880947418585`*^9}, {3.7202042824449253`*^9, 
   3.720204284164508*^9}, {3.7202043509139023`*^9, 3.720204386026003*^9}, 
   3.7202044284011354`*^9, {3.7202055244995403`*^9, 3.7202055296773176`*^9}, {
   3.7202055733917313`*^9, 3.720205594900003*^9}, {3.720210164127368*^9, 
   3.720210213326824*^9}, {3.7207987224428253`*^9, 3.720798722645978*^9}, {
   3.7207990500611916`*^9, 3.7207990555777082`*^9}, {3.720801196852972*^9, 
   3.720801197290634*^9}, 3.7208086655605793`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.72020551062994*^9, 3.720205510758308*^9}, 
   3.7202055843097367`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Export data",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.718840613450031*^9, 3.7188406143720045`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"with", " ", "uncertainty"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<sepsis model.xls\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<resistance\>\"", "\[Rule]", " ", "resistance"}], ",", 
        " ", 
        RowBox[{"\"\<isolates\>\"", " ", "\[Rule]", " ", "isolates"}], ",", 
        RowBox[{"\"\<rfit\>\"", "\[Rule]", " ", "rfit"}], ",", 
        RowBox[{"\"\<rmbest\>\"", "\[Rule]", " ", "rmbest"}], ",", " ", 
        RowBox[{"\"\<fitS\>\"", "\[Rule]", " ", "fitS"}], ",", " ", 
        RowBox[{"\"\<rSQbest\>\"", "\[Rule]", " ", "rSQbest"}], ",", " ", 
        RowBox[{"\"\<fitI\>\"", "\[Rule]", " ", "fitI"}], ",", " ", 
        RowBox[{"\"\<rIbest\>\"", "\[Rule]", " ", "rIbest"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.702407870457457*^9, {3.7024248406466923`*^9, 3.702425175347551*^9}, {
   3.702425945909051*^9, 3.702426004912137*^9}, {3.702427421515868*^9, 
   3.7024274558517714`*^9}, {3.702427486284043*^9, 3.7024275824191093`*^9}, {
   3.7024276263168*^9, 3.702427715560113*^9}, {3.702427748535629*^9, 
   3.7024277518682117`*^9}, {3.702427870675129*^9, 3.7024278752066483`*^9}, {
   3.702427908102473*^9, 3.702427937725103*^9}, {3.7024279681150503`*^9, 
   3.7024280470823584`*^9}, {3.702428096138521*^9, 3.7024281635034637`*^9}, {
   3.702428194076641*^9, 3.7024282365377474`*^9}, {3.7024284276501617`*^9, 
   3.7024285345698442`*^9}, {3.7024287126011314`*^9, 
   3.7024287517714176`*^9}, {3.7024287966754894`*^9, 3.702428799345875*^9}, {
   3.7024291627971797`*^9, 3.702429188752822*^9}, {3.7024293149599457`*^9, 
   3.702429362972146*^9}, {3.702429470849602*^9, 3.7024295031878643`*^9}, {
   3.7024295811711235`*^9, 3.7024295905754395`*^9}, {3.702429637656077*^9, 
   3.702429644484815*^9}, {3.7024297385128016`*^9, 3.702429743987793*^9}, {
   3.702429790612954*^9, 3.7024298113467045`*^9}, {3.702430351995313*^9, 
   3.7024303641922092`*^9}, {3.7024303952954717`*^9, 3.70243043580497*^9}, {
   3.70243152124923*^9, 3.7024315724123297`*^9}, {3.7024316465214443`*^9, 
   3.7024316663737264`*^9}, 3.7024318095117598`*^9, {3.7024318425123625`*^9, 
   3.702431843053169*^9}, {3.7024318931153374`*^9, 3.702432025890111*^9}, {
   3.7024324067391715`*^9, 3.7024324552833986`*^9}, {3.7024325236477146`*^9, 
   3.7024325273519754`*^9}, {3.702432565792087*^9, 3.702432579781447*^9}, {
   3.702653141421315*^9, 3.702653340519669*^9}, {3.702653836950541*^9, 
   3.702653881154426*^9}, {3.702653930010499*^9, 3.702653930121722*^9}, {
   3.702653960974854*^9, 3.7026539886096687`*^9}, {3.702654703707715*^9, 
   3.702654743215666*^9}, {3.7026547983200006`*^9, 3.702654828986767*^9}, {
   3.7026548813636503`*^9, 3.70265490093046*^9}, {3.702656551897674*^9, 
   3.7026565522405033`*^9}, {3.702660970024069*^9, 3.702661004431554*^9}, {
   3.702661111268489*^9, 3.7026611838034678`*^9}, {3.7026612528233557`*^9, 
   3.70266127757127*^9}, {3.70266130900733*^9, 3.7026613273557*^9}, {
   3.70266140549081*^9, 3.7026614078432903`*^9}, {3.70266145995835*^9, 
   3.70266146399852*^9}, {3.702726367050666*^9, 3.7027263756931677`*^9}, {
   3.7033444973180904`*^9, 3.703344503376297*^9}, {3.7033445648014855`*^9, 
   3.7033445835992775`*^9}, {3.703345160683509*^9, 3.7033451663141155`*^9}, {
   3.703345216247076*^9, 3.703345254000185*^9}, {3.7033453055613375`*^9, 
   3.7033453322704515`*^9}, {3.7033455069148197`*^9, 
   3.7033455352267556`*^9}, {3.7033456283212767`*^9, 
   3.7033456689376497`*^9}, {3.7033458186462755`*^9, 
   3.7033459744766707`*^9}, {3.703346129568878*^9, 3.7033461503802004`*^9}, {
   3.703346254688214*^9, 3.7033462629316206`*^9}, {3.703346369772493*^9, 
   3.703346388754492*^9}, {3.703346489901452*^9, 3.7033464906843596`*^9}, {
   3.703504990815522*^9, 3.703504992862009*^9}, {3.7035187167927237`*^9, 
   3.7035187178586063`*^9}, {3.7035187615575533`*^9, 
   3.7035188042339067`*^9}, {3.7036102873478975`*^9, 
   3.7036102908197927`*^9}, {3.703942295040556*^9, 3.7039423028356504`*^9}, {
   3.7039423344662037`*^9, 3.703942409872303*^9}, {3.7039424855185337`*^9, 
   3.703942797119769*^9}, {3.7039428311486692`*^9, 3.7039428502447453`*^9}, {
   3.703944790038698*^9, 3.7039448321450825`*^9}, {3.7039448933233776`*^9, 
   3.703944970794406*^9}, {3.703945005777646*^9, 3.703945092598867*^9}, {
   3.703945302092024*^9, 3.7039453022170687`*^9}, {3.703945524497073*^9, 
   3.7039455450469*^9}, {3.703954548322132*^9, 3.703954604951898*^9}, {
   3.710129810301406*^9, 3.7101298278201823`*^9}, {3.7101299849463654`*^9, 
   3.710130010204197*^9}, 3.710130501347456*^9, {3.7101332571550727`*^9, 
   3.710133262372559*^9}, 3.7101345429009256`*^9, {3.7101363159632416`*^9, 
   3.710136324663267*^9}, {3.7101370332164*^9, 3.7101370336879807`*^9}, {
   3.710137095705262*^9, 3.710137157813202*^9}, {3.713648376291336*^9, 
   3.713648380871111*^9}, {3.7188289271036415`*^9, 3.718828927477979*^9}, {
   3.7188306392265763`*^9, 3.718830790572982*^9}, {3.718830844134308*^9, 
   3.7188308731081142`*^9}, {3.7188376901765647`*^9, 3.718837728671163*^9}, {
   3.7188377663825254`*^9, 3.7188377951392393`*^9}, {3.718840551277587*^9, 
   3.718840622403604*^9}, {3.7188406808377438`*^9, 3.718840708748925*^9}, {
   3.7188407773660784`*^9, 3.7188409985927615`*^9}, {3.718841117170991*^9, 
   3.718841136782341*^9}, {3.7188415483672705`*^9, 3.718841550530661*^9}, {
   3.7188416325314837`*^9, 3.718841683891843*^9}, {3.7188423762372923`*^9, 
   3.7188423813791904`*^9}, {3.718843792411873*^9, 3.718843792755308*^9}, {
   3.7188440177751904`*^9, 3.7188440847545824`*^9}, {3.7188442218831973`*^9, 
   3.7188443210704317`*^9}, {3.7207987300122995`*^9, 
   3.7207987301998186`*^9}, {3.720801194083495*^9, 3.7208011946460505`*^9}},
 ExpressionUUID -> "e293dcdf-d160-4ce2-8cd4-42e92e4e113d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Switch Year",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.7134522765151215`*^9, 3.7134523005100126`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Calculating the switch year",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7134525069481277`*^9, 3.713452512799042*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yswitch", "=", 
   RowBox[{"NSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "*", 
        RowBox[{"m", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "x"}], ")"}], "*", 
        RowBox[{"m", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "\[Equal]", 
      RowBox[{"m", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"yswitch", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"yswitch", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "set", " ", "mortality", " ", "from", " ", "CBP", " ", "equal", " ", "to", 
    " ", "mortality", " ", "from", " ", "alternative", " ", "to", " ", 
    "solve", " ", "for", " ", "resistance", " ", "where", " ", "we", " ", 
    "need", " ", "to", " ", "switch", " ", "prescription"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.720209468568576*^9, 3.720209474152439*^9}, {
   3.7202095088553944`*^9, 3.72020959459009*^9}, {3.7202096248538246`*^9, 
   3.720209626416975*^9}, 3.7207954697277613`*^9, 3.720800873287058*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Applying the switch year",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7134548988412075`*^9, 3.7134549044894447`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Calculating the switch year",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7141469210484486`*^9, 3.7141469241128535`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2000", ",", "tf"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"switchdata", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"yswitch", ",", 
           RowBox[{"Length", "[", "y", "]"}]}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymin", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"rmbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"rSQbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"rIbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", "0.05"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "where", " ", "to", " ", "put", " ", "the", " ", "x", " ", "axis"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"switch", " ", "years", " ", 
    RowBox[{"(", 
     RowBox[{"year", ",", "resistance"}], ")"}], " ", "coordinates"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ySQ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"rSQbest", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "yswitch"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"switch", " ", "point", " ", "y", " ", "value"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ySQ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ySQ", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xSQpos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"rSQbest", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"ySQ", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xSQpos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xSQpos", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xSQ", "=", 
    RowBox[{"2015", "+", "xSQpos"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"switch", " ", "years", " ", 
    RowBox[{"(", 
     RowBox[{"year", ",", "resistance"}], ")"}], " ", "coordinates"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yI", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{"rIbest", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "yswitch"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yI", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"yI", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xIpos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"rIbest", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"yI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xIpos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xIpos", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xI", "=", 
    RowBox[{"2015", "+", "xIpos"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"plots", " ", "of", " ", "switch", " ", "years", " ", 
    RowBox[{"(", 
     RowBox[{"vertical", " ", "line"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"yearSQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xSQ", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ymin", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xSQ", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"rSQbest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"xSQpos", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
            RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "Thin"}], "}"}]}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "switch", " ", "year", " ", "under", " ", "status", " ", "quo", " ", 
      RowBox[{"(", "plots", ")"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"yearI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xI", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"ymin", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xI", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"rIbest", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"xIpos", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Opacity", "[", "0.7", "]"}], ",", "Thin"}], "}"}]}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"years", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"switch", " ", "year", " ", "under", " ", "intervention", " ", 
     RowBox[{"(", "plots", ")"}]}], "*)"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7134584280589156`*^9, 3.713458766864848*^9}, {
   3.713458807481724*^9, 3.7134588157285123`*^9}, 3.713459280553359*^9, 
   3.7134594926657257`*^9, {3.71345985778963*^9, 3.7134598608429728`*^9}, {
   3.713631764127009*^9, 3.7136317919407253`*^9}, {3.7136318308451767`*^9, 
   3.713631914624951*^9}, {3.713631962504418*^9, 3.713632041110547*^9}, {
   3.7136320723317204`*^9, 3.713632106136525*^9}, {3.7136323189449387`*^9, 
   3.7136323851551075`*^9}, {3.7136329702760115`*^9, 
   3.7136329734341593`*^9}, {3.7136330081759253`*^9, 3.7136333351377907`*^9}, 
   3.713633382126835*^9, {3.7136334475945253`*^9, 3.7136339165083127`*^9}, {
   3.7136339854062247`*^9, 3.713633997800308*^9}, {3.7136340581635714`*^9, 
   3.7136340891697273`*^9}, {3.7136341307507505`*^9, 
   3.7136341771997766`*^9}, {3.71363422417024*^9, 3.713634246860915*^9}, {
   3.71363439414433*^9, 3.7136343942068596`*^9}, {3.7136344634701324`*^9, 
   3.713634494902569*^9}, {3.713645308145779*^9, 3.7136453085020466`*^9}, 
   3.7136453542422223`*^9, {3.713648525408132*^9, 3.7136486110030394`*^9}, {
   3.7141413778983626`*^9, 3.7141413979441977`*^9}, {3.7141414288252096`*^9, 
   3.714141470905487*^9}, {3.7141416152211657`*^9, 3.7141416239699564`*^9}, {
   3.7141417045734463`*^9, 3.7141417198182125`*^9}, {3.714141980321491*^9, 
   3.714142015487296*^9}, {3.714142064498788*^9, 3.7141420645770235`*^9}, {
   3.7141421492226477`*^9, 3.7141421493726635`*^9}, {3.71414222735497*^9, 
   3.7141422475298853`*^9}, {3.7141423211217337`*^9, 
   3.7141423214176517`*^9}, {3.714145624343717*^9, 3.7141456468676205`*^9}, {
   3.7141458008028965`*^9, 3.714145851335739*^9}, {3.71414616021764*^9, 
   3.7141461613731065`*^9}, {3.7141473123918686`*^9, 3.714147497908945*^9}, {
   3.7141475315817833`*^9, 3.7141475323652773`*^9}, {3.714147643678943*^9, 
   3.714147643900504*^9}, {3.7141502517204823`*^9, 3.714150267373786*^9}, {
   3.7202036967021685`*^9, 3.7202037076949034`*^9}, {3.7202037807239456`*^9, 
   3.720203826915698*^9}, {3.720203945271983*^9, 3.7202040272992535`*^9}, {
   3.7202045727805595`*^9, 3.7202045729851*^9}, {3.720204697273621*^9, 
   3.7202047280503826`*^9}, {3.720204985457324*^9, 3.720205011547507*^9}, {
   3.720209633875821*^9, 3.7202096457935324`*^9}, 3.7202098559997363`*^9, {
   3.7207957820602098`*^9, 3.7207958146575255`*^9}, {3.7207958597692804`*^9, 
   3.7207960201404266`*^9}, {3.7207960753391104`*^9, 
   3.7207961007072115`*^9}, {3.7207964795478544`*^9, 
   3.7207964843629093`*^9}, {3.720797248611517*^9, 3.7207972511573825`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"plot", " ", "points", " ", "instead", " ", "of", " ", "lines"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"yearSQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xSQ", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"rSQbest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"xSQpos", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
           "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yearI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xI", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"rIbest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"xIpos", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
           "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7207961813596745`*^9, 3.7207961836567917`*^9}, {
  3.7207962357876577`*^9, 3.72079640484778*^9}, {3.7207964380912943`*^9, 
  3.7207964395289593`*^9}, {3.720797064876004*^9, 3.7207971637584095`*^9}, {
  3.7207972099983315`*^9, 3.7207972465019274`*^9}, {3.720797301438198*^9, 
  3.7207973208648143`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Plots",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.720203926072606*^9, 3.7202039265328293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"switchplots", "=", 
   RowBox[{"Panel", "[", 
    RowBox[{
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"plotSQf", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"plotIf", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"yearSQ", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"yearI", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AxesStyle", "->", 
              RowBox[{"Directive", "[", "14", "]"}]}], ",", 
             RowBox[{"AxesOrigin", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"years", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"ymin", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"plotSQf", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"plotIf", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"yearSQ", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"yearI", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"Axes", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesStyle", "->", 
              RowBox[{"Directive", "[", "14", "]"}]}], ",", 
             RowBox[{"AxesOrigin", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"years", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"ymin", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"plotSQf", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"plotIf", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"yearSQ", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"yearI", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"AxesStyle", "->", 
             RowBox[{"Directive", "[", "14", "]"}]}], ",", 
            RowBox[{"AxesOrigin", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"years", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"ymin", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "}"}]}], "}"}], 
       ",", 
       RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{
      "\"\<Antibiotic Replacement Year Under Various Interventions\>\"", ",", 
       "\"\<Panel\>\"", ",", "24", ",", 
       RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.713454919301251*^9, 3.7134549292970066`*^9}, {
   3.7134549619169188`*^9, 3.713454962709193*^9}, {3.7134582250552216`*^9, 
   3.7134583977945538`*^9}, {3.7134586644929357`*^9, 
   3.7134586653213005`*^9}, {3.713458819650803*^9, 3.71345883819281*^9}, {
   3.713458884225548*^9, 3.7134588980536966`*^9}, {3.7134589948673277`*^9, 
   3.713459106017939*^9}, {3.713460949783657*^9, 3.71346095011191*^9}, {
   3.713461032471781*^9, 3.7134610604594965`*^9}, {3.713461130417637*^9, 
   3.7134611855340433`*^9}, {3.713630714930092*^9, 3.713630719308117*^9}, {
   3.713631469460163*^9, 3.7136315205987883`*^9}, {3.713631586327712*^9, 
   3.7136316467908897`*^9}, {3.7136317017663183`*^9, 3.7136317117114515`*^9}, 
   3.7136317548024936`*^9, {3.713631795652906*^9, 3.7136318079812818`*^9}, {
   3.7136319667886767`*^9, 3.7136319714459505`*^9}, {3.7136322646987057`*^9, 
   3.713632310375107*^9}, {3.7136323923361597`*^9, 3.7136323928518367`*^9}, {
   3.7136325157827682`*^9, 3.7136328267805147`*^9}, {3.7136328677924814`*^9, 
   3.7136329178808217`*^9}, {3.7136333944258823`*^9, 3.713633402178949*^9}, {
   3.7136339220253983`*^9, 3.7136339548332343`*^9}, {3.7136340035571785`*^9, 
   3.713634032508773*^9}, {3.713634107612667*^9, 3.713634110786038*^9}, {
   3.713634185786481*^9, 3.713634221037372*^9}, {3.713634278424631*^9, 
   3.713634365315288*^9}, {3.713634544027397*^9, 3.7136345559089537`*^9}, {
   3.7136453680716763`*^9, 3.7136453842968993`*^9}, {3.7136454831751156`*^9, 
   3.713645503880472*^9}, {3.7136486517822523`*^9, 3.7136486551777296`*^9}, {
   3.7141411847333417`*^9, 3.714141350112115*^9}, {3.7141414948613667`*^9, 
   3.7141415787499285`*^9}, {3.7141416352133055`*^9, 
   3.7141416356929317`*^9}, {3.7141416699574623`*^9, 
   3.7141416723235035`*^9}, {3.714142023222451*^9, 3.714142023390128*^9}, {
   3.7141420697894197`*^9, 3.7141420752097516`*^9}, {3.714142165529324*^9, 
   3.7141421750225573`*^9}, {3.714150105264803*^9, 3.714150106296422*^9}, {
   3.7141501670427837`*^9, 3.71415016726232*^9}, {3.7150881354459453`*^9, 
   3.7150881452155476`*^9}, 3.7202040611914887`*^9, {3.7202045357378225`*^9, 
   3.7202045382415195`*^9}, {3.7202045884774356`*^9, 3.72020466029179*^9}, {
   3.72020492662848*^9, 3.7202049762527914`*^9}, {3.720209663006626*^9, 
   3.7202096693514705`*^9}, 3.720209701400757*^9, {3.720795526640277*^9, 
   3.7207955371248245`*^9}, {3.7207957429627733`*^9, 3.720795743869116*^9}, {
   3.7207991320647564`*^9, 3.7207991546012383`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Respiratory Isolates Total",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7188453758732896`*^9, 3.718845379574012*^9}, {
  3.720203616588756*^9, 3.7202036176595716`*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"resp", "=", 
      RowBox[{"Import", "[", "\"\<resp model.xls\>\"", "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "Years", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"years", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"ti", "=", 
     RowBox[{"years", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"start", " ", "of", " ", "projections"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"tf", "=", "2030"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"end", " ", "of", " ", "projections"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"pyears", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"ti", ",", "tf"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7188453801531887`*^9, 3.718845430013217*^9}, {
  3.718845466151233*^9, 3.7188454714725695`*^9}, {3.7188455110661945`*^9, 
  3.7188456215640535`*^9}, {3.7188456938851833`*^9, 3.718845807614062*^9}, {
  3.7188458515353203`*^9, 3.7188459611390004`*^9}, {3.7188459959942074`*^9, 
  3.7188460297285147`*^9}, {3.7188481244266825`*^9, 3.7188482154069605`*^9}, {
  3.720201522351923*^9, 3.7202015448353343`*^9}, {3.7202017617110806`*^9, 
  3.7202017618695755`*^9}, {3.720795091654133*^9, 3.720795094014281*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"respdistr", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"resp", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "5"}], ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "#", " ", "isolates", " ", "per", " ", "pathogen", " ", "averaged", " ", 
     "over", " ", "last", " ", "2", " ", "years", " ", "of", " ", "data"}], 
    "*)"}], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"MODEL", " ", "FIT"}], "*)"}],
    FontWeight->"Bold"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"respM", "=", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"resp", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"respdistr", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{"Total", "[", "respdistr", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}], " ", "]"}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "total", " ", "resistance", " ", "for", " ", "resp", " ", "isolates", " ",
      "weighted", " ", "by", " ", "#", " ", 
     RowBox[{"isolates", "/", "total"}], " ", "for", " ", "last", " ", "year",
      " ", "available"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"SQ", " ", "PROJECTIONS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"respSQ", "=", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"resp", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"respdistr", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{"Total", "[", "respdistr", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}], " ", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"I", " ", "PROJECTIONS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"respI", "=", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"resp", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"respdistr", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{"Total", "[", "respdistr", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}], " ", "]"}]}], 
    ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7188453801531887`*^9, 3.718845430013217*^9}, {
  3.718845466151233*^9, 3.7188454714725695`*^9}, {3.7188455110661945`*^9, 
  3.7188456215640535`*^9}, {3.7188456938851833`*^9, 3.718845807614062*^9}, {
  3.7188458515353203`*^9, 3.7188459611390004`*^9}, {3.7188459959942074`*^9, 
  3.7188460297285147`*^9}, {3.7188481244266825`*^9, 3.7188482154069605`*^9}, {
  3.720201522351923*^9, 3.720201547878248*^9}, {3.7202016154252224`*^9, 
  3.7202016666083765`*^9}, {3.7202018429038725`*^9, 3.720201845470547*^9}, {
  3.720201900295343*^9, 3.7202019382349195`*^9}, {3.7202019743511906`*^9, 
  3.7202019746137905`*^9}, {3.720203559398692*^9, 3.7202035934691973`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Plots",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7188460661865225`*^9, 3.7188460694481435`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"respD", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"resp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", 
      RowBox[{"Total", "[", 
       RowBox[{"resp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "raw", " ", "data", " ", "totaled", " ", "across", " ", "pathogens"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotrD", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", "respD"}], "}"}]}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Black", ",", " ", 
           RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], "}"}]}], ",", 
       " ", 
       RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", " ", 
       RowBox[{"AxesOrigin", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"years", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
    ";"}], " ", 
   RowBox[{"(*", "DATA", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotrM", "=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", "respM"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "Thick"}], "}"}]}], 
       ",", 
       RowBox[{"AxesStyle", "->", 
        RowBox[{"Directive", "[", "14", "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"years", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
    ";"}], " ", 
   RowBox[{"(*", "MODEL", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotrSQ", "=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"pyears", ",", "respSQ"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "Thick", ",", 
          "Dashed"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "->", 
        RowBox[{"Directive", "[", "14", "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"years", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{"SQ", " ", "PROJECTIONS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotrI", "=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"pyears", ",", "respI"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CMYKColor", "[", 
           RowBox[{"0.83", ",", "0.45", ",", "0.16", ",", "0.24"}], "]"}], 
          ",", "Thick"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "->", 
        RowBox[{"Directive", "[", "14", "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"years", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "]"}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{"I", " ", "PROJECTIONS"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"respplot", "=", 
     RowBox[{"Show", "[", 
      RowBox[{"plotrD", ",", "plotrM", ",", "plotrSQ", ",", "plotrI", ",", 
       RowBox[{"PlotRange", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"years", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "tf"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"respM", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "0.1"}], ",", 
            RowBox[{
             RowBox[{"respSQ", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "+", "0.1"}]}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"years", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"respM", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "0.1"}]}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "14"}], "]"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Resistance Frequency Among Respiratory Isolates\>\"", ",", 
          "Black", ",", " ", "Italic", ",", " ", "16"}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}]}], ";"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7188463311834335`*^9, 3.718846430253338*^9}, {
   3.7188464712070117`*^9, 3.718846597497552*^9}, 3.718846638535694*^9, 
   3.7188466871552362`*^9, {3.718846778254945*^9, 3.7188468585138874`*^9}, {
   3.7188469097552834`*^9, 3.71884711515104*^9}, {3.7188472028513727`*^9, 
   3.7188473706769733`*^9}, {3.718847430907382*^9, 3.718847559846242*^9}, {
   3.718847603430477*^9, 3.7188476962499185`*^9}, 3.7188477355825377`*^9, {
   3.718847817804181*^9, 3.7188478263229575`*^9}, {3.718848139538685*^9, 
   3.7188481396948104`*^9}, {3.7188482343620057`*^9, 
   3.7188482639788456`*^9}, {3.7202017961027613`*^9, 
   3.7202017965101566`*^9}, {3.720202054705079*^9, 3.7202020549141264`*^9}, {
   3.7202022039133816`*^9, 3.720202204022487*^9}, {3.7202034879427233`*^9, 
   3.7202034981173773`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{958, 1108},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
SpellingDictionaries->{"CorrectWords"->{
 "quo", "Formulary", "ntv,", "ey", "intv"}},
Magnification:>0.9 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 153, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[736, 26, 345, 5, 91, "Title"],
Cell[CellGroupData[{
Cell[1106, 35, 179, 3, 61, "Section"],
Cell[CellGroupData[{
Cell[1310, 42, 150, 2, 45, "Subsection"],
Cell[1463, 46, 301, 6, 28, "Text"],
Cell[1767, 54, 1229, 27, 82, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3033, 86, 191, 3, 45, "Subsection"],
Cell[3227, 91, 163, 4, 28, "Text"],
Cell[3393, 97, 13934, 321, 496, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17376, 424, 449, 6, 61, "Section"],
Cell[CellGroupData[{
Cell[17850, 434, 208, 3, 45, "Subsection"],
Cell[18061, 439, 1641, 48, 103, "Text"],
Cell[19705, 489, 6937, 113, 79, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26679, 607, 190, 3, 45, "Subsection"],
Cell[26872, 612, 6156, 110, 82, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33065, 727, 241, 4, 45, "Subsection"],
Cell[33309, 733, 325, 10, 28, "Text"],
Cell[33637, 745, 7281, 166, 316, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40955, 916, 259, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[41239, 924, 145, 2, 35, "Subsubsection"],
Cell[41387, 928, 3925, 92, 226, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45349, 1025, 255, 4, 35, "Subsubsection"],
Cell[45607, 1031, 2398, 63, 172, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48042, 1099, 217, 3, 35, "Subsubsection"],
Cell[48262, 1104, 12464, 263, 514, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60775, 1373, 154, 2, 40, "Subsection"],
Cell[CellGroupData[{
Cell[60954, 1379, 149, 2, 31, "Subsubsection"],
Cell[61106, 1383, 2647, 74, 171, "Input"],
Cell[63756, 1459, 12114, 283, 219, "Input"]
}, Open  ]],
Cell[75885, 1745, 263, 4, 31, "Subsubsection"],
Cell[CellGroupData[{
Cell[76173, 1753, 146, 2, 27, "Subsubsection"],
Cell[76322, 1757, 551, 16, 42, "Text"],
Cell[76876, 1775, 7054, 141, 154, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83967, 1921, 149, 2, 31, "Subsubsection"],
Cell[84119, 1925, 9090, 183, 203, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93246, 2113, 198, 3, 31, "Subsubsection"],
Cell[93447, 2118, 21324, 574, 576, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114808, 2697, 177, 3, 31, "Subsubsection"],
Cell[114988, 2702, 5948, 99, 73, "Input"],
Cell[120939, 2803, 7831, 186, 171, "Input"],
Cell[128773, 2991, 5300, 112, 171, "Input"],
Cell[134076, 3105, 119, 2, 24, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134232, 3112, 145, 2, 31, "Subsubsection"],
Cell[134380, 3116, 5874, 88, 57, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[140315, 3211, 141, 2, 54, "Section"],
Cell[CellGroupData[{
Cell[140481, 3217, 158, 2, 40, "Subsection"],
Cell[140642, 3221, 1303, 35, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141982, 3261, 157, 2, 40, "Subsection"],
Cell[CellGroupData[{
Cell[142164, 3267, 164, 2, 31, "Subsubsection"],
Cell[142331, 3271, 10535, 277, 414, "Input"],
Cell[152869, 3550, 2082, 56, 57, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[155000, 3612, 136, 2, 40, "Subsection"],
Cell[155139, 3616, 5998, 117, 171, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161174, 3738, 230, 4, 40, "Subsection"],
Cell[161407, 3744, 1472, 34, 138, "Input"],
Cell[162882, 3780, 3967, 103, 171, "Input"],
Cell[CellGroupData[{
Cell[166874, 3887, 163, 3, 31, "Subsubsection"],
Cell[167040, 3892, 6047, 157, 138, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

