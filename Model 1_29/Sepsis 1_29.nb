(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    149216,       3490]
NotebookOptionsPosition[    145940,       3378]
NotebookOutlinePosition[    146493,       3398]
CellTagsIndexPosition[    146450,       3395]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["sepsis",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.7005872688200474`*^9, 3.700587274570282*^9}, {
  3.7188410276281157`*^9, 3.718841040872573*^9}, {3.7201979535797777`*^9, 
  3.720197955570175*^9}, {3.7262448051022034`*^9, 3.726244806784498*^9}, {
  3.7262498341078825`*^9, 3.7262498381451793`*^9}, {3.7262594797109284`*^9, 
  3.726259480233915*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["data",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.700586955166306*^9, 3.700586956688905*^9}, {
  3.700586999864338*^9, 3.700586999895615*^9}, {3.7262451865021553`*^9, 
  3.7262451868064556`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["preparing directory",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7005868421634493`*^9, 3.700586844493045*^9}, {
  3.7262451878092437`*^9, 3.726245189656511*^9}, {3.7262513662786016`*^9, 
  3.7262513663107185`*^9}}],

Cell["\<\
Clear all variables. Set directory and change setting such that when it \
closes it closes all outputs.\
\>", "Text",
 CellChangeTimes->{{3.6864016594282627`*^9, 3.6864016983437967`*^9}, {
  3.6864017385595016`*^9, 3.6864017467278137`*^9}, {3.7005783616134434`*^9, 
  3.700578363379423*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "Code",
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["SetDirectory", "Code"], 
   StyleBox["[", "Code"], 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  StyleBox[";", "Code"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"NotebookEventActions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
        RowBox[{"FrontEndExecute", "[", 
         RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
         "]"}]}], "}"}]}]}], "]"}], ";"}], "Code"]}], "Input",
 CellChangeTimes->{{3.686401706812792*^9, 3.6864017521197643`*^9}, 
   3.686403149219241*^9, {3.686504717864292*^9, 3.686504722791524*^9}, {
   3.700578365301522*^9, 3.7005783714796133`*^9}, {3.7005784918705196`*^9, 
   3.7005784924955854`*^9}, 3.718035742047043*^9, {3.718841224288909*^9, 
   3.718841230958413*^9}, {3.718841355222883*^9, 3.7188414238070726`*^9}, {
   3.718841461764323*^9, 3.7188414909630756`*^9}},
 ExpressionUUID -> "947cde04-da7c-4abf-a430-eb3841611396"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["load data",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.700586818794753*^9, 3.7005868197322516`*^9}, {
  3.7005873521608763`*^9, 3.700587352176503*^9}, {3.7262451924114122`*^9, 
  3.726245193818562*^9}}],

Cell["\<\
Reading country data on consumption and resistance and assigning them to \
appropriate variables.\
\>", "Text",
 CellChangeTimes->{3.686400603032765*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<AMR_Datasheet.xlsx\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Data\>\"", ",", "\"\<Sepsis_model\>\""}], "}"}]}], 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"import", " ", "data"}], "*)"}]}], "Code"], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], "Code"], 
  StyleBox[" ", "Code"], "\n", "\n", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "data", " ", "for", " ", "model", " ", "fit", " ", "and", " ", 
     "projections"}], "*)"}], "Code"]}], "\n", 
 RowBox[{
  RowBox[{
   StyleBox["dataM", "Code"], 
   StyleBox["=", "Code"], 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "16"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"years", " ", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"years", " ", "of", " ", "available", " ", "data"}], "*)"}]}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"tt", " ", "=", " ", 
     RowBox[{"Length", "[", "years", "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"#", " ", "years", " ", "of", " ", "available", " ", "data"}], 
    "*)"}]}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"nop", " ", "=", " ", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"dataM", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"#", " ", "of", " ", "pathogens"}], "*)"}]}], "Code"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"isolates", " ", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", 
        RowBox[{
         RowBox[{"2", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
    ";"}], " "}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"resistance", " ", "=", " ", 
    RowBox[{"dataM", "[", 
     RowBox[{"[", 
      RowBox[{"3", ";;", 
       RowBox[{
        RowBox[{"2", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
   ";"}], "Code"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["rfreq", "Code"], 
    StyleBox[" ", "Code"], 
    StyleBox["=", "Code"], 
    RowBox[{"resistance", "/", "isolates"}]}], ";"}], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"resistance", " ", "frequency"}], "*)"}], 
   "Code"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathogens", "=", 
    RowBox[{
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", "*", "nop"}], "+", "3"}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "nop"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"pathogen", " ", "headers"}], "*)"}]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"carbcons", " ", "=", "  ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", "*", "nop"}], "+", "4"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CBP", " ", "consumption", " ", 
      RowBox[{"(", "DDDs", ")"}]}], ":", " ", "total"}], "*)"}]}], 
  "Code"], "\n", 
 RowBox[{
  RowBox[{
   StyleBox["inapp", "Code"], 
   StyleBox[" ", "Code"], 
   StyleBox["=", "Code"], 
   StyleBox[" ", "Code"], 
   RowBox[{
    RowBox[{
     StyleBox["dataM", "Code"], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", "*", "nop"}], "+", "6"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"conbreak", " ", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "nop"}], "+", "7"}], ";;", 
        RowBox[{
         RowBox[{"3", "*", "nop"}], "+", "6"}]}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "breakdown", " ", "of", " ", "disease", " ", "by", " ", "pathogen"}], 
    "*)"}]}], "Code"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpp", "=", " ", 
    RowBox[{"dataM", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", "*", "nop"}], "+", "5"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "CBP", " ", "prescribed", " ", "to", " ", "that", " ", "diagnosis"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"cbp", " ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"cbpp", "*", "inapp", "*", "carbcons", "*", 
       RowBox[{"conbreak", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbp", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], "\n", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"CBP", " ", 
     RowBox[{"consumption", ":", " ", 
      RowBox[{"by", " ", "indication", " ", "and", " ", "pathogen"}]}]}], 
    "*)"}], "Code"], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "data", " ", "for", " ", "economic", " ", "and", " ", "health", " ", 
    "outcomes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataE", "=", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"17", ";;"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stw", " ", "=", " ", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"reduction", " ", "in", " ", "inappropriate", " ", "therapy"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mR", "=", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "mortality", " ", "with", " ", "CBPS", " ", "of", " ", "resistant"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mS", "=", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "mortality", " ", "with", " ", "CBPS", " ", "of", " ", "susceptible"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mA", "=", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"mortality", " ", "with", " ", "alternatives"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686422034696558*^9, 3.6864220688839083`*^9}, {
   3.686422244390477*^9, 3.686422257854924*^9}, {3.6864223170828114`*^9, 
   3.6864223431908817`*^9}, 3.6864948657783527`*^9, {3.686495706144705*^9, 
   3.686495706998027*^9}, {3.686497157777652*^9, 3.686497176663332*^9}, {
   3.686500722352275*^9, 3.6865007839598494`*^9}, {3.6865008234158993`*^9, 
   3.686500860558977*^9}, {3.686500895439396*^9, 3.6865009047916603`*^9}, {
   3.686501132914021*^9, 3.6865011961896877`*^9}, {3.686502039475134*^9, 
   3.686502053471085*^9}, 3.686504820987131*^9, {3.686504927512206*^9, 
   3.68650493323075*^9}, {3.686505663500307*^9, 3.686505834942637*^9}, {
   3.686506221505989*^9, 3.686506233253963*^9}, 3.6865062638755836`*^9, {
   3.686506304950383*^9, 3.6865063857051888`*^9}, {3.686506464729933*^9, 
   3.686506570268374*^9}, {3.686507885056096*^9, 3.686507925091408*^9}, 
   3.68650806648864*^9, {3.686508132562462*^9, 3.686508159468111*^9}, {
   3.6865082387863083`*^9, 3.686508289413818*^9}, {3.686593508533208*^9, 
   3.686593578249978*^9}, {3.686670822461113*^9, 3.686670846265149*^9}, 
   3.686671020176771*^9, {3.686671058093039*^9, 3.686671058348937*^9}, {
   3.686671195039489*^9, 3.686671197287084*^9}, {3.686672205273057*^9, 
   3.686672265615234*^9}, {3.686672313935074*^9, 3.686672315030695*^9}, {
   3.690514968752684*^9, 3.6905149711878157`*^9}, {3.6905151605791454`*^9, 
   3.6905151977141056`*^9}, {3.6905490426059213`*^9, 
   3.6905490710575967`*^9}, {3.6905491666256824`*^9, 3.69054916762508*^9}, {
   3.690560008801766*^9, 3.690560021440817*^9}, {3.693235488416274*^9, 
   3.693235488880404*^9}, {3.693237503430167*^9, 3.693237504912262*^9}, {
   3.693242514519369*^9, 3.693242533218896*^9}, {3.69324278229449*^9, 
   3.6932427827305317`*^9}, {3.69324331082885*^9, 3.693243311380581*^9}, {
   3.694794944107407*^9, 3.6947949456275787`*^9}, 3.694869444462384*^9, {
   3.69486947773489*^9, 3.6948694780468807`*^9}, {3.696613845884832*^9, 
   3.69661384630057*^9}, 3.6966142251356783`*^9, {3.696614267163052*^9, 
   3.696614268931164*^9}, {3.696614336734581*^9, 3.69661436742657*^9}, {
   3.6966143989830647`*^9, 3.6966144011982822`*^9}, {3.696614476914295*^9, 
   3.696614477617947*^9}, {3.696614523998536*^9, 3.696614524365843*^9}, {
   3.6966149875383883`*^9, 3.69661502321297*^9}, {3.696615101388283*^9, 
   3.69661512177125*^9}, {3.6966152518805857`*^9, 3.696615261003038*^9}, {
   3.696615389139082*^9, 3.696615395235524*^9}, {3.696615597886518*^9, 
   3.696615598926401*^9}, {3.696615815221848*^9, 3.696615816637291*^9}, {
   3.696616322068841*^9, 3.696616323151634*^9}, {3.6968731019011183`*^9, 
   3.696873102132331*^9}, {3.696873474263825*^9, 3.696873474894909*^9}, {
   3.696873750270289*^9, 3.6968737506538773`*^9}, {3.696952191029182*^9, 
   3.696952192165349*^9}, {3.6969525040529337`*^9, 3.69695250910539*^9}, {
   3.696952959626371*^9, 3.696952960785913*^9}, {3.696954591424856*^9, 
   3.696954592264494*^9}, {3.69695474259662*^9, 3.696954751834024*^9}, {
   3.696954829844029*^9, 3.696954858941578*^9}, {3.696959711253429*^9, 
   3.6969597124892597`*^9}, {3.696960225982828*^9, 3.696960229688342*^9}, {
   3.6974636430928164`*^9, 3.69746364475207*^9}, 3.6974636990330257`*^9, {
   3.69746572261734*^9, 3.6974657303934927`*^9}, {3.697466319707209*^9, 
   3.6974663208109493`*^9}, {3.699979819323583*^9, 3.699979824749195*^9}, {
   3.6999798994047337`*^9, 3.699979971399865*^9}, 3.700577857699892*^9, {
   3.700580301187483*^9, 3.7005803061567545`*^9}, {3.700580352344078*^9, 
   3.7005804332667875`*^9}, {3.700587356480831*^9, 3.7005873808606195`*^9}, {
   3.7014286067933145`*^9, 3.701428607337329*^9}, {3.701537183106104*^9, 
   3.7015371983584056`*^9}, {3.701537245629196*^9, 3.701537248154693*^9}, {
   3.7033434311097727`*^9, 3.703343437835854*^9}, {3.703505176641322*^9, 
   3.7035051788060784`*^9}, {3.703505326064638*^9, 3.7035053362004156`*^9}, {
   3.7035053790724077`*^9, 3.70350549006406*^9}, {3.703519398604677*^9, 
   3.703519432043036*^9}, {3.703519484955608*^9, 3.7035194851477613`*^9}, {
   3.7036029675366874`*^9, 3.7036029699555335`*^9}, {3.7041953951420145`*^9, 
   3.704195436240984*^9}, {3.7041954683610396`*^9, 3.7041955278418465`*^9}, {
   3.7041955732057734`*^9, 3.704195573330967*^9}, {3.704195640102418*^9, 
   3.7041956401959877`*^9}, 3.704195724703086*^9, {3.704195764869725*^9, 
   3.7041957937993608`*^9}, {3.704196032654626*^9, 3.704196036186615*^9}, {
   3.704196293670497*^9, 3.7041963168059745`*^9}, 3.7181247286556635`*^9, {
   3.7185479302107954`*^9, 3.718547930636095*^9}, {3.718726023153342*^9, 
   3.7187261228702497`*^9}, {3.718726179293728*^9, 3.718726184661331*^9}, {
   3.7187262163678045`*^9, 3.7187262167273273`*^9}, {3.7187292301088905`*^9, 
   3.718729231954373*^9}, 3.7187295838901253`*^9, {3.718730125091565*^9, 
   3.718730132625313*^9}, {3.7187304258212843`*^9, 3.7187304259463053`*^9}, {
   3.71873062095632*^9, 3.7187307197747135`*^9}, {3.7187308396265497`*^9, 
   3.7187308413967557`*^9}, {3.718730914974766*^9, 3.7187309183377433`*^9}, {
   3.7187309514840517`*^9, 3.7187309537718887`*^9}, {3.7187310113847795`*^9, 
   3.7187311372892237`*^9}, {3.7188268942806444`*^9, 3.718826895218213*^9}, {
   3.7188273209485097`*^9, 3.7188273215198584`*^9}, {3.718827355753003*^9, 
   3.7188274138674693`*^9}, {3.7188285615747223`*^9, 3.718828561715214*^9}, {
   3.718837931353737*^9, 3.7188379318905697`*^9}, {3.7201979700775166`*^9, 
   3.7201980014920006`*^9}, {3.7201986686680145`*^9, 3.720198698529197*^9}, {
   3.720198863811266*^9, 3.720198869435609*^9}, {3.720199355762143*^9, 
   3.7201993659002624`*^9}, {3.7202029908373814`*^9, 3.720202992526834*^9}, {
   3.720203264912648*^9, 3.720203285482752*^9}, {3.7207974836146517`*^9, 
   3.7207974888040757`*^9}, {3.7207975516245885`*^9, 3.720797563722108*^9}, {
   3.720797862144657*^9, 3.720797870097934*^9}, {3.72079800291986*^9, 
   3.720798011375171*^9}, {3.7207980594992423`*^9, 3.7207980884771147`*^9}, {
   3.7207982991987953`*^9, 3.720798356873657*^9}, {3.7207996202987976`*^9, 
   3.7207996257442436`*^9}, {3.720799724310115*^9, 3.72079974886286*^9}, {
   3.720799871614236*^9, 3.720799902106693*^9}, {3.720800123322297*^9, 
   3.720800159727727*^9}, {3.7219976120736094`*^9, 3.7219976156271057`*^9}, {
   3.7219976631063395`*^9, 3.7219976766698575`*^9}, {3.7220087470653563`*^9, 
   3.722008750879076*^9}, {3.722527593920542*^9, 3.7225275951387806`*^9}, 
   3.7241984244499283`*^9, {3.7241985029776044`*^9, 3.7241985177309012`*^9}, {
   3.725124664544177*^9, 3.7251246711886854`*^9}, {3.7251248399255843`*^9, 
   3.7251248403057213`*^9}, {3.725127092315174*^9, 3.7251270929182825`*^9}, {
   3.7256386432025948`*^9, 3.72563870850587*^9}, {3.726237653664692*^9, 
   3.726237674402959*^9}, {3.7262513741871357`*^9, 3.7262513769149113`*^9}, {
   3.726259502022908*^9, 3.7262595025755997`*^9}},
 ExpressionUUID -> "163af784-7490-4e8e-95c8-284f538d9d5f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model fit", "Section",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.686400307952888*^9, 3.6864004084403467`*^9}, {
   3.686400489920883*^9, 3.686400491960532*^9}, 3.7005870090415688`*^9, 
   3.701429412245363*^9, {3.7035194899587927`*^9, 3.703519491726164*^9}, {
   3.7035241365553827`*^9, 3.7035241365731897`*^9}, {3.703602876186926*^9, 
   3.7036028769526424`*^9}, {3.7040410783324747`*^9, 
   3.7040410788569627`*^9}, {3.726244886554697*^9, 3.7262448868627825`*^9}, {
   3.7262451972084165`*^9, 3.7262451992147317`*^9}, {3.726245457292791*^9, 
   3.726245457348791*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model structure & likelihood function",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.700586719444282*^9, 3.700586729715373*^9}, {
  3.700586791459395*^9, 3.7005867927406187`*^9}, {3.726245200986512*^9, 
  3.726245213975565*^9}}],

Cell[TextData[{
 StyleBox["r(t)", "Text",
  FontWeight->"Bold"],
 StyleBox[" = frequency of resistance\n", "Text"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "s"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the sensitive strain\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "r"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the resistance strain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["k", "r"]}], TraditionalForm]]],
 " < ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "s"], ")"}], TraditionalForm]]],
 "\n",
 StyleBox["\[Theta]",
  FontWeight->"Bold"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["k", "r"], "-", 
     SubscriptBox["k", "s"]}], "<", " ", "0"}], TraditionalForm]]],
 " \n",
 StyleBox["a =",
  FontWeight->"Bold"],
 " CBP consumption (DDD)"
}], "Text",
 CellChangeTimes->{{3.686400499649311*^9, 3.68640052600694*^9}, {
   3.6864005718225193`*^9, 3.686400575021463*^9}, {3.68736386207417*^9, 
   3.687363862074381*^9}, 3.6905491725333633`*^9, {3.690722553178647*^9, 
   3.69072257128833*^9}, {3.690722611632101*^9, 3.6907226192004843`*^9}, 
   3.696614487562492*^9, {3.696954774986088*^9, 3.696954776429123*^9}, {
   3.699978618851925*^9, 3.69997862542444*^9}, {3.700578555451971*^9, 
   3.700578559628787*^9}, {3.700578612001893*^9, 3.700578612705063*^9}, {
   3.7005806236313753`*^9, 3.700580635401388*^9}, {3.7005806769712067`*^9, 
   3.7005809518298016`*^9}, {3.7005811924601393`*^9, 
   3.7005812164615297`*^9}, {3.702216322838592*^9, 3.702216326755948*^9}, 
   3.726244853438151*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"r", "[", 
      RowBox[{"t_", ",", "r0_", ",", "ks_"}], "]"}],
     FontWeight->"Plain"], 
    StyleBox[":=",
     FontWeight->"Plain"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ks", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"t", "+", "1"}], "]"}], "]"}], "/", "2"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "/", "2"}], ")"}]}], ")"}]}], 
         "+", "\[Theta]"}], ")"}]], " "}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ks", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"t", "+", "1"}], "]"}], "]"}], "/", "2"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "/", "2"}], ")"}]}], ")"}]}], 
         "+", "\[Theta]"}], ")"}]], " "}]]}], ";"}], " ", 
  RowBox[{"(*", "Model", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"Lik", "[", 
      RowBox[{"r0_", ",", "ks_"}], "]"}],
     FontWeight->"Plain"], 
    StyleBox[":=",
     FontWeight->"Plain"], 
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "[", 
           RowBox[{"j", ",", "r0", ",", "ks"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "[", 
            RowBox[{"j", ",", "r0", ",", "ks"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"Likelihood", " ", "function"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.683030762976203*^9, 3.6830307646226077`*^9}, {
   3.683030892090124*^9, 3.6830309083188725`*^9}, {3.6830309721242533`*^9, 
   3.683030993984562*^9}, {3.6830311371186757`*^9, 3.6830311451555557`*^9}, {
   3.683031934623186*^9, 3.6830319364931593`*^9}, {3.683032013522828*^9, 
   3.683032065758599*^9}, {3.6830346542453313`*^9, 3.68303465754213*^9}, {
   3.6830363241484847`*^9, 3.683036329938362*^9}, {3.6830365276454496`*^9, 
   3.683036530676465*^9}, 3.6830367497782087`*^9, {3.683041381379426*^9, 
   3.683041393024686*^9}, {3.6830421349464197`*^9, 3.683042139599684*^9}, {
   3.6830447788287015`*^9, 3.683044779606695*^9}, {3.683045184458967*^9, 
   3.6830452004752617`*^9}, {3.6852083241401463`*^9, 3.685208331594561*^9}, {
   3.685208507957798*^9, 3.685208565997737*^9}, 3.6852094721246767`*^9, {
   3.685209903141817*^9, 3.6852099398500347`*^9}, {3.6852099889580927`*^9, 
   3.685210058891021*^9}, {3.6852103080680428`*^9, 3.685210309237547*^9}, {
   3.685210371854425*^9, 3.685210380461464*^9}, {3.685210428797523*^9, 
   3.6852105257382507`*^9}, {3.6852105754249763`*^9, 3.6852105928533*^9}, {
   3.6852107253971167`*^9, 3.685210739728479*^9}, {3.685211129911818*^9, 
   3.685211139176404*^9}, {3.68521175723141*^9, 3.6852117935313168`*^9}, {
   3.6852123574632883`*^9, 3.685212368014336*^9}, {3.685279366491384*^9, 
   3.685279382363071*^9}, {3.685279416295306*^9, 3.685279429839871*^9}, 
   3.6852808275142384`*^9, {3.6853860677425203`*^9, 3.6853861678062687`*^9}, {
   3.685386259499681*^9, 3.685386260403224*^9}, {3.685881879376438*^9, 
   3.68588188788455*^9}, {3.685882144512109*^9, 3.685882211247509*^9}, {
   3.685882264975534*^9, 3.6858823048645563`*^9}, {3.6863259609700985`*^9, 
   3.68632602143394*^9}, {3.6863261123987613`*^9, 3.6863261127132187`*^9}, {
   3.6863261459947433`*^9, 3.686326158772418*^9}, {3.6863300988135977`*^9, 
   3.6863301392487526`*^9}, {3.6863301968103313`*^9, 
   3.6863302455048313`*^9}, {3.686330295179199*^9, 3.686330312060356*^9}, {
   3.6863310425150905`*^9, 3.686331077920039*^9}, {3.6863311592705336`*^9, 
   3.686331161351984*^9}, {3.686331196844039*^9, 3.6863312002829003`*^9}, {
   3.6863316074494753`*^9, 3.68633161191486*^9}, {3.6863316677333975`*^9, 
   3.6863316752266045`*^9}, {3.686331756685466*^9, 3.6863317652227015`*^9}, {
   3.6863318579611225`*^9, 3.6863318604224625`*^9}, {3.6863320284264183`*^9, 
   3.6863320896920385`*^9}, {3.6863333970093203`*^9, 3.686333468722809*^9}, {
   3.686333527818489*^9, 3.686333530257064*^9}, {3.686333585882146*^9, 
   3.6863335937595434`*^9}, {3.6863337944358063`*^9, 
   3.6863338012252955`*^9}, {3.686333860129887*^9, 3.686333926127783*^9}, {
   3.686334541041381*^9, 3.6863345432302294`*^9}, {3.6863346050474234`*^9, 
   3.6863346194036174`*^9}, {3.6863350339422607`*^9, 
   3.6863350402439137`*^9}, {3.686396824312439*^9, 3.686396830206884*^9}, {
   3.68639728852584*^9, 3.686397385676342*^9}, {3.6863974219206467`*^9, 
   3.686397591467824*^9}, {3.6863977467434483`*^9, 3.686397856243059*^9}, {
   3.6863979037596188`*^9, 3.686398009617909*^9}, {3.686398049831843*^9, 
   3.686398058770108*^9}, {3.68639915087844*^9, 3.686399168049336*^9}, {
   3.686399538546379*^9, 3.686399540314131*^9}, 3.6864005110851316`*^9, 
   3.686400581816401*^9, {3.6864006197723083`*^9, 3.686400620244726*^9}, {
   3.686401869966902*^9, 3.686401900676633*^9}, {3.6864032479875317`*^9, 
   3.6864032930076036`*^9}, {3.6864112529344683`*^9, 3.686411262755252*^9}, {
   3.6864112967508183`*^9, 3.686411330746829*^9}, {3.686412024717753*^9, 
   3.686412049333313*^9}, 3.6864123304368677`*^9, {3.686412473817891*^9, 
   3.686412485495213*^9}, {3.686412529906288*^9, 3.686412535342702*^9}, 
   3.686413143077464*^9, {3.686413922349515*^9, 3.6864139332766542`*^9}, {
   3.686414054550778*^9, 3.68641405601223*^9}, {3.686414101545352*^9, 
   3.686414169219296*^9}, {3.6864142432310667`*^9, 3.686414273315958*^9}, {
   3.686414369325341*^9, 3.686414388826579*^9}, {3.6864144199682903`*^9, 
   3.686414447742525*^9}, {3.686414613494096*^9, 3.686414779850452*^9}, {
   3.686414811798102*^9, 3.686414906928382*^9}, {3.686415062398457*^9, 
   3.686415134968748*^9}, {3.686415560254722*^9, 3.686415665538151*^9}, {
   3.686418321121459*^9, 3.686418334972437*^9}, {3.686508624478046*^9, 
   3.686508632277608*^9}, 3.68650871497578*^9, {3.6866710450891523`*^9, 
   3.686671051229025*^9}, {3.6866716077238398`*^9, 3.6866716968985*^9}, {
   3.686671727131069*^9, 3.6866717297824497`*^9}, {3.686672280091339*^9, 
   3.68667229406674*^9}, {3.6869386960631742`*^9, 3.686938708012053*^9}, {
   3.690514877200051*^9, 3.6905148892161407`*^9}, {3.690721514268401*^9, 
   3.690721571699773*^9}, 3.696616035925852*^9, {3.6975661826500597`*^9, 
   3.6975661924568453`*^9}, {3.697566564484868*^9, 3.697566577524445*^9}, {
   3.69997860542073*^9, 3.699978631025688*^9}, {3.699978671234418*^9, 
   3.699978743381155*^9}, 3.6999787843122373`*^9, {3.6999788740181875`*^9, 
   3.699978892479066*^9}, {3.699978953924489*^9, 3.699978998636625*^9}, {
   3.699979481328476*^9, 3.699979524287679*^9}, {3.6999797618961906`*^9, 
   3.6999797636369605`*^9}, {3.700577837888285*^9, 3.7005778452831726`*^9}, {
   3.700577896592633*^9, 3.700577898123874*^9}, {3.700577982561618*^9, 
   3.7005779859363604`*^9}, 3.700580714849549*^9, {3.700580866866892*^9, 
   3.7005808755221605`*^9}, {3.7005809652484455`*^9, 3.700581054510634*^9}, {
   3.700581143420582*^9, 3.700581158726591*^9}, {3.7005812221988354`*^9, 
   3.700581224699131*^9}, {3.7005813900782413`*^9, 3.7005814812173157`*^9}, 
   3.700581594578314*^9, {3.7005817018893595`*^9, 3.7005817331728625`*^9}, {
   3.70058236481491*^9, 3.7005823685675287`*^9}, {3.7005824573051863`*^9, 
   3.7005824598974485`*^9}, {3.7005825333408175`*^9, 3.700582536338009*^9}, {
   3.7016103449359617`*^9, 3.701610389366672*^9}, {3.7214141660949025`*^9, 
   3.7214141671576414`*^9}, {3.721490354595252*^9, 3.721490375661333*^9}, {
   3.721490496246007*^9, 3.7214905118583574`*^9}, 3.7214907116385136`*^9, 
   3.721995023313809*^9, {3.721995780039253*^9, 3.721995828639323*^9}, {
   3.7219958706953983`*^9, 3.7219958976230364`*^9}, {3.7219964360706077`*^9, 
   3.721996442409454*^9}, {3.7219966635005045`*^9, 3.7219966650196266`*^9}, {
   3.7219986137927465`*^9, 3.721998617694166*^9}, {3.72199864820356*^9, 
   3.721998648641725*^9}, {3.722010099376684*^9, 3.722010102827274*^9}, {
   3.7225277846939898`*^9, 3.7225277882824926`*^9}, {3.7225278480253625`*^9, 
   3.7225278530705767`*^9}, {3.722528611803776*^9, 3.7225286143534937`*^9}, {
   3.7225521994595213`*^9, 3.7225522070867414`*^9}, {3.7225650553036375`*^9, 
   3.722565072887498*^9}, {3.7227907951757555`*^9, 3.7227907989723015`*^9}, {
   3.7227917950912704`*^9, 3.7227917978878403`*^9}, {3.722792061744688*^9, 
   3.722792064080303*^9}, {3.724191522359974*^9, 3.7241915246905336`*^9}, {
   3.725127239296571*^9, 3.7251272485545874`*^9}, {3.7262448145402937`*^9, 
   3.726244814683119*^9}, {3.726244914452033*^9, 3.726244945870349*^9}, 
   3.726259546377276*^9},
 ExpressionUUID -> "ebe5f114-8fd3-4fd7-94a0-8f75b8068d13"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model fitting",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.700586762450125*^9, 3.70058676485663*^9}, {
   3.700587072272579*^9, 3.7005870740416794`*^9}, 3.714151770237274*^9, 
   3.718730005614851*^9, {3.7262452165031266`*^9, 3.7262452181822786`*^9}}],

Cell[TextData[{
 "Fit ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["r", "0"], " ", "and", " ", 
    SubscriptBox["k", "s"], " "}], TraditionalForm]]],
 "using a binomial maximum likelihood function. Fix \[Theta] based on \
literature. "
}], "Text",
 CellChangeTimes->{{3.703505727447111*^9, 3.7035057866848*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "=", 
    RowBox[{"-", "0.02"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Di", " ", "Luca"}], ",", " ", "2017"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", "max"}], ";", " ", 
  RowBox[{"fks", "=", "max"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Bold"], 
       StyleBox[" ",
        FontWeight->"Bold"], 
       StyleBox["=",
        FontWeight->"Bold"], 
       StyleBox[" ",
        FontWeight->"Bold"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      StyleBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"max", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], "=", 
        RowBox[{"NMaximize", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lik", "[", 
             RowBox[{"r0", ",", "ks"}], "]"}], ",", 
            RowBox[{"0.", "<", "r0", "<", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r0", ",", "ks"}], "}"}], ",", " ", 
          RowBox[{"MaxIterations", "\[Rule]", "100000"}]}], "]"}]}],
       FontWeight->"Bold"]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fr0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fks", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fks", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"create", " ", "table", " ", "of", " ", "fitted", " ", "values"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "max", "}"}], ",", 
     RowBox[{"{", "fr0", "}"}], ",", 
     RowBox[{"{", "fks", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings1", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"params", ",", "pathogens"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings2", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Prepend", ",", 
     RowBox[{"{", 
      RowBox[{"headings1", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\>\"", ",", "\"\<Likelihood\>\"", ",", "\"\<r0\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(k\), \(s\)]\)\>\""}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Grid", "[", 
   RowBox[{"headings2", ",", 
    RowBox[{"Frame", "\[Rule]", " ", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.699979080700176*^9, 3.6999791285198135`*^9}, {
   3.6999795459289694`*^9, 3.6999795782642183`*^9}, {3.6999797469333143`*^9, 
   3.699979792164003*^9}, {3.699980655896045*^9, 3.6999807052383485`*^9}, {
   3.6999807386234922`*^9, 3.699980791359419*^9}, {3.6999808520183363`*^9, 
   3.699980857908617*^9}, {3.699980894395363*^9, 3.699980901995653*^9}, {
   3.699981214894743*^9, 3.699981244798695*^9}, {3.7005780580515375`*^9, 
   3.700578062092603*^9}, {3.7005811797204523`*^9, 3.700581187269937*^9}, {
   3.700581229488211*^9, 3.7005812726645036`*^9}, {3.7005813389896755`*^9, 
   3.7005813408419547`*^9}, {3.7005818466872196`*^9, 
   3.7005819987739115`*^9}, {3.7005822013314333`*^9, 3.700582287313163*^9}, {
   3.7005823546895723`*^9, 3.7005823990303335`*^9}, {3.7005825108149376`*^9, 
   3.7005825468018093`*^9}, {3.700583346136323*^9, 3.7005834001190147`*^9}, {
   3.700583431757659*^9, 3.7005834793698597`*^9}, {3.7005835118331184`*^9, 
   3.700583587628395*^9}, {3.700583644416862*^9, 3.700583645662918*^9}, {
   3.7005837321566935`*^9, 3.7005838421663465`*^9}, {3.7005838770509467`*^9, 
   3.7005840265769577`*^9}, {3.700584078823574*^9, 3.7005842033909864`*^9}, {
   3.700584239397745*^9, 3.7005842672882395`*^9}, {3.7005842975217457`*^9, 
   3.700584414314398*^9}, {3.700584769347272*^9, 3.700584770128607*^9}, {
   3.7005856949027915`*^9, 3.70058570076023*^9}, {3.7005870940906606`*^9, 
   3.7005870972436595`*^9}, {3.701427719951297*^9, 3.701427720217131*^9}, {
   3.701427761473959*^9, 3.701427803824013*^9}, {3.7014293722024174`*^9, 
   3.701429376227524*^9}, {3.7014295432311172`*^9, 3.701429543485509*^9}, {
   3.701429591451513*^9, 3.7014297070606256`*^9}, {3.701429910967057*^9, 
   3.7014299112260013`*^9}, {3.7015350613559856`*^9, 
   3.7015350624100776`*^9}, {3.7015351181957607`*^9, 
   3.7015351265069523`*^9}, {3.7033435416495123`*^9, 3.7033435444982157`*^9}, 
   3.703344913956914*^9, {3.703505648855173*^9, 3.703505692219559*^9}, {
   3.7035058029294133`*^9, 3.703505860689376*^9}, {3.703506296099897*^9, 
   3.7035063002073135`*^9}, {3.703524147348421*^9, 3.70352414930751*^9}, {
   3.7035248323526907`*^9, 3.7035248342670765`*^9}, 3.7035248733335547`*^9, 
   3.7035249640151196`*^9, {3.7036038737836237`*^9, 3.703603875319255*^9}, {
   3.7036086530928545`*^9, 3.7036086544593906`*^9}, {3.7036087014543476`*^9, 
   3.703608704175104*^9}, {3.703610055503646*^9, 3.7036100556286716`*^9}, {
   3.703610115648935*^9, 3.703610117549713*^9}, {3.703610158594226*^9, 
   3.7036101616058965`*^9}, {3.7036102451512833`*^9, 3.703610245401309*^9}, {
   3.7036103163292437`*^9, 3.703610316500459*^9}, {3.7036104516970577`*^9, 
   3.7036104521603866`*^9}, 3.7039414065616455`*^9, {3.7039429291565056`*^9, 
   3.703942929898025*^9}, {3.7039454848217554`*^9, 3.7039454852126107`*^9}, {
   3.7039456432733736`*^9, 3.70394564503203*^9}, {3.703945687429302*^9, 
   3.7039456888089523`*^9}, {3.7041981783075266`*^9, 3.704198179229902*^9}, {
   3.7041984388929377`*^9, 3.704198440629492*^9}, {3.7132798103674827`*^9, 
   3.7132798109456377`*^9}, {3.7132798812323017`*^9, 3.713279881404348*^9}, 
   3.718828326221363*^9, {3.7188285252355976`*^9, 3.7188285315739574`*^9}, {
   3.720809322919801*^9, 3.7208093327359*^9}, {3.7208094153444123`*^9, 
   3.7208094226708913`*^9}, {3.7208095203857727`*^9, 
   3.7208095205832973`*^9}, {3.721490517488619*^9, 3.7214905647309017`*^9}, {
   3.7214906099303427`*^9, 3.7214906196486225`*^9}, {3.7214906623397336`*^9, 
   3.72149067901336*^9}, {3.7214929141766624`*^9, 3.721492917804928*^9}, {
   3.721493913978365*^9, 3.7214939148379893`*^9}, {3.7219950371215515`*^9, 
   3.721995045925116*^9}, {3.721998544034895*^9, 3.721998555556568*^9}, {
   3.722008069389223*^9, 3.722008075317501*^9}, {3.722008234587409*^9, 
   3.7220082867737074`*^9}, {3.7220088862291956`*^9, 
   3.7220089209859114`*^9}, {3.722009310044792*^9, 3.722009316157277*^9}, {
   3.72200963701622*^9, 3.7220096375305204`*^9}, {3.7220098701909785`*^9, 
   3.7220098703160295`*^9}, {3.722560200209793*^9, 3.7225602263871884`*^9}, {
   3.7227908619407387`*^9, 3.722790862249206*^9}},
 ExpressionUUID -> "eccb0fde-28f5-4a39-bf59-111f011ccd44"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["sampling and Bayesian melding",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.703505907825551*^9, 3.70350591757016*^9}, {
  3.703517237174137*^9, 3.7035172372069798`*^9}, {3.7141491720993824`*^9, 
  3.714149172127963*^9}, {3.726245220556244*^9, 3.7262452404464817`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["functions",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7035059520524473`*^9, 3.7035059530259547`*^9}, {
  3.7262452293262324`*^9, 3.7262452294839163`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fonGrid", "[", 
    RowBox[{"x_", ",", "y_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "m", ",", "fvals"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fvals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "m", "}"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"preallocate", " ", "fvals"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"fvals", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"y", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "fvals"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"x", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
    RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"y", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
    RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "f", " ", "is", " ", "a", " ", "scalar", " ", "function", " ", "of", " ", 
    "two", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"fvals", " ", "is", " ", "an", " ", "m"}], "-", "by", "-", 
     RowBox[{"n", " ", "matirx", " ", "where", " ", 
      RowBox[{"fVals", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "=", 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", 
      RowBox[{"y", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repeat", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"n_Integer", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"Sequence", "@@", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"m", ",", "n"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.702212683239119*^9, 3.7022126862151327`*^9}, {
   3.702212732383494*^9, 3.702212776298992*^9}, {3.702212941922406*^9, 
   3.702213009546727*^9}, {3.7022130397508373`*^9, 3.702213071586981*^9}, {
   3.702213192706868*^9, 3.702213194550742*^9}, {3.7022136105741663`*^9, 
   3.702213611089116*^9}, {3.702221180021676*^9, 3.70222119417346*^9}, {
   3.7022971549358997`*^9, 3.702297155736002*^9}, {3.702297221260055*^9, 
   3.70229722141407*^9}, {3.702297269679932*^9, 3.702297269895307*^9}, {
   3.702297512902986*^9, 3.7022975130708237`*^9}, {3.7022975635228*^9, 
   3.702297563706696*^9}, 3.702303308232937*^9, {3.702303358643429*^9, 
   3.702303371304614*^9}, {3.702407962401205*^9, 3.702407963409082*^9}, {
   3.702408002693084*^9, 3.702408003621046*^9}, {3.703344996367432*^9, 
   3.7033450041765223`*^9}, {3.703506010920048*^9, 3.7035060229937377`*^9}, {
   3.703524886188547*^9, 3.703524892006974*^9}, {3.7036101951520205`*^9, 
   3.703610202048828*^9}, {3.713279523091601*^9, 3.7132795269358807`*^9}, {
   3.713280005935954*^9, 3.7132800087325726`*^9}, {3.7214907439864197`*^9, 
   3.7214907447931004`*^9}, {3.7214946007309847`*^9, 3.721494603201349*^9}, 
   3.7219950656454964`*^9},
 ExpressionUUID -> "88cc9e8e-3a82-4482-a950-9cc1c878fd35"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["initialization for parameter estimates",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{
  3.7024059374388638`*^9, 3.702407959905129*^9, 3.702408000724612*^9, {
   3.702408041080536*^9, 3.702408076599719*^9}, {3.7262452319900017`*^9, 
   3.72624523227453*^9}, {3.7262458927807903`*^9, 3.7262458931224413`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r0T", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ksT", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0CI", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ksCI", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nif", " ", "=", " ", "0.1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "noise", " ", "around", " ", "mle", " ", "values", " ", "for", " ", 
    "bayesian", " ", "melding", " ", "prior"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nb", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "parameter", " ", "values", " ", "randomly", " ",
     "selected", " ", "for", " ", "Bayesian", " ", "melding", " ", "step"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sb", "=", "1000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "weighted", " ", "samples", " ", "for", " ", 
    "Bayesian", " ", "melding", " ", "step"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7024082569761457`*^9, 3.702408266207646*^9}, {
   3.702408343115411*^9, 3.702408488975521*^9}, {3.7035060352029147`*^9, 
   3.703506150524708*^9}, {3.703506193776966*^9, 3.703506211460781*^9}, {
   3.7035062701954436`*^9, 3.7035062772825317`*^9}, 3.703506401432895*^9, {
   3.7035066025745726`*^9, 3.7035066163041906`*^9}, 3.7035073352029247`*^9, {
   3.7039414368707027`*^9, 3.7039414381468353`*^9}, {3.704203094089471*^9, 
   3.7042031032386603`*^9}, {3.70420322467133*^9, 3.7042032256723127`*^9}, {
   3.7042159823253794`*^9, 3.7042159827363496`*^9}, 3.7262458951982408`*^9, {
   3.7262484492175455`*^9, 3.7262484951145754`*^9}},
 ExpressionUUID -> "2e920cbd-7737-491b-b330-b23ad3d954e1"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Bayesian melding for each pathogen",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.702408283660355*^9, 3.702408321599058*^9}, {
  3.702410509476049*^9, 3.7024105239317827`*^9}, {3.7262452360538282`*^9, 
  3.726245244174065*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iso", " ", "=", " ", 
      RowBox[{"isolates", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"resis", " ", "=", " ", 
      RowBox[{"resistance", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"cbp", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Take", " ", "nb", " ", "samples", " ", "for", " ", 
       SubscriptBox["r", "0"], " ", "and", " ", 
       SubscriptBox["k", "s"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r0s", " ", "=", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "nif"}], ")"}], "*", 
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "nif"}], ")"}], "*", 
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "nb"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["r", "0"], " ", "samples"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"kss", " ", "=", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "nif"}], ")"}], "*", 
           RowBox[{"fks", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "nif"}], ")"}], "*", 
           RowBox[{"fks", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "nb"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["k", "s"], " ", "samples"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lik", " ", "=", " ", 
      RowBox[{"fonGrid", "[", 
       RowBox[{"r0s", ",", "kss", ",", "Lik"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Calculates", " ", "a", " ", "matrix", " ", "of", " ", "loglikelihood",
         " ", "values", " ", "for", " ", 
        SubscriptBox["r", "0"]}], ",", " ", 
       RowBox[{
        SubscriptBox["k", "s"], " ", "values"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ls", " ", "=", " ", 
      RowBox[{"Exp", "[", "lik", "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Exponential", " ", "to", " ", "get", " ", "likelihood"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lb", " ", "=", 
      RowBox[{
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"ls", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"nb", "^", "2"}]}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Flatten", " ", "the", " ", "likelihood", " ", "to", " ", "get", " ", 
       "a", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"wb", " ", "=", " ", 
      RowBox[{"lb", "/", 
       RowBox[{"Total", "[", "lb", "]"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Calculate", " ", "weights", " ", "for", " ", "likelihood"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r0b", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"repeat", "[", 
         RowBox[{
          RowBox[{"r0s", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "nb"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Resize", " ", "r0", " ", "to", " ", "match", " ", "likelihood", " ", 
        RowBox[{"vector", ":", " ", 
         RowBox[{
         "repeat", " ", "1", "st", " ", "term", " ", "of", " ", "r0", " ", 
          "vector", " ", "n", " ", "times"}]}]}], ",", " ", 
       RowBox[{"then", " ", "2", "nd", " ", "term", " ", "n", " ", "times"}], 
       ",", " ", 
       RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ksb", " ", "=", " ", 
      RowBox[{"PadRight", "[", 
       RowBox[{"kss", ",", 
        RowBox[{"nb", "^", "2"}], ",", "kss"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Resize", " ", "ks", " ", "to", " ", "match", " ", "size", " ", "of", 
       " ", "likelihood", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{
        "repeat", " ", "ks", " ", "vector", " ", "n", " ", "times"}]}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ind", " ", "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"wb", "\[Rule]", 
         RowBox[{"Range", "[", 
          RowBox[{"nb", "^", "2"}], "]"}]}], ",", "sb"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Choose", " ", "mb", " ", "indices", " ", "from", " ", "1", " ", "to", 
       " ", 
       RowBox[{"nb", "^", "2"}], " ", "based", " ", "on", " ", "weights", 
       RowBox[{"(", 
        RowBox[{
        "importance", " ", "sampling", " ", "with", " ", "replacement"}], 
        ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r0b", " ", "=", " ", 
      RowBox[{"r0b", "[", 
       RowBox[{"[", "ind", "]"}], "]"}]}], ";", 
     RowBox[{"ksb", " ", "=", " ", 
      RowBox[{"ksb", "[", 
       RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
     RowBox[{"lb", " ", "=", " ", 
      RowBox[{"lb", "[", 
       RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Get", " ", "posterior", " ", "parameters", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["r0", "v"], ",", 
         SubscriptBox["ks", "v"]}], ")"}], " ", "and", " ", "likelihood", " ", 
       RowBox[{"(", 
        SubscriptBox["l", "v"], ")"}], " ", "based", " ", "on", " ", 
       "melding"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"od", " ", "=", " ", 
      RowBox[{"Ordering", "[", "lb", "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "sort", " ", "the", " ", "likelihood", " ", "values", " ", "in", " ", 
       "order", " ", "to", " ", "get", " ", "confidence", " ", "intervals"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r0T", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"r0b", "[", 
       RowBox[{"[", "od", "]"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"ksT", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"ksb", "[", 
       RowBox[{"[", "od", "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Order", " ", "parameters", " ", "in", " ", "the", " ", "same", " ", 
       "order", " ", "as", " ", "sorted", " ", "likelihoods"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r0CI", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"r0T", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"51", ";;", "1000"}], "]"}], "]"}]}], ";", " ", 
     RowBox[{
      RowBox[{"ksCI", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"ksT", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"51", ";;", "1000"}], "]"}], "]"}]}], ";"}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"95", "%", " ", "CI"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.702213085206161*^9, 3.7022130910461597`*^9}, {
   3.702213242497711*^9, 3.702213365697401*^9}, {3.702213422953679*^9, 
   3.702213477292939*^9}, {3.702213521753269*^9, 3.702213524804967*^9}, {
   3.702213556768837*^9, 3.702213582672481*^9}, {3.7022136314092712`*^9, 
   3.70221365245243*^9}, {3.70221452594149*^9, 3.7022145568976917`*^9}, {
   3.702214596469501*^9, 3.702214643929315*^9}, {3.702214743890162*^9, 
   3.702214772772786*^9}, {3.7022159578055067`*^9, 3.702215992345421*^9}, {
   3.702216384715893*^9, 3.702216468511726*^9}, {3.7022212185686398`*^9, 
   3.702221219649168*^9}, 3.702227690016165*^9, {3.702228184346311*^9, 
   3.702228265734083*^9}, {3.702232762931981*^9, 3.702232767724331*^9}, {
   3.702232926003491*^9, 3.702233040788165*^9}, {3.702297068084367*^9, 
   3.702297168036446*^9}, {3.702303376632094*^9, 3.702303385612136*^9}, {
   3.702303972506579*^9, 3.702303977594195*^9}, {3.702320989116581*^9, 
   3.702321010111902*^9}, 3.70232108199686*^9, {3.702321115008659*^9, 
   3.7023211673086243`*^9}, {3.7023214705632*^9, 3.70232166710699*^9}, {
   3.702321799631673*^9, 3.702321801102396*^9}, {3.702321897274564*^9, 
   3.702321899306859*^9}, {3.70232315196726*^9, 3.702323163354329*^9}, {
   3.7023232757065353`*^9, 3.702323297185672*^9}, {3.702384853229362*^9, 
   3.7023848533728523`*^9}, {3.702385012421068*^9, 3.70238501267686*^9}, {
   3.702385049496627*^9, 3.702385049632351*^9}, {3.702385259924115*^9, 
   3.702385260020009*^9}, {3.702386682651862*^9, 3.702386682772114*^9}, {
   3.7023868387958*^9, 3.702386838907045*^9}, {3.702386880255397*^9, 
   3.702386880374984*^9}, {3.702386982854719*^9, 3.702386982926188*^9}, {
   3.702401315877528*^9, 3.70240131662119*^9}, {3.7024030323879337`*^9, 
   3.702403033316182*^9}, {3.702403066256227*^9, 3.702403066323863*^9}, {
   3.702403098895918*^9, 3.702403099031457*^9}, {3.7024032442277946`*^9, 
   3.7024032503392878`*^9}, {3.702403416894806*^9, 3.702403428034679*^9}, {
   3.7024045641874437`*^9, 3.702404584471945*^9}, 3.702404730195898*^9, {
   3.702404834891159*^9, 3.702404865694994*^9}, {3.702405111310614*^9, 
   3.702405117137938*^9}, {3.70240548864151*^9, 3.702405509021366*^9}, {
   3.702405626455765*^9, 3.702405628692748*^9}, {3.7024057355759077`*^9, 
   3.702405757488584*^9}, {3.702405926684291*^9, 3.70240593361585*^9}, 
   3.7024059733405724`*^9, {3.702406051847333*^9, 3.7024060554312143`*^9}, {
   3.702406168519135*^9, 3.702406177238905*^9}, {3.702406309506442*^9, 
   3.702406353999366*^9}, {3.702406399210183*^9, 3.702406414959035*^9}, {
   3.7024066280390882`*^9, 3.702406635893631*^9}, 3.702406668499001*^9, {
   3.70240678337252*^9, 3.702406911739341*^9}, {3.702407074771019*^9, 
   3.702407075548867*^9}, {3.70240772665248*^9, 3.70240781734237*^9}, 
   3.702408050794153*^9, {3.7024080815328217`*^9, 3.702408254097418*^9}, 
   3.7024083355148067`*^9, {3.702408491923511*^9, 3.702408515974907*^9}, {
   3.702408550179139*^9, 3.702408613274899*^9}, 3.702408665722334*^9, {
   3.702408725009778*^9, 3.702408804305491*^9}, {3.7024088371940002`*^9, 
   3.70240892827332*^9}, {3.702408971790017*^9, 3.702408973925147*^9}, {
   3.702409012124255*^9, 3.702409073253428*^9}, {3.702409139888706*^9, 
   3.7024091966210623`*^9}, {3.702409236832713*^9, 3.7024092616688423`*^9}, {
   3.70240932778806*^9, 3.702409388664703*^9}, {3.702409796093885*^9, 
   3.702409805135612*^9}, 3.703505979075016*^9, {3.703506333300953*^9, 
   3.703506445601673*^9}, {3.7035066193341255`*^9, 3.7035069872736635`*^9}, {
   3.703507019956253*^9, 3.7035072727357817`*^9}, {3.7035073609324703`*^9, 
   3.7035073624633493`*^9}, {3.703517306467251*^9, 3.703517310849083*^9}, {
   3.7035192771647353`*^9, 3.703519277328511*^9}, 3.7042027153154707`*^9, {
   3.7042028708649664`*^9, 3.704202896809804*^9}, {3.7042030652955346`*^9, 
   3.7042031194883347`*^9}, {3.704203209028186*^9, 3.704203222698798*^9}, 
   3.704203348104335*^9, 3.7042038339109683`*^9, {3.704209882568907*^9, 
   3.704209884061839*^9}, {3.704209953879178*^9, 3.704209959134246*^9}, {
   3.7042100237585497`*^9, 3.7042100258080425`*^9}, {3.7042101322802916`*^9, 
   3.704210147512648*^9}, {3.704210860938739*^9, 3.7042108619577665`*^9}, {
   3.704211541876624*^9, 3.7042115715077343`*^9}, 3.704211674149534*^9, 
   3.704211765678898*^9, {3.704211865289325*^9, 3.704211891497982*^9}, {
   3.704212662198522*^9, 3.7042126648387003`*^9}, {3.7042148679452066`*^9, 
   3.7042148701747704`*^9}, {3.704215799147096*^9, 3.704215799614151*^9}, {
   3.7042162700765667`*^9, 3.7042162763825583`*^9}, {3.7042163568754053`*^9, 
   3.704216393769023*^9}, {3.7132795351025047`*^9, 3.7132795355086393`*^9}, {
   3.721494528040166*^9, 3.7214945607753773`*^9}, 3.721995102135546*^9, {
   3.7219996960475187`*^9, 3.721999696699308*^9}, {3.721999747748229*^9, 
   3.7219997485608487`*^9}, {3.7219998924088793`*^9, 
   3.7219999247342815`*^9}, {3.721999955506683*^9, 3.7219999557020545`*^9}, {
   3.7220000001026297`*^9, 3.7220000005870523`*^9}, 3.7220063770990324`*^9, {
   3.7220067414358635`*^9, 3.7220067431162977`*^9}, {3.7220070110256157`*^9, 
   3.7220070129214253`*^9}, {3.722007200404398*^9, 3.7220072322321825`*^9}, {
   3.7220073220963025`*^9, 3.7220073674507456`*^9}, {3.7220074803343687`*^9, 
   3.72200752108786*^9}, {3.7220076159581733`*^9, 3.7220076214535704`*^9}, {
   3.722007690556248*^9, 3.722007698672093*^9}, {3.722008515320757*^9, 
   3.722008588063988*^9}, 3.7220091239222875`*^9, {3.7220097446240797`*^9, 
   3.7220097845930405`*^9}, {3.7262454404239063`*^9, 
   3.7262454436063814`*^9}, {3.726247918062642*^9, 3.7262479193974605`*^9}, {
   3.726248372474083*^9, 3.726248444081644*^9}, {3.7262485046192226`*^9, 
   3.726248506804306*^9}, {3.7262485377855844`*^9, 3.7262485383580713`*^9}, {
   3.7262486035097823`*^9, 3.7262486089303994`*^9}},
 ExpressionUUID -> "8e46c2ca-b297-47c8-9ea8-88aa2fec681e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model projections",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7035094794637623`*^9, 3.7035094869978647`*^9}, {
  3.7262449554978848`*^9, 3.726244962314658*^9}, {3.72624524728148*^9, 
  3.726245247382464*^9}, {3.726245666355273*^9, 3.7262456674802165`*^9}, {
  3.726249447328065*^9, 3.7262494485353994`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["status quo consumption",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.703508588435497*^9, 3.7035085961604033`*^9}, {
   3.726245681554492*^9, 3.726245681777619*^9}, {3.7262460538847017`*^9, 
   3.7262460760735145`*^9}, 3.7262494512754974`*^9}],

Cell[TextData[{
 "assume linear trend of increasing consumption levels until end of \
projections ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["t", "f"]}], TraditionalForm]]],
 ")"
}], "Text",
 CellChangeTimes->{{3.703508618504487*^9, 3.70350870246686*^9}, {
  3.7035087755311627`*^9, 3.703508783329441*^9}, {3.703508931440913*^9, 
  3.70350893332882*^9}, {3.72624601264876*^9, 3.7262460258545628`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ti", "=", 
    RowBox[{
     RowBox[{"years", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "+", "1"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projections", " ", "begin", " ", "at", " ", "year", " ", 
    SubscriptBox["t", "i"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tf", " ", "=", "2040"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projection", " ", "until", " ", "year", " ", 
    SubscriptBox["t", "f"]}], "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyears", " ", "=", " ", 
    RowBox[{"Range", "[", " ", 
     RowBox[{"ti", ",", "tf"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "vector", " ", "of", " ", "years", " ", "from", " ", "ti", " ", "to", " ", 
    "tf"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nyears", " ", "=", " ", 
    RowBox[{"Length", "[", "pyears", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "of", " ", "years", " ", "to", " ", "project", " ", "across"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yvals", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"years", ",", "pyears"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"2000", "-", "2040"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpdata", " ", "=", " ", 
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{"years", ",", "carbcons"}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"CBP", " ", "consumption", " ", "data", " ", "by", " ", "year"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lm", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"LinearModelFit", "[", 
     RowBox[{"cbpdata", ",", "xy", ",", "xy"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cbpmodelfit", "[", "xy_", "]"}], "=", "lm"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "linear", " ", "fit", " ", "for", " ", "CBP", " ", "consumption", " ", 
    "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projSQ", " ", "=", 
    RowBox[{"cbpmodelfit", "[", "pyears", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "status", " ", "quo", " ", "projection", " ", "of", " ", "CBP", " ", 
    "consumption", " ", 
    RowBox[{"(", "total", ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpSQ", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"projSQ", "*", 
         RowBox[{"cbpp", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"conbreak", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", "inapp"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CBP", " ", "consumption"}], " ", "-", " ", 
    RowBox[{"status", " ", "quo"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.7024101570563507`*^9, {3.702410218390636*^9, 3.702410362817946*^9}, {
   3.702410394869886*^9, 3.7024103970699472`*^9}, {3.7024104362820168`*^9, 
   3.702410444877763*^9}, {3.702410485033464*^9, 3.702410497966292*^9}, {
   3.7024106015437107`*^9, 3.702410687478723*^9}, 3.702410887353681*^9, {
   3.7024109658707323`*^9, 3.702410969317919*^9}, {3.7024261213503265`*^9, 
   3.7024261280905967`*^9}, {3.7024263725653534`*^9, 3.702426380245617*^9}, {
   3.702426457971155*^9, 3.7024264932668233`*^9}, {3.7024293872030387`*^9, 
   3.7024293931895275`*^9}, {3.702429462175844*^9, 3.70242946525767*^9}, {
   3.702430121492141*^9, 3.7024301671103873`*^9}, {3.7024302762387476`*^9, 
   3.702430288760964*^9}, {3.702644820122126*^9, 3.702644895701531*^9}, 
   3.702644943830612*^9, 3.702645089788928*^9, {3.7026451707843*^9, 
   3.70264526906386*^9}, {3.702646860223049*^9, 3.702646868962504*^9}, {
   3.702649139296464*^9, 3.702649320466694*^9}, {3.702649365182232*^9, 
   3.702649404887587*^9}, {3.702651111455793*^9, 3.7026511124499407`*^9}, {
   3.7026511597468357`*^9, 3.702651164081389*^9}, {3.702651196198786*^9, 
   3.702651197694605*^9}, {3.702651273522381*^9, 3.702651376152687*^9}, {
   3.702651418053768*^9, 3.702651443400633*^9}, 3.702652454145401*^9, {
   3.7026525127209053`*^9, 3.702652515601593*^9}, 3.702652548364834*^9, {
   3.702652608636973*^9, 3.702652657849235*^9}, {3.702653096817143*^9, 
   3.702653125610446*^9}, {3.702653749523258*^9, 3.702653750928804*^9}, {
   3.702653950929109*^9, 3.702653951679988*^9}, {3.702654039324127*^9, 
   3.702654039419592*^9}, {3.7026543363477087`*^9, 3.702654341882617*^9}, {
   3.7026545090261793`*^9, 3.7026545134917192`*^9}, {3.702654545342651*^9, 
   3.702654545558536*^9}, {3.702654608693609*^9, 3.702654619161729*^9}, {
   3.702654668682192*^9, 3.702654671385303*^9}, {3.702654727962429*^9, 
   3.7026547324014072`*^9}, {3.702654776069682*^9, 3.702654787369268*^9}, {
   3.7026548624498568`*^9, 3.702654867864908*^9}, {3.70265639087677*^9, 
   3.702656394099745*^9}, {3.7026564282281523`*^9, 3.702656545027399*^9}, {
   3.7026565898351803`*^9, 3.702656628453731*^9}, {3.702656668626183*^9, 
   3.7026566753049593`*^9}, {3.702656819101117*^9, 3.70265682103613*^9}, {
   3.7026569967323914`*^9, 3.702657008143818*^9}, {3.7026571246398993`*^9, 
   3.702657126487445*^9}, {3.702657371432023*^9, 3.702657425054729*^9}, {
   3.7026576846030293`*^9, 3.7026576856582727`*^9}, {3.7026608953323927`*^9, 
   3.7026609089441843`*^9}, 3.702661089124311*^9, {3.702661204048341*^9, 
   3.702661205391203*^9}, {3.702661284675581*^9, 3.702661291750792*^9}, {
   3.7026613428193283`*^9, 3.702661349627429*^9}, {3.702661379802754*^9, 
   3.702661380058751*^9}, {3.7033456056961913`*^9, 3.70334561000235*^9}, {
   3.7033458050779953`*^9, 3.7033458083271484`*^9}, {3.7033459913971276`*^9, 
   3.7033459939106092`*^9}, {3.7033461681953135`*^9, 
   3.7033461712910085`*^9}, {3.7033463567537875`*^9, 
   3.7033463572654247`*^9}, {3.7035082338264885`*^9, 
   3.7035082471470747`*^9}, {3.7035087059971313`*^9, 3.703508734307201*^9}, {
   3.7035087669185963`*^9, 3.7035087692494555`*^9}, {3.703508805421707*^9, 
   3.703508839820469*^9}, {3.7035088853377066`*^9, 3.7035090491735573`*^9}, {
   3.7035091583001184`*^9, 3.7035091686386347`*^9}, {3.703509602488188*^9, 
   3.703509602707128*^9}, {3.703509656145857*^9, 3.703509657959392*^9}, {
   3.703509720346399*^9, 3.7035097520558357`*^9}, {3.7035136434461355`*^9, 
   3.703513644255722*^9}, {3.703515324001593*^9, 3.703515324190832*^9}, {
   3.7035153572111883`*^9, 3.7035153710902896`*^9}, {3.7035160023508244`*^9, 
   3.7035160105050383`*^9}, {3.703517141670616*^9, 3.703517142985299*^9}, {
   3.70351738400301*^9, 3.703517404497833*^9}, {3.703517456846857*^9, 
   3.70351745704605*^9}, {3.7035175648886843`*^9, 3.7035175650573587`*^9}, {
   3.7035176152258997`*^9, 3.703517615449293*^9}, {3.703518215269558*^9, 
   3.703518216913766*^9}, {3.703524715096772*^9, 3.7035247324833183`*^9}, {
   3.704196230212077*^9, 3.7041962380707293`*^9}, {3.7041963209995203`*^9, 
   3.704196321425269*^9}, {3.7041964119609237`*^9, 3.704196452236375*^9}, {
   3.7041964974847107`*^9, 3.7041965084028883`*^9}, {3.7141466287897124`*^9, 
   3.7141466352042933`*^9}, {3.718829196351863*^9, 3.718829253465877*^9}, {
   3.7188293469290233`*^9, 3.718829364498951*^9}, {3.718829422805379*^9, 
   3.7188294994078255`*^9}, {3.7188402620911055`*^9, 
   3.7188402624192715`*^9}, {3.7207950472392936`*^9, 3.720795047364275*^9}, {
   3.7208072123624816`*^9, 3.7208072128808603`*^9}, 3.7220091711485066`*^9, {
   3.722560342697755*^9, 3.72256034609943*^9}, {3.7225610430786324`*^9, 
   3.722561051537126*^9}, {3.722562468414258*^9, 3.7225624710237346`*^9}, {
   3.7225625416355686`*^9, 3.7225626724681463`*^9}, {3.7225629196816945`*^9, 
   3.7225629782528963`*^9}, {3.7225633452428217`*^9, 3.722563430276744*^9}, {
   3.722563494658048*^9, 3.722563495278005*^9}, {3.722563606318383*^9, 
   3.722563623743952*^9}, {3.722563661995595*^9, 3.7225636628879533`*^9}, {
   3.7225637923455095`*^9, 3.722563795370119*^9}, {3.722564571781474*^9, 
   3.722564574770585*^9}, {3.7225646422810173`*^9, 3.722564669162845*^9}, {
   3.722564743611783*^9, 3.7225647782358713`*^9}, {3.726238841946047*^9, 
   3.726238842483596*^9}, {3.726240190706023*^9, 3.7262402078716836`*^9}, {
   3.7262487894798417`*^9, 3.726248808759999*^9}},
 ExpressionUUID -> "a0c0b461-cf24-49a7-b2d1-dfdb7c4a7d72"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["intervention consumption",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.703509177309683*^9, 3.7035091785015554`*^9}, 
   3.7225634141858664`*^9, 3.726238857403862*^9, {3.7262456876529884`*^9, 
   3.726245689853446*^9}, {3.7262460578876004`*^9, 3.726246078966159*^9}, 
   3.726249458542785*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sy", "=", "2018"}], ";", " ", 
   RowBox[{"ey", "=", "2023"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"start", " ", "of", " ", "intervention"}], ",", " ", 
    RowBox[{
    "year", " ", "of", " ", "achieving", " ", "full", " ", "reduction"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sqyears", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"ti", ",", 
      RowBox[{"sy", "-", "1"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "status", " ", "quo", " ", "years", " ", "prior", " ", "to", " ", 
    "intervention", " ", "start"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ncy", "=", 
    RowBox[{"Length", "[", "sqyears", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "sq", " ", "years", " ", "before", " ", "beginning", " ", 
    "intervention"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"niy", "=", 
    RowBox[{"ey", "-", "sy", "+", "1"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "intervention", " ", "years", " ", "prior", " ", "to", " ", 
    "reaching", " ", "full", " ", "reduction"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projI", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{"ncy", "-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"cbp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "stw"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"cbp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "*", "stw"}], ")"}]}], "/", 
          RowBox[{"(", "niy", ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cbp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "stw"}], ")"}]}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{"nyears", "-", "ncy", "-", "niy"}], "]"}]}], "]"}]}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cbpI", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"projI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7024101570563507`*^9, {3.702410218390636*^9, 3.702410362817946*^9}, {
   3.702410394869886*^9, 3.7024103970699472`*^9}, {3.7024104362820168`*^9, 
   3.702410444877763*^9}, {3.702410485033464*^9, 3.702410497966292*^9}, {
   3.7024106015437107`*^9, 3.702410687478723*^9}, 3.702410887353681*^9, {
   3.7024109658707323`*^9, 3.702410969317919*^9}, {3.7024261213503265`*^9, 
   3.7024261280905967`*^9}, {3.7024263725653534`*^9, 3.702426380245617*^9}, {
   3.702426457971155*^9, 3.7024264932668233`*^9}, {3.7024293872030387`*^9, 
   3.7024293931895275`*^9}, {3.702429462175844*^9, 3.70242946525767*^9}, {
   3.702430121492141*^9, 3.7024301671103873`*^9}, {3.7024302762387476`*^9, 
   3.702430288760964*^9}, {3.702644820122126*^9, 3.702644895701531*^9}, 
   3.702644943830612*^9, 3.702645089788928*^9, {3.7026451707843*^9, 
   3.70264526906386*^9}, {3.702646860223049*^9, 3.702646868962504*^9}, {
   3.702649139296464*^9, 3.702649320466694*^9}, {3.702649365182232*^9, 
   3.702649404887587*^9}, {3.702651111455793*^9, 3.7026511124499407`*^9}, {
   3.7026511597468357`*^9, 3.702651164081389*^9}, {3.702651196198786*^9, 
   3.702651197694605*^9}, {3.702651273522381*^9, 3.702651376152687*^9}, {
   3.702651418053768*^9, 3.702651443400633*^9}, 3.702652454145401*^9, {
   3.7026525127209053`*^9, 3.702652515601593*^9}, 3.702652548364834*^9, {
   3.702652608636973*^9, 3.702652657849235*^9}, {3.702653096817143*^9, 
   3.702653125610446*^9}, {3.702653749523258*^9, 3.702653750928804*^9}, {
   3.702653950929109*^9, 3.702653951679988*^9}, {3.702654039324127*^9, 
   3.702654039419592*^9}, {3.7026543363477087`*^9, 3.702654341882617*^9}, {
   3.7026545090261793`*^9, 3.7026545134917192`*^9}, {3.702654545342651*^9, 
   3.702654545558536*^9}, {3.702654608693609*^9, 3.702654619161729*^9}, {
   3.702654668682192*^9, 3.702654671385303*^9}, {3.702654727962429*^9, 
   3.7026547324014072`*^9}, {3.702654776069682*^9, 3.702654787369268*^9}, {
   3.7026548624498568`*^9, 3.702654867864908*^9}, {3.70265639087677*^9, 
   3.702656394099745*^9}, {3.7026564282281523`*^9, 3.702656545027399*^9}, {
   3.7026565898351803`*^9, 3.702656628453731*^9}, {3.702656668626183*^9, 
   3.7026566753049593`*^9}, {3.702656819101117*^9, 3.70265682103613*^9}, {
   3.7026569967323914`*^9, 3.702657008143818*^9}, {3.7026571246398993`*^9, 
   3.702657126487445*^9}, {3.702657371432023*^9, 3.702657425054729*^9}, {
   3.7026576846030293`*^9, 3.7026576856582727`*^9}, {3.7026608953323927`*^9, 
   3.7026609089441843`*^9}, 3.702661089124311*^9, {3.702661204048341*^9, 
   3.702661205391203*^9}, {3.702661284675581*^9, 3.702661291750792*^9}, {
   3.7026613428193283`*^9, 3.702661349627429*^9}, {3.702661379802754*^9, 
   3.702661380058751*^9}, {3.7033456056961913`*^9, 3.70334561000235*^9}, {
   3.7033458050779953`*^9, 3.7033458083271484`*^9}, {3.7033459913971276`*^9, 
   3.7033459939106092`*^9}, {3.7033461681953135`*^9, 
   3.7033461712910085`*^9}, {3.7033463567537875`*^9, 
   3.7033463572654247`*^9}, {3.7035082338264885`*^9, 
   3.7035082471470747`*^9}, {3.7035087059971313`*^9, 3.703508734307201*^9}, {
   3.7035087669185963`*^9, 3.7035087692494555`*^9}, {3.703508805421707*^9, 
   3.703508839820469*^9}, {3.7035088853377066`*^9, 3.7035090491735573`*^9}, {
   3.7035091583001184`*^9, 3.7035091686386347`*^9}, {3.7035107380975866`*^9, 
   3.703510739164034*^9}, {3.703510930848754*^9, 3.70351099149683*^9}, {
   3.7035136106172495`*^9, 3.703513610754774*^9}, {3.703513742363851*^9, 
   3.7035137425128*^9}, {3.7035138143541393`*^9, 3.703513815425207*^9}, {
   3.70351386887615*^9, 3.703513965248187*^9}, {3.7035140660487466`*^9, 
   3.703514066580064*^9}, {3.7035152373321915`*^9, 3.703515308408615*^9}, {
   3.7035153419441814`*^9, 3.7035153851112537`*^9}, {3.703524283585355*^9, 
   3.7035242840850816`*^9}, {3.703524725073661*^9, 3.7035247251961956`*^9}, {
   3.7039377407464848`*^9, 3.7039377436080956`*^9}, {3.703943020524397*^9, 
   3.703943078199394*^9}, 3.703943316828333*^9, {3.7039434295423536`*^9, 
   3.7039434310270224`*^9}, {3.703943462979719*^9, 3.703943488672473*^9}, 
   3.703945122440321*^9, {3.7041965367300167`*^9, 3.7041965417697525`*^9}, {
   3.7136482204296927`*^9, 3.7136482270947514`*^9}, {3.7136483402910395`*^9, 
   3.713648359484461*^9}, 3.7136495073740664`*^9, {3.7188297222228003`*^9, 
   3.7188297356890836`*^9}, {3.718829781732129*^9, 3.7188297858617077`*^9}, {
   3.718829855297886*^9, 3.7188300088240232`*^9}, {3.7188300554791975`*^9, 
   3.7188300609921503`*^9}, {3.718838228521333*^9, 3.718838316562482*^9}, {
   3.718838457366002*^9, 3.7188385128141403`*^9}, {3.718838794705413*^9, 
   3.7188388078677073`*^9}, {3.7188388674465785`*^9, 3.718838942702777*^9}, {
   3.718839110692155*^9, 3.718839197853115*^9}, {3.718839255890061*^9, 
   3.718839289920641*^9}, {3.7188393265504537`*^9, 3.7188393359606256`*^9}, {
   3.718839428929613*^9, 3.7188394982783527`*^9}, {3.718839555483637*^9, 
   3.7188397015672064`*^9}, {3.718839738862632*^9, 3.7188397390657396`*^9}, {
   3.7188399622012606`*^9, 3.718839970257415*^9}, {3.7188400231418943`*^9, 
   3.7188400363880043`*^9}, {3.718840095531454*^9, 3.7188400976085405`*^9}, {
   3.7188402012199483`*^9, 3.718840201672966*^9}, {3.718840239664407*^9, 
   3.71884025961497*^9}, {3.7202011712667074`*^9, 3.7202012208637094`*^9}, 
   3.7202050826450586`*^9, {3.72020997735411*^9, 3.720209978495145*^9}, {
   3.72079802721357*^9, 3.7207980442093744`*^9}, 3.72079986649399*^9, 
   3.721998376064726*^9, {3.7225279884831944`*^9, 3.7225279886524*^9}, {
   3.7225280768290553`*^9, 3.7225280769932785`*^9}, {3.722528138717511*^9, 
   3.7225281750463514`*^9}, {3.7225282549911757`*^9, 3.722528271821331*^9}},
 ExpressionUUID -> "a0c0b461-cf24-49a7-b2d1-dfdb7c4a7d72"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["projected resistance frequencies",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7035155045659313`*^9, 3.7035155225031085`*^9}, 
   3.7035158752769194`*^9, {3.7262460704197855`*^9, 3.726246070698738*^9}, 
   3.7262494611496186`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"INITIALIZE", " ", "STORED", " ", "VALUES"}], "*)"}],
   FontWeight->"Bold"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nos", "=", 
     RowBox[{"Round", "[", 
      RowBox[{"0.95", "*", "sb"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     StyleBox["rSQ",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "nos"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "status", " ", "quo"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQbest", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "SQ", " ", "with", " ",
      "best", " ", "fit"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQm", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";", 
    RowBox[{"rSQM", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"min", " ", "and", " ", "max"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rI", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "nos"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "intervention"}], 
    "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     StyleBox["rIbest",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"best", " ", "fit"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     StyleBox["rIm",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Plain"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";", " ", 
    RowBox[{"rIM", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"min", " ", "and", " ", "max", " ", "resistance", " ", "values"}],
     "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.702656624595193*^9, 3.70265663463831*^9}, 
   3.7033447831113815`*^9, {3.7033449849882936`*^9, 3.7033449870707026`*^9}, {
   3.703515451649769*^9, 3.703515473290518*^9}, {3.7035155595203905`*^9, 
   3.703515685082728*^9}, {3.7035157432515965`*^9, 3.703515802176572*^9}, {
   3.7035159176168036`*^9, 3.7035159337037663`*^9}, {3.7035160501219788`*^9, 
   3.7035161139656773`*^9}, {3.7035161532168655`*^9, 3.70351620668676*^9}, {
   3.703516280376177*^9, 3.703516428656685*^9}, {3.703516497435608*^9, 
   3.7035164983504086`*^9}, {3.7035165309561834`*^9, 3.703516688172882*^9}, {
   3.703516769137375*^9, 3.703516828218351*^9}, {3.703517181626542*^9, 
   3.703517189108159*^9}, {3.703518444926235*^9, 3.7035184483422613`*^9}, {
   3.703518517615677*^9, 3.703518608012863*^9}, {3.7035186747767005`*^9, 
   3.7035187115422773`*^9}, {3.70351903666362*^9, 3.7035190699702806`*^9}, {
   3.70351911265419*^9, 3.7035191429602427`*^9}, {3.7035243858521786`*^9, 
   3.703524391647381*^9}, {3.7036037301810565`*^9, 3.703603742905409*^9}, {
   3.7036038213900967`*^9, 3.7036038561558275`*^9}, 3.703941183431985*^9, 
   3.7039422896846323`*^9, 3.703943483913226*^9, {3.7039452360363064`*^9, 
   3.7039452643340855`*^9}, 3.703945365860498*^9, {3.703947024971072*^9, 
   3.7039470263667407`*^9}, {3.7040338656944685`*^9, 3.704033884342639*^9}, {
   3.7042077184093065`*^9, 3.7042077193302183`*^9}, {3.7042077541226187`*^9, 
   3.704207768917225*^9}, {3.7042080345634203`*^9, 3.70420806400382*^9}, {
   3.7042081952744865`*^9, 3.7042082346858187`*^9}, 3.70420845637644*^9, {
   3.7042085503847275`*^9, 3.7042085516613026`*^9}, {3.7042086228821497`*^9, 
   3.7042086259920063`*^9}, {3.704208696037682*^9, 3.7042087087808523`*^9}, {
   3.704208785355607*^9, 3.7042088270032454`*^9}, {3.704212867152712*^9, 
   3.704212932676712*^9}, {3.7042130487576513`*^9, 3.7042130767047434`*^9}, {
   3.7042131943976526`*^9, 3.7042131961367793`*^9}, {3.7042137405002265`*^9, 
   3.704213760004231*^9}, {3.7042138375787573`*^9, 3.704213845834399*^9}, {
   3.7042139206490345`*^9, 3.7042139972932615`*^9}, {3.7042140916551704`*^9, 
   3.704214101039055*^9}, {3.7101328824617715`*^9, 3.7101328907375593`*^9}, {
   3.7132809828702126`*^9, 3.713281021486581*^9}, {3.713286973901414*^9, 
   3.7132869935900702`*^9}, {3.713287052666051*^9, 3.7132871144919367`*^9}, {
   3.7188303634394875`*^9, 3.7188303638349323`*^9}, {3.718830492463052*^9, 
   3.7188305166489286`*^9}, {3.7188305754065027`*^9, 
   3.7188305980326777`*^9}, {3.7188371116830025`*^9, 3.71883711225224*^9}, {
   3.718837236731703*^9, 3.7188372369969234`*^9}, {3.7188373288940926`*^9, 
   3.7188373550973196`*^9}, {3.718838044820858*^9, 3.7188380475086484`*^9}, {
   3.7188383883239055`*^9, 3.718838440994768*^9}, {3.7188390552601795`*^9, 
   3.7188390847987757`*^9}, {3.718844378069232*^9, 3.7188444569821467`*^9}, {
   3.718846713876641*^9, 3.718846720530072*^9}, {3.7219983914201884`*^9, 
   3.72199840774343*^9}, 3.7225284617346525`*^9, {3.7225290363261547`*^9, 
   3.722529036694713*^9}, {3.7225291076658516`*^9, 3.722529136647497*^9}, {
   3.7225291726960964`*^9, 3.7225292095541754`*^9}, {3.7262405069495983`*^9, 
   3.7262405323796234`*^9}, {3.726246092537933*^9, 3.7262462170249605`*^9}, {
   3.7262462491520395`*^9, 3.7262462523832397`*^9}, {3.726246328025806*^9, 
   3.7262463360752063`*^9}, {3.726246565164415*^9, 3.7262465657309823`*^9}, {
   3.726247347175177*^9, 3.726247424927148*^9}, {3.7262486349442196`*^9, 
   3.726248664122633*^9}, {3.7262516622333183`*^9, 3.7262516688397603`*^9}},
 ExpressionUUID -> "eeb0ea7c-db8d-434c-8af1-fba84a2341bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"STATUS", " ", "QUO", " ", "PROJECTIONS"}], "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    RowBox[{"res", "=", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"rfreq", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    StyleBox["For",
     FontWeight->"Bold"], 
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox[
      RowBox[{"i", "=", "1"}],
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox["i",
       FontWeight->"Bold"], 
      StyleBox["\[LessEqual]",
       FontWeight->"Bold"], " ", 
      StyleBox["nop",
       FontWeight->"Bold"]}], 
     StyleBox[",",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"i", "++"}],
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"(*", 
       RowBox[{"#", " ", "pathogens"}], "*)"}],
      FontWeight->"Bold"], 
     StyleBox["\[IndentingNewLine]",
      FontWeight->"Bold"], 
     RowBox[{
      RowBox[{
       StyleBox["r0p",
        FontWeight->"Bold"], 
       StyleBox[" ",
        FontWeight->"Bold"], 
       StyleBox["=",
        FontWeight->"Bold"], 
       RowBox[{"r0CI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", 
      RowBox[{"ksp", " ", "=", " ", 
       RowBox[{"ksCI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "save", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ", 
        "each", " ", "pathogen"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "nos"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", " ", "=", " ", 
           RowBox[{"cbpSQ", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rSQ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"k", ",", 
               RowBox[{"r0p", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
               RowBox[{"ksp", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
       "]"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rSQm", " ", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"rSQ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"rSQM", " ", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"rSQ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
        " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rSQbest", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"k", ",", 
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"fks", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rSQfill", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rSQm", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", 
           RowBox[{"rSQM", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sqdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{"rSQbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2000", "-", "2040"}], ",", " ", 
     RowBox[{"no", " ", "uncertainty"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitS", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{
           RowBox[{"rSQfill", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.702656624595193*^9, 3.70265663463831*^9}, 
   3.7033447831113815`*^9, {3.7033449849882936`*^9, 3.7033449870707026`*^9}, {
   3.703515451649769*^9, 3.703515473290518*^9}, {3.7035155595203905`*^9, 
   3.703515685082728*^9}, {3.7035157432515965`*^9, 3.703515802176572*^9}, {
   3.7035159176168036`*^9, 3.7035159337037663`*^9}, {3.7035160501219788`*^9, 
   3.7035161139656773`*^9}, {3.7035161532168655`*^9, 3.70351620668676*^9}, {
   3.703516280376177*^9, 3.703516428656685*^9}, {3.703516497435608*^9, 
   3.7035164983504086`*^9}, {3.7035165309561834`*^9, 3.703516688172882*^9}, {
   3.703516769137375*^9, 3.703516828218351*^9}, {3.703517181626542*^9, 
   3.703517189108159*^9}, {3.703518444926235*^9, 3.7035184483422613`*^9}, {
   3.703518517615677*^9, 3.703518608012863*^9}, {3.7035186747767005`*^9, 
   3.7035187115422773`*^9}, {3.70351903666362*^9, 3.7035190699702806`*^9}, {
   3.70351911265419*^9, 3.7035191429602427`*^9}, {3.7035243858521786`*^9, 
   3.703524391647381*^9}, {3.7036037301810565`*^9, 3.703603742905409*^9}, {
   3.7036038213900967`*^9, 3.7036038561558275`*^9}, 3.703941183431985*^9, 
   3.7039422896846323`*^9, 3.703943483913226*^9, {3.7039452360363064`*^9, 
   3.7039452643340855`*^9}, 3.703945365860498*^9, {3.703947024971072*^9, 
   3.7039470263667407`*^9}, {3.7040338656944685`*^9, 3.704033884342639*^9}, {
   3.7042077184093065`*^9, 3.7042077193302183`*^9}, {3.7042077541226187`*^9, 
   3.704207768917225*^9}, {3.7042080345634203`*^9, 3.70420806400382*^9}, {
   3.7042081952744865`*^9, 3.7042082346858187`*^9}, 3.70420845637644*^9, {
   3.7042085503847275`*^9, 3.7042085516613026`*^9}, {3.7042086228821497`*^9, 
   3.7042086259920063`*^9}, {3.704208696037682*^9, 3.7042087087808523`*^9}, {
   3.704208785355607*^9, 3.7042088270032454`*^9}, {3.704212867152712*^9, 
   3.704212932676712*^9}, {3.7042130487576513`*^9, 3.7042130767047434`*^9}, {
   3.7042131943976526`*^9, 3.7042131961367793`*^9}, {3.7042137405002265`*^9, 
   3.704213760004231*^9}, {3.7042138375787573`*^9, 3.704213845834399*^9}, {
   3.7042139206490345`*^9, 3.7042139972932615`*^9}, {3.7042140916551704`*^9, 
   3.704214101039055*^9}, {3.7101328824617715`*^9, 3.7101328907375593`*^9}, {
   3.7132809828702126`*^9, 3.713281021486581*^9}, {3.713286973901414*^9, 
   3.7132869935900702`*^9}, {3.713287052666051*^9, 3.7132871144919367`*^9}, {
   3.7188303634394875`*^9, 3.7188303638349323`*^9}, {3.718830492463052*^9, 
   3.7188305166489286`*^9}, {3.7188305754065027`*^9, 
   3.7188305980326777`*^9}, {3.7188371116830025`*^9, 3.71883711225224*^9}, {
   3.718837236731703*^9, 3.7188372369969234`*^9}, {3.7188373288940926`*^9, 
   3.7188373550973196`*^9}, {3.718838044820858*^9, 3.7188380475086484`*^9}, {
   3.7188383883239055`*^9, 3.718838440994768*^9}, {3.7188390552601795`*^9, 
   3.7188390847987757`*^9}, {3.718844378069232*^9, 3.7188444569821467`*^9}, {
   3.718846713876641*^9, 3.718846720530072*^9}, {3.7219983914201884`*^9, 
   3.72199840774343*^9}, 3.7225284617346525`*^9, {3.7225290363261547`*^9, 
   3.722529036694713*^9}, {3.7225291076658516`*^9, 3.722529136647497*^9}, {
   3.7225291726960964`*^9, 3.7225292095541754`*^9}, {3.7262405069495983`*^9, 
   3.7262405323796234`*^9}, {3.726246092537933*^9, 3.7262462170249605`*^9}, {
   3.7262462491520395`*^9, 3.7262462523832397`*^9}, {3.726246328025806*^9, 
   3.7262463360752063`*^9}, {3.726246565164415*^9, 3.7262465657309823`*^9}, {
   3.726247347175177*^9, 3.726247424927148*^9}, 3.726247641309924*^9, 
   3.7262476855563493`*^9, {3.726247734745173*^9, 3.726247735235879*^9}, 
   3.726248948591551*^9, {3.7262489786686244`*^9, 3.726249036121557*^9}, {
   3.7262490835368347`*^9, 3.7262490937794075`*^9}, {3.7262493329809084`*^9, 
   3.726249410514642*^9}, {3.726251622233486*^9, 3.7262516547437778`*^9}, {
   3.726251911365012*^9, 3.726251927909552*^9}, {3.7263339181246495`*^9, 
   3.726333961075926*^9}},
 ExpressionUUID -> "eeb0ea7c-db8d-434c-8af1-fba84a2341bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"INTERVENTION", " ", "PROJECTIONS"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    StyleBox["For",
     FontWeight->"Bold"], 
    StyleBox["[",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox[
      RowBox[{"i", "=", "1"}],
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox["i",
       FontWeight->"Bold"], 
      StyleBox["\[LessEqual]",
       FontWeight->"Bold"], " ", 
      StyleBox["nop",
       FontWeight->"Bold"]}], 
     StyleBox[",",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"i", "++"}],
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"(*", 
       RowBox[{"#", " ", "pathogens"}], "*)"}],
      FontWeight->"Bold"], 
     StyleBox["\[IndentingNewLine]",
      FontWeight->"Bold"], 
     RowBox[{
      RowBox[{
       StyleBox["r0p",
        FontWeight->"Bold"], 
       StyleBox[" ",
        FontWeight->"Bold"], 
       StyleBox["=",
        FontWeight->"Bold"], 
       RowBox[{"r0CI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", 
      RowBox[{"ksp", " ", "=", " ", 
       RowBox[{"ksCI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "save", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ", 
        "each", " ", "pathogen"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "nos"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"iso", "=", 
           RowBox[{"isolates", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           StyleBox["resis",
            FontWeight->"Plain"], 
           StyleBox[" ",
            FontWeight->"Plain"], 
           StyleBox["=",
            FontWeight->"Plain"], 
           StyleBox[" ",
            FontWeight->"Plain"], 
           RowBox[{"resistance", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"a", " ", "=", " ", 
           RowBox[{"cbpI", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rI", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"k", ",", 
               RowBox[{"r0p", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
               RowBox[{"ksp", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "tt", ",", 
               RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
       "]"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"2014", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rIm", " ", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"rI", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           RowBox[{"nyears", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"rIM", " ", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"rI", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           RowBox[{"nyears", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
        " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rIbest", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"k", ",", 
           RowBox[{"fr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"fks", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "tt", ",", 
           RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"2014", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rIfill", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rIm", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", 
           RowBox[{"rIM", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"if", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"years", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "}"}], ",", "pyears"}], 
           "]"}], ",", 
          RowBox[{"rIbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2000", "-", "2040"}], ",", " ", 
     RowBox[{"no", " ", "uncertainty"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitI", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"years", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "}"}], ",", "pyears"}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{"rIfill", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"2014", "-", "2040"}], "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.702656624595193*^9, 3.70265663463831*^9}, 
   3.7033447831113815`*^9, {3.7033449849882936`*^9, 3.7033449870707026`*^9}, {
   3.703515451649769*^9, 3.703515473290518*^9}, {3.7035155595203905`*^9, 
   3.703515685082728*^9}, {3.7035157432515965`*^9, 3.703515802176572*^9}, {
   3.7035159176168036`*^9, 3.7035159337037663`*^9}, {3.7035160501219788`*^9, 
   3.7035161139656773`*^9}, {3.7035161532168655`*^9, 3.70351620668676*^9}, {
   3.703516280376177*^9, 3.703516428656685*^9}, {3.703516497435608*^9, 
   3.7035164983504086`*^9}, {3.7035165309561834`*^9, 3.703516688172882*^9}, {
   3.703516769137375*^9, 3.703516828218351*^9}, {3.703517181626542*^9, 
   3.703517189108159*^9}, {3.703518444926235*^9, 3.7035184483422613`*^9}, {
   3.703518517615677*^9, 3.703518608012863*^9}, {3.7035186747767005`*^9, 
   3.7035187115422773`*^9}, {3.70351903666362*^9, 3.7035190699702806`*^9}, {
   3.70351911265419*^9, 3.7035191429602427`*^9}, {3.7035243858521786`*^9, 
   3.703524391647381*^9}, {3.7036037301810565`*^9, 3.703603742905409*^9}, {
   3.7036038213900967`*^9, 3.7036038561558275`*^9}, 3.703941183431985*^9, 
   3.7039422896846323`*^9, 3.703943483913226*^9, {3.7039452360363064`*^9, 
   3.7039452643340855`*^9}, 3.703945365860498*^9, {3.703947024971072*^9, 
   3.7039470263667407`*^9}, {3.7040338656944685`*^9, 3.704033884342639*^9}, {
   3.7042077184093065`*^9, 3.7042077193302183`*^9}, {3.7042077541226187`*^9, 
   3.704207768917225*^9}, {3.7042080345634203`*^9, 3.70420806400382*^9}, {
   3.7042081952744865`*^9, 3.7042082346858187`*^9}, 3.70420845637644*^9, {
   3.7042085503847275`*^9, 3.7042085516613026`*^9}, {3.7042086228821497`*^9, 
   3.7042086259920063`*^9}, {3.704208696037682*^9, 3.7042087087808523`*^9}, {
   3.704208785355607*^9, 3.7042088270032454`*^9}, {3.704212867152712*^9, 
   3.704212932676712*^9}, {3.7042130487576513`*^9, 3.7042130767047434`*^9}, {
   3.7042131943976526`*^9, 3.7042131961367793`*^9}, {3.7042137405002265`*^9, 
   3.704213760004231*^9}, {3.7042138375787573`*^9, 3.704213845834399*^9}, {
   3.7042139206490345`*^9, 3.7042139972932615`*^9}, {3.7042140916551704`*^9, 
   3.704214101039055*^9}, {3.7101328824617715`*^9, 3.7101328907375593`*^9}, {
   3.7132809828702126`*^9, 3.713281021486581*^9}, {3.713286973901414*^9, 
   3.7132869935900702`*^9}, {3.713287052666051*^9, 3.7132871144919367`*^9}, {
   3.7188303634394875`*^9, 3.7188303638349323`*^9}, {3.718830492463052*^9, 
   3.7188305166489286`*^9}, {3.7188305754065027`*^9, 
   3.7188305980326777`*^9}, {3.7188371116830025`*^9, 3.71883711225224*^9}, {
   3.718837236731703*^9, 3.7188372369969234`*^9}, {3.7188373288940926`*^9, 
   3.7188373550973196`*^9}, {3.718838044820858*^9, 3.7188380475086484`*^9}, {
   3.7188383883239055`*^9, 3.718838440994768*^9}, {3.7188390552601795`*^9, 
   3.7188390847987757`*^9}, {3.718844378069232*^9, 3.7188444569821467`*^9}, {
   3.718846713876641*^9, 3.718846720530072*^9}, {3.7219983914201884`*^9, 
   3.72199840774343*^9}, 3.7225284617346525`*^9, {3.7225290363261547`*^9, 
   3.722529036694713*^9}, {3.7225291076658516`*^9, 3.722529136647497*^9}, {
   3.7225291726960964`*^9, 3.7225292095541754`*^9}, {3.7262405069495983`*^9, 
   3.7262405323796234`*^9}, {3.726246092537933*^9, 3.7262462170249605`*^9}, {
   3.7262462491520395`*^9, 3.7262462523832397`*^9}, {3.726246328025806*^9, 
   3.7262463360752063`*^9}, {3.726246565164415*^9, 3.7262465657309823`*^9}, {
   3.726247347175177*^9, 3.726247421527196*^9}, 3.7262478049465313`*^9, {
   3.726248361525426*^9, 3.726248362232238*^9}, {3.7262490991848516`*^9, 
   3.7262491386241317`*^9}, {3.7262492071631026`*^9, 3.726249208280466*^9}, 
   3.726249337792073*^9, {3.726249579349925*^9, 3.7262496121591625`*^9}, {
   3.7262516896395893`*^9, 3.7262517122741847`*^9}, {3.7262645400992265`*^9, 
   3.726264571903493*^9}, {3.726264602413167*^9, 3.726264606856409*^9}, {
   3.7263341281428967`*^9, 3.7263341402220793`*^9}},
 ExpressionUUID -> "eeb0ea7c-db8d-434c-8af1-fba84a2341bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"test", " ", "model", " ", "fits"}], ";", " ", 
    RowBox[{
     RowBox[{"calculated", " ", "p"}], "-", "values"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PearsonCorrelationTest", "[", 
    RowBox[{
     RowBox[{"rfreq", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"rSQbest", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "tt"}], "]"}], "]"}], ",", 
     "\"\<TestDataTable\>\""}], "]"}], " ", 
   RowBox[{"(*", "PA", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"PearsonCorrelationTest", "[", 
    RowBox[{
     RowBox[{"rfreq", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"rSQbest", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "tt"}], "]"}], "]"}], ",", 
     "\"\<TestDataTable\>\""}], "]"}], "  ", 
   RowBox[{"(*", "AB", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"PearsonCorrelationTest", "[", 
    RowBox[{
     RowBox[{"rfreq", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"rSQbest", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "tt"}], "]"}], "]"}], ",", 
     "\"\<TestDataTable\>\""}], "]"}], "   ", 
   RowBox[{"(*", "KP", "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7242854248163495`*^9, 3.724285426774618*^9}, {
  3.7262457598673644`*^9, 3.726245766313583*^9}, {3.7262459848054447`*^9, 
  3.7262459954841337`*^9}, {3.7262492437373123`*^9, 3.7262492492446065`*^9}, {
  3.726249282128851*^9, 3.7262492947095327`*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["switch year",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.7134522765151215`*^9, 3.7134523005100126`*^9}, {
  3.7262496334654684`*^9, 3.726249635788082*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["calculating the switch year",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7134525069481277`*^9, 3.713452512799042*^9}, {
  3.7262496584472046`*^9, 3.726249659404624*^9}, {3.726252160753993*^9, 
  3.726252160853113*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yswitch", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", "nop"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"yswitch", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "*", 
          RowBox[{"mR", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}], "*", 
          RowBox[{"mS", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "\[Equal]", 
        RowBox[{"mA", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", "x"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yswitch", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"yswitch", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "set", " ", "mortality", " ", "from", " ", "CBP", " ", "equal", " ", "to", 
    " ", "mortality", " ", "from", " ", "alternative", " ", "to", " ", 
    "solve", " ", "for", " ", "resistance", " ", "where", " ", "we", " ", 
    "need", " ", "to", " ", "switch", " ", "prescription"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.720209468568576*^9, 3.720209474152439*^9}, {
   3.7202095088553944`*^9, 3.72020959459009*^9}, {3.7202096248538246`*^9, 
   3.720209626416975*^9}, 3.7207954697277613`*^9, {3.720800170427697*^9, 
   3.7208001876189876`*^9}, {3.720800232770626*^9, 3.720800233819287*^9}, {
   3.7256388275901504`*^9, 3.7256389452382607`*^9}, {3.7256390279339247`*^9, 
   3.725639034866147*^9}, {3.7256391221802936`*^9, 3.725639123010331*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["applying the switch year",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7134548988412075`*^9, 3.7134549044894447`*^9}, {
  3.726249677102138*^9, 3.726249677261724*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["indexing",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7141469210484486`*^9, 3.7141469241128535`*^9}, {
  3.7262496864617863`*^9, 3.726249687156872*^9}}],

Cell["determining switch year coordinates (year, resistance freq)", "Text",
 CellChangeTimes->{{3.726249802848733*^9, 3.726249811933242*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"STATUS", " ", "QUO"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ySQinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"rSQbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"yswitch", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ySQinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ySQinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ySQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "0.85"}], "\[LessEqual]", 
          " ", 
          RowBox[{"ySQinit", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "1.15"}]}], ",", 
         RowBox[{"ySQinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"switch", " ", "point", " ", "y", " ", "value"}], ";", " ", 
     RowBox[{
     "excluding", " ", "values", " ", "that", " ", "have", " ", "not", " ", 
      "yet", " ", "reached", " ", "the", " ", "switch", " ", "point", " ", 
      "in", " ", "our", " ", "projections"}]}], "*)"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSQpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"rSQbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"ySQinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSQpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"xSQpos", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSQ", "=", 
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", "1", "+", "xSQpos"}]}], ";"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{"switch", " ", "point", " ", "x", " ", "value"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7134584280589156`*^9, 3.713458766864848*^9}, {
   3.713458807481724*^9, 3.7134588157285123`*^9}, 3.713459280553359*^9, 
   3.7134594926657257`*^9, {3.71345985778963*^9, 3.7134598608429728`*^9}, {
   3.713631764127009*^9, 3.7136317919407253`*^9}, {3.7136318308451767`*^9, 
   3.713631914624951*^9}, {3.713631962504418*^9, 3.713632041110547*^9}, {
   3.7136320723317204`*^9, 3.713632106136525*^9}, {3.7136323189449387`*^9, 
   3.7136323851551075`*^9}, {3.7136329702760115`*^9, 
   3.7136329734341593`*^9}, {3.7136330081759253`*^9, 3.7136333351377907`*^9}, 
   3.713633382126835*^9, {3.7136334475945253`*^9, 3.7136339165083127`*^9}, {
   3.7136339854062247`*^9, 3.713633997800308*^9}, {3.7136340581635714`*^9, 
   3.7136340891697273`*^9}, {3.7136341307507505`*^9, 
   3.7136341771997766`*^9}, {3.71363422417024*^9, 3.713634246860915*^9}, {
   3.71363439414433*^9, 3.7136343942068596`*^9}, {3.7136344634701324`*^9, 
   3.713634494902569*^9}, {3.713645308145779*^9, 3.7136453085020466`*^9}, 
   3.7136453542422223`*^9, {3.713648525408132*^9, 3.7136486110030394`*^9}, {
   3.7141413778983626`*^9, 3.7141413979441977`*^9}, {3.7141414288252096`*^9, 
   3.714141470905487*^9}, {3.7141416152211657`*^9, 3.7141416239699564`*^9}, {
   3.7141417045734463`*^9, 3.7141417198182125`*^9}, {3.714141980321491*^9, 
   3.714142015487296*^9}, {3.714142064498788*^9, 3.7141420645770235`*^9}, {
   3.7141421492226477`*^9, 3.7141421493726635`*^9}, {3.71414222735497*^9, 
   3.7141422475298853`*^9}, {3.7141423211217337`*^9, 
   3.7141423214176517`*^9}, {3.714145624343717*^9, 3.7141456468676205`*^9}, {
   3.7141458008028965`*^9, 3.714145851335739*^9}, {3.71414616021764*^9, 
   3.7141461613731065`*^9}, {3.7141473123918686`*^9, 3.714147497908945*^9}, {
   3.7141475315817833`*^9, 3.7141475323652773`*^9}, {3.714147643678943*^9, 
   3.714147643900504*^9}, {3.7141502517204823`*^9, 3.714150267373786*^9}, {
   3.7202036967021685`*^9, 3.7202037076949034`*^9}, {3.7202037807239456`*^9, 
   3.720203826915698*^9}, {3.720203945271983*^9, 3.7202040272992535`*^9}, {
   3.7202045727805595`*^9, 3.7202045729851*^9}, {3.720204697273621*^9, 
   3.7202047280503826`*^9}, {3.720204985457324*^9, 3.720205011547507*^9}, {
   3.720209633875821*^9, 3.7202096457935324`*^9}, 3.7202098559997363`*^9, {
   3.7207957820602098`*^9, 3.7207958146575255`*^9}, {3.7207958597692804`*^9, 
   3.7207960201404266`*^9}, {3.7207960753391104`*^9, 
   3.7207961007072115`*^9}, {3.7207964795478544`*^9, 
   3.7207964843629093`*^9}, {3.720797248611517*^9, 3.7207972511573825`*^9}, {
   3.7208003244015765`*^9, 3.720800336483694*^9}, {3.720800434764969*^9, 
   3.720800489097722*^9}, {3.7225294155021644`*^9, 3.722529460318919*^9}, {
   3.7225294961707935`*^9, 3.722529504316861*^9}, {3.7225295450661883`*^9, 
   3.722529668626982*^9}, {3.7225297304361706`*^9, 3.722529823671062*^9}, {
   3.722529993427544*^9, 3.722530034955288*^9}, {3.7225300694530907`*^9, 
   3.72253008433576*^9}, {3.7225301203529167`*^9, 3.7225301231729317`*^9}, {
   3.722530153376381*^9, 3.7225301544248238`*^9}, {3.7225301950355844`*^9, 
   3.722530196165636*^9}, {3.722530292488182*^9, 3.722530293220454*^9}, {
   3.7225304314314656`*^9, 3.7225304613618875`*^9}, {3.722530550600855*^9, 
   3.722530551601328*^9}, {3.72253066820481*^9, 3.7225306697925053`*^9}, {
   3.7225307801775074`*^9, 3.7225307816855326`*^9}, {3.722791565480418*^9, 
   3.7227916095191107`*^9}, {3.7251363205699487`*^9, 3.725136337792056*^9}, {
   3.725136375436524*^9, 3.7251364186274242`*^9}, {3.7251370022277136`*^9, 
   3.725137003182129*^9}, {3.725137145577628*^9, 3.725137210019928*^9}, {
   3.7256391473478994`*^9, 3.7256391486353264`*^9}, {3.7262414320664997`*^9, 
   3.7262414334674077`*^9}, {3.7262417275164227`*^9, 
   3.7262417457701116`*^9}, {3.7262418321969395`*^9, 3.726241835722521*^9}, {
   3.726242153211757*^9, 3.7262421855282493`*^9}, {3.72624287641317*^9, 
   3.726242877322575*^9}, {3.726249710714135*^9, 3.726249712404219*^9}, {
   3.7262497560439806`*^9, 3.7262498155116987`*^9}, {3.726249875922388*^9, 
   3.726249878469741*^9}, {3.726250183253683*^9, 3.7262502839571357`*^9}, 
   3.7262503719020443`*^9, {3.726251739946997*^9, 3.726251755070236*^9}, {
   3.7268433379648914`*^9, 3.7268433382071495`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "INTERVENTION", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"yIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"rIbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"yswitch", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"yIinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "0.85"}], "\[LessEqual]", 
          " ", 
          RowBox[{"yIinit", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "1.15"}]}], ",", 
         RowBox[{"yIinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", "yval", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xIpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"rIbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"yIinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"2014", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xIpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"xIpos", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xI", "=", 
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}], "+", "xIpos"}]}], ";"}], " ", 
   RowBox[{"(*", "xval", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"JOIN", " ", "VALUES", " ", "FOR", " ", "EXPORT", " ", "LATER"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sySQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xSQ", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ySQ", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"syI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"yI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7134584280589156`*^9, 3.713458766864848*^9}, {
   3.713458807481724*^9, 3.7134588157285123`*^9}, 3.713459280553359*^9, 
   3.7134594926657257`*^9, {3.71345985778963*^9, 3.7134598608429728`*^9}, {
   3.713631764127009*^9, 3.7136317919407253`*^9}, {3.7136318308451767`*^9, 
   3.713631914624951*^9}, {3.713631962504418*^9, 3.713632041110547*^9}, {
   3.7136320723317204`*^9, 3.713632106136525*^9}, {3.7136323189449387`*^9, 
   3.7136323851551075`*^9}, {3.7136329702760115`*^9, 
   3.7136329734341593`*^9}, {3.7136330081759253`*^9, 3.7136333351377907`*^9}, 
   3.713633382126835*^9, {3.7136334475945253`*^9, 3.7136339165083127`*^9}, {
   3.7136339854062247`*^9, 3.713633997800308*^9}, {3.7136340581635714`*^9, 
   3.7136340891697273`*^9}, {3.7136341307507505`*^9, 
   3.7136341771997766`*^9}, {3.71363422417024*^9, 3.713634246860915*^9}, {
   3.71363439414433*^9, 3.7136343942068596`*^9}, {3.7136344634701324`*^9, 
   3.713634494902569*^9}, {3.713645308145779*^9, 3.7136453085020466`*^9}, 
   3.7136453542422223`*^9, {3.713648525408132*^9, 3.7136486110030394`*^9}, {
   3.7141413778983626`*^9, 3.7141413979441977`*^9}, {3.7141414288252096`*^9, 
   3.714141470905487*^9}, {3.7141416152211657`*^9, 3.7141416239699564`*^9}, {
   3.7141417045734463`*^9, 3.7141417198182125`*^9}, {3.714141980321491*^9, 
   3.714142015487296*^9}, {3.714142064498788*^9, 3.7141420645770235`*^9}, {
   3.7141421492226477`*^9, 3.7141421493726635`*^9}, {3.71414222735497*^9, 
   3.7141422475298853`*^9}, {3.7141423211217337`*^9, 
   3.7141423214176517`*^9}, {3.714145624343717*^9, 3.7141456468676205`*^9}, {
   3.7141458008028965`*^9, 3.714145851335739*^9}, {3.71414616021764*^9, 
   3.7141461613731065`*^9}, {3.7141473123918686`*^9, 3.714147497908945*^9}, {
   3.7141475315817833`*^9, 3.7141475323652773`*^9}, {3.714147643678943*^9, 
   3.714147643900504*^9}, {3.7141502517204823`*^9, 3.714150267373786*^9}, {
   3.7202036967021685`*^9, 3.7202037076949034`*^9}, {3.7202037807239456`*^9, 
   3.720203826915698*^9}, {3.720203945271983*^9, 3.7202040272992535`*^9}, {
   3.7202045727805595`*^9, 3.7202045729851*^9}, {3.720204697273621*^9, 
   3.7202047280503826`*^9}, {3.720204985457324*^9, 3.720205011547507*^9}, {
   3.720209633875821*^9, 3.7202096457935324`*^9}, 3.7202098559997363`*^9, {
   3.7207957820602098`*^9, 3.7207958146575255`*^9}, {3.7207958597692804`*^9, 
   3.7207960201404266`*^9}, {3.7207960753391104`*^9, 
   3.7207961007072115`*^9}, {3.7207964795478544`*^9, 
   3.7207964843629093`*^9}, {3.720797248611517*^9, 3.7207972511573825`*^9}, {
   3.7208003244015765`*^9, 3.720800336483694*^9}, {3.720800434764969*^9, 
   3.720800489097722*^9}, {3.7225294155021644`*^9, 3.722529460318919*^9}, {
   3.7225294961707935`*^9, 3.722529504316861*^9}, {3.7225295450661883`*^9, 
   3.722529668626982*^9}, {3.7225297304361706`*^9, 3.722529823671062*^9}, {
   3.722529993427544*^9, 3.722530034955288*^9}, {3.7225300694530907`*^9, 
   3.72253008433576*^9}, {3.7225301203529167`*^9, 3.7225301231729317`*^9}, {
   3.722530153376381*^9, 3.7225301544248238`*^9}, {3.7225301950355844`*^9, 
   3.722530196165636*^9}, {3.722530292488182*^9, 3.722530293220454*^9}, {
   3.7225304314314656`*^9, 3.7225304613618875`*^9}, {3.722530550600855*^9, 
   3.722530551601328*^9}, {3.72253066820481*^9, 3.7225306697925053`*^9}, {
   3.7225307801775074`*^9, 3.7225307816855326`*^9}, {3.722791565480418*^9, 
   3.7227916095191107`*^9}, {3.7251363205699487`*^9, 3.725136337792056*^9}, {
   3.725136375436524*^9, 3.7251364186274242`*^9}, {3.7251370022277136`*^9, 
   3.725137003182129*^9}, {3.725137145577628*^9, 3.7251372182656493`*^9}, {
   3.7251373012715445`*^9, 3.725137301543909*^9}, {3.725639157552537*^9, 
   3.725639166993535*^9}, {3.725639314222226*^9, 3.725639319349864*^9}, {
   3.726241944376091*^9, 3.7262419676690936`*^9}, {3.726242000603204*^9, 
   3.7262420055503225`*^9}, {3.7262420730841384`*^9, 3.726242073202569*^9}, {
   3.7262421875157948`*^9, 3.7262421882764335`*^9}, {3.7262502867435017`*^9, 
   3.7262503025200534`*^9}, {3.726250397804761*^9, 3.726250479581321*^9}, {
   3.726251971120058*^9, 3.7262519782587748`*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["steady state",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.725639587747517*^9, 3.7256396037787504`*^9}, {
  3.7262506340844374`*^9, 3.72625066618869*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["consumption",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.726250710395259*^9, 3.7262507219669714`*^9}}],

Cell["constant consumption/resistance after the switch year", "Text",
 CellChangeTimes->{3.726250952839876*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ny", "=", "2"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "years", " ", "to", " ", "get", " ", "to", " ", 
    "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rise", "=", "1.01"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "rise", " ", "in", " ", "consumption", " ", "until", " ", "reaching", " ", 
    "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syi", "=", " ", 
    RowBox[{"Round", "[", 
     RowBox[{"xSQpos", "-", 
      RowBox[{"(", 
       RowBox[{"ti", "-", 
        RowBox[{"years", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "index", " ", "of", " ", "switch", " ", "year", " ", "for", " ", "2015"}],
     "-", 
    RowBox[{"2040", " ", "vector"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syi", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"syi", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ">", "0"}], ",", 
        RowBox[{"syi", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Round", "[", 
         RowBox[{"sy", "-", "ti", "+", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "switch", " ", "point", " ", "is", " ", "in", " ", "the", " ", 
    "past", " ", "then", " ", "start", " ", "to", " ", "apply", " ", "steady",
     " ", "state", " ", "at", " ", "sy"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projSS", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tf", "-", 
          RowBox[{"years", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "-", "ny"}], ">", 
         RowBox[{"syi", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"projSQ", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"syi", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"projSQ", "[", 
             RowBox[{"[", 
              RowBox[{"syi", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"projSQ", "[", 
              RowBox[{"[", 
               RowBox[{"syi", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "*", "rise"}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"projSQ", "[", 
                 RowBox[{"[", 
                  RowBox[{"syi", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "*", 
                "rise"}], "-", 
               RowBox[{"projSQ", "[", 
                RowBox[{"[", 
                 RowBox[{"syi", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"ny", "-", "1"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"projSQ", "[", 
              RowBox[{"[", 
               RowBox[{"syi", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "*", "rise"}], 
            ",", 
            RowBox[{"Round", "[", 
             RowBox[{"tf", "-", "ti", "+", "1", "-", 
              RowBox[{"syi", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", "ny"}], "]"}]}], "]"}]}], 
         "]"}], ",", "projSQ"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "switch", " ", "point", " ", "is", " ", "after", " ", "2038", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "would"}], " ", "not", " ", "reach", 
      " ", "steady", " ", "state", " ", "in", " ", "projections"}], ")"}], 
    "then", " ", "leave", " ", "cbp", " ", "consumption", " ", "unaltered"}], 
   "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpSS", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"projSS", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"cbpp", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"conbreak", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", "inapp"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CBP", " ", "consumption", " ", "2015"}], "-", 
    RowBox[{
    "2040", " ", "with", " ", "constant", " ", "consumption", " ", "after", 
     " ", "switch", " ", "year"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7251289067181563`*^9, 3.7251290017046423`*^9}, {
   3.72512917356564*^9, 3.725129321148529*^9}, {3.725133660740316*^9, 
   3.7251336641110373`*^9}, {3.7251341087522545`*^9, 
   3.7251341131258917`*^9}, {3.725134146881181*^9, 3.7251341518243294`*^9}, {
   3.7251343430672197`*^9, 3.72513437220872*^9}, {3.725134408400887*^9, 
   3.7251344394231043`*^9}, {3.7251345245764294`*^9, 3.725134528270133*^9}, {
   3.7251355836040545`*^9, 3.7251356218464375`*^9}, 3.725135754529772*^9, {
   3.7251359070651093`*^9, 3.7251359071694613`*^9}, {3.725135940062811*^9, 
   3.7251359663836036`*^9}, {3.7251361381087213`*^9, 
   3.7251361385060225`*^9}, {3.7251374297894044`*^9, 
   3.7251374343144035`*^9}, {3.7251374860194445`*^9, 
   3.7251374865340576`*^9}, {3.7251376046751313`*^9, 
   3.7251376443739443`*^9}, {3.725137703884145*^9, 3.7251378221332903`*^9}, {
   3.7251434917498045`*^9, 3.7251434918593807`*^9}, {3.7262439026475134`*^9, 
   3.7262439038041463`*^9}, {3.726243950741517*^9, 3.7262439520611286`*^9}, {
   3.726244016440898*^9, 3.726244068188442*^9}, {3.7262507276341877`*^9, 
   3.726250727922593*^9}, {3.7262599276509*^9, 3.7262599304347925`*^9}, {
   3.7262599651189003`*^9, 3.7262600880165005`*^9}, {3.726260188779896*^9, 
   3.726260273660551*^9}, {3.7262603566537495`*^9, 3.7262603719961123`*^9}, {
   3.7262604083819413`*^9, 3.7262604689693923`*^9}, {3.726260507545828*^9, 
   3.726260552171982*^9}, {3.7262605993317175`*^9, 3.7262606268601627`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["projections",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.726250710395259*^9, 3.7262507219669714`*^9}, {
  3.7262507812210274`*^9, 3.7262507820510893`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"INITIALIZE", " ", "STORED", " ", "VALUES"}], "*)"}],
   FontWeight->"Bold"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["rSS",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "nos"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "status", " ", "quo"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSSbest", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "SQ", " ", "with", " ",
      "best", " ", "fit"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSSm", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";", 
    RowBox[{"rSSM", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"min", " ", "and", " ", "max"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], "\[IndentingNewLine]", 
   RowBox[{"(*", "PROJECTIONS", "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{
     StyleBox["For",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{"i", "=", "1"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["i",
        FontWeight->"Bold"], 
       StyleBox["\[LessEqual]",
        FontWeight->"Bold"], " ", 
       StyleBox["nop",
        FontWeight->"Bold"]}], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"i", "++"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"(*", 
        RowBox[{"#", " ", "pathogens"}], "*)"}],
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox["r0p",
         FontWeight->"Bold"], 
        StyleBox[" ",
         FontWeight->"Bold"], 
        StyleBox["=",
         FontWeight->"Bold"], 
        RowBox[{"r0CI", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"ksp", " ", "=", " ", 
        RowBox[{"ksCI", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "save", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ",
          "each", " ", "pathogen"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", "nos"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iso", "=", 
            RowBox[{"isolates", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            StyleBox["resis",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            StyleBox["=",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            RowBox[{"resistance", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"a", " ", "=", " ", 
            RowBox[{"cbpSS", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"rSS", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"k", ",", 
                RowBox[{"r0p", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                RowBox[{"ksp", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
        "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rSSm", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"rSS", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"rSSM", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"rSS", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
         " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rSSbest", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"k", ",", 
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rSSfill", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rSSm", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"rSSM", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}]}]}], "]"}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{"rSSbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitSS", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{
           RowBox[{"rSSfill", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.725133658106213*^9, 3.725133658306497*^9}, {
  3.725133751397529*^9, 3.7251337663776298`*^9}, {3.725134002651643*^9, 
  3.7251341019105053`*^9}, {3.725134167201734*^9, 3.7251342247929263`*^9}, {
  3.725135750649969*^9, 3.725135756932887*^9}, {3.7256396974467344`*^9, 
  3.725639701587803*^9}, {3.7262441150008173`*^9, 3.726244139879402*^9}, {
  3.7262441711630883`*^9, 3.7262441860993176`*^9}, {3.7262442178561287`*^9, 
  3.726244219615264*^9}, {3.7262442686676674`*^9, 3.7262442725228677`*^9}, {
  3.726250961332518*^9, 3.726250976708639*^9}, {3.7262510186521387`*^9, 
  3.726251104581026*^9}, {3.726251152607335*^9, 3.726251153104614*^9}, {
  3.7262520061968*^9, 3.726252138991432*^9}, {3.7263601773392353`*^9, 
  3.726360203025037*^9}, {3.7263602606920953`*^9, 3.7263602654904346`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["export data",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.725639587747517*^9, 3.7256396037787504`*^9}, {
  3.7262506340844374`*^9, 3.72625066618869*^9}, {3.726251205518097*^9, 
  3.7262512076083922`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<sepsis output.xlsx\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<raw data\>\"", "\[Rule]", " ", "res"}], ",", " ", 
       RowBox[{"\"\<SQ+band\>\"", " ", "\[Rule]", " ", "fitS"}], ",", 
       RowBox[{"\"\<I+band\>\"", "\[Rule]", " ", "fitI"}], ",", 
       RowBox[{"\"\<SQ\>\"", "\[Rule]", " ", "sqdata"}], ",", " ", 
       RowBox[{"\"\<I\>\"", "\[Rule]", " ", "if"}], ",", " ", 
       RowBox[{"\"\<SS+band\>\"", "\[Rule]", " ", "fitSS"}], ",", " ", 
       RowBox[{"\"\<SS\>\"", "\[Rule]", " ", "ssdata"}], ",", " ", 
       RowBox[{"\"\<SQ switch year\>\"", "\[Rule]", " ", "sySQ"}], ",", 
       RowBox[{"\"\<I switch year\>\"", "\[Rule]", " ", "syI"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.726237399854079*^9, 3.7262374186065645`*^9}, {
   3.72623746542581*^9, 3.7262374679083056`*^9}, {3.7262512207423286`*^9, 
   3.7262512212386293`*^9}, {3.726252173172405*^9, 3.726252355857831*^9}, 
   3.726252391682102*^9, {3.726259587311105*^9, 3.7262595877543015`*^9}}]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{1920, 1117},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
SpellingDictionaries->{"CorrectWords"->{
 "quo", "Formulary", "ntv,", "ey", "intv"}},
Magnification->0.75,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 386, 6, 76, "Title"],
Cell[CellGroupData[{
Cell[991, 32, 232, 4, 53, "Section"],
Cell[CellGroupData[{
Cell[1248, 40, 276, 5, 36, "Subsection"],
Cell[1527, 47, 301, 6, 4, "Text"],
Cell[1831, 55, 1229, 27, 15, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[3097, 87, 264, 5, 31, "Subsection"],
Cell[3364, 94, 163, 4, 4, "Text"],
Cell[3530, 100, 14278, 336, 97, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17857, 442, 608, 9, 53, "Section"],
Cell[CellGroupData[{
Cell[18490, 455, 288, 5, 36, "Subsection"],
Cell[18781, 462, 1639, 48, 20, "Text"],
Cell[20423, 512, 9980, 187, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[30440, 704, 313, 5, 31, "Subsection"],
Cell[30756, 711, 325, 10, 4, "Text"],
Cell[31084, 723, 8090, 177, 65, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[39211, 905, 329, 5, 31, "Subsection"],
Cell[CellGroupData[{
Cell[39565, 914, 220, 4, 6, "Subsubsection"],
Cell[39788, 920, 4055, 94, 43, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[43880, 1019, 368, 6, 6, "Subsubsection"],
Cell[44251, 1027, 2187, 52, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[46475, 1084, 290, 5, 6, "Subsubsection"],
Cell[46768, 1091, 13543, 282, 114, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[60360, 1379, 370, 6, 31, "Subsection"],
Cell[CellGroupData[{
Cell[60755, 1389, 306, 5, 30, "Subsubsection"],
Cell[61064, 1396, 421, 11, 4, "Text"],
Cell[61488, 1409, 8679, 172, 43, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[70204, 1586, 356, 6, 26, "Subsubsection"],
Cell[70563, 1594, 9290, 183, 47, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[79890, 1782, 294, 5, 26, "Subsubsection"],
Cell[80187, 1789, 6252, 130, 49, "Input"],
Cell[86442, 1921, 10357, 243, 78, "Input"],
Cell[96802, 2166, 10867, 257, 78, "Input"],
Cell[107672, 2425, 1694, 45, 26, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109427, 2477, 192, 3, 53, "Section"],
Cell[CellGroupData[{
Cell[109644, 2484, 280, 5, 36, "Subsection"],
Cell[109927, 2491, 2163, 57, 47, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[112127, 2553, 228, 4, 31, "Subsection"],
Cell[CellGroupData[{
Cell[112380, 2561, 217, 4, 30, "Subsubsection"],
Cell[112600, 2567, 141, 1, 13, "Text"],
Cell[112744, 2570, 7369, 150, 97, "Input"],
Cell[120116, 2722, 8002, 172, 114, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128179, 2901, 190, 3, 53, "Section"],
Cell[CellGroupData[{
Cell[128394, 2908, 164, 3, 36, "Subsection"],
Cell[128561, 2913, 111, 1, 4, "Text"],
Cell[128675, 2916, 6974, 177, 65, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[135686, 3098, 217, 4, 31, "Subsection"],
Cell[135906, 3104, 8597, 238, 123, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[144552, 3348, 240, 4, 53, "Section"],
Cell[144795, 3354, 1117, 20, 39, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

