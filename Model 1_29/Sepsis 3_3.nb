(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    151955,       3613]
NotebookOptionsPosition[    148356,       3494]
NotebookOutlinePosition[    148916,       3514]
CellTagsIndexPosition[    148873,       3511]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["sepsis",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.7005872688200474`*^9, 3.700587274570282*^9}, {
  3.7188410276281157`*^9, 3.718841040872573*^9}, {3.7201979535797777`*^9, 
  3.720197955570175*^9}, {3.7262448051022034`*^9, 3.726244806784498*^9}, {
  3.7262498341078825`*^9, 3.7262498381451793`*^9}, {3.7262594797109284`*^9, 
  3.726259480233915*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["data",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.700586955166306*^9, 3.700586956688905*^9}, {
  3.700586999864338*^9, 3.700586999895615*^9}, {3.7262451865021553`*^9, 
  3.7262451868064556`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["preparing directory",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7005868421634493`*^9, 3.700586844493045*^9}, {
  3.7262451878092437`*^9, 3.726245189656511*^9}, {3.7262513662786016`*^9, 
  3.7262513663107185`*^9}}],

Cell["\<\
Clear all variables. Set directory and change setting such that when it \
closes it closes all outputs.\
\>", "Text",
 CellChangeTimes->{{3.6864016594282627`*^9, 3.6864016983437967`*^9}, {
  3.6864017385595016`*^9, 3.6864017467278137`*^9}, {3.7005783616134434`*^9, 
  3.700578363379423*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "Code",
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["SetDirectory", "Code"], 
   StyleBox["[", "Code"], 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  StyleBox[";", "Code"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"NotebookEventActions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
        RowBox[{"FrontEndExecute", "[", 
         RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
         "]"}]}], "}"}]}]}], "]"}], ";"}], "Code"]}], "Input",
 CellChangeTimes->{{3.686401706812792*^9, 3.6864017521197643`*^9}, 
   3.686403149219241*^9, {3.686504717864292*^9, 3.686504722791524*^9}, {
   3.700578365301522*^9, 3.7005783714796133`*^9}, {3.7005784918705196`*^9, 
   3.7005784924955854`*^9}, 3.718035742047043*^9, {3.718841224288909*^9, 
   3.718841230958413*^9}, {3.718841355222883*^9, 3.7188414238070726`*^9}, {
   3.718841461764323*^9, 3.7188414909630756`*^9}},
 ExpressionUUID -> "947cde04-da7c-4abf-a430-eb3841611396"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["load data",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.700586818794753*^9, 3.7005868197322516`*^9}, {
  3.7005873521608763`*^9, 3.700587352176503*^9}, {3.7262451924114122`*^9, 
  3.726245193818562*^9}}],

Cell["\<\
Reading country data on consumption and resistance and assigning them to \
appropriate variables.\
\>", "Text",
 CellChangeTimes->{3.686400603032765*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<AMR_Datasheet.xlsx\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Data\>\"", ",", "\"\<Sepsis_model\>\""}], "}"}]}], 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"import", " ", "data"}], "*)"}]}], "Code"], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], "Code"], 
  StyleBox[" ", "Code"], "\n", "\n", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "data", " ", "for", " ", "model", " ", "fit", " ", "and", " ", 
     "projections"}], "*)"}], "Code"]}], "\n", 
 RowBox[{
  RowBox[{
   StyleBox["dataM", "Code"], 
   StyleBox["=", "Code"], 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "20"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"years", " ", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "Code"], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"years", " ", "of", " ", "available", " ", "data"}], "*)"}], 
   "Code"]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"tt", " ", "=", " ", 
     RowBox[{"Length", "[", "years", "]"}]}], ";"}], "Code"], 
  StyleBox["  ", "Code"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"#", " ", "years", " ", "of", " ", "available", " ", "data"}], 
    "*)"}], "Code"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathogens", "=", 
    RowBox[{
     RowBox[{"dataM", "[", 
      RowBox[{"[", "15", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"pathogen", " ", "headers"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["nop", "Code"], 
    StyleBox[" ", "Code"], 
    StyleBox["=", "Code"], 
    StyleBox[" ", "Code"], 
    RowBox[{"Length", "[", "pathogens", "]"}]}], 
   StyleBox[";", "Code"]}], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"#", " ", "of", " ", "pathogens"}], "*)"}], "Code"]}], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"isolatesC", " ", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", 
        RowBox[{
         RowBox[{"2", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
    ";"}], "Code"], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", "CDDEP", "*)"}], "Code"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"resistanceC", " ", "=", " ", 
    RowBox[{"dataM", "[", 
     RowBox[{"[", 
      RowBox[{"3", ";;", 
       RowBox[{
        RowBox[{"2", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
   ";"}], "Code"], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"isolatesM", " ", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{"8", ";;", 
        RowBox[{
         RowBox[{"4", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
    ";"}], "Code"], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", "MERCK", "*)"}], "Code"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"resistanceM", " ", "=", " ", 
    RowBox[{"dataM", "[", 
     RowBox[{"[", 
      RowBox[{"9", ";;", 
       RowBox[{
        RowBox[{"4", "*", "nop"}], "+", "1"}], ";;", "2"}], "]"}], "]"}]}], 
   ";"}], "Code"], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"carbcons", " ", "=", "  ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", "14", "]"}], "]"}]}], ";"}], "Code"], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CBP", " ", "consumption"}], "-", " ", "total"}], "*)"}], 
   "Code"]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["inapp", "Code"], 
    StyleBox[" ", "Code"], 
    StyleBox["=", "Code"], 
    StyleBox[" ", "Code"], 
    RowBox[{
     RowBox[{
      StyleBox["dataM", "Code"], "[", 
      RowBox[{"[", 
       RowBox[{"-", "4"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "proportion", " ", "of", " ", "prescription", " ", "inappropriate"}], 
   "*)"}]}], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"conbreak", " ", "=", " ", 
     RowBox[{"dataM", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "3"}], ";;", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "Code"], 
  StyleBox[" ", "Code"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "breakdown", " ", "of", " ", "disease", " ", "by", " ", "pathogen"}], 
    "*)"}], "Code"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpp", "=", " ", 
    RowBox[{"dataM", "[", 
     RowBox[{"[", 
      RowBox[{"-", "5"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "CBP", " ", "prescribed", " ", "to", " ", "that", " ", "diagnosis"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"cbp", " ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"cbpp", "*", "inapp", "*", "carbcons", "*", 
       RowBox[{"conbreak", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbp", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], "\n", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"CBP", " ", 
     RowBox[{"consumption", ":", " ", 
      RowBox[{"by", " ", "indication", " ", "and", " ", "pathogen"}]}]}], 
    "*)"}], "Code"], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "data", " ", "for", " ", "economic", " ", "and", " ", "health", " ", 
    "outcomes"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"dataE", "=", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"17", ";;"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stw", " ", "=", " ", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"reduction", " ", "in", " ", "inappropriate", " ", "therapy"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mR", "=", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "mortality", " ", "with", " ", "CBPS", " ", "of", " ", "resistant"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mS", "=", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "mortality", " ", "with", " ", "CBPS", " ", "of", " ", "susceptible"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mA", "=", 
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"mortality", " ", "with", " ", "alternatives"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686422034696558*^9, 3.6864220688839083`*^9}, {
   3.686422244390477*^9, 3.686422257854924*^9}, {3.6864223170828114`*^9, 
   3.6864223431908817`*^9}, 3.6864948657783527`*^9, {3.686495706144705*^9, 
   3.686495706998027*^9}, {3.686497157777652*^9, 3.686497176663332*^9}, {
   3.686500722352275*^9, 3.6865007839598494`*^9}, {3.6865008234158993`*^9, 
   3.686500860558977*^9}, {3.686500895439396*^9, 3.6865009047916603`*^9}, {
   3.686501132914021*^9, 3.6865011961896877`*^9}, {3.686502039475134*^9, 
   3.686502053471085*^9}, 3.686504820987131*^9, {3.686504927512206*^9, 
   3.68650493323075*^9}, {3.686505663500307*^9, 3.686505834942637*^9}, {
   3.686506221505989*^9, 3.686506233253963*^9}, 3.6865062638755836`*^9, {
   3.686506304950383*^9, 3.6865063857051888`*^9}, {3.686506464729933*^9, 
   3.686506570268374*^9}, {3.686507885056096*^9, 3.686507925091408*^9}, 
   3.68650806648864*^9, {3.686508132562462*^9, 3.686508159468111*^9}, {
   3.6865082387863083`*^9, 3.686508289413818*^9}, {3.686593508533208*^9, 
   3.686593578249978*^9}, {3.686670822461113*^9, 3.686670846265149*^9}, 
   3.686671020176771*^9, {3.686671058093039*^9, 3.686671058348937*^9}, {
   3.686671195039489*^9, 3.686671197287084*^9}, {3.686672205273057*^9, 
   3.686672265615234*^9}, {3.686672313935074*^9, 3.686672315030695*^9}, {
   3.690514968752684*^9, 3.6905149711878157`*^9}, {3.6905151605791454`*^9, 
   3.6905151977141056`*^9}, {3.6905490426059213`*^9, 
   3.6905490710575967`*^9}, {3.6905491666256824`*^9, 3.69054916762508*^9}, {
   3.690560008801766*^9, 3.690560021440817*^9}, {3.693235488416274*^9, 
   3.693235488880404*^9}, {3.693237503430167*^9, 3.693237504912262*^9}, {
   3.693242514519369*^9, 3.693242533218896*^9}, {3.69324278229449*^9, 
   3.6932427827305317`*^9}, {3.69324331082885*^9, 3.693243311380581*^9}, {
   3.694794944107407*^9, 3.6947949456275787`*^9}, 3.694869444462384*^9, {
   3.69486947773489*^9, 3.6948694780468807`*^9}, {3.696613845884832*^9, 
   3.69661384630057*^9}, 3.6966142251356783`*^9, {3.696614267163052*^9, 
   3.696614268931164*^9}, {3.696614336734581*^9, 3.69661436742657*^9}, {
   3.6966143989830647`*^9, 3.6966144011982822`*^9}, {3.696614476914295*^9, 
   3.696614477617947*^9}, {3.696614523998536*^9, 3.696614524365843*^9}, {
   3.6966149875383883`*^9, 3.69661502321297*^9}, {3.696615101388283*^9, 
   3.69661512177125*^9}, {3.6966152518805857`*^9, 3.696615261003038*^9}, {
   3.696615389139082*^9, 3.696615395235524*^9}, {3.696615597886518*^9, 
   3.696615598926401*^9}, {3.696615815221848*^9, 3.696615816637291*^9}, {
   3.696616322068841*^9, 3.696616323151634*^9}, {3.6968731019011183`*^9, 
   3.696873102132331*^9}, {3.696873474263825*^9, 3.696873474894909*^9}, {
   3.696873750270289*^9, 3.6968737506538773`*^9}, {3.696952191029182*^9, 
   3.696952192165349*^9}, {3.6969525040529337`*^9, 3.69695250910539*^9}, {
   3.696952959626371*^9, 3.696952960785913*^9}, {3.696954591424856*^9, 
   3.696954592264494*^9}, {3.69695474259662*^9, 3.696954751834024*^9}, {
   3.696954829844029*^9, 3.696954858941578*^9}, {3.696959711253429*^9, 
   3.6969597124892597`*^9}, {3.696960225982828*^9, 3.696960229688342*^9}, {
   3.6974636430928164`*^9, 3.69746364475207*^9}, 3.6974636990330257`*^9, {
   3.69746572261734*^9, 3.6974657303934927`*^9}, {3.697466319707209*^9, 
   3.6974663208109493`*^9}, {3.699979819323583*^9, 3.699979824749195*^9}, {
   3.6999798994047337`*^9, 3.699979971399865*^9}, 3.700577857699892*^9, {
   3.700580301187483*^9, 3.7005803061567545`*^9}, {3.700580352344078*^9, 
   3.7005804332667875`*^9}, {3.700587356480831*^9, 3.7005873808606195`*^9}, {
   3.7014286067933145`*^9, 3.701428607337329*^9}, {3.701537183106104*^9, 
   3.7015371983584056`*^9}, {3.701537245629196*^9, 3.701537248154693*^9}, {
   3.7033434311097727`*^9, 3.703343437835854*^9}, {3.703505176641322*^9, 
   3.7035051788060784`*^9}, {3.703505326064638*^9, 3.7035053362004156`*^9}, {
   3.7035053790724077`*^9, 3.70350549006406*^9}, {3.703519398604677*^9, 
   3.703519432043036*^9}, {3.703519484955608*^9, 3.7035194851477613`*^9}, {
   3.7036029675366874`*^9, 3.7036029699555335`*^9}, {3.7041953951420145`*^9, 
   3.704195436240984*^9}, {3.7041954683610396`*^9, 3.7041955278418465`*^9}, {
   3.7041955732057734`*^9, 3.704195573330967*^9}, {3.704195640102418*^9, 
   3.7041956401959877`*^9}, 3.704195724703086*^9, {3.704195764869725*^9, 
   3.7041957937993608`*^9}, {3.704196032654626*^9, 3.704196036186615*^9}, {
   3.704196293670497*^9, 3.7041963168059745`*^9}, 3.7181247286556635`*^9, {
   3.7185479302107954`*^9, 3.718547930636095*^9}, {3.718726023153342*^9, 
   3.7187261228702497`*^9}, {3.718726179293728*^9, 3.718726184661331*^9}, {
   3.7187262163678045`*^9, 3.7187262167273273`*^9}, {3.7187292301088905`*^9, 
   3.718729231954373*^9}, 3.7187295838901253`*^9, {3.718730125091565*^9, 
   3.718730132625313*^9}, {3.7187304258212843`*^9, 3.7187304259463053`*^9}, {
   3.71873062095632*^9, 3.7187307197747135`*^9}, {3.7187308396265497`*^9, 
   3.7187308413967557`*^9}, {3.718730914974766*^9, 3.7187309183377433`*^9}, {
   3.7187309514840517`*^9, 3.7187309537718887`*^9}, {3.7187310113847795`*^9, 
   3.7187311372892237`*^9}, {3.7188268942806444`*^9, 3.718826895218213*^9}, {
   3.7188273209485097`*^9, 3.7188273215198584`*^9}, {3.718827355753003*^9, 
   3.7188274138674693`*^9}, {3.7188285615747223`*^9, 3.718828561715214*^9}, {
   3.718837931353737*^9, 3.7188379318905697`*^9}, {3.7201979700775166`*^9, 
   3.7201980014920006`*^9}, {3.7201986686680145`*^9, 3.720198698529197*^9}, {
   3.720198863811266*^9, 3.720198869435609*^9}, {3.720199355762143*^9, 
   3.7201993659002624`*^9}, {3.7202029908373814`*^9, 3.720202992526834*^9}, {
   3.720203264912648*^9, 3.720203285482752*^9}, {3.7207974836146517`*^9, 
   3.7207974888040757`*^9}, {3.7207975516245885`*^9, 3.720797563722108*^9}, {
   3.720797862144657*^9, 3.720797870097934*^9}, {3.72079800291986*^9, 
   3.720798011375171*^9}, {3.7207980594992423`*^9, 3.7207980884771147`*^9}, {
   3.7207982991987953`*^9, 3.720798356873657*^9}, {3.7207996202987976`*^9, 
   3.7207996257442436`*^9}, {3.720799724310115*^9, 3.72079974886286*^9}, {
   3.720799871614236*^9, 3.720799902106693*^9}, {3.720800123322297*^9, 
   3.720800159727727*^9}, {3.7219976120736094`*^9, 3.7219976156271057`*^9}, {
   3.7219976631063395`*^9, 3.7219976766698575`*^9}, {3.7220087470653563`*^9, 
   3.722008750879076*^9}, {3.722527593920542*^9, 3.7225275951387806`*^9}, 
   3.7241984244499283`*^9, {3.7241985029776044`*^9, 3.7241985177309012`*^9}, {
   3.725124664544177*^9, 3.7251246711886854`*^9}, {3.7251248399255843`*^9, 
   3.7251248403057213`*^9}, {3.725127092315174*^9, 3.7251270929182825`*^9}, {
   3.7256386432025948`*^9, 3.72563870850587*^9}, {3.726237653664692*^9, 
   3.726237674402959*^9}, {3.7262513741871357`*^9, 3.7262513769149113`*^9}, {
   3.726259502022908*^9, 3.7262595025755997`*^9}, 3.729265831997689*^9},
 ExpressionUUID -> "163af784-7490-4e8e-95c8-284f538d9d5f"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["sampling from resistance & isolates data",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7289927587160635`*^9, 3.7289927627579374`*^9}, {
  3.7291283467533145`*^9, 3.729128346936475*^9}}],

Cell["\<\
sample from the distribution from max likelihoods from resistance data \
(before bayesian melding step) to create final \
\>", "Text",
 CellChangeTimes->{{3.7290191154485717`*^9, 3.7290191380573516`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"i", "=", "pathogen"}], ";", " ", 
    RowBox[{"t", "=", "year"}], ";", " ", 
    RowBox[{"k", "=", "sample"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resistanceMn", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"resistanceM", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "t", "]"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "0.0001", ",", 
         RowBox[{
          RowBox[{"resistanceM", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", 
         RowBox[{"Length", "[", "years", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "replace", " ", "values", " ", "of", " ", "0", " ", "with", " ", 
     "0.0001"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"BetaDistribution", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"resistanceMn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "t", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"isolatesM", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "t", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"resistanceMn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "t", "]"}], "]"}]}]}], "]"}], ",", "1000"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", 
         RowBox[{"Length", "[", "years", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"resistance", " ", "frequency", " ", "Merck"}], "-", " ", 
     RowBox[{"sampled", " ", "from", " ", "beta", " ", "distribution"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resistance", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{"BinomialDistribution", "[", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"isolatesC", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pM", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "t", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", 
         RowBox[{"Length", "[", "years", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "sample", " ", "100", " ", "from", " ", "binomial", " ", "distribution"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"resistance", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"resistance", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", 
          RowBox[{"Length", "[", "years", "]"}]}], "}"}]}], "]"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resistance", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"resistance", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", "transpose", "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7289927719236045`*^9, 3.728992774082279*^9}, {
   3.7289929355399427`*^9, 3.7289929411033497`*^9}, {3.7290154302927732`*^9, 
   3.7290154325048223`*^9}, 3.7290154671458654`*^9, {3.72901576853448*^9, 
   3.729015792841606*^9}, {3.7290177783578234`*^9, 3.729017782753009*^9}, {
   3.729024953049884*^9, 3.7290249621268864`*^9}, {3.7290250848544164`*^9, 
   3.729025101683522*^9}, {3.72902731684013*^9, 3.7290273306215954`*^9}, {
   3.7290275054482317`*^9, 3.7290275358497696`*^9}, {3.729028586462989*^9, 
   3.72902858680679*^9}, {3.729028738747554*^9, 3.7290287424722376`*^9}, {
   3.7290489272897553`*^9, 3.729048966576394*^9}, {3.7292612954321313`*^9, 
   3.729261310702986*^9}, {3.729261345102049*^9, 3.7292613637388673`*^9}, 
   3.7292614245509834`*^9, {3.729262157027606*^9, 3.7292621588091464`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model fit", "Section",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.686400307952888*^9, 3.6864004084403467`*^9}, {
   3.686400489920883*^9, 3.686400491960532*^9}, 3.7005870090415688`*^9, 
   3.701429412245363*^9, {3.7035194899587927`*^9, 3.703519491726164*^9}, {
   3.7035241365553827`*^9, 3.7035241365731897`*^9}, {3.703602876186926*^9, 
   3.7036028769526424`*^9}, {3.7040410783324747`*^9, 
   3.7040410788569627`*^9}, {3.726244886554697*^9, 3.7262448868627825`*^9}, {
   3.7262451972084165`*^9, 3.7262451992147317`*^9}, {3.726245457292791*^9, 
   3.726245457348791*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model structure & likelihood function",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.700586719444282*^9, 3.700586729715373*^9}, {
  3.700586791459395*^9, 3.7005867927406187`*^9}, {3.726245200986512*^9, 
  3.726245213975565*^9}}],

Cell[TextData[{
 StyleBox["r(t)", "Text",
  FontWeight->"Bold"],
 StyleBox[" = frequency of resistance\n", "Text"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "s"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the sensitive strain\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "r"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the resistance strain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["k", "r"]}], TraditionalForm]]],
 " < ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "s"], ")"}], TraditionalForm]]],
 "\n",
 StyleBox["\[Theta]",
  FontWeight->"Bold"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["k", "r"], "-", 
     SubscriptBox["k", "s"]}], "<", " ", "0"}], TraditionalForm]]],
 " \n",
 StyleBox["a =",
  FontWeight->"Bold"],
 " CBP consumption (DDD)"
}], "Text",
 CellChangeTimes->{{3.686400499649311*^9, 3.68640052600694*^9}, {
   3.6864005718225193`*^9, 3.686400575021463*^9}, {3.68736386207417*^9, 
   3.687363862074381*^9}, 3.6905491725333633`*^9, {3.690722553178647*^9, 
   3.69072257128833*^9}, {3.690722611632101*^9, 3.6907226192004843`*^9}, 
   3.696614487562492*^9, {3.696954774986088*^9, 3.696954776429123*^9}, {
   3.699978618851925*^9, 3.69997862542444*^9}, {3.700578555451971*^9, 
   3.700578559628787*^9}, {3.700578612001893*^9, 3.700578612705063*^9}, {
   3.7005806236313753`*^9, 3.700580635401388*^9}, {3.7005806769712067`*^9, 
   3.7005809518298016`*^9}, {3.7005811924601393`*^9, 
   3.7005812164615297`*^9}, {3.702216322838592*^9, 3.702216326755948*^9}, 
   3.726244853438151*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"r", "[", 
      RowBox[{"t_", ",", "r0_", ",", "ks_"}], "]"}],
     FontWeight->"Plain"], 
    StyleBox[":=",
     FontWeight->"Plain"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ks", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"t", "+", "1"}], "]"}], "]"}], "/", "2"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "/", "2"}], ")"}]}], ")"}]}], 
         "+", "\[Theta]"}], ")"}]], " "}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ks", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"t", "+", "1"}], "]"}], "]"}], "/", "2"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "/", "2"}], ")"}]}], ")"}]}], 
         "+", "\[Theta]"}], ")"}]], " "}]]}], ";"}], " ", 
  RowBox[{"(*", "Model", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"Lik", "[", 
      RowBox[{"r0_", ",", "ks_"}], "]"}],
     FontWeight->"Plain"], 
    StyleBox[":=",
     FontWeight->"Plain"], 
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"resis", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "[", 
           RowBox[{"j", ",", "r0", ",", "ks"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"iso", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"resis", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "[", 
            RowBox[{"j", ",", "r0", ",", "ks"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"Likelihood", " ", "function"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.683030762976203*^9, 3.6830307646226077`*^9}, {
   3.683030892090124*^9, 3.6830309083188725`*^9}, {3.6830309721242533`*^9, 
   3.683030993984562*^9}, {3.6830311371186757`*^9, 3.6830311451555557`*^9}, {
   3.683031934623186*^9, 3.6830319364931593`*^9}, {3.683032013522828*^9, 
   3.683032065758599*^9}, {3.6830346542453313`*^9, 3.68303465754213*^9}, {
   3.6830363241484847`*^9, 3.683036329938362*^9}, {3.6830365276454496`*^9, 
   3.683036530676465*^9}, 3.6830367497782087`*^9, {3.683041381379426*^9, 
   3.683041393024686*^9}, {3.6830421349464197`*^9, 3.683042139599684*^9}, {
   3.6830447788287015`*^9, 3.683044779606695*^9}, {3.683045184458967*^9, 
   3.6830452004752617`*^9}, {3.6852083241401463`*^9, 3.685208331594561*^9}, {
   3.685208507957798*^9, 3.685208565997737*^9}, 3.6852094721246767`*^9, {
   3.685209903141817*^9, 3.6852099398500347`*^9}, {3.6852099889580927`*^9, 
   3.685210058891021*^9}, {3.6852103080680428`*^9, 3.685210309237547*^9}, {
   3.685210371854425*^9, 3.685210380461464*^9}, {3.685210428797523*^9, 
   3.6852105257382507`*^9}, {3.6852105754249763`*^9, 3.6852105928533*^9}, {
   3.6852107253971167`*^9, 3.685210739728479*^9}, {3.685211129911818*^9, 
   3.685211139176404*^9}, {3.68521175723141*^9, 3.6852117935313168`*^9}, {
   3.6852123574632883`*^9, 3.685212368014336*^9}, {3.685279366491384*^9, 
   3.685279382363071*^9}, {3.685279416295306*^9, 3.685279429839871*^9}, 
   3.6852808275142384`*^9, {3.6853860677425203`*^9, 3.6853861678062687`*^9}, {
   3.685386259499681*^9, 3.685386260403224*^9}, {3.685881879376438*^9, 
   3.68588188788455*^9}, {3.685882144512109*^9, 3.685882211247509*^9}, {
   3.685882264975534*^9, 3.6858823048645563`*^9}, {3.6863259609700985`*^9, 
   3.68632602143394*^9}, {3.6863261123987613`*^9, 3.6863261127132187`*^9}, {
   3.6863261459947433`*^9, 3.686326158772418*^9}, {3.6863300988135977`*^9, 
   3.6863301392487526`*^9}, {3.6863301968103313`*^9, 
   3.6863302455048313`*^9}, {3.686330295179199*^9, 3.686330312060356*^9}, {
   3.6863310425150905`*^9, 3.686331077920039*^9}, {3.6863311592705336`*^9, 
   3.686331161351984*^9}, {3.686331196844039*^9, 3.6863312002829003`*^9}, {
   3.6863316074494753`*^9, 3.68633161191486*^9}, {3.6863316677333975`*^9, 
   3.6863316752266045`*^9}, {3.686331756685466*^9, 3.6863317652227015`*^9}, {
   3.6863318579611225`*^9, 3.6863318604224625`*^9}, {3.6863320284264183`*^9, 
   3.6863320896920385`*^9}, {3.6863333970093203`*^9, 3.686333468722809*^9}, {
   3.686333527818489*^9, 3.686333530257064*^9}, {3.686333585882146*^9, 
   3.6863335937595434`*^9}, {3.6863337944358063`*^9, 
   3.6863338012252955`*^9}, {3.686333860129887*^9, 3.686333926127783*^9}, {
   3.686334541041381*^9, 3.6863345432302294`*^9}, {3.6863346050474234`*^9, 
   3.6863346194036174`*^9}, {3.6863350339422607`*^9, 
   3.6863350402439137`*^9}, {3.686396824312439*^9, 3.686396830206884*^9}, {
   3.68639728852584*^9, 3.686397385676342*^9}, {3.6863974219206467`*^9, 
   3.686397591467824*^9}, {3.6863977467434483`*^9, 3.686397856243059*^9}, {
   3.6863979037596188`*^9, 3.686398009617909*^9}, {3.686398049831843*^9, 
   3.686398058770108*^9}, {3.68639915087844*^9, 3.686399168049336*^9}, {
   3.686399538546379*^9, 3.686399540314131*^9}, 3.6864005110851316`*^9, 
   3.686400581816401*^9, {3.6864006197723083`*^9, 3.686400620244726*^9}, {
   3.686401869966902*^9, 3.686401900676633*^9}, {3.6864032479875317`*^9, 
   3.6864032930076036`*^9}, {3.6864112529344683`*^9, 3.686411262755252*^9}, {
   3.6864112967508183`*^9, 3.686411330746829*^9}, {3.686412024717753*^9, 
   3.686412049333313*^9}, 3.6864123304368677`*^9, {3.686412473817891*^9, 
   3.686412485495213*^9}, {3.686412529906288*^9, 3.686412535342702*^9}, 
   3.686413143077464*^9, {3.686413922349515*^9, 3.6864139332766542`*^9}, {
   3.686414054550778*^9, 3.68641405601223*^9}, {3.686414101545352*^9, 
   3.686414169219296*^9}, {3.6864142432310667`*^9, 3.686414273315958*^9}, {
   3.686414369325341*^9, 3.686414388826579*^9}, {3.6864144199682903`*^9, 
   3.686414447742525*^9}, {3.686414613494096*^9, 3.686414779850452*^9}, {
   3.686414811798102*^9, 3.686414906928382*^9}, {3.686415062398457*^9, 
   3.686415134968748*^9}, {3.686415560254722*^9, 3.686415665538151*^9}, {
   3.686418321121459*^9, 3.686418334972437*^9}, {3.686508624478046*^9, 
   3.686508632277608*^9}, 3.68650871497578*^9, {3.6866710450891523`*^9, 
   3.686671051229025*^9}, {3.6866716077238398`*^9, 3.6866716968985*^9}, {
   3.686671727131069*^9, 3.6866717297824497`*^9}, {3.686672280091339*^9, 
   3.68667229406674*^9}, {3.6869386960631742`*^9, 3.686938708012053*^9}, {
   3.690514877200051*^9, 3.6905148892161407`*^9}, {3.690721514268401*^9, 
   3.690721571699773*^9}, 3.696616035925852*^9, {3.6975661826500597`*^9, 
   3.6975661924568453`*^9}, {3.697566564484868*^9, 3.697566577524445*^9}, {
   3.69997860542073*^9, 3.699978631025688*^9}, {3.699978671234418*^9, 
   3.699978743381155*^9}, 3.6999787843122373`*^9, {3.6999788740181875`*^9, 
   3.699978892479066*^9}, {3.699978953924489*^9, 3.699978998636625*^9}, {
   3.699979481328476*^9, 3.699979524287679*^9}, {3.6999797618961906`*^9, 
   3.6999797636369605`*^9}, {3.700577837888285*^9, 3.7005778452831726`*^9}, {
   3.700577896592633*^9, 3.700577898123874*^9}, {3.700577982561618*^9, 
   3.7005779859363604`*^9}, 3.700580714849549*^9, {3.700580866866892*^9, 
   3.7005808755221605`*^9}, {3.7005809652484455`*^9, 3.700581054510634*^9}, {
   3.700581143420582*^9, 3.700581158726591*^9}, {3.7005812221988354`*^9, 
   3.700581224699131*^9}, {3.7005813900782413`*^9, 3.7005814812173157`*^9}, 
   3.700581594578314*^9, {3.7005817018893595`*^9, 3.7005817331728625`*^9}, {
   3.70058236481491*^9, 3.7005823685675287`*^9}, {3.7005824573051863`*^9, 
   3.7005824598974485`*^9}, {3.7005825333408175`*^9, 3.700582536338009*^9}, {
   3.7016103449359617`*^9, 3.701610389366672*^9}, {3.7214141660949025`*^9, 
   3.7214141671576414`*^9}, {3.721490354595252*^9, 3.721490375661333*^9}, {
   3.721490496246007*^9, 3.7214905118583574`*^9}, 3.7214907116385136`*^9, 
   3.721995023313809*^9, {3.721995780039253*^9, 3.721995828639323*^9}, {
   3.7219958706953983`*^9, 3.7219958976230364`*^9}, {3.7219964360706077`*^9, 
   3.721996442409454*^9}, {3.7219966635005045`*^9, 3.7219966650196266`*^9}, {
   3.7219986137927465`*^9, 3.721998617694166*^9}, {3.72199864820356*^9, 
   3.721998648641725*^9}, {3.722010099376684*^9, 3.722010102827274*^9}, {
   3.7225277846939898`*^9, 3.7225277882824926`*^9}, {3.7225278480253625`*^9, 
   3.7225278530705767`*^9}, {3.722528611803776*^9, 3.7225286143534937`*^9}, {
   3.7225521994595213`*^9, 3.7225522070867414`*^9}, {3.7225650553036375`*^9, 
   3.722565072887498*^9}, {3.7227907951757555`*^9, 3.7227907989723015`*^9}, {
   3.7227917950912704`*^9, 3.7227917978878403`*^9}, {3.722792061744688*^9, 
   3.722792064080303*^9}, {3.724191522359974*^9, 3.7241915246905336`*^9}, {
   3.725127239296571*^9, 3.7251272485545874`*^9}, {3.7262448145402937`*^9, 
   3.726244814683119*^9}, {3.726244914452033*^9, 3.726244945870349*^9}, 
   3.726259546377276*^9},
 ExpressionUUID -> "ebe5f114-8fd3-4fd7-94a0-8f75b8068d13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model fitting",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.700586762450125*^9, 3.70058676485663*^9}, {
   3.700587072272579*^9, 3.7005870740416794`*^9}, 3.714151770237274*^9, 
   3.718730005614851*^9, {3.7262452165031266`*^9, 3.7262452181822786`*^9}}],

Cell[TextData[{
 "Fit ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["r", "0"], " ", "and", " ", 
    SubscriptBox["k", "s"], " "}], TraditionalForm]]],
 "using a binomial maximum likelihood function. Fix \[Theta] based on \
literature. "
}], "Text",
 CellChangeTimes->{{3.703505727447111*^9, 3.7035057866848*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "=", 
    RowBox[{"-", "0.02"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Di", " ", "Luca"}], ",", " ", "2017"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"likt", "=", 
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"max", "  ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"{", 
          RowBox[{"nop", ",", "1000"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fr01", " ", "=", " ", "max"}], ";", " ", 
      RowBox[{"fks1", "=", "max"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", " ", "1000"}], ",", " ", 
          RowBox[{"k", "++"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"iso", "=", 
             RowBox[{"isolatesC", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{
             StyleBox["resis",
              FontWeight->"Bold"], 
             StyleBox[" ",
              FontWeight->"Bold"], 
             StyleBox["=",
              FontWeight->"Bold"], 
             StyleBox[" ",
              FontWeight->"Bold"], 
             RowBox[{
              RowBox[{"resistance", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ",", 
            RowBox[{"a", " ", "=", " ", 
             RowBox[{"cbp", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            StyleBox[
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"max", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fr01", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"fks1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "}"}], "=", 
              RowBox[{"NMaximize", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Lik", "[", 
                   RowBox[{"r0", ",", "ks"}], "]"}], ",", 
                  RowBox[{"0.", "<", "r0", "<", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"r0", ",", "ks"}], "}"}], ",", " ", 
                RowBox[{"MaxIterations", "\[Rule]", "100000"}]}], "]"}]}],
             FontWeight->"Bold"]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fr01", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fks", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fks1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], " ", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699979080700176*^9, 3.6999791285198135`*^9}, {
   3.6999795459289694`*^9, 3.6999795782642183`*^9}, {3.6999797469333143`*^9, 
   3.699979792164003*^9}, {3.699980655896045*^9, 3.6999807052383485`*^9}, {
   3.6999807386234922`*^9, 3.699980791359419*^9}, {3.6999808520183363`*^9, 
   3.699980857908617*^9}, {3.699980894395363*^9, 3.699980901995653*^9}, {
   3.699981214894743*^9, 3.699981244798695*^9}, {3.7005780580515375`*^9, 
   3.700578062092603*^9}, {3.7005811797204523`*^9, 3.700581187269937*^9}, {
   3.700581229488211*^9, 3.7005812726645036`*^9}, {3.7005813389896755`*^9, 
   3.7005813408419547`*^9}, {3.7005818466872196`*^9, 
   3.7005819987739115`*^9}, {3.7005822013314333`*^9, 3.700582287313163*^9}, {
   3.7005823546895723`*^9, 3.7005823990303335`*^9}, {3.7005825108149376`*^9, 
   3.7005825468018093`*^9}, {3.700583346136323*^9, 3.7005834001190147`*^9}, {
   3.700583431757659*^9, 3.7005834793698597`*^9}, {3.7005835118331184`*^9, 
   3.700583587628395*^9}, {3.700583644416862*^9, 3.700583645662918*^9}, {
   3.7005837321566935`*^9, 3.7005838421663465`*^9}, {3.7005838770509467`*^9, 
   3.7005840265769577`*^9}, {3.700584078823574*^9, 3.7005842033909864`*^9}, {
   3.700584239397745*^9, 3.7005842672882395`*^9}, {3.7005842975217457`*^9, 
   3.700584414314398*^9}, {3.700584769347272*^9, 3.700584770128607*^9}, {
   3.7005856949027915`*^9, 3.70058570076023*^9}, {3.7005870940906606`*^9, 
   3.7005870972436595`*^9}, {3.701427719951297*^9, 3.701427720217131*^9}, {
   3.701427761473959*^9, 3.701427803824013*^9}, {3.7014293722024174`*^9, 
   3.701429376227524*^9}, {3.7014295432311172`*^9, 3.701429543485509*^9}, {
   3.701429591451513*^9, 3.7014297070606256`*^9}, {3.701429910967057*^9, 
   3.7014299112260013`*^9}, {3.7015350613559856`*^9, 
   3.7015350624100776`*^9}, {3.7015351181957607`*^9, 
   3.7015351265069523`*^9}, {3.7033435416495123`*^9, 3.7033435444982157`*^9}, 
   3.703344913956914*^9, {3.703505648855173*^9, 3.703505692219559*^9}, {
   3.7035058029294133`*^9, 3.703505860689376*^9}, {3.703506296099897*^9, 
   3.7035063002073135`*^9}, {3.703524147348421*^9, 3.70352414930751*^9}, {
   3.7035248323526907`*^9, 3.7035248342670765`*^9}, 3.7035248733335547`*^9, 
   3.7035249640151196`*^9, {3.7036038737836237`*^9, 3.703603875319255*^9}, {
   3.7036086530928545`*^9, 3.7036086544593906`*^9}, {3.7036087014543476`*^9, 
   3.703608704175104*^9}, {3.703610055503646*^9, 3.7036100556286716`*^9}, {
   3.703610115648935*^9, 3.703610117549713*^9}, {3.703610158594226*^9, 
   3.7036101616058965`*^9}, {3.7036102451512833`*^9, 3.703610245401309*^9}, {
   3.7036103163292437`*^9, 3.703610316500459*^9}, {3.7036104516970577`*^9, 
   3.7036104521603866`*^9}, 3.7039414065616455`*^9, {3.7039429291565056`*^9, 
   3.703942929898025*^9}, {3.7039454848217554`*^9, 3.7039454852126107`*^9}, {
   3.7039456432733736`*^9, 3.70394564503203*^9}, {3.703945687429302*^9, 
   3.7039456888089523`*^9}, {3.7041981783075266`*^9, 3.704198179229902*^9}, {
   3.7041984388929377`*^9, 3.704198440629492*^9}, {3.7132798103674827`*^9, 
   3.7132798109456377`*^9}, {3.7132798812323017`*^9, 3.713279881404348*^9}, 
   3.718828326221363*^9, {3.7188285252355976`*^9, 3.7188285315739574`*^9}, {
   3.720809322919801*^9, 3.7208093327359*^9}, {3.7208094153444123`*^9, 
   3.7208094226708913`*^9}, {3.7208095203857727`*^9, 
   3.7208095205832973`*^9}, {3.721490517488619*^9, 3.7214905647309017`*^9}, {
   3.7214906099303427`*^9, 3.7214906196486225`*^9}, {3.7214906623397336`*^9, 
   3.72149067901336*^9}, {3.7214929141766624`*^9, 3.721492917804928*^9}, {
   3.721493913978365*^9, 3.7214939148379893`*^9}, {3.7219950371215515`*^9, 
   3.721995045925116*^9}, {3.721998544034895*^9, 3.721998555556568*^9}, {
   3.722008069389223*^9, 3.722008075317501*^9}, {3.722008234587409*^9, 
   3.7220082867737074`*^9}, {3.7220088862291956`*^9, 
   3.7220089209859114`*^9}, {3.722009310044792*^9, 3.722009316157277*^9}, {
   3.72200963701622*^9, 3.7220096375305204`*^9}, {3.7220098701909785`*^9, 
   3.7220098703160295`*^9}, {3.722560200209793*^9, 3.7225602263871884`*^9}, {
   3.7227908619407387`*^9, 3.722790862249206*^9}, {3.7289587478201957`*^9, 
   3.728958768214672*^9}, {3.7289588445155525`*^9, 3.728958878381192*^9}, {
   3.7289590680394545`*^9, 3.728959073433016*^9}, {3.728959127684125*^9, 
   3.728959147263362*^9}, {3.728959277815409*^9, 3.728959308190682*^9}, {
   3.728959471602191*^9, 3.7289594901134596`*^9}, {3.728959525624195*^9, 
   3.7289595286456347`*^9}, {3.7289636455626345`*^9, 
   3.7289636664128294`*^9}, {3.7289933915020328`*^9, 3.728993391593958*^9}, {
   3.7289934463096805`*^9, 3.728993446482699*^9}, {3.729015922727088*^9, 
   3.729015931204018*^9}, {3.729028665213275*^9, 3.729028676973795*^9}, {
   3.7290287289227*^9, 3.729028736036268*^9}, {3.7290485693252134`*^9, 
   3.7290485698295546`*^9}, {3.7290489182842426`*^9, 
   3.7290489207333684`*^9}, {3.729049007052568*^9, 3.7290490216625137`*^9}},
 ExpressionUUID -> "eccb0fde-28f5-4a39-bf59-111f011ccd44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"best", " ", "fits"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mindex", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"max", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{"max", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"max", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"mindex", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fr0b", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fr0", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"mindex", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fksb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fks", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"mindex", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.699979080700176*^9, 3.6999791285198135`*^9}, {
   3.6999795459289694`*^9, 3.6999795782642183`*^9}, {3.6999797469333143`*^9, 
   3.699979792164003*^9}, {3.699980655896045*^9, 3.6999807052383485`*^9}, {
   3.6999807386234922`*^9, 3.699980791359419*^9}, {3.6999808520183363`*^9, 
   3.699980857908617*^9}, {3.699980894395363*^9, 3.699980901995653*^9}, {
   3.699981214894743*^9, 3.699981244798695*^9}, {3.7005780580515375`*^9, 
   3.700578062092603*^9}, {3.7005811797204523`*^9, 3.700581187269937*^9}, {
   3.700581229488211*^9, 3.7005812726645036`*^9}, {3.7005813389896755`*^9, 
   3.7005813408419547`*^9}, {3.7005818466872196`*^9, 
   3.7005819987739115`*^9}, {3.7005822013314333`*^9, 3.700582287313163*^9}, {
   3.7005823546895723`*^9, 3.7005823990303335`*^9}, {3.7005825108149376`*^9, 
   3.7005825468018093`*^9}, {3.700583346136323*^9, 3.7005834001190147`*^9}, {
   3.700583431757659*^9, 3.7005834793698597`*^9}, {3.7005835118331184`*^9, 
   3.700583587628395*^9}, {3.700583644416862*^9, 3.700583645662918*^9}, {
   3.7005837321566935`*^9, 3.7005838421663465`*^9}, {3.7005838770509467`*^9, 
   3.7005840265769577`*^9}, {3.700584078823574*^9, 3.7005842033909864`*^9}, {
   3.700584239397745*^9, 3.7005842672882395`*^9}, {3.7005842975217457`*^9, 
   3.700584414314398*^9}, {3.700584769347272*^9, 3.700584770128607*^9}, {
   3.7005856949027915`*^9, 3.70058570076023*^9}, {3.7005870940906606`*^9, 
   3.7005870972436595`*^9}, {3.701427719951297*^9, 3.701427720217131*^9}, {
   3.701427761473959*^9, 3.701427803824013*^9}, {3.7014293722024174`*^9, 
   3.701429376227524*^9}, {3.7014295432311172`*^9, 3.701429543485509*^9}, {
   3.701429591451513*^9, 3.7014297070606256`*^9}, {3.701429910967057*^9, 
   3.7014299112260013`*^9}, {3.7015350613559856`*^9, 
   3.7015350624100776`*^9}, {3.7015351181957607`*^9, 
   3.7015351265069523`*^9}, {3.7033435416495123`*^9, 3.7033435444982157`*^9}, 
   3.703344913956914*^9, {3.703505648855173*^9, 3.703505692219559*^9}, {
   3.7035058029294133`*^9, 3.703505860689376*^9}, {3.703506296099897*^9, 
   3.7035063002073135`*^9}, {3.703524147348421*^9, 3.70352414930751*^9}, {
   3.7035248323526907`*^9, 3.7035248342670765`*^9}, 3.7035248733335547`*^9, 
   3.7035249640151196`*^9, {3.7036038737836237`*^9, 3.703603875319255*^9}, {
   3.7036086530928545`*^9, 3.7036086544593906`*^9}, {3.7036087014543476`*^9, 
   3.703608704175104*^9}, {3.703610055503646*^9, 3.7036100556286716`*^9}, {
   3.703610115648935*^9, 3.703610117549713*^9}, {3.703610158594226*^9, 
   3.7036101616058965`*^9}, {3.7036102451512833`*^9, 3.703610245401309*^9}, {
   3.7036103163292437`*^9, 3.703610316500459*^9}, {3.7036104516970577`*^9, 
   3.7036104521603866`*^9}, 3.7039414065616455`*^9, {3.7039429291565056`*^9, 
   3.703942929898025*^9}, {3.7039454848217554`*^9, 3.7039454852126107`*^9}, {
   3.7039456432733736`*^9, 3.70394564503203*^9}, {3.703945687429302*^9, 
   3.7039456888089523`*^9}, {3.7041981783075266`*^9, 3.704198179229902*^9}, {
   3.7041984388929377`*^9, 3.704198440629492*^9}, {3.7132798103674827`*^9, 
   3.7132798109456377`*^9}, {3.7132798812323017`*^9, 3.713279881404348*^9}, 
   3.718828326221363*^9, {3.7188285252355976`*^9, 3.7188285315739574`*^9}, {
   3.720809322919801*^9, 3.7208093327359*^9}, {3.7208094153444123`*^9, 
   3.7208094226708913`*^9}, {3.7208095203857727`*^9, 
   3.7208095205832973`*^9}, {3.721490517488619*^9, 3.7214905647309017`*^9}, {
   3.7214906099303427`*^9, 3.7214906196486225`*^9}, {3.7214906623397336`*^9, 
   3.72149067901336*^9}, {3.7214929141766624`*^9, 3.721492917804928*^9}, {
   3.721493913978365*^9, 3.7214939148379893`*^9}, {3.7219950371215515`*^9, 
   3.721995045925116*^9}, {3.721998544034895*^9, 3.721998555556568*^9}, {
   3.722008069389223*^9, 3.722008075317501*^9}, {3.722008234587409*^9, 
   3.7220082867737074`*^9}, {3.7220088862291956`*^9, 
   3.7220089209859114`*^9}, {3.722009310044792*^9, 3.722009316157277*^9}, {
   3.72200963701622*^9, 3.7220096375305204`*^9}, {3.7220098701909785`*^9, 
   3.7220098703160295`*^9}, {3.722560200209793*^9, 3.7225602263871884`*^9}, {
   3.7227908619407387`*^9, 3.722790862249206*^9}, {3.7289587478201957`*^9, 
   3.728958768214672*^9}, {3.7289588445155525`*^9, 3.728958878381192*^9}, {
   3.7289590680394545`*^9, 3.728959073433016*^9}, {3.728959127684125*^9, 
   3.728959147263362*^9}, {3.728959277815409*^9, 3.728959308190682*^9}, {
   3.7289602843615727`*^9, 3.728960306378829*^9}, {3.7289606668294516`*^9, 
   3.728960667856587*^9}, 3.728962226832712*^9, {3.728963518712943*^9, 
   3.72896353723915*^9}, {3.728963619311045*^9, 3.7289636538436785`*^9}, {
   3.728964520614499*^9, 3.728964527281468*^9}, {3.728964590871838*^9, 
   3.7289646090614657`*^9}, {3.728964670026601*^9, 3.7289648066388535`*^9}, {
   3.728993224232035*^9, 3.7289932535541415`*^9}, {3.7289936500462084`*^9, 
   3.728993652693243*^9}, {3.729015941781251*^9, 3.729015945419981*^9}, 
   3.7290253873081865`*^9, {3.7290254777608356`*^9, 3.7290254782088833`*^9}, {
   3.729029111802226*^9, 3.729029116085031*^9}, {3.729029337694167*^9, 
   3.7290293430707407`*^9}, {3.7290485587901983`*^9, 3.72904856057695*^9}, {
   3.7291124499065347`*^9, 3.7291124573788376`*^9}, {3.7291189578306036`*^9, 
   3.729119047899895*^9}, {3.7291198970603304`*^9, 3.729119900796731*^9}, {
   3.7291202441527996`*^9, 3.7291202501604986`*^9}, {3.7291283733178496`*^9, 
   3.729128390629987*^9}},
 ExpressionUUID -> "eccb0fde-28f5-4a39-bf59-111f011ccd44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"resistance", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resisb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"resistance", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"mindex", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resism", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"resistance", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", "tt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resisM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"resistance", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", "tt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rfreqb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        StyleBox[
         RowBox[{"resisb", "[", 
          RowBox[{"[", "i", "]"}], "]"}],
         FontWeight->"Bold"], 
        StyleBox["/",
         FontWeight->"Bold"], 
        RowBox[{"isolatesC", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{
     StyleBox["rfreqm",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"resism", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        RowBox[{"isolatesC", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{
     StyleBox["rfreqM",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"resisM", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        RowBox[{"isolatesC", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{"resb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"rfreqb", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{"resm", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"rfreqm", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"rfreqM", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"res", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"resistance", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "k", "]"}], "]"}], "/", 
        RowBox[{"isolatesC", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rfreq", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{
           RowBox[{"res", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.729120125205758*^9, 3.729120125392107*^9}, {
  3.7291283924294176`*^9, 3.7291284175138083`*^9}, {3.7292599521352415`*^9, 
  3.7292599565653296`*^9}, {3.7292612837045593`*^9, 3.729261285214563*^9}, {
  3.7292621618045177`*^9, 3.7292621621274166`*^9}, {3.7292626318305373`*^9, 
  3.7292626319971066`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["sampling",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.702408283660355*^9, 3.702408321599058*^9}, {
  3.702410509476049*^9, 3.7024105239317827`*^9}, {3.7262452360538282`*^9, 
  3.726245244174065*^9}, {3.7290253978943386`*^9, 3.7290254037037196`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"max", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "/", 
      RowBox[{"Total", "[", 
       RowBox[{"max", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fr0s", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{"fr0", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", "500"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"sample", " ", "from", " ", "r0"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pos", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"fr0", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"fr0s", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "500"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"take", " ", "positions", " ", "of", " ", "samples"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fkss", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fks", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"pos", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "500"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.729029155539231*^9, 3.7290291561943293`*^9}, {
   3.72902928830313*^9, 3.7290293327034154`*^9}, {3.7290296192615337`*^9, 
   3.7290296448479137`*^9}, {3.7290296756549478`*^9, 
   3.7290296969442425`*^9}, {3.7290495326721*^9, 3.7290495470152397`*^9}, {
   3.729082484124242*^9, 3.7290824959305925`*^9}, {3.7290825494845247`*^9, 
   3.7290825505615587`*^9}, {3.7291039810242367`*^9, 3.729103984480856*^9}, {
   3.7291040562393227`*^9, 3.7291040625562305`*^9}, {3.7291087792372255`*^9, 
   3.7291087796170464`*^9}, {3.729108883820481*^9, 3.729108907748885*^9}, {
   3.7291092692584324`*^9, 3.7291093065270014`*^9}, {3.729113026179309*^9, 
   3.7291130565811815`*^9}, {3.729113187578851*^9, 3.729113266932521*^9}, {
   3.7291133540832043`*^9, 3.7291133625408072`*^9}, {3.72911349759789*^9, 
   3.729113555679965*^9}, {3.7291136009382076`*^9, 3.7291136338412504`*^9}, {
   3.7291144497948084`*^9, 3.7291144981825094`*^9}, {3.7291145342771497`*^9, 
   3.729114593356372*^9}, {3.7291147079267244`*^9, 3.7291147304379473`*^9}, 
   3.7291190521060266`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["model projections",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7035094794637623`*^9, 3.7035094869978647`*^9}, {
  3.7262449554978848`*^9, 3.726244962314658*^9}, {3.72624524728148*^9, 
  3.726245247382464*^9}, {3.726245666355273*^9, 3.7262456674802165`*^9}, {
  3.726249447328065*^9, 3.7262494485353994`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["status quo consumption",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.703508588435497*^9, 3.7035085961604033`*^9}, {
   3.726245681554492*^9, 3.726245681777619*^9}, {3.7262460538847017`*^9, 
   3.7262460760735145`*^9}, 3.7262494512754974`*^9}],

Cell[TextData[{
 "assume linear trend of increasing consumption levels until end of \
projections ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["t", "f"]}], TraditionalForm]]],
 ")"
}], "Text",
 CellChangeTimes->{{3.703508618504487*^9, 3.70350870246686*^9}, {
  3.7035087755311627`*^9, 3.703508783329441*^9}, {3.703508931440913*^9, 
  3.70350893332882*^9}, {3.72624601264876*^9, 3.7262460258545628`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ti", "=", 
    RowBox[{
     RowBox[{"years", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "+", "1"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projections", " ", "begin", " ", "at", " ", "year", " ", 
    SubscriptBox["t", "i"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tf", " ", "=", "2040"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projection", " ", "until", " ", "year", " ", 
    SubscriptBox["t", "f"]}], "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyears", " ", "=", " ", 
    RowBox[{"Range", "[", " ", 
     RowBox[{"ti", ",", "tf"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "vector", " ", "of", " ", "years", " ", "from", " ", "ti", " ", "to", " ", 
    "tf"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nyears", " ", "=", " ", 
    RowBox[{"Length", "[", "pyears", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "of", " ", "years", " ", "to", " ", "project", " ", "across"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yvals", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"years", ",", "pyears"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"2000", "-", "2040"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpdata", " ", "=", " ", 
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{"years", ",", "carbcons"}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"CBP", " ", "consumption", " ", "data", " ", "by", " ", "year"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lm", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"LinearModelFit", "[", 
     RowBox[{"cbpdata", ",", "xy", ",", "xy"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cbpmodelfit", "[", "xy_", "]"}], "=", "lm"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "linear", " ", "fit", " ", "for", " ", "CBP", " ", "consumption", " ", 
    "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projSQ", " ", "=", 
    RowBox[{"cbpmodelfit", "[", "pyears", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "status", " ", "quo", " ", "projection", " ", "of", " ", "CBP", " ", 
    "consumption", " ", 
    RowBox[{"(", "total", ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpSQ", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"projSQ", "*", 
         RowBox[{"cbpp", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"conbreak", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", "inapp"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CBP", " ", "consumption"}], " ", "-", " ", 
    RowBox[{"status", " ", "quo"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.7024101570563507`*^9, {3.702410218390636*^9, 3.702410362817946*^9}, {
   3.702410394869886*^9, 3.7024103970699472`*^9}, {3.7024104362820168`*^9, 
   3.702410444877763*^9}, {3.702410485033464*^9, 3.702410497966292*^9}, {
   3.7024106015437107`*^9, 3.702410687478723*^9}, 3.702410887353681*^9, {
   3.7024109658707323`*^9, 3.702410969317919*^9}, {3.7024261213503265`*^9, 
   3.7024261280905967`*^9}, {3.7024263725653534`*^9, 3.702426380245617*^9}, {
   3.702426457971155*^9, 3.7024264932668233`*^9}, {3.7024293872030387`*^9, 
   3.7024293931895275`*^9}, {3.702429462175844*^9, 3.70242946525767*^9}, {
   3.702430121492141*^9, 3.7024301671103873`*^9}, {3.7024302762387476`*^9, 
   3.702430288760964*^9}, {3.702644820122126*^9, 3.702644895701531*^9}, 
   3.702644943830612*^9, 3.702645089788928*^9, {3.7026451707843*^9, 
   3.70264526906386*^9}, {3.702646860223049*^9, 3.702646868962504*^9}, {
   3.702649139296464*^9, 3.702649320466694*^9}, {3.702649365182232*^9, 
   3.702649404887587*^9}, {3.702651111455793*^9, 3.7026511124499407`*^9}, {
   3.7026511597468357`*^9, 3.702651164081389*^9}, {3.702651196198786*^9, 
   3.702651197694605*^9}, {3.702651273522381*^9, 3.702651376152687*^9}, {
   3.702651418053768*^9, 3.702651443400633*^9}, 3.702652454145401*^9, {
   3.7026525127209053`*^9, 3.702652515601593*^9}, 3.702652548364834*^9, {
   3.702652608636973*^9, 3.702652657849235*^9}, {3.702653096817143*^9, 
   3.702653125610446*^9}, {3.702653749523258*^9, 3.702653750928804*^9}, {
   3.702653950929109*^9, 3.702653951679988*^9}, {3.702654039324127*^9, 
   3.702654039419592*^9}, {3.7026543363477087`*^9, 3.702654341882617*^9}, {
   3.7026545090261793`*^9, 3.7026545134917192`*^9}, {3.702654545342651*^9, 
   3.702654545558536*^9}, {3.702654608693609*^9, 3.702654619161729*^9}, {
   3.702654668682192*^9, 3.702654671385303*^9}, {3.702654727962429*^9, 
   3.7026547324014072`*^9}, {3.702654776069682*^9, 3.702654787369268*^9}, {
   3.7026548624498568`*^9, 3.702654867864908*^9}, {3.70265639087677*^9, 
   3.702656394099745*^9}, {3.7026564282281523`*^9, 3.702656545027399*^9}, {
   3.7026565898351803`*^9, 3.702656628453731*^9}, {3.702656668626183*^9, 
   3.7026566753049593`*^9}, {3.702656819101117*^9, 3.70265682103613*^9}, {
   3.7026569967323914`*^9, 3.702657008143818*^9}, {3.7026571246398993`*^9, 
   3.702657126487445*^9}, {3.702657371432023*^9, 3.702657425054729*^9}, {
   3.7026576846030293`*^9, 3.7026576856582727`*^9}, {3.7026608953323927`*^9, 
   3.7026609089441843`*^9}, 3.702661089124311*^9, {3.702661204048341*^9, 
   3.702661205391203*^9}, {3.702661284675581*^9, 3.702661291750792*^9}, {
   3.7026613428193283`*^9, 3.702661349627429*^9}, {3.702661379802754*^9, 
   3.702661380058751*^9}, {3.7033456056961913`*^9, 3.70334561000235*^9}, {
   3.7033458050779953`*^9, 3.7033458083271484`*^9}, {3.7033459913971276`*^9, 
   3.7033459939106092`*^9}, {3.7033461681953135`*^9, 
   3.7033461712910085`*^9}, {3.7033463567537875`*^9, 
   3.7033463572654247`*^9}, {3.7035082338264885`*^9, 
   3.7035082471470747`*^9}, {3.7035087059971313`*^9, 3.703508734307201*^9}, {
   3.7035087669185963`*^9, 3.7035087692494555`*^9}, {3.703508805421707*^9, 
   3.703508839820469*^9}, {3.7035088853377066`*^9, 3.7035090491735573`*^9}, {
   3.7035091583001184`*^9, 3.7035091686386347`*^9}, {3.703509602488188*^9, 
   3.703509602707128*^9}, {3.703509656145857*^9, 3.703509657959392*^9}, {
   3.703509720346399*^9, 3.7035097520558357`*^9}, {3.7035136434461355`*^9, 
   3.703513644255722*^9}, {3.703515324001593*^9, 3.703515324190832*^9}, {
   3.7035153572111883`*^9, 3.7035153710902896`*^9}, {3.7035160023508244`*^9, 
   3.7035160105050383`*^9}, {3.703517141670616*^9, 3.703517142985299*^9}, {
   3.70351738400301*^9, 3.703517404497833*^9}, {3.703517456846857*^9, 
   3.70351745704605*^9}, {3.7035175648886843`*^9, 3.7035175650573587`*^9}, {
   3.7035176152258997`*^9, 3.703517615449293*^9}, {3.703518215269558*^9, 
   3.703518216913766*^9}, {3.703524715096772*^9, 3.7035247324833183`*^9}, {
   3.704196230212077*^9, 3.7041962380707293`*^9}, {3.7041963209995203`*^9, 
   3.704196321425269*^9}, {3.7041964119609237`*^9, 3.704196452236375*^9}, {
   3.7041964974847107`*^9, 3.7041965084028883`*^9}, {3.7141466287897124`*^9, 
   3.7141466352042933`*^9}, {3.718829196351863*^9, 3.718829253465877*^9}, {
   3.7188293469290233`*^9, 3.718829364498951*^9}, {3.718829422805379*^9, 
   3.7188294994078255`*^9}, {3.7188402620911055`*^9, 
   3.7188402624192715`*^9}, {3.7207950472392936`*^9, 3.720795047364275*^9}, {
   3.7208072123624816`*^9, 3.7208072128808603`*^9}, 3.7220091711485066`*^9, {
   3.722560342697755*^9, 3.72256034609943*^9}, {3.7225610430786324`*^9, 
   3.722561051537126*^9}, {3.722562468414258*^9, 3.7225624710237346`*^9}, {
   3.7225625416355686`*^9, 3.7225626724681463`*^9}, {3.7225629196816945`*^9, 
   3.7225629782528963`*^9}, {3.7225633452428217`*^9, 3.722563430276744*^9}, {
   3.722563494658048*^9, 3.722563495278005*^9}, {3.722563606318383*^9, 
   3.722563623743952*^9}, {3.722563661995595*^9, 3.7225636628879533`*^9}, {
   3.7225637923455095`*^9, 3.722563795370119*^9}, {3.722564571781474*^9, 
   3.722564574770585*^9}, {3.7225646422810173`*^9, 3.722564669162845*^9}, {
   3.722564743611783*^9, 3.7225647782358713`*^9}, {3.726238841946047*^9, 
   3.726238842483596*^9}, {3.726240190706023*^9, 3.7262402078716836`*^9}, {
   3.7262487894798417`*^9, 3.726248808759999*^9}},
 ExpressionUUID -> "a0c0b461-cf24-49a7-b2d1-dfdb7c4a7d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["intervention consumption",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.703509177309683*^9, 3.7035091785015554`*^9}, 
   3.7225634141858664`*^9, 3.726238857403862*^9, {3.7262456876529884`*^9, 
   3.726245689853446*^9}, {3.7262460578876004`*^9, 3.726246078966159*^9}, 
   3.726249458542785*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sy", "=", "2018"}], ";", " ", 
   RowBox[{"ey", "=", "2023"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"start", " ", "of", " ", "intervention"}], ",", " ", 
    RowBox[{
    "year", " ", "of", " ", "achieving", " ", "full", " ", "reduction"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sqyears", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"ti", ",", 
      RowBox[{"sy", "-", "1"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "status", " ", "quo", " ", "years", " ", "prior", " ", "to", " ", 
    "intervention", " ", "start"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ncy", "=", 
    RowBox[{"Length", "[", "sqyears", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "sq", " ", "years", " ", "before", " ", "beginning", " ", 
    "intervention"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"niy", "=", 
    RowBox[{"ey", "-", "sy", "+", "1"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "intervention", " ", "years", " ", "prior", " ", "to", " ", 
    "reaching", " ", "full", " ", "reduction"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projI", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{"ncy", "-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cbp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"cbp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "stw"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"cbp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "*", "stw"}], ")"}]}], "/", 
          RowBox[{"(", "niy", ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cbp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "stw"}], ")"}]}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{"nyears", "-", "ncy", "-", "niy"}], "]"}]}], "]"}]}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cbpI", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"projI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7024101570563507`*^9, {3.702410218390636*^9, 3.702410362817946*^9}, {
   3.702410394869886*^9, 3.7024103970699472`*^9}, {3.7024104362820168`*^9, 
   3.702410444877763*^9}, {3.702410485033464*^9, 3.702410497966292*^9}, {
   3.7024106015437107`*^9, 3.702410687478723*^9}, 3.702410887353681*^9, {
   3.7024109658707323`*^9, 3.702410969317919*^9}, {3.7024261213503265`*^9, 
   3.7024261280905967`*^9}, {3.7024263725653534`*^9, 3.702426380245617*^9}, {
   3.702426457971155*^9, 3.7024264932668233`*^9}, {3.7024293872030387`*^9, 
   3.7024293931895275`*^9}, {3.702429462175844*^9, 3.70242946525767*^9}, {
   3.702430121492141*^9, 3.7024301671103873`*^9}, {3.7024302762387476`*^9, 
   3.702430288760964*^9}, {3.702644820122126*^9, 3.702644895701531*^9}, 
   3.702644943830612*^9, 3.702645089788928*^9, {3.7026451707843*^9, 
   3.70264526906386*^9}, {3.702646860223049*^9, 3.702646868962504*^9}, {
   3.702649139296464*^9, 3.702649320466694*^9}, {3.702649365182232*^9, 
   3.702649404887587*^9}, {3.702651111455793*^9, 3.7026511124499407`*^9}, {
   3.7026511597468357`*^9, 3.702651164081389*^9}, {3.702651196198786*^9, 
   3.702651197694605*^9}, {3.702651273522381*^9, 3.702651376152687*^9}, {
   3.702651418053768*^9, 3.702651443400633*^9}, 3.702652454145401*^9, {
   3.7026525127209053`*^9, 3.702652515601593*^9}, 3.702652548364834*^9, {
   3.702652608636973*^9, 3.702652657849235*^9}, {3.702653096817143*^9, 
   3.702653125610446*^9}, {3.702653749523258*^9, 3.702653750928804*^9}, {
   3.702653950929109*^9, 3.702653951679988*^9}, {3.702654039324127*^9, 
   3.702654039419592*^9}, {3.7026543363477087`*^9, 3.702654341882617*^9}, {
   3.7026545090261793`*^9, 3.7026545134917192`*^9}, {3.702654545342651*^9, 
   3.702654545558536*^9}, {3.702654608693609*^9, 3.702654619161729*^9}, {
   3.702654668682192*^9, 3.702654671385303*^9}, {3.702654727962429*^9, 
   3.7026547324014072`*^9}, {3.702654776069682*^9, 3.702654787369268*^9}, {
   3.7026548624498568`*^9, 3.702654867864908*^9}, {3.70265639087677*^9, 
   3.702656394099745*^9}, {3.7026564282281523`*^9, 3.702656545027399*^9}, {
   3.7026565898351803`*^9, 3.702656628453731*^9}, {3.702656668626183*^9, 
   3.7026566753049593`*^9}, {3.702656819101117*^9, 3.70265682103613*^9}, {
   3.7026569967323914`*^9, 3.702657008143818*^9}, {3.7026571246398993`*^9, 
   3.702657126487445*^9}, {3.702657371432023*^9, 3.702657425054729*^9}, {
   3.7026576846030293`*^9, 3.7026576856582727`*^9}, {3.7026608953323927`*^9, 
   3.7026609089441843`*^9}, 3.702661089124311*^9, {3.702661204048341*^9, 
   3.702661205391203*^9}, {3.702661284675581*^9, 3.702661291750792*^9}, {
   3.7026613428193283`*^9, 3.702661349627429*^9}, {3.702661379802754*^9, 
   3.702661380058751*^9}, {3.7033456056961913`*^9, 3.70334561000235*^9}, {
   3.7033458050779953`*^9, 3.7033458083271484`*^9}, {3.7033459913971276`*^9, 
   3.7033459939106092`*^9}, {3.7033461681953135`*^9, 
   3.7033461712910085`*^9}, {3.7033463567537875`*^9, 
   3.7033463572654247`*^9}, {3.7035082338264885`*^9, 
   3.7035082471470747`*^9}, {3.7035087059971313`*^9, 3.703508734307201*^9}, {
   3.7035087669185963`*^9, 3.7035087692494555`*^9}, {3.703508805421707*^9, 
   3.703508839820469*^9}, {3.7035088853377066`*^9, 3.7035090491735573`*^9}, {
   3.7035091583001184`*^9, 3.7035091686386347`*^9}, {3.7035107380975866`*^9, 
   3.703510739164034*^9}, {3.703510930848754*^9, 3.70351099149683*^9}, {
   3.7035136106172495`*^9, 3.703513610754774*^9}, {3.703513742363851*^9, 
   3.7035137425128*^9}, {3.7035138143541393`*^9, 3.703513815425207*^9}, {
   3.70351386887615*^9, 3.703513965248187*^9}, {3.7035140660487466`*^9, 
   3.703514066580064*^9}, {3.7035152373321915`*^9, 3.703515308408615*^9}, {
   3.7035153419441814`*^9, 3.7035153851112537`*^9}, {3.703524283585355*^9, 
   3.7035242840850816`*^9}, {3.703524725073661*^9, 3.7035247251961956`*^9}, {
   3.7039377407464848`*^9, 3.7039377436080956`*^9}, {3.703943020524397*^9, 
   3.703943078199394*^9}, 3.703943316828333*^9, {3.7039434295423536`*^9, 
   3.7039434310270224`*^9}, {3.703943462979719*^9, 3.703943488672473*^9}, 
   3.703945122440321*^9, {3.7041965367300167`*^9, 3.7041965417697525`*^9}, {
   3.7136482204296927`*^9, 3.7136482270947514`*^9}, {3.7136483402910395`*^9, 
   3.713648359484461*^9}, 3.7136495073740664`*^9, {3.7188297222228003`*^9, 
   3.7188297356890836`*^9}, {3.718829781732129*^9, 3.7188297858617077`*^9}, {
   3.718829855297886*^9, 3.7188300088240232`*^9}, {3.7188300554791975`*^9, 
   3.7188300609921503`*^9}, {3.718838228521333*^9, 3.718838316562482*^9}, {
   3.718838457366002*^9, 3.7188385128141403`*^9}, {3.718838794705413*^9, 
   3.7188388078677073`*^9}, {3.7188388674465785`*^9, 3.718838942702777*^9}, {
   3.718839110692155*^9, 3.718839197853115*^9}, {3.718839255890061*^9, 
   3.718839289920641*^9}, {3.7188393265504537`*^9, 3.7188393359606256`*^9}, {
   3.718839428929613*^9, 3.7188394982783527`*^9}, {3.718839555483637*^9, 
   3.7188397015672064`*^9}, {3.718839738862632*^9, 3.7188397390657396`*^9}, {
   3.7188399622012606`*^9, 3.718839970257415*^9}, {3.7188400231418943`*^9, 
   3.7188400363880043`*^9}, {3.718840095531454*^9, 3.7188400976085405`*^9}, {
   3.7188402012199483`*^9, 3.718840201672966*^9}, {3.718840239664407*^9, 
   3.71884025961497*^9}, {3.7202011712667074`*^9, 3.7202012208637094`*^9}, 
   3.7202050826450586`*^9, {3.72020997735411*^9, 3.720209978495145*^9}, {
   3.72079802721357*^9, 3.7207980442093744`*^9}, 3.72079986649399*^9, 
   3.721998376064726*^9, {3.7225279884831944`*^9, 3.7225279886524*^9}, {
   3.7225280768290553`*^9, 3.7225280769932785`*^9}, {3.722528138717511*^9, 
   3.7225281750463514`*^9}, {3.7225282549911757`*^9, 3.722528271821331*^9}},
 ExpressionUUID -> "a0c0b461-cf24-49a7-b2d1-dfdb7c4a7d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["projected resistance frequencies",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7035155045659313`*^9, 3.7035155225031085`*^9}, 
   3.7035158752769194`*^9, {3.7262460704197855`*^9, 3.726246070698738*^9}, 
   3.7262494611496186`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"INITIALIZE", " ", "STORED", " ", "VALUES"}], "*)"}],
   FontWeight->"Bold"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nos", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     StyleBox["rSQ",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "nos", ",", "nos"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "status", " ", "quo"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rI", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "nos", ",", "nos"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "intervention"}], 
    "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.702656624595193*^9, 3.70265663463831*^9}, 
   3.7033447831113815`*^9, {3.7033449849882936`*^9, 3.7033449870707026`*^9}, {
   3.703515451649769*^9, 3.703515473290518*^9}, {3.7035155595203905`*^9, 
   3.703515685082728*^9}, {3.7035157432515965`*^9, 3.703515802176572*^9}, {
   3.7035159176168036`*^9, 3.7035159337037663`*^9}, {3.7035160501219788`*^9, 
   3.7035161139656773`*^9}, {3.7035161532168655`*^9, 3.70351620668676*^9}, {
   3.703516280376177*^9, 3.703516428656685*^9}, {3.703516497435608*^9, 
   3.7035164983504086`*^9}, {3.7035165309561834`*^9, 3.703516688172882*^9}, {
   3.703516769137375*^9, 3.703516828218351*^9}, {3.703517181626542*^9, 
   3.703517189108159*^9}, {3.703518444926235*^9, 3.7035184483422613`*^9}, {
   3.703518517615677*^9, 3.703518608012863*^9}, {3.7035186747767005`*^9, 
   3.7035187115422773`*^9}, {3.70351903666362*^9, 3.7035190699702806`*^9}, {
   3.70351911265419*^9, 3.7035191429602427`*^9}, {3.7035243858521786`*^9, 
   3.703524391647381*^9}, {3.7036037301810565`*^9, 3.703603742905409*^9}, {
   3.7036038213900967`*^9, 3.7036038561558275`*^9}, 3.703941183431985*^9, 
   3.7039422896846323`*^9, 3.703943483913226*^9, {3.7039452360363064`*^9, 
   3.7039452643340855`*^9}, 3.703945365860498*^9, {3.703947024971072*^9, 
   3.7039470263667407`*^9}, {3.7040338656944685`*^9, 3.704033884342639*^9}, {
   3.7042077184093065`*^9, 3.7042077193302183`*^9}, {3.7042077541226187`*^9, 
   3.704207768917225*^9}, {3.7042080345634203`*^9, 3.70420806400382*^9}, {
   3.7042081952744865`*^9, 3.7042082346858187`*^9}, 3.70420845637644*^9, {
   3.7042085503847275`*^9, 3.7042085516613026`*^9}, {3.7042086228821497`*^9, 
   3.7042086259920063`*^9}, {3.704208696037682*^9, 3.7042087087808523`*^9}, {
   3.704208785355607*^9, 3.7042088270032454`*^9}, {3.704212867152712*^9, 
   3.704212932676712*^9}, {3.7042130487576513`*^9, 3.7042130767047434`*^9}, {
   3.7042131943976526`*^9, 3.7042131961367793`*^9}, {3.7042137405002265`*^9, 
   3.704213760004231*^9}, {3.7042138375787573`*^9, 3.704213845834399*^9}, {
   3.7042139206490345`*^9, 3.7042139972932615`*^9}, {3.7042140916551704`*^9, 
   3.704214101039055*^9}, {3.7101328824617715`*^9, 3.7101328907375593`*^9}, {
   3.7132809828702126`*^9, 3.713281021486581*^9}, {3.713286973901414*^9, 
   3.7132869935900702`*^9}, {3.713287052666051*^9, 3.7132871144919367`*^9}, {
   3.7188303634394875`*^9, 3.7188303638349323`*^9}, {3.718830492463052*^9, 
   3.7188305166489286`*^9}, {3.7188305754065027`*^9, 
   3.7188305980326777`*^9}, {3.7188371116830025`*^9, 3.71883711225224*^9}, {
   3.718837236731703*^9, 3.7188372369969234`*^9}, {3.7188373288940926`*^9, 
   3.7188373550973196`*^9}, {3.718838044820858*^9, 3.7188380475086484`*^9}, {
   3.7188383883239055`*^9, 3.718838440994768*^9}, {3.7188390552601795`*^9, 
   3.7188390847987757`*^9}, {3.718844378069232*^9, 3.7188444569821467`*^9}, {
   3.718846713876641*^9, 3.718846720530072*^9}, {3.7219983914201884`*^9, 
   3.72199840774343*^9}, 3.7225284617346525`*^9, {3.7225290363261547`*^9, 
   3.722529036694713*^9}, {3.7225291076658516`*^9, 3.722529136647497*^9}, {
   3.7225291726960964`*^9, 3.7225292095541754`*^9}, {3.7262405069495983`*^9, 
   3.7262405323796234`*^9}, {3.726246092537933*^9, 3.7262462170249605`*^9}, {
   3.7262462491520395`*^9, 3.7262462523832397`*^9}, {3.726246328025806*^9, 
   3.7262463360752063`*^9}, {3.726246565164415*^9, 3.7262465657309823`*^9}, {
   3.726247347175177*^9, 3.726247424927148*^9}, {3.7262486349442196`*^9, 
   3.726248664122633*^9}, {3.7262516622333183`*^9, 3.7262516688397603`*^9}, {
   3.72910914020179*^9, 3.7291091471452627`*^9}, {3.7291094246145086`*^9, 
   3.729109429591915*^9}, {3.7291095972303696`*^9, 3.729109606989891*^9}, {
   3.7291111604281096`*^9, 3.7291111625100126`*^9}, {3.7291112182578*^9, 
   3.729111224048073*^9}, {3.7291112786795297`*^9, 3.729111282573516*^9}, {
   3.729111490480979*^9, 3.729111494452632*^9}, {3.7291153955864315`*^9, 
   3.729115396052495*^9}, {3.729116882555006*^9, 3.7291168851841373`*^9}},
 ExpressionUUID -> "eeb0ea7c-db8d-434c-8af1-fba84a2341bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"STATUS", " ", "QUO", " ", "PROJECTIONS"}], "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["For",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{"i", "=", "1"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["i",
        FontWeight->"Bold"], 
       StyleBox["\[LessEqual]",
        FontWeight->"Bold"], " ", 
       StyleBox["nop",
        FontWeight->"Bold"]}], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"i", "++"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"(*", 
        RowBox[{"#", " ", "pathogens"}], "*)"}],
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox["r0p",
         FontWeight->"Bold"], 
        StyleBox["=",
         FontWeight->"Bold"], 
        RowBox[{"fr0s", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ksp", "=", 
        RowBox[{"fkss", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"cbpSQ", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"rSQ", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"k", ",", 
              RowBox[{"r0p", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
              RowBox[{"ksp", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"tt", "+", "nyears"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "500"}], "}"}]}], "]"}]}]}], 
        "}"}]}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQm", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"rSQ", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", 
         RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"rSQM", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"rSQ", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", 
         RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"rSQ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", " ",
      "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQbest", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"k", ",", 
         RowBox[{"fr0b", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"fksb", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSQfill", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rSQm", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{"rSQM", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sqdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{"rSQbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2000", "-", "2040"}], ",", " ", 
     RowBox[{"no", " ", "uncertainty"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitS", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{
           RowBox[{"rSQfill", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"2000", "-", "2040"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.702656624595193*^9, 3.70265663463831*^9}, 
   3.7033447831113815`*^9, {3.7033449849882936`*^9, 3.7033449870707026`*^9}, {
   3.703515451649769*^9, 3.703515473290518*^9}, {3.7035155595203905`*^9, 
   3.703515685082728*^9}, {3.7035157432515965`*^9, 3.703515802176572*^9}, {
   3.7035159176168036`*^9, 3.7035159337037663`*^9}, {3.7035160501219788`*^9, 
   3.7035161139656773`*^9}, {3.7035161532168655`*^9, 3.70351620668676*^9}, {
   3.703516280376177*^9, 3.703516428656685*^9}, {3.703516497435608*^9, 
   3.7035164983504086`*^9}, {3.7035165309561834`*^9, 3.703516688172882*^9}, {
   3.703516769137375*^9, 3.703516828218351*^9}, {3.703517181626542*^9, 
   3.703517189108159*^9}, {3.703518444926235*^9, 3.7035184483422613`*^9}, {
   3.703518517615677*^9, 3.703518608012863*^9}, {3.7035186747767005`*^9, 
   3.7035187115422773`*^9}, {3.70351903666362*^9, 3.7035190699702806`*^9}, {
   3.70351911265419*^9, 3.7035191429602427`*^9}, {3.7035243858521786`*^9, 
   3.703524391647381*^9}, {3.7036037301810565`*^9, 3.703603742905409*^9}, {
   3.7036038213900967`*^9, 3.7036038561558275`*^9}, 3.703941183431985*^9, 
   3.7039422896846323`*^9, 3.703943483913226*^9, {3.7039452360363064`*^9, 
   3.7039452643340855`*^9}, 3.703945365860498*^9, {3.703947024971072*^9, 
   3.7039470263667407`*^9}, {3.7040338656944685`*^9, 3.704033884342639*^9}, {
   3.7042077184093065`*^9, 3.7042077193302183`*^9}, {3.7042077541226187`*^9, 
   3.704207768917225*^9}, {3.7042080345634203`*^9, 3.70420806400382*^9}, {
   3.7042081952744865`*^9, 3.7042082346858187`*^9}, 3.70420845637644*^9, {
   3.7042085503847275`*^9, 3.7042085516613026`*^9}, {3.7042086228821497`*^9, 
   3.7042086259920063`*^9}, {3.704208696037682*^9, 3.7042087087808523`*^9}, {
   3.704208785355607*^9, 3.7042088270032454`*^9}, {3.704212867152712*^9, 
   3.704212932676712*^9}, {3.7042130487576513`*^9, 3.7042130767047434`*^9}, {
   3.7042131943976526`*^9, 3.7042131961367793`*^9}, {3.7042137405002265`*^9, 
   3.704213760004231*^9}, {3.7042138375787573`*^9, 3.704213845834399*^9}, {
   3.7042139206490345`*^9, 3.7042139972932615`*^9}, {3.7042140916551704`*^9, 
   3.704214101039055*^9}, {3.7101328824617715`*^9, 3.7101328907375593`*^9}, {
   3.7132809828702126`*^9, 3.713281021486581*^9}, {3.713286973901414*^9, 
   3.7132869935900702`*^9}, {3.713287052666051*^9, 3.7132871144919367`*^9}, {
   3.7188303634394875`*^9, 3.7188303638349323`*^9}, {3.718830492463052*^9, 
   3.7188305166489286`*^9}, {3.7188305754065027`*^9, 
   3.7188305980326777`*^9}, {3.7188371116830025`*^9, 3.71883711225224*^9}, {
   3.718837236731703*^9, 3.7188372369969234`*^9}, {3.7188373288940926`*^9, 
   3.7188373550973196`*^9}, {3.718838044820858*^9, 3.7188380475086484`*^9}, {
   3.7188383883239055`*^9, 3.718838440994768*^9}, {3.7188390552601795`*^9, 
   3.7188390847987757`*^9}, {3.718844378069232*^9, 3.7188444569821467`*^9}, {
   3.718846713876641*^9, 3.718846720530072*^9}, {3.7219983914201884`*^9, 
   3.72199840774343*^9}, 3.7225284617346525`*^9, {3.7225290363261547`*^9, 
   3.722529036694713*^9}, {3.7225291076658516`*^9, 3.722529136647497*^9}, {
   3.7225291726960964`*^9, 3.7225292095541754`*^9}, {3.7262405069495983`*^9, 
   3.7262405323796234`*^9}, {3.726246092537933*^9, 3.7262462170249605`*^9}, {
   3.7262462491520395`*^9, 3.7262462523832397`*^9}, {3.726246328025806*^9, 
   3.7262463360752063`*^9}, {3.726246565164415*^9, 3.7262465657309823`*^9}, {
   3.726247347175177*^9, 3.726247424927148*^9}, 3.726247641309924*^9, 
   3.7262476855563493`*^9, {3.726247734745173*^9, 3.726247735235879*^9}, 
   3.726248948591551*^9, {3.7262489786686244`*^9, 3.726249036121557*^9}, {
   3.7262490835368347`*^9, 3.7262490937794075`*^9}, {3.7262493329809084`*^9, 
   3.726249410514642*^9}, {3.726251622233486*^9, 3.7262516547437778`*^9}, {
   3.726251911365012*^9, 3.726251927909552*^9}, {3.7263339181246495`*^9, 
   3.726333961075926*^9}, {3.7291092151681476`*^9, 3.72910922893272*^9}, {
   3.729109557389089*^9, 3.7291095910983925`*^9}, {3.729109666423749*^9, 
   3.7291097049017725`*^9}, 3.729109838826823*^9, {3.729110052447117*^9, 
   3.729110069019548*^9}, {3.7291103403205867`*^9, 3.729110360914575*^9}, {
   3.729110554276822*^9, 3.7291105928824687`*^9}, {3.729110625674959*^9, 
   3.7291106447065763`*^9}, {3.7291110876769075`*^9, 3.729111093187066*^9}, {
   3.7291111277928305`*^9, 3.7291111462618866`*^9}, {3.7291112075651445`*^9, 
   3.729111212725356*^9}, {3.7291112446141863`*^9, 3.7291113077931805`*^9}, {
   3.7291113469770184`*^9, 3.7291113575458493`*^9}, {3.729111485116587*^9, 
   3.7291115143428454`*^9}, {3.729113949716448*^9, 3.7291139589280243`*^9}, {
   3.729113998830544*^9, 3.729113999011567*^9}, {3.729114053027043*^9, 
   3.729114072858988*^9}, {3.729114178056237*^9, 3.729114178518894*^9}, {
   3.7291154141929197`*^9, 3.729115474779273*^9}, {3.729115528839506*^9, 
   3.7291155558104672`*^9}, {3.7291155977029266`*^9, 
   3.7291156730521593`*^9}, {3.729116012637045*^9, 3.7291160531760597`*^9}, {
   3.7291161361200523`*^9, 3.729116141214974*^9}, {3.729118909729664*^9, 
   3.7291189219746037`*^9}, {3.72911907869149*^9, 3.729119082965598*^9}, {
   3.729119166600572*^9, 3.72911923508523*^9}, {3.7291193250098276`*^9, 
   3.7291193737876124`*^9}, {3.7291199048133125`*^9, 3.729119909258649*^9}, {
   3.7291285389490676`*^9, 3.7291285743013515`*^9}},
 ExpressionUUID -> "eeb0ea7c-db8d-434c-8af1-fba84a2341bc"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", "INTERVENTION", "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["For",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{"i", "=", "1"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["i",
        FontWeight->"Bold"], 
       StyleBox["\[LessEqual]",
        FontWeight->"Bold"], " ", 
       StyleBox["nop",
        FontWeight->"Bold"]}], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"i", "++"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"(*", 
        RowBox[{"#", " ", "pathogens"}], "*)"}],
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox["r0p",
         FontWeight->"Bold"], 
        StyleBox["=",
         FontWeight->"Bold"], 
        RowBox[{"fr0s", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ksp", "=", 
        RowBox[{"fkss", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"cbpI", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"rI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"k", ",", 
              RowBox[{"r0p", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
              RowBox[{"ksp", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"tt", "+", "nyears"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "500"}], "}"}]}], "]"}]}]}], 
        "}"}]}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rIm", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"rI", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", 
         RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"rIM", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"rI", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1", ",", 
         RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"rI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", " ",
      "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rIbest", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"k", ",", 
         RowBox[{"fr0b", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"fksb", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rIfill", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rIm", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{"rIM", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"idata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{"rIbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2000", "-", "2040"}], ",", " ", 
     RowBox[{"no", " ", "uncertainty"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitI", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{
           RowBox[{"rIfill", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"2000", "-", "2040"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7291142638820424`*^9, 3.7291142727481775`*^9}, {
  3.7291144045156984`*^9, 3.729114408942769*^9}, {3.7291167564299183`*^9, 
  3.7291167573008757`*^9}, {3.729116875192153*^9, 3.729116875582811*^9}, {
  3.7291171150776615`*^9, 3.729117172420849*^9}, {3.729128590949171*^9, 
  3.7291285988877773`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"test", " ", "model", " ", "fits"}], ";", " ", 
    RowBox[{
     RowBox[{"calculated", " ", "p"}], "-", "values"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PearsonCorrelationTest", "[", 
    RowBox[{
     RowBox[{"rfreqb", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"rSQbest", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "tt"}], "]"}], "]"}], ",", 
     "\"\<TestDataTable\>\""}], "]"}], " ", 
   RowBox[{"(*", "PA", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"PearsonCorrelationTest", "[", 
    RowBox[{
     RowBox[{"rfreqb", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"rSQbest", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "tt"}], "]"}], "]"}], ",", 
     "\"\<TestDataTable\>\""}], "]"}], "  ", 
   RowBox[{"(*", "AB", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"PearsonCorrelationTest", "[", 
    RowBox[{
     RowBox[{"rfreqb", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"rSQbest", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "tt"}], "]"}], "]"}], ",", 
     "\"\<TestDataTable\>\""}], "]"}], "   ", 
   RowBox[{"(*", "KP", "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7242854248163495`*^9, 3.724285426774618*^9}, {
  3.7262457598673644`*^9, 3.726245766313583*^9}, {3.7262459848054447`*^9, 
  3.7262459954841337`*^9}, {3.7262492437373123`*^9, 3.7262492492446065`*^9}, {
  3.726249282128851*^9, 3.7262492947095327`*^9}, {3.7291172946179047`*^9, 
  3.7291173079156184`*^9}, {3.729119252570905*^9, 3.7291192640709963`*^9}}],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"\<\"Pearson Correlation\"\>", "0.7290522757735798`", 
      "0.0020441633604467843`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.729259853432046*^9, 3.729266221320118*^9, {3.72998251073479*^9, 
   3.7299825368186655`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "PearsonCorrelationTest","nortst",
   "\"At least one of the p-values in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0.4769923044980037`\\\", \\\",\\\", \
\\\"0.0003403238365187019`\\\"}], \\\"}\\\"}]\\), resulting from a test for \
normality, is below \\!\\(\\*RowBox[{\\\"0.025`\\\"}]\\). The tests in \\!\\(\
\\*RowBox[{\\\"{\\\", \\\"\\\\\\\"PearsonCorrelation\\\\\\\"\\\", \\\"}\\\"}]\
\\) require that the data is normally distributed.\"",2,211,37,
   26617585096421565271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.729259853494553*^9, 3.72926622135137*^9, {3.7299825107504168`*^9, 
   3.729982536834292*^9}}],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"\<\"Pearson Correlation\"\>", "0.7964029432863853`", 
      "0.0003807538430769449`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.729259853432046*^9, 3.729266221320118*^9, {3.72998251073479*^9, 
   3.7299825368655787`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "PearsonCorrelationTest","nortst",
   "\"At least one of the p-values in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0.008100641874962398`\\\", \\\",\\\", \\\"0.037345751340419175`\\\
\"}], \\\"}\\\"}]\\), resulting from a test for normality, is below \
\\!\\(\\*RowBox[{\\\"0.025`\\\"}]\\). The tests in \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"\\\\\\\"PearsonCorrelation\\\\\\\"\\\", \\\"}\
\\\"}]\\) require that the data is normally distributed.\"",2,212,38,
   26617585096421565271,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.729259853494553*^9, 3.72926622135137*^9, {3.7299825107504168`*^9, 
   3.7299825368655787`*^9}}],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"\<\"Pearson Correlation\"\>", "0.5873152049544168`", 
      "0.02133197522479212`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.729259853432046*^9, 3.729266221320118*^9, {3.72998251073479*^9, 
   3.7299825368811703`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["switch year",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.7134522765151215`*^9, 3.7134523005100126`*^9}, {
  3.7262496334654684`*^9, 3.726249635788082*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["mortality uncertainty",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7134525069481277`*^9, 3.713452512799042*^9}, {
  3.7262496584472046`*^9, 3.726249659404624*^9}, {3.726252160753993*^9, 
  3.726252160853113*^9}, {3.729128258775426*^9, 3.7291282603924828`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dataE", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "5", ",", "15"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7291287110097003`*^9, 3.729128711526395*^9}, {
   3.729135069975507*^9, 3.7291350712741723`*^9}, {3.7291352485018883`*^9, 
   3.7291352996324215`*^9}, 3.7291354298383427`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["calculating the switch year",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7134525069481277`*^9, 3.713452512799042*^9}, {
  3.7262496584472046`*^9, 3.726249659404624*^9}, {3.726252160753993*^9, 
  3.726252160853113*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yswitch", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", "nop"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"yswitch", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "*", 
          RowBox[{"mR", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}], "*", 
          RowBox[{"mS", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "\[Equal]", 
        RowBox[{"mA", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", "x"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yswitch", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"yswitch", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "set", " ", "mortality", " ", "from", " ", "CBP", " ", "equal", " ", "to", 
    " ", "mortality", " ", "from", " ", "alternative", " ", "to", " ", 
    "solve", " ", "for", " ", "resistance", " ", "where", " ", "we", " ", 
    "need", " ", "to", " ", "switch", " ", "prescription"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.720209468568576*^9, 3.720209474152439*^9}, {
   3.7202095088553944`*^9, 3.72020959459009*^9}, {3.7202096248538246`*^9, 
   3.720209626416975*^9}, 3.7207954697277613`*^9, {3.720800170427697*^9, 
   3.7208001876189876`*^9}, {3.720800232770626*^9, 3.720800233819287*^9}, {
   3.7256388275901504`*^9, 3.7256389452382607`*^9}, {3.7256390279339247`*^9, 
   3.725639034866147*^9}, {3.7256391221802936`*^9, 3.725639123010331*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["applying the switch year",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.7134548988412075`*^9, 3.7134549044894447`*^9}, {
  3.726249677102138*^9, 3.726249677261724*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["indexing",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.7141469210484486`*^9, 3.7141469241128535`*^9}, {
  3.7262496864617863`*^9, 3.726249687156872*^9}}],

Cell["determining switch year coordinates (year, resistance freq)", "Text",
 CellChangeTimes->{{3.726249802848733*^9, 3.726249811933242*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"STATUS", " ", "QUO"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ySQinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"rSQbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"yswitch", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ySQinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ySQinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ySQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "0.85"}], "\[LessEqual]", 
          " ", 
          RowBox[{"ySQinit", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "1.15"}]}], ",", 
         RowBox[{"ySQinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"switch", " ", "point", " ", "y", " ", "value"}], ";", " ", 
     RowBox[{
     "excluding", " ", "values", " ", "that", " ", "have", " ", "not", " ", 
      "yet", " ", "reached", " ", "the", " ", "switch", " ", "point", " ", 
      "in", " ", "our", " ", "projections"}]}], "*)"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSQpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"rSQbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"ySQinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSQpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"xSQpos", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSQ", "=", 
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", "1", "+", "xSQpos"}]}], ";"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{"switch", " ", "point", " ", "x", " ", "value"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7134584280589156`*^9, 3.713458766864848*^9}, {
   3.713458807481724*^9, 3.7134588157285123`*^9}, 3.713459280553359*^9, 
   3.7134594926657257`*^9, {3.71345985778963*^9, 3.7134598608429728`*^9}, {
   3.713631764127009*^9, 3.7136317919407253`*^9}, {3.7136318308451767`*^9, 
   3.713631914624951*^9}, {3.713631962504418*^9, 3.713632041110547*^9}, {
   3.7136320723317204`*^9, 3.713632106136525*^9}, {3.7136323189449387`*^9, 
   3.7136323851551075`*^9}, {3.7136329702760115`*^9, 
   3.7136329734341593`*^9}, {3.7136330081759253`*^9, 3.7136333351377907`*^9}, 
   3.713633382126835*^9, {3.7136334475945253`*^9, 3.7136339165083127`*^9}, {
   3.7136339854062247`*^9, 3.713633997800308*^9}, {3.7136340581635714`*^9, 
   3.7136340891697273`*^9}, {3.7136341307507505`*^9, 
   3.7136341771997766`*^9}, {3.71363422417024*^9, 3.713634246860915*^9}, {
   3.71363439414433*^9, 3.7136343942068596`*^9}, {3.7136344634701324`*^9, 
   3.713634494902569*^9}, {3.713645308145779*^9, 3.7136453085020466`*^9}, 
   3.7136453542422223`*^9, {3.713648525408132*^9, 3.7136486110030394`*^9}, {
   3.7141413778983626`*^9, 3.7141413979441977`*^9}, {3.7141414288252096`*^9, 
   3.714141470905487*^9}, {3.7141416152211657`*^9, 3.7141416239699564`*^9}, {
   3.7141417045734463`*^9, 3.7141417198182125`*^9}, {3.714141980321491*^9, 
   3.714142015487296*^9}, {3.714142064498788*^9, 3.7141420645770235`*^9}, {
   3.7141421492226477`*^9, 3.7141421493726635`*^9}, {3.71414222735497*^9, 
   3.7141422475298853`*^9}, {3.7141423211217337`*^9, 
   3.7141423214176517`*^9}, {3.714145624343717*^9, 3.7141456468676205`*^9}, {
   3.7141458008028965`*^9, 3.714145851335739*^9}, {3.71414616021764*^9, 
   3.7141461613731065`*^9}, {3.7141473123918686`*^9, 3.714147497908945*^9}, {
   3.7141475315817833`*^9, 3.7141475323652773`*^9}, {3.714147643678943*^9, 
   3.714147643900504*^9}, {3.7141502517204823`*^9, 3.714150267373786*^9}, {
   3.7202036967021685`*^9, 3.7202037076949034`*^9}, {3.7202037807239456`*^9, 
   3.720203826915698*^9}, {3.720203945271983*^9, 3.7202040272992535`*^9}, {
   3.7202045727805595`*^9, 3.7202045729851*^9}, {3.720204697273621*^9, 
   3.7202047280503826`*^9}, {3.720204985457324*^9, 3.720205011547507*^9}, {
   3.720209633875821*^9, 3.7202096457935324`*^9}, 3.7202098559997363`*^9, {
   3.7207957820602098`*^9, 3.7207958146575255`*^9}, {3.7207958597692804`*^9, 
   3.7207960201404266`*^9}, {3.7207960753391104`*^9, 
   3.7207961007072115`*^9}, {3.7207964795478544`*^9, 
   3.7207964843629093`*^9}, {3.720797248611517*^9, 3.7207972511573825`*^9}, {
   3.7208003244015765`*^9, 3.720800336483694*^9}, {3.720800434764969*^9, 
   3.720800489097722*^9}, {3.7225294155021644`*^9, 3.722529460318919*^9}, {
   3.7225294961707935`*^9, 3.722529504316861*^9}, {3.7225295450661883`*^9, 
   3.722529668626982*^9}, {3.7225297304361706`*^9, 3.722529823671062*^9}, {
   3.722529993427544*^9, 3.722530034955288*^9}, {3.7225300694530907`*^9, 
   3.72253008433576*^9}, {3.7225301203529167`*^9, 3.7225301231729317`*^9}, {
   3.722530153376381*^9, 3.7225301544248238`*^9}, {3.7225301950355844`*^9, 
   3.722530196165636*^9}, {3.722530292488182*^9, 3.722530293220454*^9}, {
   3.7225304314314656`*^9, 3.7225304613618875`*^9}, {3.722530550600855*^9, 
   3.722530551601328*^9}, {3.72253066820481*^9, 3.7225306697925053`*^9}, {
   3.7225307801775074`*^9, 3.7225307816855326`*^9}, {3.722791565480418*^9, 
   3.7227916095191107`*^9}, {3.7251363205699487`*^9, 3.725136337792056*^9}, {
   3.725136375436524*^9, 3.7251364186274242`*^9}, {3.7251370022277136`*^9, 
   3.725137003182129*^9}, {3.725137145577628*^9, 3.725137210019928*^9}, {
   3.7256391473478994`*^9, 3.7256391486353264`*^9}, {3.7262414320664997`*^9, 
   3.7262414334674077`*^9}, {3.7262417275164227`*^9, 
   3.7262417457701116`*^9}, {3.7262418321969395`*^9, 3.726241835722521*^9}, {
   3.726242153211757*^9, 3.7262421855282493`*^9}, {3.72624287641317*^9, 
   3.726242877322575*^9}, {3.726249710714135*^9, 3.726249712404219*^9}, {
   3.7262497560439806`*^9, 3.7262498155116987`*^9}, {3.726249875922388*^9, 
   3.726249878469741*^9}, {3.726250183253683*^9, 3.7262502839571357`*^9}, 
   3.7262503719020443`*^9, {3.726251739946997*^9, 3.726251755070236*^9}, {
   3.7268433379648914`*^9, 3.7268433382071495`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "INTERVENTION", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"yIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"rIbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"yswitch", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"yIinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "0.85"}], "\[LessEqual]", 
          " ", 
          RowBox[{"yIinit", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"yswitch", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "1.15"}]}], ",", 
         RowBox[{"yIinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", "yval", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xIpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"rIbest", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"yIinit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"2014", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xIpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"xIpos", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xI", "=", 
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}], "+", "xIpos"}]}], ";"}], " ", 
   RowBox[{"(*", "xval", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"JOIN", " ", "VALUES", " ", "FOR", " ", "EXPORT", " ", "LATER"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sySQ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xSQ", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ySQ", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"syI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"yI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7134584280589156`*^9, 3.713458766864848*^9}, {
   3.713458807481724*^9, 3.7134588157285123`*^9}, 3.713459280553359*^9, 
   3.7134594926657257`*^9, {3.71345985778963*^9, 3.7134598608429728`*^9}, {
   3.713631764127009*^9, 3.7136317919407253`*^9}, {3.7136318308451767`*^9, 
   3.713631914624951*^9}, {3.713631962504418*^9, 3.713632041110547*^9}, {
   3.7136320723317204`*^9, 3.713632106136525*^9}, {3.7136323189449387`*^9, 
   3.7136323851551075`*^9}, {3.7136329702760115`*^9, 
   3.7136329734341593`*^9}, {3.7136330081759253`*^9, 3.7136333351377907`*^9}, 
   3.713633382126835*^9, {3.7136334475945253`*^9, 3.7136339165083127`*^9}, {
   3.7136339854062247`*^9, 3.713633997800308*^9}, {3.7136340581635714`*^9, 
   3.7136340891697273`*^9}, {3.7136341307507505`*^9, 
   3.7136341771997766`*^9}, {3.71363422417024*^9, 3.713634246860915*^9}, {
   3.71363439414433*^9, 3.7136343942068596`*^9}, {3.7136344634701324`*^9, 
   3.713634494902569*^9}, {3.713645308145779*^9, 3.7136453085020466`*^9}, 
   3.7136453542422223`*^9, {3.713648525408132*^9, 3.7136486110030394`*^9}, {
   3.7141413778983626`*^9, 3.7141413979441977`*^9}, {3.7141414288252096`*^9, 
   3.714141470905487*^9}, {3.7141416152211657`*^9, 3.7141416239699564`*^9}, {
   3.7141417045734463`*^9, 3.7141417198182125`*^9}, {3.714141980321491*^9, 
   3.714142015487296*^9}, {3.714142064498788*^9, 3.7141420645770235`*^9}, {
   3.7141421492226477`*^9, 3.7141421493726635`*^9}, {3.71414222735497*^9, 
   3.7141422475298853`*^9}, {3.7141423211217337`*^9, 
   3.7141423214176517`*^9}, {3.714145624343717*^9, 3.7141456468676205`*^9}, {
   3.7141458008028965`*^9, 3.714145851335739*^9}, {3.71414616021764*^9, 
   3.7141461613731065`*^9}, {3.7141473123918686`*^9, 3.714147497908945*^9}, {
   3.7141475315817833`*^9, 3.7141475323652773`*^9}, {3.714147643678943*^9, 
   3.714147643900504*^9}, {3.7141502517204823`*^9, 3.714150267373786*^9}, {
   3.7202036967021685`*^9, 3.7202037076949034`*^9}, {3.7202037807239456`*^9, 
   3.720203826915698*^9}, {3.720203945271983*^9, 3.7202040272992535`*^9}, {
   3.7202045727805595`*^9, 3.7202045729851*^9}, {3.720204697273621*^9, 
   3.7202047280503826`*^9}, {3.720204985457324*^9, 3.720205011547507*^9}, {
   3.720209633875821*^9, 3.7202096457935324`*^9}, 3.7202098559997363`*^9, {
   3.7207957820602098`*^9, 3.7207958146575255`*^9}, {3.7207958597692804`*^9, 
   3.7207960201404266`*^9}, {3.7207960753391104`*^9, 
   3.7207961007072115`*^9}, {3.7207964795478544`*^9, 
   3.7207964843629093`*^9}, {3.720797248611517*^9, 3.7207972511573825`*^9}, {
   3.7208003244015765`*^9, 3.720800336483694*^9}, {3.720800434764969*^9, 
   3.720800489097722*^9}, {3.7225294155021644`*^9, 3.722529460318919*^9}, {
   3.7225294961707935`*^9, 3.722529504316861*^9}, {3.7225295450661883`*^9, 
   3.722529668626982*^9}, {3.7225297304361706`*^9, 3.722529823671062*^9}, {
   3.722529993427544*^9, 3.722530034955288*^9}, {3.7225300694530907`*^9, 
   3.72253008433576*^9}, {3.7225301203529167`*^9, 3.7225301231729317`*^9}, {
   3.722530153376381*^9, 3.7225301544248238`*^9}, {3.7225301950355844`*^9, 
   3.722530196165636*^9}, {3.722530292488182*^9, 3.722530293220454*^9}, {
   3.7225304314314656`*^9, 3.7225304613618875`*^9}, {3.722530550600855*^9, 
   3.722530551601328*^9}, {3.72253066820481*^9, 3.7225306697925053`*^9}, {
   3.7225307801775074`*^9, 3.7225307816855326`*^9}, {3.722791565480418*^9, 
   3.7227916095191107`*^9}, {3.7251363205699487`*^9, 3.725136337792056*^9}, {
   3.725136375436524*^9, 3.7251364186274242`*^9}, {3.7251370022277136`*^9, 
   3.725137003182129*^9}, {3.725137145577628*^9, 3.7251372182656493`*^9}, {
   3.7251373012715445`*^9, 3.725137301543909*^9}, {3.725639157552537*^9, 
   3.725639166993535*^9}, {3.725639314222226*^9, 3.725639319349864*^9}, {
   3.726241944376091*^9, 3.7262419676690936`*^9}, {3.726242000603204*^9, 
   3.7262420055503225`*^9}, {3.7262420730841384`*^9, 3.726242073202569*^9}, {
   3.7262421875157948`*^9, 3.7262421882764335`*^9}, {3.7262502867435017`*^9, 
   3.7262503025200534`*^9}, {3.726250397804761*^9, 3.726250479581321*^9}, {
   3.726251971120058*^9, 3.7262519782587748`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["steady state",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.725639587747517*^9, 3.7256396037787504`*^9}, {
  3.7262506340844374`*^9, 3.72625066618869*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["consumption",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.726250710395259*^9, 3.7262507219669714`*^9}}],

Cell["constant consumption/resistance after the switch year", "Text",
 CellChangeTimes->{3.726250952839876*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ny", "=", "2"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "years", " ", "to", " ", "get", " ", "to", " ", 
    "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rise", "=", "1.01"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "rise", " ", "in", " ", "consumption", " ", "until", " ", "reaching", " ", 
    "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syi", "=", " ", 
    RowBox[{"Round", "[", 
     RowBox[{"xSQpos", "-", 
      RowBox[{"(", 
       RowBox[{"ti", "-", 
        RowBox[{"years", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "index", " ", "of", " ", "switch", " ", "year", " ", "for", " ", "2015"}],
     "-", 
    RowBox[{"2040", " ", "vector"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syi", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"syi", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ">", "0"}], ",", 
        RowBox[{"syi", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Round", "[", 
         RowBox[{"sy", "-", "ti", "+", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "switch", " ", "point", " ", "is", " ", "in", " ", "the", " ", 
    "past", " ", "then", " ", "start", " ", "to", " ", "apply", " ", "steady",
     " ", "state", " ", "at", " ", "sy"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projSS", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tf", "-", 
          RowBox[{"years", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "-", "ny"}], ">", 
         RowBox[{"syi", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"projSQ", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"syi", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"projSQ", "[", 
             RowBox[{"[", 
              RowBox[{"syi", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"projSQ", "[", 
              RowBox[{"[", 
               RowBox[{"syi", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "*", "rise"}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"projSQ", "[", 
                 RowBox[{"[", 
                  RowBox[{"syi", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "*", 
                "rise"}], "-", 
               RowBox[{"projSQ", "[", 
                RowBox[{"[", 
                 RowBox[{"syi", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"ny", "-", "1"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"projSQ", "[", 
              RowBox[{"[", 
               RowBox[{"syi", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "*", "rise"}], 
            ",", 
            RowBox[{"Round", "[", 
             RowBox[{"tf", "-", "ti", "+", "1", "-", 
              RowBox[{"syi", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", "ny"}], "]"}]}], "]"}]}], 
         "]"}], ",", "projSQ"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "switch", " ", "point", " ", "is", " ", "after", " ", "2038", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "would"}], " ", "not", " ", "reach", 
      " ", "steady", " ", "state", " ", "in", " ", "projections"}], ")"}], 
    "then", " ", "leave", " ", "cbp", " ", "consumption", " ", "unaltered"}], 
   "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cbpSS", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"projSS", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"cbpp", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"conbreak", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "*", "inapp"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CBP", " ", "consumption", " ", "2015"}], "-", 
    RowBox[{
    "2040", " ", "with", " ", "constant", " ", "consumption", " ", "after", 
     " ", "switch", " ", "year"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7251289067181563`*^9, 3.7251290017046423`*^9}, {
   3.72512917356564*^9, 3.725129321148529*^9}, {3.725133660740316*^9, 
   3.7251336641110373`*^9}, {3.7251341087522545`*^9, 
   3.7251341131258917`*^9}, {3.725134146881181*^9, 3.7251341518243294`*^9}, {
   3.7251343430672197`*^9, 3.72513437220872*^9}, {3.725134408400887*^9, 
   3.7251344394231043`*^9}, {3.7251345245764294`*^9, 3.725134528270133*^9}, {
   3.7251355836040545`*^9, 3.7251356218464375`*^9}, 3.725135754529772*^9, {
   3.7251359070651093`*^9, 3.7251359071694613`*^9}, {3.725135940062811*^9, 
   3.7251359663836036`*^9}, {3.7251361381087213`*^9, 
   3.7251361385060225`*^9}, {3.7251374297894044`*^9, 
   3.7251374343144035`*^9}, {3.7251374860194445`*^9, 
   3.7251374865340576`*^9}, {3.7251376046751313`*^9, 
   3.7251376443739443`*^9}, {3.725137703884145*^9, 3.7251378221332903`*^9}, {
   3.7251434917498045`*^9, 3.7251434918593807`*^9}, {3.7262439026475134`*^9, 
   3.7262439038041463`*^9}, {3.726243950741517*^9, 3.7262439520611286`*^9}, {
   3.726244016440898*^9, 3.726244068188442*^9}, {3.7262507276341877`*^9, 
   3.726250727922593*^9}, {3.7262599276509*^9, 3.7262599304347925`*^9}, {
   3.7262599651189003`*^9, 3.7262600880165005`*^9}, {3.726260188779896*^9, 
   3.726260273660551*^9}, {3.7262603566537495`*^9, 3.7262603719961123`*^9}, {
   3.7262604083819413`*^9, 3.7262604689693923`*^9}, {3.726260507545828*^9, 
   3.726260552171982*^9}, {3.7262605993317175`*^9, 3.7262606268601627`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["projections",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.726250710395259*^9, 3.7262507219669714`*^9}, {
  3.7262507812210274`*^9, 3.7262507820510893`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"INITIALIZE", " ", "STORED", " ", "VALUES"}], "*)"}],
   FontWeight->"Bold"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["rSS",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"{", 
        RowBox[{"nop", ",", "nos"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "status", " ", "quo"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSSbest", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "resistance", " ", "projections", " ", "for", " ", "SQ", " ", "with", " ",
      "best", " ", "fit"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rSSm", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";", 
    RowBox[{"rSSM", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "nop"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"min", " ", "and", " ", "max"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   RowBox[{"(*", "PROJECTIONS", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     StyleBox["For",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{"i", "=", "1"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["i",
        FontWeight->"Bold"], 
       StyleBox["\[LessEqual]",
        FontWeight->"Bold"], " ", 
       StyleBox["nop",
        FontWeight->"Bold"]}], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"i", "++"}],
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"(*", 
        RowBox[{"#", " ", "pathogens"}], "*)"}],
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox["r0p",
         FontWeight->"Bold"], 
        StyleBox[" ",
         FontWeight->"Bold"], 
        StyleBox["=",
         FontWeight->"Bold"], 
        RowBox[{"r0CI", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"ksp", " ", "=", " ", 
        RowBox[{"ksCI", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "save", " ", "95", "%", " ", "CI", " ", "parameters", " ", "for", " ",
          "each", " ", "pathogen"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", "nos"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iso", "=", 
            RowBox[{"isolates", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            StyleBox["resis",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            StyleBox["=",
             FontWeight->"Plain"], 
            StyleBox[" ",
             FontWeight->"Plain"], 
            RowBox[{"resistance", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"a", " ", "=", " ", 
            RowBox[{"cbpSS", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"rSS", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"k", ",", 
                RowBox[{"r0p", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                RowBox[{"ksp", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
        "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rSSm", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"rSS", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"rSSM", " ", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"rSS", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "r", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "generate", " ", "model", " ", "outputs", " ", "for", " ", "sampled", 
         " ", "parameter", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rSSbest", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"k", ",", 
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rSSfill", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rSSm", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"rSSM", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "nop"}], "}"}]}], "]"}]}]}]}], "]"}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{"2000", "-", "2040"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{"rSSbest", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitSS", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"yvals", ",", 
          RowBox[{
           RowBox[{"rSSfill", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.725133658106213*^9, 3.725133658306497*^9}, {
  3.725133751397529*^9, 3.7251337663776298`*^9}, {3.725134002651643*^9, 
  3.7251341019105053`*^9}, {3.725134167201734*^9, 3.7251342247929263`*^9}, {
  3.725135750649969*^9, 3.725135756932887*^9}, {3.7256396974467344`*^9, 
  3.725639701587803*^9}, {3.7262441150008173`*^9, 3.726244139879402*^9}, {
  3.7262441711630883`*^9, 3.7262441860993176`*^9}, {3.7262442178561287`*^9, 
  3.726244219615264*^9}, {3.7262442686676674`*^9, 3.7262442725228677`*^9}, {
  3.726250961332518*^9, 3.726250976708639*^9}, {3.7262510186521387`*^9, 
  3.726251104581026*^9}, {3.726251152607335*^9, 3.726251153104614*^9}, {
  3.7262520061968*^9, 3.726252138991432*^9}, {3.7263601773392353`*^9, 
  3.726360203025037*^9}, {3.7263602606920953`*^9, 3.7263602654904346`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["export data",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.725639587747517*^9, 3.7256396037787504`*^9}, {
  3.7262506340844374`*^9, 3.72625066618869*^9}, {3.726251205518097*^9, 
  3.7262512076083922`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<sepsis output.xlsx\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<raw data\>\"", "\[Rule]", " ", "rfreq"}], ",", " ", 
       RowBox[{"\"\<SQ+band\>\"", " ", "\[Rule]", " ", "fitS"}], ",", 
       RowBox[{"\"\<I+band\>\"", "\[Rule]", " ", "fitI"}], ",", 
       RowBox[{"\"\<SQ\>\"", "\[Rule]", " ", "sqdata"}], ",", " ", 
       RowBox[{"\"\<I\>\"", "\[Rule]", " ", "idata"}], ",", " ", 
       RowBox[{"\"\<SS+band\>\"", "\[Rule]", " ", "fitSS"}], ",", " ", 
       RowBox[{"\"\<SS\>\"", "\[Rule]", " ", "ssdata"}], ",", " ", 
       RowBox[{"\"\<SQ switch year\>\"", "\[Rule]", " ", "sySQ"}], ",", 
       RowBox[{"\"\<I switch year\>\"", "\[Rule]", " ", "syI"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.726237399854079*^9, 3.7262374186065645`*^9}, {
   3.72623746542581*^9, 3.7262374679083056`*^9}, {3.7262512207423286`*^9, 
   3.7262512212386293`*^9}, {3.726252173172405*^9, 3.726252355857831*^9}, 
   3.726252391682102*^9, {3.726259587311105*^9, 3.7262595877543015`*^9}, {
   3.7292659229578934`*^9, 3.7292659234591265`*^9}, {3.7299825189930315`*^9, 
   3.729982524937338*^9}}]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{638, 628},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
SpellingDictionaries->{"CorrectWords"->{
 "quo", "Formulary", "ntv,", "ey", "intv"}},
Magnification:>0.85 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 386, 6, 86, "Title"],
Cell[CellGroupData[{
Cell[991, 32, 232, 4, 60, "Section"],
Cell[CellGroupData[{
Cell[1248, 40, 276, 5, 42, "Subsection"],
Cell[1527, 47, 301, 6, 44, "Text"],
Cell[1831, 55, 1229, 27, 94, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3097, 87, 264, 5, 42, "Subsection"],
Cell[3364, 94, 163, 4, 44, "Text"],
Cell[3530, 100, 14667, 354, 485, "Input"],
Cell[CellGroupData[{
Cell[18222, 458, 228, 3, 33, "Subsubsection"],
Cell[18453, 463, 214, 4, 44, "Text"],
Cell[18670, 469, 5254, 133, 366, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23985, 609, 608, 9, 60, "Section"],
Cell[CellGroupData[{
Cell[24618, 622, 288, 5, 42, "Subsection"],
Cell[24909, 629, 1639, 48, 97, "Text"],
Cell[26551, 679, 9980, 187, 153, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36568, 871, 313, 5, 42, "Subsection"],
Cell[36884, 878, 325, 10, 26, "Text"],
Cell[37212, 890, 9006, 180, 196, "Input"],
Cell[46221, 1072, 7381, 135, 111, "Input"],
Cell[53605, 1209, 5698, 173, 264, "Input"],
Cell[CellGroupData[{
Cell[59328, 1386, 314, 5, 33, "Subsubsection"],
Cell[59645, 1393, 3320, 86, 128, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63014, 1485, 370, 6, 42, "Subsection"],
Cell[CellGroupData[{
Cell[63409, 1495, 306, 5, 33, "Subsubsection"],
Cell[63718, 1502, 421, 11, 26, "Text"],
Cell[64142, 1515, 8679, 172, 230, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72858, 1692, 356, 6, 33, "Subsubsection"],
Cell[73217, 1700, 9290, 183, 247, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82544, 1888, 294, 5, 33, "Subsubsection"],
Cell[82841, 1895, 5144, 88, 128, "Input"],
Cell[87988, 1985, 11224, 250, 315, "Input"],
Cell[99215, 2237, 6142, 182, 332, "Input"],
Cell[CellGroupData[{
Cell[105382, 2423, 1798, 46, 145, "Input"],
Cell[107183, 2471, 757, 18, 37, "Output"],
Cell[107943, 2491, 676, 13, 34, "Message"],
Cell[108622, 2506, 757, 18, 37, "Output"],
Cell[109382, 2526, 679, 13, 34, "Message"],
Cell[110064, 2541, 755, 18, 37, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110892, 2567, 192, 3, 60, "Section"],
Cell[CellGroupData[{
Cell[111109, 2574, 322, 5, 42, "Subsection"],
Cell[111434, 2581, 478, 12, 25, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111949, 2598, 280, 5, 42, "Subsection"],
Cell[112232, 2605, 2163, 57, 111, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114432, 2667, 228, 4, 42, "Subsection"],
Cell[CellGroupData[{
Cell[114685, 2675, 217, 4, 33, "Subsubsection"],
Cell[114905, 2681, 141, 1, 26, "Text"],
Cell[115049, 2684, 7369, 150, 196, "Input"],
Cell[122421, 2836, 8002, 172, 230, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130484, 3015, 190, 3, 60, "Section"],
Cell[CellGroupData[{
Cell[130699, 3022, 164, 3, 42, "Subsection"],
Cell[130866, 3027, 111, 1, 26, "Text"],
Cell[130980, 3030, 6974, 177, 366, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137991, 3212, 217, 4, 42, "Subsection"],
Cell[138211, 3218, 8597, 238, 417, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146857, 3462, 240, 4, 60, "Section"],
Cell[147100, 3468, 1228, 22, 134, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

