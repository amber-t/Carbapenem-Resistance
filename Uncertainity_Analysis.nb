(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83225,       2030]
NotebookOptionsPosition[     81219,       1961]
NotebookOutlinePosition[     81675,       1979]
CellTagsIndexPosition[     81632,       1976]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6858785098524837`*^9, 3.685878512794094*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CARBAPENEM RESISTANCE MODEL",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.7005872688200474`*^9, 3.700587274570282*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Data",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.700586955166306*^9, 3.700586956688905*^9}, {
  3.700586999864338*^9, 3.700586999895615*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Preparing Directory",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7005868421634493`*^9, 3.700586844493045*^9}}],

Cell["\<\
Clear all variables. Set directory and change setting such that when it \
closes it closes all outputs.\
\>", "Text",
 CellChangeTimes->{{3.6864016594282627`*^9, 3.6864016983437967`*^9}, {
  3.6864017385595016`*^9, 3.6864017467278137`*^9}, {3.7005783616134434`*^9, 
  3.700578363379423*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "Code",
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"NotebookEventActions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
        RowBox[{"FrontEndExecute", "[", 
         RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
         "]"}]}], "}"}]}]}], "]"}], ";"}], "Code"]}], "Input",
 CellChangeTimes->{{3.686401706812792*^9, 3.6864017521197643`*^9}, 
   3.686403149219241*^9, {3.686504717864292*^9, 3.686504722791524*^9}, {
   3.700578365301522*^9, 3.7005783714796133`*^9}, {3.7005784918705196`*^9, 
   3.7005784924955854`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Load Data",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586818794753*^9, 3.7005868197322516`*^9}, {
  3.7005873521608763`*^9, 3.700587352176503*^9}}],

Cell["\<\
Reading country data on consumption and resistance and assigning them to \
appropriate variables.\
\>", "Text",
 CellChangeTimes->{3.686400603032765*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"countryname", "=", "\"\<US_DDD\>\""}], ";"}], " "}], 
  "Code"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<DataSheet_cddep.xlsx\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Data\>\"", ",", "countryname"}], "}"}]}], "]"}]}], ";"}], 
  "Code"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"years", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "Code"], "\[IndentingNewLine]", 

 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"tt", " ", "=", " ", 
     RowBox[{"Length", "[", "years", "]"}]}], ";"}], " "}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"nop", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "-", "5"}], ")"}], "/", "2"}]}],
     ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"#", " ", "of", " ", "pathogens"}], "*)"}]}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"isolates", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", 
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "-", "4"}], ";;", "2"}], "]"}], 
     "]"}]}], ";"}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"resistance", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"3", ";;", 
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "-", "4"}], ";;", "2"}], "]"}], 
     "]"}]}], ";"}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"rfreq", " ", "=", 
    RowBox[{"resistance", "/", "isolates"}]}], ";"}], 
  "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"carbcons", " ", "=", "  ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "Code"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"conbreak", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", 
        RowBox[{"1", ";;", "nop"}]}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CBP", " ", "consumption", " ", "for", " ", "KP"}], ",", " ", 
     "PA", ",", " ", "AB"}], "*)"}]}], "Code"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"cbp", " ", "=", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"carbcons", "*", 
        RowBox[{"conbreak", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}]}], ";"}], 
  "Code"]}], "Input",
 CellChangeTimes->{{3.686422034696558*^9, 3.6864220688839083`*^9}, {
   3.686422244390477*^9, 3.686422257854924*^9}, {3.6864223170828114`*^9, 
   3.6864223431908817`*^9}, 3.6864948657783527`*^9, {3.686495706144705*^9, 
   3.686495706998027*^9}, {3.686497157777652*^9, 3.686497176663332*^9}, {
   3.686500722352275*^9, 3.6865007839598494`*^9}, {3.6865008234158993`*^9, 
   3.686500860558977*^9}, {3.686500895439396*^9, 3.6865009047916603`*^9}, {
   3.686501132914021*^9, 3.6865011961896877`*^9}, {3.686502039475134*^9, 
   3.686502053471085*^9}, 3.686504820987131*^9, {3.686504927512206*^9, 
   3.68650493323075*^9}, {3.686505663500307*^9, 3.686505834942637*^9}, {
   3.686506221505989*^9, 3.686506233253963*^9}, 3.6865062638755836`*^9, {
   3.686506304950383*^9, 3.6865063857051888`*^9}, {3.686506464729933*^9, 
   3.686506570268374*^9}, {3.686507885056096*^9, 3.686507925091408*^9}, 
   3.68650806648864*^9, {3.686508132562462*^9, 3.686508159468111*^9}, {
   3.6865082387863083`*^9, 3.686508289413818*^9}, {3.686593508533208*^9, 
   3.686593578249978*^9}, {3.686670822461113*^9, 3.686670846265149*^9}, 
   3.686671020176771*^9, {3.686671058093039*^9, 3.686671058348937*^9}, {
   3.686671195039489*^9, 3.686671197287084*^9}, {3.686672205273057*^9, 
   3.686672265615234*^9}, {3.686672313935074*^9, 3.686672315030695*^9}, {
   3.690514968752684*^9, 3.6905149711878157`*^9}, {3.6905151605791454`*^9, 
   3.6905151977141056`*^9}, {3.6905490426059213`*^9, 
   3.6905490710575967`*^9}, {3.6905491666256824`*^9, 3.69054916762508*^9}, {
   3.690560008801766*^9, 3.690560021440817*^9}, {3.693235488416274*^9, 
   3.693235488880404*^9}, {3.693237503430167*^9, 3.693237504912262*^9}, {
   3.693242514519369*^9, 3.693242533218896*^9}, {3.69324278229449*^9, 
   3.6932427827305317`*^9}, {3.69324331082885*^9, 3.693243311380581*^9}, {
   3.694794944107407*^9, 3.6947949456275787`*^9}, 3.694869444462384*^9, {
   3.69486947773489*^9, 3.6948694780468807`*^9}, {3.696613845884832*^9, 
   3.69661384630057*^9}, 3.6966142251356783`*^9, {3.696614267163052*^9, 
   3.696614268931164*^9}, {3.696614336734581*^9, 3.69661436742657*^9}, {
   3.6966143989830647`*^9, 3.6966144011982822`*^9}, {3.696614476914295*^9, 
   3.696614477617947*^9}, {3.696614523998536*^9, 3.696614524365843*^9}, {
   3.6966149875383883`*^9, 3.69661502321297*^9}, {3.696615101388283*^9, 
   3.69661512177125*^9}, {3.6966152518805857`*^9, 3.696615261003038*^9}, {
   3.696615389139082*^9, 3.696615395235524*^9}, {3.696615597886518*^9, 
   3.696615598926401*^9}, {3.696615815221848*^9, 3.696615816637291*^9}, {
   3.696616322068841*^9, 3.696616323151634*^9}, {3.6968731019011183`*^9, 
   3.696873102132331*^9}, {3.696873474263825*^9, 3.696873474894909*^9}, {
   3.696873750270289*^9, 3.6968737506538773`*^9}, {3.696952191029182*^9, 
   3.696952192165349*^9}, {3.6969525040529337`*^9, 3.69695250910539*^9}, {
   3.696952959626371*^9, 3.696952960785913*^9}, {3.696954591424856*^9, 
   3.696954592264494*^9}, {3.69695474259662*^9, 3.696954751834024*^9}, {
   3.696954829844029*^9, 3.696954858941578*^9}, {3.696959711253429*^9, 
   3.6969597124892597`*^9}, {3.696960225982828*^9, 3.696960229688342*^9}, {
   3.6974636430928164`*^9, 3.69746364475207*^9}, 3.6974636990330257`*^9, {
   3.69746572261734*^9, 3.6974657303934927`*^9}, {3.697466319707209*^9, 
   3.6974663208109493`*^9}, {3.699979819323583*^9, 3.699979824749195*^9}, {
   3.6999798994047337`*^9, 3.699979971399865*^9}, 3.700577857699892*^9, {
   3.700580301187483*^9, 3.7005803061567545`*^9}, {3.700580352344078*^9, 
   3.7005804332667875`*^9}, {3.700587356480831*^9, 3.7005873808606195`*^9}, {
   3.7014286067933145`*^9, 3.701428607337329*^9}, {3.701537183106104*^9, 
   3.7015371983584056`*^9}, {3.701537245629196*^9, 3.701537248154693*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model ", "Section",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.686400307952888*^9, 3.6864004084403467`*^9}, {
   3.686400489920883*^9, 3.686400491960532*^9}, 3.7005870090415688`*^9, 
   3.701429412245363*^9}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Parameters & Model Structure",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586719444282*^9, 3.700586729715373*^9}, {
  3.700586791459395*^9, 3.7005867927406187`*^9}}],

Cell[TextData[{
 StyleBox["r(t)", "Text",
  FontWeight->"Bold"],
 StyleBox[" = frequency of resistance\n", "Text"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "s"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the sensitive strain\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "r"], TraditionalForm]],
  FontWeight->"Bold"],
 "= natural growth rate of the resistance strain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["k", "r"]}], TraditionalForm]]],
 " < ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "s"], ")"}], TraditionalForm]]],
 "\n",
 StyleBox["\[Theta]",
  FontWeight->"Bold"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["k", "r"], "-", 
     SubscriptBox["k", "s"]}], "<", " ", "0"}], TraditionalForm]]],
 " \n",
 StyleBox["a =",
  FontWeight->"Bold"],
 " CBP consumption (DDD)"
}], "Text",
 CellChangeTimes->{{3.686400499649311*^9, 3.68640052600694*^9}, {
   3.6864005718225193`*^9, 3.686400575021463*^9}, {3.68736386207417*^9, 
   3.687363862074381*^9}, 3.6905491725333633`*^9, {3.690722553178647*^9, 
   3.69072257128833*^9}, {3.690722611632101*^9, 3.6907226192004843`*^9}, 
   3.696614487562492*^9, {3.696954774986088*^9, 3.696954776429123*^9}, {
   3.699978618851925*^9, 3.69997862542444*^9}, {3.700578555451971*^9, 
   3.700578559628787*^9}, {3.700578612001893*^9, 3.700578612705063*^9}, {
   3.7005806236313753`*^9, 3.700580635401388*^9}, {3.7005806769712067`*^9, 
   3.7005809518298016`*^9}, {3.7005811924601393`*^9, 
   3.7005812164615297`*^9}, {3.702216322838592*^9, 3.702216326755948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"r", "[", 
      RowBox[{"t_", ",", "r0_", ",", "ks_", ",", "\[Theta]_"}], "]"}],
     FontWeight->"Plain"], 
    StyleBox[":=",
     FontWeight->"Plain"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"ks", "*", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"\[Theta]", "*", "t"}]}], ")"}]], " "}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"ks", "*", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "t"}], "]"}], "]"}]}], "]"}], "+", " ", 
         RowBox[{"\[Theta]", "*", "t"}]}], ")"}]], "  "}]]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.683030762976203*^9, 3.6830307646226077`*^9}, {
   3.683030892090124*^9, 3.6830309083188725`*^9}, {3.6830309721242533`*^9, 
   3.683030993984562*^9}, {3.6830311371186757`*^9, 3.6830311451555557`*^9}, {
   3.683031934623186*^9, 3.6830319364931593`*^9}, {3.683032013522828*^9, 
   3.683032065758599*^9}, {3.6830346542453313`*^9, 3.68303465754213*^9}, {
   3.6830363241484847`*^9, 3.683036329938362*^9}, {3.6830365276454496`*^9, 
   3.683036530676465*^9}, 3.6830367497782087`*^9, {3.683041381379426*^9, 
   3.683041393024686*^9}, {3.6830421349464197`*^9, 3.683042139599684*^9}, {
   3.6830447788287015`*^9, 3.683044779606695*^9}, {3.683045184458967*^9, 
   3.6830452004752617`*^9}, {3.6852083241401463`*^9, 3.685208331594561*^9}, {
   3.685208507957798*^9, 3.685208565997737*^9}, 3.6852094721246767`*^9, {
   3.685209903141817*^9, 3.6852099398500347`*^9}, {3.6852099889580927`*^9, 
   3.685210058891021*^9}, {3.6852103080680428`*^9, 3.685210309237547*^9}, {
   3.685210371854425*^9, 3.685210380461464*^9}, {3.685210428797523*^9, 
   3.6852105257382507`*^9}, {3.6852105754249763`*^9, 3.6852105928533*^9}, {
   3.6852107253971167`*^9, 3.685210739728479*^9}, {3.685211129911818*^9, 
   3.685211139176404*^9}, {3.68521175723141*^9, 3.6852117935313168`*^9}, {
   3.6852123574632883`*^9, 3.685212368014336*^9}, {3.685279366491384*^9, 
   3.685279382363071*^9}, {3.685279416295306*^9, 3.685279429839871*^9}, 
   3.6852808275142384`*^9, {3.6853860677425203`*^9, 3.6853861678062687`*^9}, {
   3.685386259499681*^9, 3.685386260403224*^9}, {3.685881879376438*^9, 
   3.68588188788455*^9}, {3.685882144512109*^9, 3.685882211247509*^9}, {
   3.685882264975534*^9, 3.6858823048645563`*^9}, {3.6863259609700985`*^9, 
   3.68632602143394*^9}, {3.6863261123987613`*^9, 3.6863261127132187`*^9}, {
   3.6863261459947433`*^9, 3.686326158772418*^9}, {3.6863300988135977`*^9, 
   3.6863301392487526`*^9}, {3.6863301968103313`*^9, 
   3.6863302455048313`*^9}, {3.686330295179199*^9, 3.686330312060356*^9}, {
   3.6863310425150905`*^9, 3.686331077920039*^9}, {3.6863311592705336`*^9, 
   3.686331161351984*^9}, {3.686331196844039*^9, 3.6863312002829003`*^9}, {
   3.6863316074494753`*^9, 3.68633161191486*^9}, {3.6863316677333975`*^9, 
   3.6863316752266045`*^9}, {3.686331756685466*^9, 3.6863317652227015`*^9}, {
   3.6863318579611225`*^9, 3.6863318604224625`*^9}, {3.6863320284264183`*^9, 
   3.6863320896920385`*^9}, {3.6863333970093203`*^9, 3.686333468722809*^9}, {
   3.686333527818489*^9, 3.686333530257064*^9}, {3.686333585882146*^9, 
   3.6863335937595434`*^9}, {3.6863337944358063`*^9, 
   3.6863338012252955`*^9}, {3.686333860129887*^9, 3.686333926127783*^9}, {
   3.686334541041381*^9, 3.6863345432302294`*^9}, {3.6863346050474234`*^9, 
   3.6863346194036174`*^9}, {3.6863350339422607`*^9, 
   3.6863350402439137`*^9}, {3.686396824312439*^9, 3.686396830206884*^9}, {
   3.68639728852584*^9, 3.686397385676342*^9}, {3.6863974219206467`*^9, 
   3.686397591467824*^9}, {3.6863977467434483`*^9, 3.686397856243059*^9}, {
   3.6863979037596188`*^9, 3.686398009617909*^9}, {3.686398049831843*^9, 
   3.686398058770108*^9}, {3.68639915087844*^9, 3.686399168049336*^9}, {
   3.686399538546379*^9, 3.686399540314131*^9}, 3.6864005110851316`*^9, 
   3.686400581816401*^9, {3.6864006197723083`*^9, 3.686400620244726*^9}, {
   3.686401869966902*^9, 3.686401900676633*^9}, {3.6864032479875317`*^9, 
   3.6864032930076036`*^9}, {3.6864112529344683`*^9, 3.686411262755252*^9}, {
   3.6864112967508183`*^9, 3.686411330746829*^9}, {3.686412024717753*^9, 
   3.686412049333313*^9}, 3.6864123304368677`*^9, {3.686412473817891*^9, 
   3.686412485495213*^9}, {3.686412529906288*^9, 3.686412535342702*^9}, 
   3.686413143077464*^9, {3.686413922349515*^9, 3.6864139332766542`*^9}, {
   3.686414054550778*^9, 3.68641405601223*^9}, {3.686414101545352*^9, 
   3.686414169219296*^9}, {3.6864142432310667`*^9, 3.686414273315958*^9}, {
   3.686414369325341*^9, 3.686414388826579*^9}, {3.6864144199682903`*^9, 
   3.686414447742525*^9}, {3.686414613494096*^9, 3.686414779850452*^9}, {
   3.686414811798102*^9, 3.686414906928382*^9}, {3.686415062398457*^9, 
   3.686415134968748*^9}, {3.686415560254722*^9, 3.686415665538151*^9}, {
   3.686418321121459*^9, 3.686418334972437*^9}, {3.686508624478046*^9, 
   3.686508632277608*^9}, 3.68650871497578*^9, {3.6866710450891523`*^9, 
   3.686671051229025*^9}, {3.6866716077238398`*^9, 3.6866716968985*^9}, {
   3.686671727131069*^9, 3.6866717297824497`*^9}, {3.686672280091339*^9, 
   3.68667229406674*^9}, {3.6869386960631742`*^9, 3.686938708012053*^9}, {
   3.690514877200051*^9, 3.6905148892161407`*^9}, {3.690721514268401*^9, 
   3.690721571699773*^9}, 3.696616035925852*^9, {3.6975661826500597`*^9, 
   3.6975661924568453`*^9}, {3.697566564484868*^9, 3.697566577524445*^9}, {
   3.69997860542073*^9, 3.699978631025688*^9}, {3.699978671234418*^9, 
   3.699978743381155*^9}, 3.6999787843122373`*^9, {3.6999788740181875`*^9, 
   3.699978892479066*^9}, {3.699978953924489*^9, 3.699978998636625*^9}, {
   3.699979481328476*^9, 3.699979524287679*^9}, {3.6999797618961906`*^9, 
   3.6999797636369605`*^9}, {3.700577837888285*^9, 3.7005778452831726`*^9}, {
   3.700577896592633*^9, 3.700577898123874*^9}, {3.700577982561618*^9, 
   3.7005779859363604`*^9}, 3.700580714849549*^9, {3.700580866866892*^9, 
   3.7005808755221605`*^9}, {3.7005809652484455`*^9, 3.700581054510634*^9}, {
   3.700581143420582*^9, 3.700581158726591*^9}, {3.7005812221988354`*^9, 
   3.700581224699131*^9}, {3.7005813900782413`*^9, 3.7005814812173157`*^9}, 
   3.700581594578314*^9, {3.7005817018893595`*^9, 3.7005817331728625`*^9}, {
   3.70058236481491*^9, 3.7005823685675287`*^9}, {3.7005824573051863`*^9, 
   3.7005824598974485`*^9}, {3.7005825333408175`*^9, 3.700582536338009*^9}, {
   3.7016103449359617`*^9, 3.701610389366672*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Likelihood",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.7005867405346403`*^9, 3.700586744228055*^9}, {
  3.701427711022795*^9, 3.701427711163434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"Lik", "[", 
     RowBox[{"r0_", ",", "ks_", ",", "\[Theta]_"}], "]"}],
    FontWeight->"Plain"], 
   StyleBox[":=",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   RowBox[{"Total", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"iso", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"resis", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"resis", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"r", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", "\[Theta]"}], 
          "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"iso", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"resis", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", "\[Theta]"}], 
           "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.6830433753306084`*^9}, {3.6830453841421323`*^9, 3.683045385373238*^9}, {
   3.683286539007884*^9, 3.6832865413676167`*^9}, {3.683286571723649*^9, 
   3.6832865735875263`*^9}, {3.6833012740307302`*^9, 
   3.6833013690917635`*^9}, {3.6833024062245913`*^9, 
   3.6833024065060987`*^9}, {3.683303978402192*^9, 3.683303988908411*^9}, {
   3.6833125533026915`*^9, 3.683312560807563*^9}, {3.6833810185649223`*^9, 
   3.6833810198201427`*^9}, {3.6839950164754915`*^9, 3.683995016631748*^9}, {
   3.683995107610061*^9, 3.683995109400138*^9}, {3.684761387233347*^9, 
   3.684761387411523*^9}, {3.685208646552435*^9, 3.685208664904273*^9}, {
   3.685210100038281*^9, 3.685210133317401*^9}, {3.685210612196949*^9, 
   3.685210625376943*^9}, {3.685279459724468*^9, 3.685279483526725*^9}, {
   3.6852807998799334`*^9, 3.6852808089832907`*^9}, {3.685281067274529*^9, 
   3.685281077298399*^9}, {3.68528125115583*^9, 3.685281261013719*^9}, {
   3.6852814331275053`*^9, 3.685281440604895*^9}, {3.685386193320956*^9, 
   3.685386207936881*^9}, {3.686325830517469*^9, 3.686325855990289*^9}, {
   3.6863316529251328`*^9, 3.68633165301976*^9}, {3.686331705422717*^9, 
   3.6863317460069585`*^9}, 3.686331790557254*^9, {3.6863340940272284`*^9, 
   3.6863340949404917`*^9}, 3.6864009082517033`*^9, 3.6864009507187*^9, {
   3.686401046619935*^9, 3.686401063283523*^9}, 3.686401104899159*^9, {
   3.68640350491506*^9, 3.6864035654181747`*^9}, {3.686415534611898*^9, 
   3.6864155467485037`*^9}, {3.6864157341890497`*^9, 
   3.6864157348122463`*^9}, {3.6864183840374823`*^9, 3.686418412399835*^9}, {
   3.686508351245968*^9, 3.686508378709692*^9}, {3.6865086384692287`*^9, 
   3.686508647192649*^9}, 3.686508721860381*^9, {3.69051493172359*^9, 
   3.690514960196232*^9}, {3.69072157779605*^9, 3.6907216007279577`*^9}, {
   3.697566200365423*^9, 3.697566212973073*^9}, {3.69997901078512*^9, 
   3.6999790631544333`*^9}, {3.699979531465004*^9, 3.699979539438403*^9}, {
   3.6999797425870667`*^9, 3.6999797443087587`*^9}, {3.7005810704350834`*^9, 
   3.7005810755460377`*^9}, {3.7005811209205437`*^9, 
   3.7005811290410414`*^9}, {3.700581304665578*^9, 3.700581331077982*^9}, {
   3.700581746040372*^9, 3.7005817902595863`*^9}, {3.7005820577108154`*^9, 
   3.7005820645214376`*^9}, 3.7005856756577263`*^9, {3.701536147947562*^9, 
   3.701536161931431*^9}, {3.7015393894383755`*^9, 3.701539413765788*^9}, 
   3.7016171706320457`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox[
      RowBox[{"Likelihood", " ", "Surface"}], "Subsubsection"], 
     "\[IndentingNewLine]", "i"}], " ", "=", " ", "3"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"iso", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"isolates", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[IndentingNewLine]", "resis"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[IndentingNewLine]", "a"}], " ", 
      "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"loglik", "[", 
         RowBox[{"r0_", ",", "ks_"}], "]"}]}], ":=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"Binomial", "[", 
              RowBox[{
               RowBox[{"iso", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"resis", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"resis", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"Log", "[", 
              RowBox[{"r", "[", 
               RowBox[{
                RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", 
                RowBox[{"-", "0.1"}]}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"iso", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "-", 
               RowBox[{"resis", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
             RowBox[{"Log", "[", 
              RowBox[{"1", "-", 
               RowBox[{"r", "[", 
                RowBox[{
                 RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", 
                 RowBox[{"-", "0.1"}]}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Plot3D", "[", 
         RowBox[{
          RowBox[{"loglik", "[", 
           RowBox[{"r0", ",", "ks"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r0", ",", "0", ",", "0.1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ks", ",", "700", ",", "1000"}], "}"}]}], 
         "]"}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.701617278135337*^9, 3.701617350795392*^9}, {
   3.701621530164538*^9, 3.7016216071879396`*^9}, {3.701622059410255*^9, 
   3.701622064874689*^9}, {3.7016230165714817`*^9, 3.70162309331101*^9}, {
   3.701623126075132*^9, 3.701623135394781*^9}, {3.7016235059809227`*^9, 
   3.7016235485444613`*^9}, 3.701623768677444*^9, {3.7016246535944757`*^9, 
   3.70162466845366*^9}, {3.7016924393185453`*^9, 3.701692439776977*^9}, 
   3.7023208477601547`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Model Fitting",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.700586762450125*^9, 3.70058676485663*^9}, {
  3.700587072272579*^9, 3.7005870740416794`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", "max"}], ";", " ", 
  RowBox[{"fks", "=", "max"}], ";", " ", 
  RowBox[{"f\[Theta]", "=", "max"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      StyleBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"max", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"f\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], "=", 
        RowBox[{"NMaximize", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lik", "[", 
             RowBox[{"r0", ",", "ks", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"0", "<", "r0", "<", "1"}], ",", 
            RowBox[{"\[Theta]", "<", 
             RowBox[{"-", "0.1"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r0", ",", "ks", ",", "\[Theta]"}], "}"}], ",", " ", 
          RowBox[{"MaxIterations", "\[Rule]", "100000"}]}], "]"}]}],
       FontWeight->"Plain"]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr0", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fr0", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fks", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fks", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f\[Theta]", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f\[Theta]", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"create", " ", "table", " ", "of", " ", "fitted", " ", "values"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "max", "}"}], ",", 
     RowBox[{"{", "fr0", "}"}], ",", 
     RowBox[{"{", "fks", "}"}], ",", 
     RowBox[{"{", "f\[Theta]", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings1", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"params", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<KP\>\"", ",", "\"\<PA\>\"", ",", "\"\<AB\>\"", ",", 
       "\"\<EA/C\>\""}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headings2", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Prepend", ",", 
     RowBox[{"{", 
      RowBox[{"headings1", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\>\"", ",", "\"\<Likelihood\>\"", ",", "\"\<r0\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(k\), \(s\)]\)\>\"", ",", 
         "\"\<\[Theta]\>\""}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Grid", "[", 
   RowBox[{"headings2", ",", 
    RowBox[{"Frame", "\[Rule]", " ", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz1tImgEABWAprKdQknrYpVFEhiNqIVG0DKvV0GqlI6i5jUXyF9i6GAnG
hjQKinWPqNwoq1mkEEWLJu2SAx+ywgJpiBtWK9O/q40Qq23/+R8OH+flwIku
r5HIgxgMRiwVuEVEVsX1kMKiMXYNjDJljEN1w8NJuPDz6RJ8k8k0Q8J4lcCl
7Bjl8qH+XJoKZRpSAFMGNLmwgpORB236VTHdnV/z4ZLOqYSeziEVTNYLt0W9
pFB7Yab1hamIfErpeGUlrB6ZqYbvsyOUUGF43gTFZ8O089d2E9z5/mMN3tDy
3PAl03sGA+ySAHztd/2Dfo4jrAA7U6Xh0CzLaYT+9eBX8IvAr4G/7WQrPJgK
tEPbzYZ+eFLSoYWjKR9px4Jb9HBB8mAePtHpFmFto8QKF8scG/CiWbENH5sO
92BWWpUHxs4lHcG3rJVL6Lh1N74Q/XYOrWHXqYXr0sF3cHbfLHpEyVrlimFI
3d9vnj5S+NkXsgyNvEQLLH6mtkK+urXLS+nKC+2GRXL3BBS1ndBa64+n4YfT
F59gjO/XJiTS3bT3Kwy8qH7q1501WmO25R78k2pLhv8B5Ys03Q==
  "]],

Cell[BoxData[
 StyleBox["Sampling", "Subsection",
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{3.702212655290496*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"loglik", "[", 
    RowBox[{"r0_", ",", "ks_"}], "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"iso", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"resis", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"resis", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"r", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", 
           RowBox[{"-", "0.1"}]}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"iso", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"resis", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "r0", ",", "ks", ",", 
            RowBox[{"-", "0.1"}]}], "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fonGrid", "[", 
   RowBox[{"x_", ",", "y_", ",", "f_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "m", ",", "fvals"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"x", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
      RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"y", " ", "is", " ", "an", " ", "n"}], "-", "by", "-", 
      RowBox[{"1", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "f", " ", "is", " ", "a", " ", "scalar", " ", "function", " ", "of", " ",
       "two", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"fvals", " ", "is", " ", "an", " ", "m"}], "-", "by", "-", 
       RowBox[{"n", " ", "matirx", " ", "where", " ", 
        RowBox[{"fVals", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "=", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Length", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fvals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "m", "}"}], ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"preallocate", " ", "fvals"}], "*)"}], 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"fvals", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "fvals"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.702212683239119*^9, 3.7022126862151327`*^9}, {
   3.702212732383494*^9, 3.702212776298992*^9}, {3.702212941922406*^9, 
   3.702213009546727*^9}, {3.7022130397508373`*^9, 3.702213071586981*^9}, {
   3.702213192706868*^9, 3.702213194550742*^9}, {3.7022136105741663`*^9, 
   3.702213611089116*^9}, {3.702221180021676*^9, 3.70222119417346*^9}, {
   3.7022971549358997`*^9, 3.702297155736002*^9}, {3.702297221260055*^9, 
   3.70229722141407*^9}, {3.702297269679932*^9, 3.702297269895307*^9}, {
   3.702297512902986*^9, 3.7022975130708237`*^9}, {3.7022975635228*^9, 
   3.702297563706696*^9}, 3.702303308232937*^9, {3.702303358643429*^9, 
   3.702303371304614*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r0f", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";", 
  RowBox[{"ksf", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";", 
  RowBox[{"lf", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pn", " ", "=", " ", "2"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"PATHOGEN", " ", "NO"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i", " ", "=", " ", "pn"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iso", " ", "=", " ", 
   RowBox[{"isolates", "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resis", " ", "=", " ", 
   RowBox[{"resistance", "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"cbp", "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.9", "*", 
        RowBox[{"fr0", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"1.1", "*", 
        RowBox[{"fr0", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "100"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", " ", "=", " ", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.9", "*", 
        RowBox[{"fks", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"1.1", "*", 
        RowBox[{"fks", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", "100"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ld", " ", "=", " ", 
   RowBox[{"fonGrid", "[", 
    RowBox[{"x", ",", "y", ",", "loglik"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", " ", "=", " ", 
   RowBox[{"Exp", "[", "ld", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"d", "/", 
    RowBox[{"Total", "[", 
     RowBox[{"Total", "[", "d", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds", " ", "=", 
   RowBox[{
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"d", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"100", "*", "100"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ws", " ", "=", " ", 
   RowBox[{
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"w", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"100", "*", "100"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repeat", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"n_Integer", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"Sequence", "@@", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"m", ",", "n"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"xs", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"repeat", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "100"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ys", " ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{"y", ",", "10000", ",", "y"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rs", " ", "=", " ", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
     RowBox[{"ws", "\[Rule]", 
      RowBox[{"Range", "[", "10000", "]"}]}], ",", "1000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r0f", "[", 
    RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
   RowBox[{"xs", "[", 
    RowBox[{"[", "rs", "]"}], "]"}]}], ";", " ", 
  RowBox[{"ys", " ", "=", " ", 
   RowBox[{"ys", "[", 
    RowBox[{"[", "rs", "]"}], "]"}]}], ";", " ", 
  RowBox[{"ds", " ", "=", " ", 
   RowBox[{"ds", "[", 
    RowBox[{"[", "rs", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ksf", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", "ys"}], ";", 
   RowBox[{
    RowBox[{"lf", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", "ds"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.702213085206161*^9, 3.7022130910461597`*^9}, {
   3.702213242497711*^9, 3.702213365697401*^9}, {3.702213422953679*^9, 
   3.702213477292939*^9}, {3.702213521753269*^9, 3.702213524804967*^9}, {
   3.702213556768837*^9, 3.702213582672481*^9}, {3.7022136314092712`*^9, 
   3.70221365245243*^9}, {3.70221452594149*^9, 3.7022145568976917`*^9}, {
   3.702214596469501*^9, 3.702214643929315*^9}, {3.702214743890162*^9, 
   3.702214772772786*^9}, {3.7022159578055067`*^9, 3.702215992345421*^9}, {
   3.702216384715893*^9, 3.702216468511726*^9}, {3.7022212185686398`*^9, 
   3.702221219649168*^9}, 3.702227690016165*^9, {3.702228184346311*^9, 
   3.702228265734083*^9}, {3.702232762931981*^9, 3.702232767724331*^9}, {
   3.702232926003491*^9, 3.702233040788165*^9}, {3.702297068084367*^9, 
   3.702297168036446*^9}, {3.702303376632094*^9, 3.702303385612136*^9}, {
   3.702303972506579*^9, 3.702303977594195*^9}, {3.702320989116581*^9, 
   3.702321010111902*^9}, 3.70232108199686*^9, {3.702321115008659*^9, 
   3.7023211673086243`*^9}, {3.7023214705632*^9, 3.70232166710699*^9}, {
   3.702321799631673*^9, 3.702321801102396*^9}, {3.702321897274564*^9, 
   3.702321899306859*^9}, {3.70232315196726*^9, 3.702323163354329*^9}, {
   3.7023232757065353`*^9, 3.702323297185672*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Plots", "Subsection",
 FontWeight->"Bold"]], "Subsubsection",
 CellChangeTimes->{{3.6864019318300753`*^9, 3.68640193261397*^9}, {
   3.700584211101284*^9, 3.7005842115232344`*^9}, 3.7005848138660707`*^9, {
   3.7005861924534636`*^9, 3.7005861960214744`*^9}, 3.701427739895981*^9, {
   3.702212639255622*^9, 3.7022126398836184`*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "tt"}], "]"}]}], ";"}], " "}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", "pn"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["xp",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "1000", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"years", ",", 
      RowBox[{"rfreq", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}]}], ";", " ", 
  RowBox[{
   StyleBox["(*",
    FontWeight->"Plain"], 
   RowBox[{"resistance", " ", "frequency", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "\[LessEqual]", "1000"}], ",", 
    RowBox[{"j", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbp", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"xp", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"k", ",", 
           RowBox[{"xs", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"ys", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"-", "0.1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "tt"}], "}"}]}], "]"}]}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fit", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"years", ",", 
        RowBox[{"xp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotD", " ", "=", " ", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"res", ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<Resitance frequency\>\"", "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotM", " ", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"fit", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1000"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "]"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "\"\<Model fit\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"plotM", ",", "plotD"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.683301416115432*^9, {3.68330283169864*^9, 3.683302993239018*^9}, {
   3.6833055910794373`*^9, 3.683305636170422*^9}, {3.6833060530293636`*^9, 
   3.6833060632715893`*^9}, {3.6833061142942333`*^9, 
   3.6833061227687674`*^9}, {3.6833063897605376`*^9, 
   3.6833063986934624`*^9}, {3.683308080002949*^9, 3.683308086552434*^9}, {
   3.683308506387912*^9, 3.6833085480807533`*^9}, {3.683308648991184*^9, 
   3.6833086520620613`*^9}, {3.6833086926488714`*^9, 
   3.6833086935110874`*^9}, {3.6833087964396143`*^9, 
   3.6833087982845883`*^9}, {3.6833088393199663`*^9, 
   3.6833088647096834`*^9}, {3.683308899388898*^9, 3.683308914020029*^9}, {
   3.683308985722557*^9, 3.6833090053830585`*^9}, {3.683309065087839*^9, 
   3.6833091018819323`*^9}, {3.683309257098646*^9, 3.683309287030099*^9}, 
   3.6833093257983055`*^9, {3.6833093700122876`*^9, 3.6833093789610586`*^9}, {
   3.683309417684349*^9, 3.683309476007949*^9}, 3.683309945564055*^9, {
   3.6833105665320864`*^9, 3.683310577583398*^9}, {3.6833121895816307`*^9, 
   3.6833122200850763`*^9}, 3.6833809394104614`*^9, {3.683994701083577*^9, 
   3.6839947027780976`*^9}, {3.6839949270869927`*^9, 
   3.6839949407653046`*^9}, {3.6839950439577026`*^9, 3.683995047008658*^9}, {
   3.6839951158716307`*^9, 3.6839951160120826`*^9}, {3.685280905458349*^9, 
   3.685280922295274*^9}, {3.6852812713416033`*^9, 3.685281271589242*^9}, {
   3.685281350521371*^9, 3.685281351481029*^9}, {3.685281446701007*^9, 
   3.685281448020803*^9}, {3.68528148668111*^9, 3.685281487544265*^9}, {
   3.685386488940509*^9, 3.6853865024012413`*^9}, {3.685386577962832*^9, 
   3.685386617220278*^9}, {3.6853866490015383`*^9, 3.6853866724672203`*^9}, {
   3.685386818298174*^9, 3.685386871427639*^9}, {3.685883511343244*^9, 
   3.685883537119133*^9}, 3.685883582491582*^9, {3.6863261931737995`*^9, 
   3.686326219150547*^9}, {3.686401046814313*^9, 3.686401046817287*^9}, {
   3.686402047733604*^9, 3.6864020986534443`*^9}, {3.68640214391778*^9, 
   3.6864021445809097`*^9}, {3.68640230775854*^9, 3.686402343989243*^9}, {
   3.686402445607501*^9, 3.686402582786208*^9}, {3.686402623002123*^9, 
   3.6864026372983227`*^9}, {3.686403710691243*^9, 3.6864037111730623`*^9}, {
   3.68641316084488*^9, 3.6864131786003036`*^9}, {3.68641877598636*^9, 
   3.686418799661862*^9}, {3.686419204532628*^9, 3.686419226142386*^9}, {
   3.686419259131887*^9, 3.686419259810073*^9}, {3.686419305110569*^9, 
   3.686419307970595*^9}, {3.686510588849517*^9, 3.686510700305969*^9}, {
   3.6865109190252237`*^9, 3.686510946164277*^9}, {3.686511685430202*^9, 
   3.686511686286436*^9}, 3.686512039853277*^9, {3.6865868610353813`*^9, 
   3.686586861883483*^9}, {3.686592896868075*^9, 3.6865929138798637`*^9}, 
   3.686593233682899*^9, {3.686593488437748*^9, 3.686593492277429*^9}, 
   3.686593643209486*^9, {3.686672399074642*^9, 3.686672399666*^9}, {
   3.690515080526602*^9, 3.690515080668233*^9}, {3.690723163686688*^9, 
   3.6907231692631474`*^9}, 3.6966143123194103`*^9, {3.697566437624357*^9, 
   3.697566457660091*^9}, {3.699979328902569*^9, 3.699979334437974*^9}, {
   3.6999796837736506`*^9, 3.699979722682167*^9}, {3.700582491740513*^9, 
   3.700582504611158*^9}, {3.700582560015941*^9, 3.700582592971918*^9}, {
   3.7005827328007126`*^9, 3.7005827332382545`*^9}, {3.700584830026703*^9, 
   3.700584830167506*^9}, {3.7014297372406874`*^9, 3.7014297657681875`*^9}, {
   3.702227720252956*^9, 3.7022277272204533`*^9}, {3.7022277659487343`*^9, 
   3.702227905527426*^9}, {3.7022279925272007`*^9, 3.70222802824715*^9}, {
   3.702228061875422*^9, 3.702228171186516*^9}, {3.702228304669935*^9, 
   3.702228424825862*^9}, {3.7022285100944138`*^9, 3.702228534809512*^9}, {
   3.7022298662453814`*^9, 3.7022300124934063`*^9}, {3.70223005229729*^9, 
   3.702230067032999*^9}, {3.702231009432767*^9, 3.7022310401273413`*^9}, {
   3.7022319034598207`*^9, 3.7022319050509977`*^9}, {3.702232173013894*^9, 
   3.702232227078298*^9}, {3.7022322708108063`*^9, 3.702232295277734*^9}, 
   3.702232381612879*^9, {3.702232479697605*^9, 3.702232484129508*^9}, 
   3.702232517054164*^9, {3.7022972334923687`*^9, 3.702297233609852*^9}, {
   3.702297505539707*^9, 3.702297506054907*^9}, {3.702297559783712*^9, 
   3.702297559880837*^9}, {3.702298054145656*^9, 3.702298056200984*^9}, {
   3.7022981015295887`*^9, 3.702298314708143*^9}, {3.702321172741309*^9, 
   3.7023211739016457`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7022975929622917`*^9, 3.702297599166153*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.702297368850086*^9, 3.7022973917228737`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox[
      RowBox[{
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "tt"}], "]"}]}], ";"}], " "}],
      FontWeight->"Plain"], "\[IndentingNewLine]", "res"}], " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"years", ",", 
         RowBox[{"rfreq", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";", " ", 
   RowBox[{
    StyleBox["(*",
     FontWeight->"Plain"], 
    RowBox[{"resistance", " ", "frequency", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"x", "  ", "=", " ", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nop", ",", "Null"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "nop"}], ",", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"iso", "=", 
        RowBox[{"isolates", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{
        StyleBox["resis",
         FontWeight->"Plain"], 
        StyleBox[" ",
         FontWeight->"Plain"], 
        StyleBox["=",
         FontWeight->"Plain"], 
        StyleBox[" ",
         FontWeight->"Plain"], 
        RowBox[{"resistance", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"cbp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"j", ",", 
            RowBox[{"fr0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"fks", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"f\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}]}]}], "}"}]}], 
    "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"fit", " ", "=", "  ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"years", ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"plotD", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"res", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<Resitance frequency\>\"", "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"plotM", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fit", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "]"}], ",", 
            "Thick"}], "}"}], "}"}]}], ",", " ", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<Model fit\>\"", "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotD", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"plotM", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (KP)\>\""}]}], "]"}], 
   " ", ";", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotD", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"plotM", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (PA)\>\""}]}], "]"}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotD", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"plotM", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (AB)\>\""}]}], "]"}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"plotD", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"plotM", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (EA/C)\>\""}]}], 
    "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.702227712046348*^9, {3.70229835085638*^9, 3.702298353639744*^9}, {
   3.702298556295629*^9, 3.7022986028768263`*^9}, {3.702298866316588*^9, 
   3.7022988724506283`*^9}, {3.7022990889844217`*^9, 3.702299101685948*^9}, {
   3.702299147069723*^9, 3.702299148221525*^9}, {3.702299200771102*^9, 
   3.702299201483881*^9}, 3.7023201347432213`*^9},
 ExpressionUUID -> "a3570527-73a9-4a15-aeed-284fbc466566"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Projections", "Section",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.6865809162848587`*^9, 3.686580932773919*^9}, {
   3.7005857146737695`*^9, 3.700585717734228*^9}, 3.700586022536952*^9, 
   3.7005862806674433`*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Status ",
  FontWeight->"Bold"],
 StyleBox["Quo",
  IgnoreSpellCheck->True,
  FontWeight->"Bold"],
 StyleBox[" & Interventions",
  FontWeight->"Bold"]
}], "Subsection",
 CellChangeTimes->{{3.7005871995517178`*^9, 3.700587211529149*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cbp0", " ", "=", " ", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"carbcons", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"current", " ", "CBP", " ", "consumption"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ti", "=", 
    RowBox[{"years", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projectsion", " ", "begin", " ", "at", " ", "year", " ", 
    SubscriptBox["t", "i"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tf", " ", "=", "2030"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projection", " ", "until", " ", "year", " ", 
    SubscriptBox["t", "f"]}], "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nyears", " ", "=", " ", 
    RowBox[{"tf", " ", "-", "ti"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "#", " ", "of", " ", "years", " ", "to", " ", "project", " ", "across"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyears", " ", "=", " ", 
   RowBox[{"Range", "[", " ", 
    RowBox[{
     RowBox[{"years", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], ",", "tf"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.686581690639391*^9, 3.686581692682914*^9}, {
   3.6865845283200493`*^9, 3.68658464361509*^9}, {3.686584825544402*^9, 
   3.686585222982565*^9}, {3.686585372725803*^9, 3.6865854662237453`*^9}, {
   3.68658550150427*^9, 3.686585569472267*^9}, {3.686585599880947*^9, 
   3.68658575892006*^9}, {3.686585802292082*^9, 3.686586160074435*^9}, {
   3.686586237312742*^9, 3.68658629656588*^9}, {3.686586696628215*^9, 
   3.6865867037801647`*^9}, {3.686586742467943*^9, 3.686586815188048*^9}, 
   3.6865868968961353`*^9, {3.686587785846178*^9, 3.686587786815857*^9}, {
   3.6865878992781677`*^9, 3.6865878998146477`*^9}, {3.686589322005342*^9, 
   3.6865893558208017`*^9}, {3.686589428876717*^9, 3.686589428972386*^9}, {
   3.686591257393601*^9, 3.6865912810725813`*^9}, {3.686593662737206*^9, 
   3.6865936659489594`*^9}, {3.6866700740147867`*^9, 3.686670117434482*^9}, {
   3.68667253363557*^9, 3.6866725768898373`*^9}, {3.686672624241622*^9, 
   3.686672700085044*^9}, {3.68667282285349*^9, 3.686672851705336*^9}, {
   3.68667402398144*^9, 3.686674024156755*^9}, {3.686674156785902*^9, 
   3.686674173992827*^9}, {3.686677981137723*^9, 3.686677981291198*^9}, {
   3.6905152558431525`*^9, 3.6905152616479993`*^9}, {3.690560052252635*^9, 
   3.69056005249806*^9}, {3.690562286998247*^9, 3.690562321050914*^9}, {
   3.69056237085006*^9, 3.6905623857432775`*^9}, 3.690650101348329*^9, {
   3.690650726564806*^9, 3.690650739223259*^9}, {3.6907289454148703`*^9, 
   3.690728968386346*^9}, {3.690729811643052*^9, 3.690729813698566*^9}, {
   3.690730235136895*^9, 3.6907302352890997`*^9}, {3.690730268345949*^9, 
   3.690730277537841*^9}, {3.694871052233786*^9, 3.694871058591963*^9}, {
   3.6948712303978977`*^9, 3.6948712476848087`*^9}, {3.699979370607155*^9, 
   3.699979449508545*^9}, {3.699980388991928*^9, 3.6999803963472424`*^9}, {
   3.699980464790619*^9, 3.6999804849270573`*^9}, {3.6999805383559713`*^9, 
   3.69998056396454*^9}, {3.69998060241968*^9, 3.6999806408287106`*^9}, {
   3.7005829324643664`*^9, 3.7005830091363564`*^9}, {3.7005830454346237`*^9, 
   3.7005831365241737`*^9}, 3.7005831717371736`*^9, 3.7005849282209883`*^9, {
   3.700585528563531*^9, 3.7005855386086164`*^9}, {3.7015357474307117`*^9, 
   3.701535748022829*^9}, {3.7015357909997444`*^9, 3.7015357912025075`*^9}, {
   3.7015373126768646`*^9, 3.701537312802163*^9}, {3.7015373965716114`*^9, 
   3.701537427554142*^9}, {3.701537901004513*^9, 3.7015379030704117`*^9}, {
   3.701538362716332*^9, 3.70153836479652*^9}, {3.701539702202931*^9, 
   3.7015397046267567`*^9}, {3.7015397451110573`*^9, 3.701539746150456*^9}, {
   3.701539946106423*^9, 3.701539950834362*^9}, 3.7015403873248672`*^9, 
   3.701611029454155*^9, {3.701612585153043*^9, 3.7016125866883*^9}, {
   3.701612648568585*^9, 3.70161267037601*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Status", " ", 
    RowBox[{"Quo", ":", " ", 
     RowBox[{"maintain", " ", "current", " ", "CBP", " ", "consumption"}]}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"projSQ", " ", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"cbp0", ",", 
       RowBox[{"Round", "[", "nyears", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cbpSQ", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"cbp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"projSQ", "*", 
          RowBox[{"conbreak", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Interventions", ":", "\[IndentingNewLine]", "   ", 
     RowBox[{
      RowBox[{"(", "0", ")"}], " ", "sparing1"}], ":", " ", 
     RowBox[{"0", " ", "consumption", " ", "at", " ", 
      SubscriptBox["t", "i"], " ", "\[IndentingNewLine]", "  ", 
      RowBox[{"(", "1", ")"}], " ", 
      RowBox[{"sparing2", ":", " ", 
       RowBox[{
       "linear", " ", "reduction", " ", "to", " ", "0", " ", "consumption", 
        " ", "by", " ", 
        SubscriptBox["t", "f"], "\[IndentingNewLine]", 
        RowBox[{"(", "2", ")"}], " ", "stewardship1"}], ":", " ", 
       RowBox[{
       "immediate", " ", "reduction", " ", "to", " ", "a", " ", "%", " ", 
        "of", " ", "current", " ", "consumption", "\[IndentingNewLine]", 
        RowBox[{"(", "3", ")"}], " ", 
        RowBox[{"stewardship2", ":", " ", 
         RowBox[{
         "linear", " ", "reduction", " ", "to", " ", "the", " ", "a", " ", 
          "%", " ", "of", " ", "current", " ", "consumption"}]}]}]}]}]}], " ",
     "*)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intv", " ", "=", " ", "0.4"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "reduce", " ", "current", " ", "carbapenem", " ", "consumption", " ", 
      "by", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "intv"}], ")"}], " ", "%", " ", "in", " ", "next", 
      " ", "npy", " ", "years", " ", "linearly"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"option", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"select", " ", "0"}], "-", "3"}], ";", " ", 
      RowBox[{"see", " ", "above"}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"option", "\[Equal]", "0"}], ",", " ", 
      RowBox[{"projI", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Round", "[", "nyears", "]"}]}], "]"}]}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"option", "\[Equal]", "1"}], ",", 
        RowBox[{"projI", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"cbp0", ",", "0", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "*", 
            RowBox[{"cbp0", "/", 
             RowBox[{"(", 
              RowBox[{"nyears", "-", "1"}], ")"}]}]}]}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"option", "\[Equal]", "2"}], ",", " ", 
          RowBox[{"projI", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"intv", "*", "cbp0"}], ",", 
             RowBox[{"Round", "[", "nyears", "]"}]}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"option", " ", "\[Equal]", " ", "3"}], ",", " ", 
            RowBox[{"projI", " ", "=", " ", 
             RowBox[{"Range", "[", 
              RowBox[{"cbp0", ",", 
               RowBox[{"intv", "*", "cbp0"}], ",", 
               RowBox[{"cbp0", "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intv", "-", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"nyears", "-", "1"}], ")"}]}]}]}], "]"}]}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cbpI", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"cbp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"projI", "*", 
          RowBox[{"conbreak", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.686581690639391*^9, 3.686581692682914*^9}, {
   3.6865845283200493`*^9, 3.68658464361509*^9}, {3.686584825544402*^9, 
   3.686585222982565*^9}, {3.686585372725803*^9, 3.6865854662237453`*^9}, {
   3.68658550150427*^9, 3.686585569472267*^9}, {3.686585599880947*^9, 
   3.68658575892006*^9}, {3.686585802292082*^9, 3.686586160074435*^9}, {
   3.686586237312742*^9, 3.68658629656588*^9}, {3.686586696628215*^9, 
   3.6865867037801647`*^9}, {3.686586742467943*^9, 3.686586815188048*^9}, 
   3.6865868968961353`*^9, {3.686587785846178*^9, 3.686587786815857*^9}, {
   3.6865878992781677`*^9, 3.6865878998146477`*^9}, {3.686589322005342*^9, 
   3.6865893558208017`*^9}, {3.686589428876717*^9, 3.686589428972386*^9}, {
   3.686591257393601*^9, 3.6865912810725813`*^9}, {3.686593662737206*^9, 
   3.6865936659489594`*^9}, {3.6866700740147867`*^9, 3.686670117434482*^9}, {
   3.68667253363557*^9, 3.6866725768898373`*^9}, {3.686672624241622*^9, 
   3.686672700085044*^9}, {3.68667282285349*^9, 3.686672851705336*^9}, {
   3.68667402398144*^9, 3.686674024156755*^9}, {3.686674156785902*^9, 
   3.686674173992827*^9}, {3.686677981137723*^9, 3.686677981291198*^9}, {
   3.6905152558431525`*^9, 3.6905152616479993`*^9}, {3.690560052252635*^9, 
   3.69056005249806*^9}, {3.690562286998247*^9, 3.690562321050914*^9}, {
   3.69056237085006*^9, 3.6905623857432775`*^9}, 3.690650101348329*^9, {
   3.690650726564806*^9, 3.690650739223259*^9}, {3.6907289454148703`*^9, 
   3.690728968386346*^9}, {3.690729811643052*^9, 3.690729813698566*^9}, {
   3.690730235136895*^9, 3.6907302352890997`*^9}, {3.690730268345949*^9, 
   3.690730277537841*^9}, {3.694871052233786*^9, 3.694871058591963*^9}, {
   3.6948712303978977`*^9, 3.6948712476848087`*^9}, {3.699979370607155*^9, 
   3.699979449508545*^9}, {3.699980388991928*^9, 3.6999803963472424`*^9}, {
   3.699980464790619*^9, 3.6999804849270573`*^9}, {3.6999805383559713`*^9, 
   3.69998056396454*^9}, {3.69998060241968*^9, 3.6999806408287106`*^9}, {
   3.7005829324643664`*^9, 3.7005830091363564`*^9}, {3.7005830454346237`*^9, 
   3.7005831365241737`*^9}, 3.7005831717371736`*^9, {3.7005849282209883`*^9, 
   3.7005850661136694`*^9}, {3.700585541114936*^9, 3.700585542383891*^9}, {
   3.700585863255377*^9, 3.7005858763284245`*^9}, {3.7015373713317122`*^9, 
   3.7015373714747066`*^9}, {3.7015379065363874`*^9, 3.701537965983855*^9}, {
   3.701538003962614*^9, 3.701538040632939*^9}, {3.7015382949133396`*^9, 
   3.7015382951924696`*^9}, {3.701539749306971*^9, 3.701539770050675*^9}, {
   3.701539978518715*^9, 3.701539989589994*^9}, {3.701540415996571*^9, 
   3.701540449840372*^9}, {3.7016110336619587`*^9, 3.701611050817713*^9}, {
   3.701611125518221*^9, 3.7016111503451443`*^9}, {3.701611884802931*^9, 
   3.701611902091097*^9}, 3.70161259164859*^9, 3.701612641128326*^9, {
   3.701613274417617*^9, 3.701613277329846*^9}, {3.7023172345045223`*^9, 
   3.702317286016449*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "tt"}], "]"}]}], ";"}], " "}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i", " ", "=", "pn"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"years", ",", 
      RowBox[{"rfreq", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}]}], ";", " ", 
  RowBox[{
   StyleBox["(*",
    FontWeight->"Plain"], 
   RowBox[{"resistance", " ", "frequency", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   StyleBox["xsq",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "1000", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "\[LessEqual]", "1000"}], ",", 
    RowBox[{"j", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbpSQ", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"xsq", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"k", ",", 
           RowBox[{"xs", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"ys", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"-", "0.1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "tt", ",", 
           RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["xfp",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "1000", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "\[LessEqual]", "1000"}], ",", 
    RowBox[{"j", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"cbpI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"xfp", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"k", ",", 
           RowBox[{"xs", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"ys", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"-", "0.1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "tt", ",", 
           RowBox[{"tt", "+", "nyears"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitS", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"pyears", ",", 
        RowBox[{"xsq", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitP", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"pyears", ",", 
        RowBox[{"xfp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "1000"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686581690639391*^9, 3.686581692682914*^9}, {
   3.6865845283200493`*^9, 3.68658464361509*^9}, {3.686584825544402*^9, 
   3.686585222982565*^9}, {3.686585372725803*^9, 3.6865854662237453`*^9}, {
   3.68658550150427*^9, 3.686585569472267*^9}, {3.686585599880947*^9, 
   3.68658575892006*^9}, {3.686585802292082*^9, 3.686586160074435*^9}, {
   3.686586237312742*^9, 3.68658629656588*^9}, {3.686586696628215*^9, 
   3.6865867037801647`*^9}, {3.686586742467943*^9, 3.686586815188048*^9}, 
   3.6865868968961353`*^9, {3.686587785846178*^9, 3.686587786815857*^9}, {
   3.6865878992781677`*^9, 3.6865878998146477`*^9}, {3.686589322005342*^9, 
   3.6865893558208017`*^9}, {3.686589428876717*^9, 3.686589428972386*^9}, {
   3.686591257393601*^9, 3.6865912810725813`*^9}, {3.686593662737206*^9, 
   3.6865936659489594`*^9}, {3.6866700740147867`*^9, 3.686670117434482*^9}, {
   3.68667253363557*^9, 3.6866725768898373`*^9}, {3.686672624241622*^9, 
   3.686672700085044*^9}, {3.68667282285349*^9, 3.686672851705336*^9}, {
   3.68667402398144*^9, 3.686674024156755*^9}, {3.686674156785902*^9, 
   3.686674173992827*^9}, {3.686677981137723*^9, 3.686677981291198*^9}, {
   3.6905152558431525`*^9, 3.6905152616479993`*^9}, {3.690560052252635*^9, 
   3.69056005249806*^9}, {3.690562286998247*^9, 3.690562321050914*^9}, {
   3.69056237085006*^9, 3.6905623857432775`*^9}, 3.690650101348329*^9, {
   3.690650726564806*^9, 3.690650739223259*^9}, {3.6907289454148703`*^9, 
   3.690728968386346*^9}, {3.690729811643052*^9, 3.690729813698566*^9}, {
   3.690730235136895*^9, 3.6907302352890997`*^9}, {3.690730268345949*^9, 
   3.690730277537841*^9}, {3.694871052233786*^9, 3.694871058591963*^9}, {
   3.6948712303978977`*^9, 3.6948712476848087`*^9}, {3.699979370607155*^9, 
   3.699979449508545*^9}, {3.699980388991928*^9, 3.6999803963472424`*^9}, {
   3.699980464790619*^9, 3.6999804849270573`*^9}, {3.6999805383559713`*^9, 
   3.69998056396454*^9}, {3.69998060241968*^9, 3.6999806408287106`*^9}, {
   3.7005829324643664`*^9, 3.7005830091363564`*^9}, {3.7005830454346237`*^9, 
   3.7005831365241737`*^9}, 3.7005831717371736`*^9, {3.7005849282209883`*^9, 
   3.7005850466897135`*^9}, {3.700585161412724*^9, 3.7005852982875395`*^9}, {
   3.700585333217291*^9, 3.7005854434806037`*^9}, {3.700585523372984*^9, 
   3.700585644047885*^9}, {3.7005857736388206`*^9, 3.7005858536032057`*^9}, {
   3.700585884880032*^9, 3.7005859413978615`*^9}, {3.700585977245121*^9, 
   3.7005859938077445`*^9}, {3.700586437306136*^9, 3.700586446386685*^9}, {
   3.7005865023154197`*^9, 3.7005865098231306`*^9}, {3.7015357935486946`*^9, 
   3.7015357947681475`*^9}, {3.701536186911565*^9, 3.7015361870364184`*^9}, {
   3.701537377730435*^9, 3.7015373778710766`*^9}, {3.7015383552880116`*^9, 
   3.7015383560714664`*^9}, 3.7015384155288506`*^9, {3.7015388413439493`*^9, 
   3.701538841780114*^9}, 3.7015388859970074`*^9, {3.7015392240506377`*^9, 
   3.7015392366879363`*^9}, {3.701539781290902*^9, 3.701539785894799*^9}, {
   3.701540843699538*^9, 3.701540853495346*^9}, {3.701612523680913*^9, 
   3.7016125270325212`*^9}, {3.701613260109211*^9, 3.7016132629707117`*^9}, {
   3.7016951494239483`*^9, 3.7016951496077423`*^9}, {3.702317232347563*^9, 
   3.7023172414842873`*^9}, {3.702317298820012*^9, 3.702317322415757*^9}, {
   3.702317370405278*^9, 3.702317377670361*^9}, {3.70231754138198*^9, 
   3.70231779287877*^9}, {3.702317846191596*^9, 3.702317847078679*^9}, 
   3.702317933968533*^9, {3.7023198206646013`*^9, 3.702319822688551*^9}, {
   3.702319882281266*^9, 3.7023198973687887`*^9}, {3.702319953672947*^9, 
   3.702319955048285*^9}, 3.702321097901084*^9, {3.702321186752553*^9, 
   3.7023211876482153`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotS", " ", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"fitS", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1000"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "]"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotP", " ", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"fitP", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1000"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0.3", ",", "0.5", ",", "0.75"}], "]"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"plotM", ",", "plotD", ",", "plotP", ",", "plotS"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.702317941553743*^9, 3.702317995185628*^9}, {
  3.7023180379017477`*^9, 3.702318061601581*^9}, {3.702318260317573*^9, 
  3.702318264125586*^9}, {3.702319711184643*^9, 3.702319712416724*^9}, {
  3.702319752316592*^9, 3.702319753253189*^9}, {3.702319911892082*^9, 
  3.702319925348009*^9}, {3.7023200135437098`*^9, 3.7023200147916327`*^9}, {
  3.702320051719733*^9, 3.70232005583974*^9}, {3.7023201042843533`*^9, 
  3.702320106123273*^9}, {3.702320222203229*^9, 3.702320250687497*^9}, {
  3.7023204854510403`*^9, 3.702320502779001*^9}, {3.702320543142473*^9, 
  3.7023206231787243`*^9}, {3.702320671038409*^9, 3.702320721601685*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{1920, 1176},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification->1.5,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 94, 1, 46, "Input"],
Cell[CellGroupData[{
Cell[677, 25, 153, 2, 139, "Title"],
Cell[CellGroupData[{
Cell[855, 31, 179, 3, 96, "Section"],
Cell[CellGroupData[{
Cell[1059, 38, 150, 2, 67, "Subsection"],
Cell[1212, 42, 301, 6, 49, "Text"],
Cell[1516, 50, 959, 23, 125, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2512, 78, 191, 3, 67, "Subsection"],
Cell[2706, 83, 163, 4, 49, "Text"],
Cell[2872, 89, 6756, 154, 393, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9677, 249, 245, 4, 96, "Section"],
Cell[CellGroupData[{
Cell[9947, 257, 208, 3, 67, "Subsection"],
Cell[10158, 262, 1613, 47, 179, "Text"],
Cell[11774, 311, 6878, 112, 136, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18689, 428, 190, 3, 67, "Subsection"],
Cell[18882, 433, 5247, 99, 151, "Input"],
Cell[24132, 534, 3008, 77, 334, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27177, 616, 192, 3, 67, "Subsection"],
Cell[27372, 621, 5108, 145, 546, "Input"],
Cell[32483, 768, 125, 3, 59, "Input"],
Cell[32611, 773, 4480, 116, 449, "Input"],
Cell[37094, 891, 5846, 161, 717, "Input"],
Cell[CellGroupData[{
Cell[42965, 1056, 356, 5, 55, "Subsubsection"],
Cell[43324, 1063, 8378, 185, 426, "Input"],
Cell[51705, 1250, 94, 1, 46, "Input"],
Cell[51802, 1253, 94, 1, 46, "Input"],
Cell[51899, 1256, 6189, 168, 550, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58149, 1431, 252, 4, 96, "Section"],
Cell[CellGroupData[{
Cell[58426, 1439, 263, 9, 67, "Subsection"],
Cell[58692, 1450, 4207, 83, 172, "Input"],
Cell[62902, 1535, 7736, 164, 580, "Input"],
Cell[70641, 1701, 8283, 201, 426, "Input"],
Cell[78927, 1904, 2252, 52, 194, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

