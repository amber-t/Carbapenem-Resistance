(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33653,        949]
NotebookOptionsPosition[     32861,        923]
NotebookOutlinePosition[     33304,        940]
CellTagsIndexPosition[     33261,        937]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   StyleBox[
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}],
    FontWeight->"Plain"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
      RowBox[{"NotebookEventActions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
         RowBox[{"FrontEndExecute", "[", 
          RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}],
           "]"}]}], "}"}]}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6894409661843815`*^9, 3.6894409666045732`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"countryname", "=", "\"\<United States\>\""}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<DataSheet_cddep.xlsx\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Data\>\"", ",", "countryname"}], "}"}]}], "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"years", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tt", " ", "=", " ", 
     RowBox[{"Length", "[", "years", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nop", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "-", "4"}], ")"}], "/", "2"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"isolates", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", 
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "-", "3"}], ";;", "2"}], "]"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resistance", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"3", ";;", 
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "-", "3"}], ";;", "2"}], "]"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rfreq", " ", "=", 
     RowBox[{"resistance", "/", "isolates"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"carbcons", " ", "=", " ", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "3"}], "]"}], "]"}], "/", "10000"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conbreak", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", 
        RowBox[{"1", ";;", "nop"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cardiv", " ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"carbcons", "*", 
        RowBox[{"conbreak", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nop"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pc", " ", "=", "  ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "proportion", " ", "of", " ", "carbapanem", " ", "prescription", " ", 
     "out", " ", "of", " ", "all", " ", "antibiotics", " ", "prescribed", " ",
      "for", " ", "bacterial", " ", "pneuomonia", " ", 
     RowBox[{"NOTE", ":", " ", 
      RowBox[{"Update", " ", "with", " ", "better", " ", 
       RowBox[{"estimate", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tc", " ", "=", " ", 
     RowBox[{"cardiv", "/", "pc"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "Total", " ", "antibiotics", " ", "prescribed", " ", "for", " ", 
     "bacterial", " ", 
     RowBox[{"pneumonia", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prop", " ", "=", " ", 
     RowBox[{"cardiv", "/", "tc"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diff", " ", "=", " ", 
     RowBox[{"tc", "-", "cardiv"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6894409426071267`*^9, 3.6894409428552637`*^9}, {
  3.689561801148302*^9, 3.689561811731206*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"t_", ",", "r0_", ",", "a_", ",", "nn_"}], "]"}], " ", ":=", 
     " ", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "a", ")"}], "*", " ", 
           RowBox[{"Total", "[", 
            RowBox[{"cn", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "t"}], "]"}], "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"theta", "-", "1"}], ")"}], "*", "nn"}], ")"}], "*", 
           "t"}]}], ")"}]], " "}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "a", ")"}], "*", " ", 
           RowBox[{"Total", "[", 
            RowBox[{"cn", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "t"}], "]"}], "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"theta", "-", "1"}], ")"}], "*", "nn"}], ")"}], "*", 
           "t"}]}], ")"}]], " ", " "}]]}], " ", ";"}],
   FontWeight->"Plain"], 
  StyleBox[" ",
   FontWeight->"Plain"]}]], "Input",
 CellChangeTimes->{{3.689440979430402*^9, 3.6894410317365065`*^9}, {
   3.689442797573896*^9, 3.6894428063852963`*^9}, {3.689444044263901*^9, 
   3.6894440451652994`*^9}, {3.6894451703673973`*^9, 
   3.6894452058103237`*^9}, {3.6894478457813396`*^9, 3.689447852770524*^9}, {
   3.6894481231747704`*^9, 3.6894481390580177`*^9}, {3.689561399207842*^9, 
   3.6895614170290294`*^9}, 3.689562768831765*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"thetarand", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"BetaDistribution", "[", 
         RowBox[{"240", ",", "4"}], "]"}], ",", "10"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ssize", "=", 
      RowBox[{"Length", "[", "thetarand", "]"}]}], ";"}]}],
   FontWeight->"Plain"]}]], "Input",
 CellChangeTimes->{{3.6895614018576937`*^9, 3.6895614020267353`*^9}, {
   3.6895616457091646`*^9, 3.689561662265583*^9}, {3.6895620382744827`*^9, 
   3.6895620394867535`*^9}, {3.68956263831409*^9, 3.6895626620057487`*^9}, {
   3.6895626942917366`*^9, 3.6895626973754945`*^9}, {3.6895627627702427`*^9, 
   3.6895627630705404`*^9}, {3.689562927160103*^9, 3.6895629273028765`*^9}, {
   3.689569364415447*^9, 3.689569367103428*^9}, 3.689569446691983*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"Lik", "[", 
      RowBox[{"r0_", ",", "a_", ",", "nn_"}], "]"}], ":=", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Binomial", "[", 
           RowBox[{
            RowBox[{"iso", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"resis", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"resis", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"Log", "[", 
           RowBox[{"r", "[", 
            RowBox[{
             RowBox[{"j", "-", "1"}], ",", "r0", ",", "a", ",", "nn"}], "]"}],
            "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"iso", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "-", 
            RowBox[{"resis", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", 
            RowBox[{"r", "[", 
             RowBox[{
              RowBox[{"j", "-", "1"}], ",", "r0", ",", "a", ",", "nn"}], 
             "]"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}], "]"}]}], 
    "\[IndentingNewLine]"}],
   FontWeight->"Plain"]}]], "Input",
 CellChangeTimes->{{3.689441040598444*^9, 3.6894410764792*^9}, {
   3.6894428124764104`*^9, 3.689442845967552*^9}, {3.6894441092082243`*^9, 
   3.689444109971221*^9}, {3.6894452264563074`*^9, 3.6894452289157534`*^9}, {
   3.68944788316933*^9, 3.689447943543269*^9}, {3.6894480496494646`*^9, 
   3.6894480653223505`*^9}, {3.68944811917275*^9, 3.6894481204196353`*^9}, 
   3.689448181621953*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"max", "  ", "=", " ", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "ssize", ",", "Null"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fr0", " ", "=", " ", "max"}], ";", " ", 
    RowBox[{"fa", "=", "max"}], ";", " ", 
    RowBox[{"fnn", "=", "max"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "ssize"}], ",", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"iso", "=", 
        RowBox[{"isolates", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        StyleBox["resis",
         FontWeight->"Plain"], 
        StyleBox[" ",
         FontWeight->"Plain"], 
        StyleBox["=",
         FontWeight->"Plain"], 
        StyleBox[" ",
         FontWeight->"Plain"], 
        RowBox[{"resistance", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"cn", " ", "=", " ", 
        RowBox[{"cardiv", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"df", " ", "=", 
        RowBox[{"diff", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"theta", "=", 
        RowBox[{"thetarand", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{
        StyleBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"max", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"fr0", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"fa", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"fnn", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}],
         FontWeight->"Plain"], 
        StyleBox["=",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox["NMaximize",
          FontWeight->"Plain"], 
         StyleBox["[",
          FontWeight->"Plain"], 
         RowBox[{
          RowBox[{
           StyleBox["{",
            FontWeight->"Plain"], 
           RowBox[{
            StyleBox[
             RowBox[{"Lik", "[", 
              RowBox[{"r0", ",", "a", ",", "nn"}], "]"}],
             FontWeight->"Plain"], 
            StyleBox[",",
             FontWeight->"Plain"], 
            RowBox[{
             StyleBox["0",
              FontWeight->"Plain"], 
             StyleBox["<",
              FontWeight->"Plain"], 
             StyleBox[" ",
              FontWeight->"Plain"], 
             StyleBox["r0",
              FontWeight->"Plain"], 
             StyleBox["<",
              FontWeight->"Plain"], " ", "1"}], ",", " ", 
            RowBox[{"nn", ">", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            StyleBox["r0",
             FontWeight->"Plain"], 
            StyleBox[",",
             FontWeight->"Plain"], 
            StyleBox["a",
             FontWeight->"Plain"], ",", "nn"}], 
           StyleBox["}",
            FontWeight->"Plain"]}], 
          StyleBox[",",
           FontWeight->"Plain"], 
          StyleBox[" ",
           FontWeight->"Plain"], 
          StyleBox[
           RowBox[{"MaxIterations", "\[Rule]", "100000"}],
           FontWeight->"Plain"]}], 
         StyleBox["]",
          FontWeight->"Plain"]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   "max", "\[IndentingNewLine]", 
   RowBox[{"mfr0", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fr0", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"mfa", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fa", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"mfnn", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fnn", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.689441088566675*^9, 3.689441178322273*^9}, {
  3.689441556006033*^9, 3.689441608246731*^9}, {3.6894416833927794`*^9, 
  3.6894416855111303`*^9}, {3.689441788251275*^9, 3.689441838490698*^9}, {
  3.6894428176335907`*^9, 3.6894429106790905`*^9}, {3.6894429769902167`*^9, 
  3.689442979928136*^9}, {3.6894441437013845`*^9, 3.689444147135224*^9}, {
  3.689444181276481*^9, 3.689444195324692*^9}, {3.6894442498479104`*^9, 
  3.689444252003417*^9}, {3.6894465838118362`*^9, 3.689446585777645*^9}, {
  3.689562385789959*^9, 3.689562394817384*^9}, {3.6895624750411863`*^9, 
  3.689562494782691*^9}, {3.689562534794813*^9, 3.689562535381037*^9}, {
  3.689562804697129*^9, 3.689562804994833*^9}, {3.68956283712304*^9, 
  3.689562840717059*^9}, {3.689562873494322*^9, 3.689562907729528*^9}, {
  3.689563050031664*^9, 3.6895630505491543`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "tt"}], "]"}]}], ";"}], " "}],
    FontWeight->"Plain"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"res", " ", "=", " ", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"years", ",", 
        RowBox[{"rfreq", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], ";"}], 
   RowBox[{
    StyleBox["(*",
     FontWeight->"Plain"], 
    RowBox[{"resistance", " ", "frequency", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "  ", "=", " ", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "ssize", ",", "Null"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "ssize"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"iso", "=", 
         RowBox[{"isolates", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         StyleBox["resis",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["=",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         RowBox[{"resistance", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"cn", " ", "=", " ", 
         RowBox[{"cardiv", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"df", " ", "=", 
         RowBox[{"diff", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"theta", "=", 
         RowBox[{"thetarand", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"j", ",", 
             RowBox[{"mfr0", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"mfa", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"mfnn", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "tt"}], "}"}]}], "]"}]}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fit", " ", "=", "  ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"years", ",", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6894419164207587`*^9, 3.6894419766889577`*^9}, {
  3.6894431251036544`*^9, 3.6894431269597178`*^9}, {3.689444371976009*^9, 
  3.6894443727931848`*^9}, {3.689445313762127*^9, 3.6894453272561584`*^9}, {
  3.6895629599198465`*^9, 3.6895631142048388`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"plotD", " ", "=", " ", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", "\"\<Resistance frequency\>\"", "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (K.P.)\>\""}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotM", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fit", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Orange", ",", "Thick"}], "}"}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<United States (KP)\>\""}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", "\"\<Model fit\>\"", "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.689441994156726*^9, 3.689441994378536*^9}, {
  3.6895631264980745`*^9, 3.6895631493220453`*^9}, {3.689563187534953*^9, 
  3.6895632320653954`*^9}, {3.6895638832897243`*^9, 3.6895638844004245`*^9}, {
  3.689563916219065*^9, 3.689563960162656*^9}, {3.6895639966084085`*^9, 
  3.6895640070061455`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"plotD", ",", 
       RowBox[{"plotM", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6894420031413636`*^9, 3.6894420034151273`*^9}, {
   3.6895632522214766`*^9, 3.6895632826083126`*^9}, {3.689563337685668*^9, 
   3.6895633785359845`*^9}, {3.689563569864748*^9, 3.68956360023534*^9}, {
   3.689563642186637*^9, 3.689563695788314*^9}, {3.6895638512890234`*^9, 
   3.689563862373593*^9}, {3.6895638936386924`*^9, 3.689563893971821*^9}, {
   3.6895640218226347`*^9, 3.689564036307526*^9}, 3.6895643287194443`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tcI", " ", "=", " ", 
   RowBox[{"cardivSQ", "/", "pc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"curcarb", " ", "=", " ", 
    RowBox[{"carbcons", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"current", " ", "carbapenem", " ", "consumption"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"py", " ", "=", "2020"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"projection", " ", "till", " ", "year", " ", "py"}], "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"npy", " ", "=", " ", 
   RowBox[{"py", " ", "-", 
    RowBox[{"years", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyears", " ", "=", " ", 
    RowBox[{"Range", "[", " ", 
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], ",", "py"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Status", " ", "Quo", " ", "consumtions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projSQ", " ", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"curcarb", ",", 
      RowBox[{"Round", "[", "npy", "]"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "maintaining", " ", "current", " ", "carbapenem", " ", "consumption", " ", 
    "levels"}], "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"carbconSQ", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"carbcons", ",", "projSQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cardivSQ", " ", "=", 
   RowBox[{"carbconSQ", "*", 
    RowBox[{"conbreak", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tcSQ", " ", "=", " ", 
    RowBox[{"cardivSQ", "/", "pc"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Total", " ", "antibiotics", " ", "prescribed", " ", "for", " ", 
    "bacterial", " ", 
    RowBox[{"pneumonia", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffSQ", " ", "=", " ", 
    RowBox[{"tcSQ", "-", "cardivSQ"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Intervention", " ", "consumtions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intv", " ", "=", " ", "0.01"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "reducing", " ", "current", " ", "carbapenem", " ", "consumption", " ", 
    "by", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "intv"}], ")"}], " ", "%", " ", "in", " ", "next", " ",
     "npy", " ", "years", " ", "linearly"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projI", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"curcarb", ",", 
     RowBox[{"intv", "*", "curcarb"}], ",", 
     RowBox[{"curcarb", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"intv", "-", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"npy", "-", "1"}], ")"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"carbconI", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"carbcons", ",", "projI"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cardivI", " ", "=", 
   RowBox[{"carbconI", "*", 
    RowBox[{"conbreak", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tcI", " ", "=", " ", 
    RowBox[{"cardivSQ", "/", "pc"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Total", " ", "antibiotics", " ", "prescribed", " ", "for", " ", 
    "bacterial", " ", 
    RowBox[{"pneumonia", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffI", " ", "=", " ", 
    RowBox[{"tcI", "-", "cardivI"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Status", " ", "Quo", " ", "resistances"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "ssize", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "ssize"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"cn", " ", "=", " ", "cardivSQ"}], ",", 
      RowBox[{"df", " ", "=", 
       RowBox[{"diffSQ", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"theta", "=", 
       RowBox[{"thetarand", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"j", ",", 
           RowBox[{"mfr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfa", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfnn", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "tt", ",", 
           RowBox[{"tt", "+", "npy"}]}], "}"}]}], "]"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prrSQ", " ", "=", "  ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"pyears", ",", 
         RowBox[{"y", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Intervention", " ", "resistances"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "  ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "ssize", ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "ssize"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iso", "=", 
       RowBox[{"isolates", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       StyleBox["resis",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{"resistance", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"cn", " ", "=", " ", "cardivI"}], ",", 
      RowBox[{"df", " ", "=", 
       RowBox[{"diffI", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"theta", "=", 
       RowBox[{"thetarand", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"j", ",", 
           RowBox[{"mfr0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfa", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"mfnn", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "tt", ",", 
           RowBox[{"tt", "+", "npy"}]}], "}"}]}], "]"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prrI", " ", "=", "  ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"pyears", ",", 
        RowBox[{"z", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"y", ";"}], "\[IndentingNewLine]", 
 RowBox[{"z", ";"}]}], "Input",
 CellChangeTimes->{{3.689442033395587*^9, 3.6894420336117496`*^9}, {
   3.6894420638190365`*^9, 3.68944211514124*^9}, {3.6894423705746*^9, 
   3.6894423753509507`*^9}, {3.6894431584142456`*^9, 
   3.6894431841238623`*^9}, {3.6894432150980883`*^9, 
   3.6894432155299826`*^9}, {3.689443627093711*^9, 3.6894436274102793`*^9}, {
   3.689443683507738*^9, 3.689443683696218*^9}, {3.6894453608659506`*^9, 
   3.689445363569457*^9}, {3.689446329884709*^9, 3.689446341982955*^9}, {
   3.689564344820803*^9, 3.689564443618291*^9}, 3.6895644897326827`*^9, {
   3.689565096816247*^9, 3.6895650979165473`*^9}, {3.6895673464589715`*^9, 
   3.689567347550646*^9}, {3.6895678482742205`*^9, 3.689567865391934*^9}, {
   3.6895680754116864`*^9, 3.689568079907199*^9}, {3.689568268334882*^9, 
   3.6895682940909605`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"plotPSQ", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prrSQ", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Orange", ",", "Thick", ",", "Dashed"}], "}"}], "}"}]}], 
         ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", "\"\<Status Quo projection\>\"", "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotPI", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prrI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", "Thick", ",", "Dashed"}], "}"}], "}"}]}], 
         ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Year", ",", "Resistance"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<United States\>\""}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", "\"\<Intervention projection\>\"", "}"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6894421322417164`*^9, 3.6894421324640255`*^9}, {
   3.6894422486516123`*^9, 3.689442251904478*^9}, 3.689446248699128*^9, {
   3.6895673638833656`*^9, 3.68956737932907*^9}, {3.689567651308831*^9, 
   3.6895677290805984`*^9}, {3.6895677753149433`*^9, 3.6895678293132315`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"plotD", ",", 
      RowBox[{"plotM", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"plotPSQ", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"plotPI", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "ssize"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6895682994087067`*^9, 3.6895683461836987`*^9}}]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{638, 628},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 801, 20, 145, "Input"],
Cell[1362, 42, 3708, 105, 392, "Input"],
Cell[5073, 149, 1848, 51, 72, "Input"],
Cell[6924, 202, 900, 20, 69, "Input"],
Cell[7827, 224, 1845, 48, 126, "Input"],
Cell[9675, 274, 5312, 148, 259, "Input"],
Cell[14990, 424, 3119, 90, 183, "Input"],
Cell[18112, 516, 1898, 45, 164, "Input"],
Cell[20013, 563, 783, 16, 50, "Input"],
Cell[20799, 581, 9137, 265, 791, "Input"],
Cell[29939, 848, 2326, 56, 240, "Input"],
Cell[32268, 906, 589, 15, 69, "Input"]
}
]
*)

