(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52070,       1213]
NotebookOptionsPosition[     49936,       1145]
NotebookOutlinePosition[     50300,       1161]
CellTagsIndexPosition[     50257,       1158]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Carbapenem",
  IgnoreSpellCheck->True,
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[0.5019607843137255, 0., 0.]],
 StyleBox[" Resistance Model: ", "Subchapter",
  FontFamily->"Arial",
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[0.5019607843137255, 0., 0.]]
}], "Text",
 CellChangeTimes->{{3.6768904540863285`*^9, 3.676890461169381*^9}, {
   3.683030854794117*^9, 3.6830308835865154`*^9}, {3.683032131761671*^9, 
   3.683032133824201*^9}, 3.683032438777007*^9, {3.683035168869869*^9, 
   3.683035172546686*^9}, {3.683287309412829*^9, 3.6832873106672077`*^9}}],

Cell[TextData[{
 "Objective:",
 StyleBox[" Whereas a clear correlation exists between consumption of \
antibiotics and the evolution of resistance in microbial communities, the \
effect of reduction of usage is less clear. To project the future frequency \
of carbapenem resistance, based on yearly surveillance data and consumption \
data. A population genetic model was adapted to retrospectively estimate the \
relationship between evolutionary fitness of carbapenem resistance and \
carbapenem consumption.",
  FontWeight->"Plain"]
}], "WolframAlphaShort",
 CellChangeTimes->{{3.683287531459428*^9, 3.68328782137551*^9}, {
  3.68328787870195*^9, 3.683287937627846*^9}}],

Cell[TextData[{
 "Derivation: ",
 StyleBox["We fit the historical selection to consumption via a \
deterministic, continuous-time haploid model of the frequency of resistance. \
See, for reference: 1) Hartl, Daniel L., Andrew G. Clark, and Andrew G. \
Clark. Principles of population genetics. Vol. 116. Sunderland: Sinauer \
associates, 1997",
  FontWeight->"Plain"],
 StyleBox["\[LongDash]base population genetic model",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["; 2) Nielsen, K. M., & Townsend, J. P. (2004). Monitoring and \
modeling horizontal gene transfer. Nature biotechnology, 22(9), 1110-1114",
  FontWeight->"Plain"],
 StyleBox["\[LongDash]relation of base model to novel DNA such as \
antimicrobial resistance elements",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["; and 3) Johnsen, P. J., Townsend, J. P., B\[OSlash]hn, T., \
Simonsen, G. S., Sundsfjord, A., & Nielsen, K. M. (2011). Retrospective \
evidence for a biological cost of vancomycin resistance determinants in the \
absence of glycopeptide selective pressures. Journal of antimicrobial \
chemotherapy, 66(3), 608-610 \[LongDash]",
  FontWeight->"Plain"],
 StyleBox["application of base model to project future vancomycin resistance \
after ban of use",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "WolframAlphaShort",
 CellChangeTimes->{{3.68328801131289*^9, 3.683288095811304*^9}, {
  3.6832882991763897`*^9, 3.6832883547127113`*^9}, {3.6832884127485647`*^9, 
  3.683288449808461*^9}, {3.683288516186564*^9, 3.683288516516803*^9}, {
  3.68328909124573*^9, 3.683289317678453*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\[IndentingNewLine]", "Text",
   FontColor->GrayLevel[0]], 
  StyleBox[" ", "Text",
   FontColor->GrayLevel[0]], 
  StyleBox["\[IndentingNewLine]", "Text",
   FontColor->GrayLevel[0]], Cell[TextData[{
   StyleBox[
   "Note that the likelihood function used here will additionally be improved \
from that used in the preliminary model above. Because surveillance is \
conducted by sampling and testing for resistance, likelihood can be \
quantified under better distributional assumptions, with greater accuracy and \
precision. Instead of the observed frequencies of resistance (which are not \
certain), likelihood can be calculated based on the observed cases of \
resistant (",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKResistance, ",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox["above) vs. non-resistant (",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKIsolates",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[" \[Dash] ",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKResistance",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[
   ", above) measured by surveillance\[LongDash]see for instance, Johnsen, P. \
J., Townsend, J. P., B\[OSlash]hn, T., Simonsen, G. S., Sundsfjord, A., & \
Nielsen, K. M. (2011). Retrospective evidence for a biological cost of \
vancomycin resistance determinants in the absence of glycopeptide selective \
pressures. Journal of antimicrobial chemotherapy, 66(3), 608-610.",
    FontSize->12,
    FontWeight->"Plain"]
  }], "WolframAlphaShort",
   CellChangeTimes->{{3.683289726057184*^9, 3.683289961266238*^9}, {
    3.683290062090114*^9, 3.6832901235745173`*^9}, {3.683290162800928*^9, 
    3.683290243023469*^9}, {3.683290380014368*^9, 
    3.6832903934151173`*^9}}]}]], "Input",
 CellChangeTimes->{{3.6842764127975616`*^9, 3.6842764132519383`*^9}, {
   3.684276445113677*^9, 3.6842764490391874`*^9}, {3.6842783785851593`*^9, 
   3.6842784076253023`*^9}, 3.684521334837637*^9, {3.684581585313509*^9, 
   3.68458159513621*^9}, 3.6845816560655518`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.684276369550303*^9, 3.6842763706987057`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["First, we test the simple model with two selection \
coefficients:", "Text",
 FontSize->12,
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.684250252606157*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["(1) a = the growth rate of resistant Klebsiella that \
are exposed to carbapenems--i.e. under positive selection conditions, ", \
"Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
   3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
   3.6842494396675725`*^9}, {3.6842499835106816`*^9, 
   3.6842500799092245`*^9}, {3.6842501329781685`*^9, 3.6842502523153934`*^9}, 
   3.6842503011757836`*^9}],

Cell[TextData[StyleBox["(2) d = the growth rate of nonresistant Klebsiella \
that are not exposed to carbapenems--i.e. natural growth rate with no \
selection.", "Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.6842503444819756`*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["We make the following assumptions:", "Text",
 FontSize->12,
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.6842503519367795`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["(1) All nonresistant Klebsiella that are exposed to \
carbapenems will die (growth rate=0)", "Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250420720542*^9}}],

Cell[TextData[StyleBox["(2) Resistant Klebsiella that are not exposed to \
carbapenems will also have a growth rate of 0", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.6842505098820148`*^9}}],

Cell[TextData[StyleBox["(3) Alternative treatments are not effective ", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.6842527004125986`*^9}}],

Cell[TextData[StyleBox["(4) All consumption data is for the community sector \
only", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.68425270950678*^9}, {
  3.684257529624141*^9, 3.6842575298888445`*^9}, {3.684274813223451*^9, 
  3.6842748132239523`*^9}}],

Cell[TextData[StyleBox["(5) No co-selection of resistance", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.68425270950678*^9}, {
  3.684257529624141*^9, 3.6842575298888445`*^9}, {3.6842748137558994`*^9, 
  3.6842748213602905`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6842764046032205`*^9, 3.6842766068918996`*^9}],

Cell[BoxData[
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}],
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.6842575509197516`*^9, 3.684257556710144*^9}, {
  3.684522190991454*^9, 3.684522192998961*^9}}],

Cell[BoxData[
 StyleBox[
  RowBox[{"Load", " ", "Data"}], "Subsubsection",
  FontFamily->"Arial",
  FontSize->16,
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.6833123864295473`*^9, 3.6833123921723623`*^9}, 
   3.683312535239305*^9, 3.684583880402137*^9}],

Cell[TextData[StyleBox["Number of resistant isolates recovered, each year \
2005\[Dash]2014; Number of isolates tested, each year 2005\[Dash]2014, \
estimated frequencies of resistance, 2005\[Dash]2014.",
 FontWeight->"Bold"]], "WolframAlphaShort",
 CellChangeTimes->{3.6833125416696196`*^9}],

Cell[BoxData[
 RowBox[{Cell[TextData[StyleBox[
  "Where c = country-wide consumption of carbapenems (DDD/1000 patient-days); \
TotalAb = country-wide total antibiotic consumption (DDD/1000 patient-days); \
Isolates = number of K. pneumoniae isolates tested for resistance; Resistance \
= number of isolates resistant; p = prescription guideline for carbapenems = \
[c(t) * of carbapenems used how many are prescribed to Klebsiella] / [total \
antibiotic use * of antibiotics used how many are prescribed to Klebsiella] = \
(c * fc) / (TotalAb * fa); note that fc and fa will be informed by data, but \
for now we're just assuming values",
   FontSize->12,
   FontWeight->"Plain"]], "WolframAlphaShort",
   CellChangeTimes->{{3.684275162081479*^9, 3.684275259387556*^9}}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.684276626087678*^9, 3.684276633866375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"CountryName", "=", "\"\<France\>\""}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"Data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<DataSheet.xlsx\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Data\>\"", ",", "CountryName"}], "}"}]}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"c", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Data", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"TotalAb", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Data", "[", 
       RowBox[{"[", "5", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Isolates", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Data", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"Resistance", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Data", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"RData", "=", 
     RowBox[{"Resistance", "/", "Isolates"}]}], ";"}], "\[IndentingNewLine]"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"fc", "=", "0.001"}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"fa", "=", "0.001"}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"p", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c", "*", "fc"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"TotalAb", "*", "fa"}], ")"}]}]}],
  FontWeight->"Plain"]}], "Input",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.683312400324967*^9, 3.6833124031150155`*^9}, {
   3.683312480037506*^9, 3.6833124823054457`*^9}, {3.683379752371278*^9, 
   3.6833797696750727`*^9}, {3.683379810011568*^9, 3.683379819174758*^9}, {
   3.6833802080536895`*^9, 3.6833802276010804`*^9}, 3.683380425541297*^9, {
   3.68338106054252*^9, 3.6833810607194576`*^9}, {3.6839883916115713`*^9, 
   3.683988392688233*^9}, {3.683989219571862*^9, 3.683989221574518*^9}, {
   3.6839892986858616`*^9, 3.6839893015491314`*^9}, {3.6839893392827463`*^9, 
   3.6839893583118525`*^9}, 3.683990839221222*^9, {3.683992475254762*^9, 
   3.6839924771674805`*^9}, {3.683993284011052*^9, 3.6839932846493635`*^9}, {
   3.6839933150984974`*^9, 3.683993315176551*^9}, {3.683993349236903*^9, 
   3.6839933493165665`*^9}, {3.6839935683808355`*^9, 
   3.6839935700088077`*^9}, {3.6842495880641026`*^9, 
   3.6842496185009174`*^9}, {3.684249966061616*^9, 3.68424997889145*^9}, {
   3.684250586265329*^9, 3.6842506241309433`*^9}, {3.684251332412817*^9, 
   3.6842514327996097`*^9}, 3.684251464663023*^9, {3.684251599960285*^9, 
   3.6842516061667867`*^9}, {3.684251742393967*^9, 3.6842517971766634`*^9}, {
   3.6842518642219057`*^9, 3.6842520155127025`*^9}, {3.6842520757261124`*^9, 
   3.6842521362095737`*^9}, {3.6842527775857663`*^9, 3.68425290136173*^9}, {
   3.6842529330553384`*^9, 3.684252984028108*^9}, {3.6842531653414726`*^9, 
   3.684253219263065*^9}, 3.684257588496031*^9, {3.684258797957877*^9, 
   3.6842588200158367`*^9}, 3.6842748273961296`*^9, {3.6842751423648367`*^9, 
   3.6842751434955735`*^9}, 3.684514548120756*^9},
 TextJustification->1.],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.00001792114695340502`", ",", "0.00005944055944055944`", ",", 
   "0.00006405693950177935`", ",", "0.00006081081081081081`", ",", 
   "0.00007092198581560284`", ",", "0.00010801393728222996`", ",", 
   "0.00013468013468013467`", ",", "0.00014617940199335548`", ",", 
   "0.00015517241379310343`"}], "}"}]], "Output",
 CellChangeTimes->{3.684583955946458*^9, 3.6845854442724457`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox["Model", "Subsubsection"], Cell[TextData[{
   StyleBox["Definitions: ", "Text",
    FontSize->12],
   StyleBox[
   "r is the frequency of resistance at time t, r0 is the initial frequency \
of resistance, p is the proportion of carbapenems prescribed, and m is the \
continuous time Malthusian selection coefficients for resistant K. pneumoniae \
relative to non-resistant.  [Make them work]", "Text",
    FontSize->12,
    FontWeight->"Plain"]
  }], "WolframAlphaShort",
   CellChangeTimes->{{3.6842495100738378`*^9, 3.684249559065999*^9}, {
    3.6842574951877213`*^9, 3.684257521641042*^9}, {3.6842763811833735`*^9, 
    3.684276385688826*^9}}]}]], "Input",
 CellChangeTimes->{
  3.6845818049499826`*^9, {3.684581846370564*^9, 3.6845818741796207`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"t_", ",", "a_", ",", "d_", ",", "r0_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"RecurrenceTable", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"md", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "\[Equal]", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "t", "]"}], "]"}], "*", 
                RowBox[{"md", "[", "n", "]"}], "*", "a"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"p", "[", 
                   RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"1", " ", "-", " ", 
                  RowBox[{
                   RowBox[{"md", "[", "n", "]"}], "*", "d"}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}]}], ")"}]}], ")"}]], " "}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "t", "]"}], "]"}], "*", 
                 RowBox[{"md", "[", "n", "]"}], "*", "a"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", " ", "-", " ", 
                   RowBox[{"p", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"1", " ", "-", " ", 
                   RowBox[{"md", "[", "n", "]"}]}], ")"}], "*", "d"}], 
                ")"}]}], "*", 
              RowBox[{"(", 
               RowBox[{"n", "+", "1"}], ")"}]}], ")"}]], " "}]]}], ",", 
        RowBox[{
         RowBox[{"md", "[", "1", "]"}], "\[Equal]", "r0"}]}], "}"}], ",", 
      "md", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "t"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"r", "[", 
   RowBox[{"3", ",", "3", ",", "1", ",", "10"}], "]"}],
  FontWeight->"Plain"], "\[IndentingNewLine]"
 StyleBox[,
  FontWeight->"Plain"]}], "Input",
 CellChangeTimes->{{3.6845837812268057`*^9, 3.684583830090269*^9}, {
  3.684583966494416*^9, 3.684583976269998*^9}}],

Cell[BoxData["10.059091762500197`"], "Output",
 CellChangeTimes->{3.684583977826858*^9, 3.6845854478403997`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    StyleBox["Maximum", "Subsubsection"], 
    StyleBox[" ", "Subsubsection"], 
    StyleBox["Likelihood", "Subsubsection"], 
    StyleBox[" ", "Subsubsection"], 
    StyleBox["Function", "Subsubsection"], 
    StyleBox[" ", "Subsection"]}],
   FontFamily->"Arial",
   FontSize->16,
   FontWeight->"Plain"]}]], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.683043381930896*^9}, {3.6830438680227976`*^9, 3.683043868846305*^9}, {
   3.6830442454668694`*^9, 3.683044246033218*^9}, {3.6830448509436717`*^9, 
   3.68304486392202*^9}, {3.683044974754309*^9, 3.683044976185506*^9}, 
   3.6830470434561033`*^9, {3.6830476822802505`*^9, 3.683047683392083*^9}, {
   3.6832872124407597`*^9, 3.68328721500746*^9}, {3.6832893821290617`*^9, 
   3.683289384175683*^9}, {3.6832905325323877`*^9, 3.683290545859972*^9}, {
   3.6832923498581467`*^9, 3.683292380849185*^9}, {3.683292436814889*^9, 
   3.68329244020065*^9}, {3.683301607607415*^9, 3.683301649318082*^9}, 
   3.683304140543382*^9, 3.683308159143393*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"Lik", "[", 
    RowBox[{"a_", ",", "d_", ",", "r0_"}], "]"}], ":=", " ", 
   RowBox[{"Total", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"Isolates", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"Resistance", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"Resistance", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"r", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "a", ",", "d", ",", "r0"}], "]"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Isolates", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"Resistance", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "a", ",", "d", ",", "r0"}], "]"}]}],
          "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2", ",", "10"}], "}"}]}], "]"}], "]"}]}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"Lik", "[", 
   RowBox[{"0.900494", ",", "1.", ",", "0.9"}], "]"}],
  FontWeight->"Plain"]}], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.6830433753306084`*^9}, {3.6830453841421323`*^9, 3.683045385373238*^9}, {
   3.683286539007884*^9, 3.6832865413676167`*^9}, {3.683286571723649*^9, 
   3.6832865735875263`*^9}, {3.6833012740307302`*^9, 
   3.6833013690917635`*^9}, {3.6833024062245913`*^9, 
   3.6833024065060987`*^9}, {3.683303978402192*^9, 3.683303988908411*^9}, {
   3.6833125533026915`*^9, 3.683312560807563*^9}, {3.6833810185649223`*^9, 
   3.6833810198201427`*^9}, {3.683989318168479*^9, 3.6839893298075542`*^9}, {
   3.6839893673194885`*^9, 3.6839893673976536`*^9}, {3.683990817309511*^9, 
   3.683990827773164*^9}, {3.6839912130182624`*^9, 3.683991218852002*^9}, {
   3.6839916027343764`*^9, 3.6839916142562222`*^9}, {3.68399172996832*^9, 
   3.6839917386510878`*^9}, {3.6839922519901714`*^9, 
   3.6839922552887535`*^9}, {3.6839922931173306`*^9, 
   3.6839922993389845`*^9}, {3.6839923304528055`*^9, 
   3.6839923634181767`*^9}, {3.6839924963196344`*^9, 3.683992496670576*^9}, {
   3.6842506328994355`*^9, 3.684250668303567*^9}, {3.684250804898382*^9, 
   3.6842508086219015`*^9}, {3.6842565639448905`*^9, 3.684256569561823*^9}, {
   3.6845845328361998`*^9, 3.684584548735821*^9}, {3.684584831480036*^9, 
   3.6845848516748257`*^9}, {3.68458490135155*^9, 3.684584909022703*^9}, {
   3.684585319937443*^9, 3.684585320090437*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "26605.45068339663`"}], "+", 
    RowBox[{"831.`", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", "n"}], "]"}]}]}], ",", 
   RowBox[{"-", "\[Infinity]"}], ",", 
   RowBox[{"-", "\[Infinity]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6845845493384047`*^9, 3.6845849143136473`*^9, {3.684585314417674*^9, 
   3.684585320748301*^9}, 3.684585460570068*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"{", 
    RowBox[{"max", ",", 
     RowBox[{"{", 
      RowBox[{"fitr0", ",", "fita", ",", "fitd"}], "}"}]}], "}"}],
   FontWeight->"Plain"], 
  StyleBox["=",
   FontWeight->"Bold"], 
  RowBox[{
   StyleBox["FindMaximum",
    FontWeight->"Plain"], 
   StyleBox["[",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     StyleBox["{",
      FontWeight->"Plain"], 
     RowBox[{
      StyleBox[
       RowBox[{"Lik", "[", 
        RowBox[{"r0", ",", "a", ",", "d"}], "]"}],
       FontWeight->"Plain"], 
      StyleBox[",",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{"0.005", "\[LessEqual]", " ", "r0", "\[LessEqual]", "1"}],
       FontWeight->"Plain"], 
      StyleBox[",",
       FontWeight->"Plain"], 
      RowBox[{
       StyleBox["a",
        FontWeight->"Plain"], 
       StyleBox["\[GreaterEqual]",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Bold"], 
       StyleBox["0",
        FontWeight->"Plain"]}], 
      StyleBox[",",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["1",
        FontWeight->"Bold"], 
       StyleBox["\[GreaterEqual]",
        FontWeight->"Bold"], " ", 
       StyleBox["d",
        FontWeight->"Bold"], 
       StyleBox["\[GreaterEqual]",
        FontWeight->"Bold"], 
       StyleBox[" ",
        FontWeight->"Bold"], 
       StyleBox["0",
        FontWeight->"Plain"]}]}], 
     StyleBox["}",
      FontWeight->"Bold"]}], 
    StyleBox[",",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["{",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"r0", ",", "a", ",", "d"}],
      FontWeight->"Plain"], 
     StyleBox["}",
      FontWeight->"Plain"]}]}], 
   StyleBox["]",
    FontWeight->"Plain"]}]}]], "Input",
 CellChangeTimes->{
  3.6833025719707384`*^9, {3.683302654728984*^9, 3.6833026918074894`*^9}, {
   3.683305381726717*^9, 3.683305382733526*^9}, {3.683305436320718*^9, 
   3.6833055620353374`*^9}, {3.68330569242245*^9, 3.6833057132553678`*^9}, {
   3.683305747381054*^9, 3.6833057503116927`*^9}, {3.6833057893957443`*^9, 
   3.6833057936091614`*^9}, {3.6833058313911486`*^9, 
   3.6833058475402813`*^9}, {3.683306174610812*^9, 3.683306356287518*^9}, {
   3.6833064096304584`*^9, 3.683306418368615*^9}, 3.683308229068428*^9, {
   3.68331049567001*^9, 3.683310530465453*^9}, {3.6833121806373806`*^9, 
   3.6833122089168105`*^9}, {3.683989375374545*^9, 3.683989381660236*^9}, {
   3.683989493849289*^9, 3.6839895132433414`*^9}, {3.683989557516734*^9, 
   3.6839895584703636`*^9}, {3.6839895907904367`*^9, 
   3.6839896533894534`*^9}, {3.6839897490318966`*^9, 3.683989749282142*^9}, {
   3.6839898892515697`*^9, 3.683989894755885*^9}, {3.6839901774890537`*^9, 
   3.683990178175762*^9}, {3.683991518343822*^9, 3.6839915347150273`*^9}, {
   3.683991631816806*^9, 3.683991654597389*^9}, {3.6839917726776557`*^9, 
   3.6839917772611647`*^9}, {3.6839918199896245`*^9, 3.683991851784051*^9}, {
   3.684250674404792*^9, 3.684250690668478*^9}, {3.684250819868787*^9, 
   3.6842508198868375`*^9}, {3.6842508636841574`*^9, 3.684250863819541*^9}, {
   3.6842509363963947`*^9, 3.684250941068818*^9}, {3.684256423297306*^9, 
   3.6842564299740553`*^9}, {3.684257250754414*^9, 3.6842572676703825`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "FindMaximum","nrnum",
   "\"The function value \\!\\(\\*RowBox[{\\\"-\\\", RowBox[{\\\"Lik\\\", \
\\\"[\\\", RowBox[{\\\"0.9004939445455475`\\\", \\\",\\\", \\\"1.`\\\", \\\",\
\\\", \\\"0.9`\\\"}], \\\"]\\\"}]}]\\) is not a real number at \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"r0\\\", \\\",\\\", \\\"a\\\", \\\",\\\
\", \\\"d\\\"}], \\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9004939445455475`\\\", \\\",\\\", \\\"1.`\\\", \\\",\\\", \
\\\"0.9`\\\"}], \\\"}\\\"}]\\).\"",2,55,10,19973370419455605031,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.684583983693677*^9}],

Cell[BoxData[
 TemplateBox[{
  "FindMaximum","grad",
   "\"Evaluation of the gradient of function \
\\!\\(\\*RowBox[{\\\"Experimental`NumericalFunction\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Hold\\\", \\\"[\\\", \
RowBox[{\\\"-\\\", RowBox[{\\\"Lik\\\", \\\"[\\\", RowBox[{\\\"r0\\\", \
\\\",\\\", \\\"a\\\", \\\",\\\", \\\"d\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\",\\\", \\\"Block\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"Hold\\\", \\\"[\\\", \\\"r0\\\", \
\\\"]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", RowBox[{\\\"Hold\\\", \\\"[\\\", \
\\\"a\\\", \\\"]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\",\\\", \\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", RowBox[{\\\"Hold\\\", \
\\\"[\\\", \\\"d\\\", \\\"]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"3\\\", \\\",\\\", \\\"817\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"Automatic\\\", \
\\\",\\\", \\\"Automatic\\\", \\\",\\\", \\\"None\\\", \\\",\\\", \\\"2\\\", \
\\\",\\\", \\\"Automatic\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\
\"}\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"8\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"904\\\", \\\",\\\", \
\\\"MachinePrecision\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\
\\\", \\\"Automatic\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Hold\\\", \\\"[\\\", RowBox[{\\\"-\\\", RowBox[{\\\"Lik\\\
\", \\\"[\\\", RowBox[{\\\"r0\\\", \\\",\\\", \\\"a\\\", \\\",\\\", \
\\\"d\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\",\\\", \\\"Block\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"True\\\", \\\",\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"Automatic\\\", \\\",\\\", \
RowBox[{\\\"\\\\\\\"CleanUpRegisters\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"False\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"WarningMessages\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"False\\\"}], \\\",\\\", \
RowBox[{\\\"\\\\\\\"EvaluateSymbolically\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"False\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"RuntimeErrorHandler\\\\\\\"\\\
\", \\\"\[Rule]\\\", RowBox[{\\\"(\\\", RowBox[{\\\"$Failed\\\", \\\"&\\\"}], \
\\\")\\\"}]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\",\\\", \\\"Automatic\\\", \\\",\\\", \\\"\\\\\\\"WVM\\\\\\\"\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"FindMaximum\\\", \\\",\\\", \\\"Automatic\\\", \\\",\\\
\", \\\"None\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"None\\\", \\\",\\\", \\\"None\\\", \\\",\\\", \\\"None\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}]\\) failed at \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9005`\\\", \\\",\\\", \\\"1.`\\\", \\\",\\\", \\\"0.9`\\\"}], \
\\\"}\\\"}]\\).\"",2,55,11,19973370419455605031,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.684583983701262*^9}],

Cell[BoxData[
 TemplateBox[{
  "Set","shape",
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"max\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"fitr0\\\", \\\",\\\", \\\"fita\\\", \\\",\\\", \
\\\"fitd\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"FindMaximum\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Lik\\\", \\\"[\\\", RowBox[{\\\"r0\\\", \\\",\\\", \
\\\"a\\\", \\\",\\\", \\\"d\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"0.005`\
\\\", \\\"\[LessEqual]\\\", \\\"r0\\\", \\\"\[LessEqual]\\\", \\\"1\\\"}], \\\
\",\\\", RowBox[{\\\"a\\\", \\\"\[GreaterEqual]\\\", \\\"0\\\"}], \\\",\\\", \
RowBox[{\\\"1\\\", \\\"\[GreaterEqual]\\\", \\\"d\\\", \
\\\"\[GreaterEqual]\\\", \\\"0\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\
\\\", RowBox[{\\\"r0\\\", \\\",\\\", \\\"a\\\", \\\",\\\", \\\"d\\\"}], \\\"}\
\\\"}]}], \\\"]\\\"}]\\) are not the same shape.\"",2,55,12,
   19973370419455605031,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.68458398370607*^9}],

Cell[BoxData[
 TemplateBox[{
  "FindMaximum","nrnum",
   "\"The function value \\!\\(\\*RowBox[{\\\"-\\\", RowBox[{\\\"Lik\\\", \
\\\"[\\\", RowBox[{\\\"0.9004939445455475`\\\", \\\",\\\", \\\"1.`\\\", \\\",\
\\\", \\\"0.9`\\\"}], \\\"]\\\"}]}]\\) is not a real number at \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"r0\\\", \\\",\\\", \\\"a\\\", \\\",\\\
\", \\\"d\\\"}], \\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9004939445455475`\\\", \\\",\\\", \\\"1.`\\\", \\\",\\\", \
\\\"0.9`\\\"}], \\\"}\\\"}]\\).\"",2,55,13,19973370419455605031,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.684583983709971*^9}],

Cell[BoxData[
 TemplateBox[{
  "FindMaximum","grad",
   "\"Evaluation of the gradient of function \
\\!\\(\\*RowBox[{\\\"Experimental`NumericalFunction\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Hold\\\", \\\"[\\\", \
RowBox[{\\\"-\\\", RowBox[{\\\"Lik\\\", \\\"[\\\", RowBox[{\\\"r0\\\", \
\\\",\\\", \\\"a\\\", \\\",\\\", \\\"d\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\",\\\", \\\"Block\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"Hold\\\", \\\"[\\\", \\\"r0\\\", \
\\\"]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", RowBox[{\\\"Hold\\\", \\\"[\\\", \
\\\"a\\\", \\\"]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\",\\\", \\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", RowBox[{\\\"Hold\\\", \
\\\"[\\\", \\\"d\\\", \\\"]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"3\\\", \\\",\\\", \\\"817\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"Automatic\\\", \
\\\",\\\", \\\"Automatic\\\", \\\",\\\", \\\"None\\\", \\\",\\\", \\\"2\\\", \
\\\",\\\", \\\"Automatic\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\
\"}\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"8\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"904\\\", \\\",\\\", \
\\\"MachinePrecision\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\
\\\", \\\"Automatic\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Hold\\\", \\\"[\\\", RowBox[{\\\"-\\\", RowBox[{\\\"Lik\\\
\", \\\"[\\\", RowBox[{\\\"r0\\\", \\\",\\\", \\\"a\\\", \\\",\\\", \
\\\"d\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\",\\\", \\\"Block\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"True\\\", \\\",\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"Automatic\\\", \\\",\\\", \
RowBox[{\\\"\\\\\\\"CleanUpRegisters\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"False\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"WarningMessages\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"False\\\"}], \\\",\\\", \
RowBox[{\\\"\\\\\\\"EvaluateSymbolically\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"False\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"RuntimeErrorHandler\\\\\\\"\\\
\", \\\"\[Rule]\\\", RowBox[{\\\"(\\\", RowBox[{\\\"$Failed\\\", \\\"&\\\"}], \
\\\")\\\"}]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\",\\\", \\\"Automatic\\\", \\\",\\\", \\\"\\\\\\\"WVM\\\\\\\"\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"FindMaximum\\\", \\\",\\\", \\\"Automatic\\\", \\\",\\\
\", \\\"None\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"None\\\", \\\",\\\", \\\"None\\\", \\\",\\\", \\\"None\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}]\\) failed at \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9005`\\\", \\\",\\\", \\\"1.`\\\", \\\",\\\", \\\"0.9`\\\"}], \
\\\"}\\\"}]\\).\"",2,55,14,19973370419455605031,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.684583983714821*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.684584491880015*^9, 3.684584491881609*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.684278457250387*^9}],

Cell["Plot over time ", "WolframAlphaShort",
 CellChangeTimes->{{3.6833082964207516`*^9, 3.6833082983831882`*^9}, {
  3.6833084968033295`*^9, 3.683308499457444*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["Years",
    FontWeight->"Plain"], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{
    StyleBox["Range",
     FontWeight->"Plain"], 
    StyleBox["[",
     FontWeight->"Bold"], 
    StyleBox[
     RowBox[{"2005", ",", "2014"}],
     FontWeight->"Plain"], 
    StyleBox["]",
     FontWeight->"Plain"]}]}], 
  StyleBox[";",
   FontWeight->"Plain"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Res", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{"Years", ",", "RData"}], "}"}]}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"t", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "10"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["ModelFit",
    FontWeight->"Plain"], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{
    StyleBox["Transpose",
     FontWeight->"Plain"], 
    StyleBox["@",
     FontWeight->"Plain"], 
    RowBox[{
     StyleBox["{",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"Years", ",", 
       RowBox[{"r", "[", 
        RowBox[{"t", ",", 
         RowBox[{"fitr0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"fita", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"fitd", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}],
      FontWeight->"Plain"], 
     StyleBox["}",
      FontWeight->"Plain"]}]}]}], 
  StyleBox[";",
   FontWeight->"Plain"]}]}], "Input",
 CellChangeTimes->{
  3.683301416115432*^9, {3.68330283169864*^9, 3.683302993239018*^9}, {
   3.6833055910794373`*^9, 3.683305636170422*^9}, {3.6833060530293636`*^9, 
   3.6833060632715893`*^9}, {3.6833061142942333`*^9, 
   3.6833061227687674`*^9}, {3.6833063897605376`*^9, 
   3.6833063986934624`*^9}, {3.683308080002949*^9, 3.683308086552434*^9}, {
   3.683308506387912*^9, 3.6833085480807533`*^9}, {3.683308648991184*^9, 
   3.6833086520620613`*^9}, {3.6833086926488714`*^9, 
   3.6833086935110874`*^9}, {3.6833087964396143`*^9, 
   3.6833087982845883`*^9}, {3.6833088393199663`*^9, 
   3.6833088647096834`*^9}, {3.683308899388898*^9, 3.683308914020029*^9}, {
   3.683308985722557*^9, 3.6833090053830585`*^9}, {3.683309065087839*^9, 
   3.6833091018819323`*^9}, {3.683309257098646*^9, 3.683309287030099*^9}, 
   3.6833093257983055`*^9, {3.6833093700122876`*^9, 3.6833093789610586`*^9}, {
   3.683309417684349*^9, 3.683309476007949*^9}, 3.683309945564055*^9, {
   3.6833105665320864`*^9, 3.683310577583398*^9}, {3.6833121895816307`*^9, 
   3.6833122200850763`*^9}, 3.6833809394104614`*^9, {3.6839925413322287`*^9, 
   3.6839925905921373`*^9}, {3.683992754925949*^9, 3.683992756908931*^9}, 
   3.68425081946772*^9, {3.6842574253914456`*^9, 3.6842574311637917`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["plot1",
    FontWeight->"Plain"], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{
    StyleBox["ListLinePlot",
     FontWeight->"Plain"], 
    StyleBox["[",
     FontWeight->"Plain"], 
    RowBox[{
     StyleBox["ModelFit",
      FontWeight->"Plain"], 
     StyleBox[",",
      FontWeight->"Plain"], 
     StyleBox[" ",
      FontWeight->"Plain"], 
     StyleBox[
      RowBox[{"PlotStyle", "\[Rule]", " ", 
       RowBox[{"{", "Black", "}"}]}],
      FontWeight->"Plain"], 
     StyleBox[",",
      FontWeight->"Plain"], 
     StyleBox[
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"year", ",", "resistance"}], "}"}]}],
      FontWeight->"Plain"], 
     StyleBox[",",
      FontWeight->"Plain"], 
     RowBox[{
      StyleBox["PlotLabel",
       FontWeight->"Plain"], 
      StyleBox["\[Rule]",
       FontWeight->"Plain"], " ", "France"}], ",", 
     StyleBox[" ",
      FontWeight->"Plain"], 
     StyleBox[
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}],
      FontWeight->"Plain"]}], 
    StyleBox["]",
     FontWeight->"Plain"]}]}], 
  StyleBox[";",
   FontWeight->"Plain"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    StyleBox["plot2",
     FontWeight->"Plain"], 
    StyleBox["=",
     FontWeight->"Plain"], 
    RowBox[{
     StyleBox["ListPlot",
      FontWeight->"Plain"], 
     StyleBox["[",
      FontWeight->"Plain"], 
     RowBox[{
      StyleBox[
       RowBox[{"{", "Res", "}"}],
       FontWeight->"Plain"], 
      StyleBox[",",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{"PlotStyle", "\[Rule]", " ", 
        RowBox[{"PointSize", "[", "Large", "]"}]}],
       FontWeight->"Plain"], 
      StyleBox[",",
       FontWeight->"Plain"], 
      RowBox[{
       StyleBox["PlotRange",
        FontWeight->"Plain"], 
       StyleBox["\[Rule]",
        FontWeight->"Plain"], " ", 
       StyleBox["All",
        FontWeight->"Plain"]}]}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"Show", "[", 
   RowBox[{"plot1", ",", "plot2"}], "]"}],
  FontWeight->"Plain"], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.683301416115432*^9, {3.68330283169864*^9, 3.683302993239018*^9}, {
   3.6833055910794373`*^9, 3.683305636170422*^9}, {3.6833060530293636`*^9, 
   3.6833060632715893`*^9}, {3.6833061142942333`*^9, 
   3.6833061227687674`*^9}, {3.6833063897605376`*^9, 
   3.6833063986934624`*^9}, {3.683308080002949*^9, 3.683308086552434*^9}, {
   3.683308506387912*^9, 3.6833085480807533`*^9}, {3.683308648991184*^9, 
   3.6833086520620613`*^9}, {3.6833086926488714`*^9, 
   3.6833086935110874`*^9}, {3.6833087964396143`*^9, 
   3.6833087982845883`*^9}, {3.6833088393199663`*^9, 
   3.6833088647096834`*^9}, {3.683308899388898*^9, 3.683308914020029*^9}, {
   3.683308985722557*^9, 3.6833090053830585`*^9}, {3.683309065087839*^9, 
   3.6833091018819323`*^9}, {3.683309257098646*^9, 3.683309287030099*^9}, 
   3.6833093257983055`*^9, {3.6833093700122876`*^9, 3.6833093789610586`*^9}, {
   3.683309417684349*^9, 3.683309476007949*^9}, {3.683309955432087*^9, 
   3.68331000142819*^9}, {3.6833100773207903`*^9, 3.6833102722280407`*^9}, {
   3.68337988702079*^9, 3.683379904163967*^9}, {3.6833804449481554`*^9, 
   3.683380445504901*^9}, {3.6833810645725784`*^9, 3.6833810670185394`*^9}, {
   3.683988413972886*^9, 3.6839884170381374`*^9}, 3.6839885229368196`*^9, {
   3.68399279241401*^9, 3.683992793148472*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6], 
      LineBox[{{2005., 0.005}, {2006., 0.005089621039766885}, {2007., 
       0.005474081959360409}, {2008., 0.005682049982785682}, {2009., 
       0.005866548551998106}, {2010., 0.006187371305813011}, {2011., 
       0.007348819537657616}, {2012., 0.008819534074715018}, {2013., 
       0.01008843907670166}, {2014., 
       0.011098271635914503`}}]}}, {}, {}, {{}, {}}}, {{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
      AbsoluteThickness[1.6], 
      PointBox[{{2005., 0.0013280212483399733`}, {2006., 0.}, {2007., 
       0.000946073793755913}, {2008., 0.0009794319294809011}, {2009., 
       0.00473186119873817}, {2010., 0.002793296089385475}, {2011., 
       0.0012195121951219512`}, {2012., 0.010448678549477565`}, {2013., 
       0.011400651465798045`}, {2014., 
       0.009034712315739421}}]}, {}}, {}, {}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["year", TraditionalForm], 
    FormBox["resistance", TraditionalForm]},
  AxesOrigin->{2004.8593750000002`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["France", TraditionalForm],
  PlotRange->{{2005., 2014.}, {0, 0.011098271635914503`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6833102305665607`*^9, 3.683310272674646*^9}, 
   3.6833122165647755`*^9, 3.683312569279402*^9, 3.6833798249819527`*^9, {
   3.6833798945412855`*^9, 3.6833799047314262`*^9}, {3.683380436514214*^9, 
   3.683380445822411*^9}, 3.683380646128228*^9, 3.6833810987278795`*^9, 
   3.683381390496502*^9, {3.6839927909748187`*^9, 3.6839927933983583`*^9}, 
   3.683992861161574*^9, 3.683993295272519*^9, 3.6839933425121045`*^9, 
   3.6839933726495914`*^9}]
}, Open  ]]
},
WindowSize->{1920, 1176},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 616, 15, 45, "Text"],
Cell[1177, 37, 673, 12, 55, "WolframAlphaShort"],
Cell[1853, 51, 1630, 34, 95, "WolframAlphaShort"],
Cell[3486, 87, 2173, 52, 160, "Input"],
Cell[5662, 141, 94, 1, 34, "Input"],
Cell[CellGroupData[{
Cell[5781, 146, 419, 7, 32, "Item"],
Cell[CellGroupData[{
Cell[6225, 157, 498, 8, 26, "Subsubitem"],
Cell[6726, 167, 526, 8, 26, "Subsubitem"]
}, Open  ]],
Cell[7267, 178, 440, 7, 32, "Item"],
Cell[CellGroupData[{
Cell[7732, 189, 479, 7, 26, "Subsubitem"],
Cell[8214, 198, 557, 8, 26, "Subsubitem"],
Cell[8774, 208, 658, 9, 26, "Subsubitem"],
Cell[9435, 219, 771, 12, 26, "Subsubitem"],
Cell[10209, 233, 747, 11, 26, "Subsubitem"]
}, Open  ]]
}, Open  ]],
Cell[10983, 248, 94, 1, 34, "Input"],
Cell[11080, 251, 229, 5, 38, "Input"],
Cell[11312, 258, 265, 7, 40, "Input"],
Cell[11580, 267, 292, 4, 37, "WolframAlphaShort"],
Cell[11875, 273, 875, 14, 110, "Input"],
Cell[CellGroupData[{
Cell[12775, 291, 3673, 95, 311, "Input"],
Cell[16451, 388, 438, 8, 34, "Output"]
}, Open  ]],
Cell[16904, 399, 790, 17, 62, "Input"],
Cell[CellGroupData[{
Cell[17719, 420, 2751, 74, 114, "Input"],
Cell[20473, 496, 112, 1, 34, "Output"]
}, Open  ]],
Cell[20600, 500, 2432, 41, 59, "Input"],
Cell[CellGroupData[{
Cell[23057, 545, 4160, 82, 81, "Input"],
Cell[27220, 629, 434, 12, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27691, 646, 3251, 89, 36, "Input"],
Cell[30945, 737, 647, 11, 24, "Message"],
Cell[31595, 750, 3573, 51, 81, "Message"],
Cell[35171, 803, 1031, 17, 24, "Message"],
Cell[36205, 822, 647, 11, 24, "Message"],
Cell[36855, 835, 3573, 51, 81, "Message"]
}, Open  ]],
Cell[40443, 889, 92, 1, 34, InheritFromParent],
Cell[40538, 892, 87, 1, 58, "Input"],
Cell[40628, 895, 165, 2, 37, "WolframAlphaShort"],
Cell[40796, 899, 2828, 79, 106, "Input"],
Cell[CellGroupData[{
Cell[43649, 982, 3542, 103, 104, "Input"],
Cell[47194, 1087, 2726, 55, 272, "Output"]
}, Open  ]]
}
]
*)

