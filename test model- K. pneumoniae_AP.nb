(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43799,       1098]
NotebookOptionsPosition[     41681,       1029]
NotebookOutlinePosition[     42045,       1045]
CellTagsIndexPosition[     42002,       1042]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.684671020188943*^9, 3.6846710221771183`*^9}, {
  3.684671267922042*^9, 3.6846712696176577`*^9}}],

Cell[TextData[{
 StyleBox["Carbapenem",
  IgnoreSpellCheck->True,
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[0.5019607843137255, 0., 0.]],
 StyleBox[" resistance Model: ", "Subchapter",
  FontFamily->"Arial",
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[0.5019607843137255, 0., 0.]]
}], "Text",
 CellChangeTimes->{{3.6768904540863285`*^9, 3.676890461169381*^9}, {
   3.683030854794117*^9, 3.6830308835865154`*^9}, {3.683032131761671*^9, 
   3.683032133824201*^9}, 3.683032438777007*^9, {3.683035168869869*^9, 
   3.683035172546686*^9}, {3.683287309412829*^9, 3.6832873106672077`*^9}, 
   3.6847127826127357`*^9}],

Cell[TextData[{
 "Objective:",
 StyleBox[" Whereas a clear correlation exists between consumption of \
antibiotics and the evolution of resistance in microbial communities, the \
effect of reduction of usage is less clear. To project the future frequency \
of carbapenem resistance, based on yearly surveillance data and consumption \
data. A population genetic model was adapted to retrospectively estimate the \
relationship between evolutionary fitness of carbapenem resistance and \
carbapenem consumption.",
  FontWeight->"Plain"]
}], "WolframAlphaShort",
 CellChangeTimes->{{3.683287531459428*^9, 3.68328782137551*^9}, {
  3.68328787870195*^9, 3.683287937627846*^9}}],

Cell[TextData[{
 "Derivation: ",
 StyleBox["We fit the historical selection to consumption via a \
deterministic, continuous-time haploid model of the frequency of resistance. \
See, for reference: 1) Hartl, Daniel L., Andrew G. Clark, and Andrew G. \
Clark. Principles of population genetics. Vol. 116. Sunderland: Sinauer \
associates, 1997",
  FontWeight->"Plain"],
 StyleBox["\[LongDash]base population genetic model",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["; 2) Nielsen, K. M., & Townsend, J. P. (2004). Monitoring and \
modeling horizontal gene transfer. Nature biotechnology, 22(9), 1110-1114",
  FontWeight->"Plain"],
 StyleBox["\[LongDash]relation of base model to novel DNA such as \
antimicrobial resistance elements",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["; and 3) Johnsen, P. J., Townsend, J. P., B\[OSlash]hn, T., \
Simonsen, G. S., Sundsfjord, A., & Nielsen, K. M. (2011). Retrospective \
evidence for a biological cost of vancomycin resistance determinants in the \
absence of glycopeptide selective pressures. Journal of antimicrobial \
chemotherapy, 66(3), 608-610 \[LongDash]",
  FontWeight->"Plain"],
 StyleBox["application of base model to project future vancomycin resistance \
after ban of use",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "WolframAlphaShort",
 CellChangeTimes->{{3.68328801131289*^9, 3.683288095811304*^9}, {
  3.6832882991763897`*^9, 3.6832883547127113`*^9}, {3.6832884127485647`*^9, 
  3.683288449808461*^9}, {3.683288516186564*^9, 3.683288516516803*^9}, {
  3.68328909124573*^9, 3.683289317678453*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\[IndentingNewLine]", "Text",
   FontColor->GrayLevel[0]], 
  StyleBox[" ", "Text",
   FontColor->GrayLevel[0]], 
  StyleBox["\[IndentingNewLine]", "Text",
   FontColor->GrayLevel[0]], Cell[TextData[{
   StyleBox[
   "Note that the likelihood function used here will additionally be improved \
from that used in the preliminary model above. Because surveillance is \
conducted by sampling and testing for resistance, likelihood can be \
quantified under better distributional assumptions, with greater accuracy and \
precision. Instead of the observed frequencies of resistance (which are not \
certain), likelihood can be calculated based on the observed cases of \
resistant (",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKresistance, ",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox["above) vs. non-resistant (",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKisolates",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[" \[Dash] ",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKresistance",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[
   ", above) measured by surveillance\[LongDash]see for instance, Johnsen, P. \
J., Townsend, J. P., B\[OSlash]hn, T., Simonsen, G. S., Sundsfjord, A., & \
Nielsen, K. M. (2011). Retrospective evidence for a biological cost of \
vancomycin resistance determinants in the absence of glycopeptide selective \
pressures. Journal of antimicrobial chemotherapy, 66(3), 608-610.",
    FontSize->12,
    FontWeight->"Plain"]
  }], "WolframAlphaShort",
   CellChangeTimes->{{3.683289726057184*^9, 3.683289961266238*^9}, {
    3.683290062090114*^9, 3.6832901235745173`*^9}, {3.683290162800928*^9, 
    3.683290243023469*^9}, {3.683290380014368*^9, 
    3.6832903934151173`*^9}}]}]], "Input",
 CellChangeTimes->{{3.6842764127975616`*^9, 3.6842764132519383`*^9}, {
   3.684276445113677*^9, 3.6842764490391874`*^9}, {3.6842783785851593`*^9, 
   3.6842784076253023`*^9}, 3.684521334837637*^9, {3.684581585313509*^9, 
   3.68458159513621*^9}, 3.6845816560655518`*^9, {3.684712767807828*^9, 
   3.6847127829127283`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.684276369550303*^9, 3.6842763706987057`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["First, we test the simple model with two selection \
coefficients:", "Text",
 FontSize->12,
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.684250252606157*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["(1) a = the growth rate of resistant Klebsiella that \
are exposed to carbapenems--i.e. under positive selection conditions, ", \
"Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
   3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
   3.6842494396675725`*^9}, {3.6842499835106816`*^9, 
   3.6842500799092245`*^9}, {3.6842501329781685`*^9, 3.6842502523153934`*^9}, 
   3.6842503011757836`*^9}],

Cell[TextData[StyleBox["(2) d = the growth rate of nonresistant Klebsiella \
that are not exposed to carbapenems--i.e. natural growth rate with no \
selection.", "Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.6842503444819756`*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["We make the following assumptions:", "Text",
 FontSize->12,
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.6842503519367795`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["(1) All nonresistant Klebsiella that are exposed to \
carbapenems will die (growth rate=0)", "Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250420720542*^9}}],

Cell[TextData[StyleBox["(2) Resistant Klebsiella that are not exposed to \
carbapenems will also have a growth rate of 0", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.6842505098820148`*^9}}],

Cell[TextData[StyleBox["(3) Alternative treatments are not effective ", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.6842527004125986`*^9}}],

Cell[TextData[StyleBox["(4) All consumption data is for the community sector \
only", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.68425270950678*^9}, {
  3.684257529624141*^9, 3.6842575298888445`*^9}, {3.684274813223451*^9, 
  3.6842748132239523`*^9}}],

Cell[TextData[StyleBox["(5) No co-selection of resistance", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.68425270950678*^9}, {
  3.684257529624141*^9, 3.6842575298888445`*^9}, {3.6842748137558994`*^9, 
  3.6842748213602905`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6842764046032205`*^9, 3.6842766068918996`*^9}],

Cell[BoxData[
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}],
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.6842575509197516`*^9, 3.684257556710144*^9}, {
  3.684522190991454*^9, 3.684522192998961*^9}}],

Cell[BoxData[
 StyleBox[
  RowBox[{"Load", " ", "data"}], "Subsubsection",
  FontFamily->"Arial",
  FontSize->16,
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.6833123864295473`*^9, 3.6833123921723623`*^9}, 
   3.683312535239305*^9, 3.684583880402137*^9, 3.6847126637765007`*^9}],

Cell[TextData[StyleBox["Number of resistant isolates recovered, each year \
2005\[Dash]2014; Number of isolates tested, each year 2005\[Dash]2014, \
estimated frequencies of resistance, 2005\[Dash]2014.",
 FontWeight->"Bold"]], "WolframAlphaShort",
 CellChangeTimes->{3.6833125416696196`*^9}],

Cell[BoxData[
 RowBox[{Cell[TextData[StyleBox[
  "Where c = country-wide consumption of carbapenems (DDD/1000 patient-days); \
totalAb = country-wide total antibiotic consumption (DDD/1000 patient-days); \
isolates = number of K. pneumoniae isolates tested for resistance; resistance \
= number of isolates resistant; p = prescription guideline for carbapenems = \
[c(t) * of carbapenems used how many are prescribed to Klebsiella] / [total \
antibiotic use * of antibiotics used how many are prescribed to Klebsiella] = \
(c * fc) / (totalAb * fa); note that fc and fa will be informed by data, but \
for now we're just assuming values",
   FontSize->12,
   FontWeight->"Plain"]], "WolframAlphaShort",
   CellChangeTimes->{{3.684275162081479*^9, 3.684275259387556*^9}}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.684276626087678*^9, 3.684276633866375*^9}, {
  3.6847127564364915`*^9, 3.6847127830125775`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"c", "ountryName"}]], "=", "\"\<France\>\""}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<DataSheet.xlsx\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Data\>\"", ",", 
        StyleBox[
         RowBox[{"c", "ountryName"}]]}], "}"}]}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"c", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"totalAb", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "5", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"isolates", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"resistance", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"rData", "=", 
     RowBox[{"resistance", "/", "isolates"}]}], ";"}],
   FontWeight->"Plain"], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Plain"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"fc", "=", "0.001"}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"fa", "=", "0.001"}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"p", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c", "*", "fc"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"totalAb", "*", "fa"}], ")"}]}]}],
  FontWeight->"Plain"]}], "Input",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.683312400324967*^9, 3.6833124031150155`*^9}, {
   3.683312480037506*^9, 3.6833124823054457`*^9}, {3.683379752371278*^9, 
   3.6833797696750727`*^9}, {3.683379810011568*^9, 3.683379819174758*^9}, {
   3.6833802080536895`*^9, 3.6833802276010804`*^9}, 3.683380425541297*^9, {
   3.68338106054252*^9, 3.6833810607194576`*^9}, {3.6839883916115713`*^9, 
   3.683988392688233*^9}, {3.683989219571862*^9, 3.683989221574518*^9}, {
   3.6839892986858616`*^9, 3.6839893015491314`*^9}, {3.6839893392827463`*^9, 
   3.6839893583118525`*^9}, 3.683990839221222*^9, {3.683992475254762*^9, 
   3.6839924771674805`*^9}, {3.683993284011052*^9, 3.6839932846493635`*^9}, {
   3.6839933150984974`*^9, 3.683993315176551*^9}, {3.683993349236903*^9, 
   3.6839933493165665`*^9}, {3.6839935683808355`*^9, 
   3.6839935700088077`*^9}, {3.6842495880641026`*^9, 
   3.6842496185009174`*^9}, {3.684249966061616*^9, 3.68424997889145*^9}, {
   3.684250586265329*^9, 3.6842506241309433`*^9}, {3.684251332412817*^9, 
   3.6842514327996097`*^9}, 3.684251464663023*^9, {3.684251599960285*^9, 
   3.6842516061667867`*^9}, {3.684251742393967*^9, 3.6842517971766634`*^9}, {
   3.6842518642219057`*^9, 3.6842520155127025`*^9}, {3.6842520757261124`*^9, 
   3.6842521362095737`*^9}, {3.6842527775857663`*^9, 3.68425290136173*^9}, {
   3.6842529330553384`*^9, 3.684252984028108*^9}, {3.6842531653414726`*^9, 
   3.684253219263065*^9}, 3.684257588496031*^9, {3.684258797957877*^9, 
   3.6842588200158367`*^9}, 3.6842748273961296`*^9, {3.6842751423648367`*^9, 
   3.6842751434955735`*^9}, 3.684514548120756*^9, {3.6847126637548494`*^9, 
   3.684712666740281*^9}, {3.684712756336339*^9, 3.6847128013586345`*^9}, {
   3.6847128666578245`*^9, 3.6847128667581215`*^9}, {3.6847149231923056`*^9, 
   3.6847149246778936`*^9}},
 TextJustification->1.],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.00001792114695340502`", ",", "0.00005944055944055944`", ",", 
   "0.00006405693950177935`", ",", "0.00006081081081081081`", ",", 
   "0.00007092198581560284`", ",", "0.00010801393728222996`", ",", 
   "0.00013468013468013467`", ",", "0.00014617940199335548`", ",", 
   "0.00015517241379310343`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.684583955946458*^9, 3.6845854442724457`*^9, 3.68458745172114*^9, 
   3.684594338059119*^9, 3.6847110363378887`*^9, {3.6847128562725945`*^9, 
   3.6847128703187513`*^9}, 3.6847136424894447`*^9, 3.6847149274835205`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox["Model", "Subsubsection"], Cell[TextData[{
   StyleBox["Definitions: ", "Text",
    FontSize->12],
   StyleBox[
   "r is the frequency of resistance at time t, r0 is the initial frequency \
of resistance, p is the proportion of carbapenems prescribed, and m is the \
continuous time Malthusian selection coefficients for resistant K. pneumoniae \
relative to non-resistant.  [Make them work]", "Text",
    FontSize->12,
    FontWeight->"Plain"]
  }], "WolframAlphaShort",
   CellChangeTimes->{{3.6842495100738378`*^9, 3.684249559065999*^9}, {
    3.6842574951877213`*^9, 3.684257521641042*^9}, {3.6842763811833735`*^9, 
    3.684276385688826*^9}}]}]], "Input",
 CellChangeTimes->{
  3.6845818049499826`*^9, {3.684581846370564*^9, 3.6845818741796207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"r", "[", 
     RowBox[{"t_", ",", "a_", ",", "d_", ",", "r0_"}], "]"}],
    FontWeight->"Plain"], 
   StyleBox[":=",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eqn", ",", "initcon", ",", "expr", ",", "md", ",", "n", ",", 
       "output"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", "==", "1"}], ",", "r0", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqn", "=", " ", 
         RowBox[{
          RowBox[{"md", "[", 
           RowBox[{"n", "+", "1"}], "]"}], "==", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "t", "]"}], "]"}], "*", 
                 RowBox[{"md", "[", "n", "]"}], "*", "a"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"1", " ", "-", " ", 
                   RowBox[{
                    RowBox[{"md", "[", "n", "]"}], "*", "d"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"n", "+", "1"}], ")"}]}], ")"}]}], ")"}]], " "}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "t", "]"}], "]"}], "*", 
                  RowBox[{"md", "[", "n", "]"}], "*", "a"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"md", "[", "n", "]"}]}], ")"}], "*", "d"}], 
                 ")"}]}], "*", 
               RowBox[{"(", 
                RowBox[{"n", "+", "1"}], ")"}]}], ")"}]], " "}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"initcon", "=", 
         RowBox[{
          RowBox[{"md", "[", "1", "]"}], "\[Equal]", " ", "r0"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"expr", "=", "md"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"RecurrenceTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"eqn", ",", "initcon"}], "}"}], ",", "expr", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "t"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6847117917271023`*^9, 3.6847117995168715`*^9}, {
  3.6847118370781827`*^9, 3.6847119126375446`*^9}, {3.6847119453016634`*^9, 
  3.684712029380983*^9}, {3.684712080680929*^9, 3.6847121829462233`*^9}, {
  3.6847123173274937`*^9, 3.6847123226084642`*^9}, {3.6847162624709215`*^9, 
  3.6847162853647017`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"r", "[", 
   RowBox[{"1", ",", "0.900494", ",", "1", ",", "0.9"}], "]"}],
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{
  3.684712219228715*^9, {3.684716145726966*^9, 3.6847161555997496`*^9}, 
   3.6847162921545672`*^9}],

Cell[BoxData["0.9`"], "Output",
 CellChangeTimes->{{3.684712215126204*^9, 3.68471221972893*^9}, 
   3.6847123260481644`*^9, 3.684712433191856*^9, 3.6847128818408675`*^9, 
   3.6847149394223003`*^9, {3.6847161459271317`*^9, 3.6847161557310047`*^9}, {
   3.684716289036539*^9, 3.684716294302305*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Likelihood function", "Subsubsection",
 CellChangeTimes->{{3.6847142236522264`*^9, 3.684714232208269*^9}, {
  3.6847143646186657`*^9, 3.684714365503598*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"lik", "[", 
     RowBox[{"a_", ",", "d_", ",", "r0_"}], "]"}], ":=", " ", 
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"isolates", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"resistance", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"resistance", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "a", ",", "d", ",", "r0"}], "]"}], 
          "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"isolates", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"resistance", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "[", 
            RowBox[{
             RowBox[{"j", "-", "1"}], ",", "a", ",", "d", ",", "r0"}], 
            "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "3", ",", "10"}], "}"}]}], "]"}], "]"}]}],
   FontWeight->"Plain"], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Plain"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"lik", "[", 
   RowBox[{"0.900494", ",", "1.", ",", "0.9"}], "]"}],
  FontWeight->"Plain"]}], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.6830433753306084`*^9}, {3.6830453841421323`*^9, 3.683045385373238*^9}, {
   3.683286539007884*^9, 3.6832865413676167`*^9}, {3.683286571723649*^9, 
   3.6832865735875263`*^9}, {3.6833012740307302`*^9, 
   3.6833013690917635`*^9}, {3.6833024062245913`*^9, 
   3.6833024065060987`*^9}, {3.683303978402192*^9, 3.683303988908411*^9}, {
   3.6833125533026915`*^9, 3.683312560807563*^9}, {3.6833810185649223`*^9, 
   3.6833810198201427`*^9}, {3.683989318168479*^9, 3.6839893298075542`*^9}, {
   3.6839893673194885`*^9, 3.6839893673976536`*^9}, {3.683990817309511*^9, 
   3.683990827773164*^9}, {3.6839912130182624`*^9, 3.683991218852002*^9}, {
   3.6839916027343764`*^9, 3.6839916142562222`*^9}, {3.68399172996832*^9, 
   3.6839917386510878`*^9}, {3.6839922519901714`*^9, 
   3.6839922552887535`*^9}, {3.6839922931173306`*^9, 
   3.6839922993389845`*^9}, {3.6839923304528055`*^9, 
   3.6839923634181767`*^9}, {3.6839924963196344`*^9, 3.683992496670576*^9}, {
   3.6842506328994355`*^9, 3.684250668303567*^9}, {3.684250804898382*^9, 
   3.6842508086219015`*^9}, {3.6842565639448905`*^9, 3.684256569561823*^9}, {
   3.6845845328361998`*^9, 3.684584548735821*^9}, {3.684584831480036*^9, 
   3.6845848516748257`*^9}, {3.68458490135155*^9, 3.684584909022703*^9}, {
   3.684585319937443*^9, 3.684585320090437*^9}, {3.684586634581026*^9, 
   3.684586634909132*^9}, {3.6845946014325323`*^9, 3.684594625686656*^9}, {
   3.6845960607569027`*^9, 3.6845960608050632`*^9}, 3.684712476380311*^9, {
   3.6847127676923895`*^9, 3.6847127825285845`*^9}, {3.684714190300474*^9, 
   3.684714190300474*^9}}],

Cell[BoxData[
 RowBox[{"-", "26605.45068339663`"}]], "Output",
 CellChangeTimes->{
  3.6845845493384047`*^9, 3.6845849143136473`*^9, {3.684585314417674*^9, 
   3.684585320748301*^9}, 3.684585460570068*^9, 3.684586635964539*^9, 
   3.684587471540845*^9, {3.684594603004469*^9, 3.684594626430352*^9}, {
   3.684596061712933*^9, 3.684596066414003*^9}, {3.6847124549705257`*^9, 
   3.684712457001728*^9}, {3.6847128858968825`*^9, 3.6847128884862614`*^9}, 
   3.6847135433613367`*^9, 3.6847142949610643`*^9, 3.6847149410231647`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Maximize likelihood", "Subsubsection",
 CellChangeTimes->{{3.684714370984742*^9, 3.684714375923484*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox[
      RowBox[{"{", 
       RowBox[{"max", ",", "params"}], "}"}],
      FontWeight->"Plain"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"NMaximize", 
      StyleBox["[",
       FontWeight->"Plain"], 
      RowBox[{
       RowBox[{
        StyleBox["{",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox[
          RowBox[{"lik", "[", 
           RowBox[{"a", ",", "d", ",", "r0"}], "]"}],
          FontWeight->"Plain"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox["{",
           FontWeight->"Plain"], 
          RowBox[{
           StyleBox[
            RowBox[{"0.005", "\[LessEqual]", "r0", "\[LessEqual]", "1"}],
            FontWeight->"Plain"], 
           StyleBox["&&",
            FontWeight->"Plain"], 
           RowBox[{
            StyleBox["0",
             FontWeight->"Plain"], 
            StyleBox["\[LessEqual]",
             FontWeight->"Plain"], "a"}], "&&", 
           RowBox[{"0", "\[LessEqual]", "d"}]}], "}"}]}], "}"}], ",", 
       RowBox[{
        StyleBox["{",
         FontWeight->"Bold"], 
        StyleBox[
         RowBox[{"a", ",", "d", ",", "r0"}],
         FontWeight->"Plain"], 
        StyleBox["}",
         FontWeight->"Plain"]}], 
       StyleBox[",",
        FontWeight->"Plain"], 
       RowBox[{"MaxIterations", "\[Rule]", "1"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "3"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "6"}]}], "*)"}], 
      StyleBox["]",
       FontWeight->"Plain"]}]}], 
    StyleBox[";",
     FontWeight->"Plain"]}], 
   StyleBox["//",
    FontWeight->"Plain"], "Timing"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"{", 
   RowBox[{"max", ",", "params"}], "}"}],
  FontWeight->"Plain"]}], "Input",
 CellChangeTimes->{{3.684714989305957*^9, 3.6847149952766247`*^9}, {
  3.6847150978285046`*^9, 3.6847151006332607`*^9}, {3.6847163924922075`*^9, 
  3.684716464554061*^9}, {3.68471778751972*^9, 3.684717858753607*^9}, {
  3.6847181556483526`*^9, 3.684718164992643*^9}, {3.684718249603449*^9, 
  3.6847182548225856`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "NMaximize","cvmit",
   "\"Failed to converge to the requested accuracy or precision within \\!\\(\
\\*RowBox[{\\\"1\\\"}]\\) iterations.\"",2,164,25,20480079115890294233,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6847150507135096`*^9, 3.6847152636323814`*^9, 
  3.6847164849513316`*^9, 3.6847178187036495`*^9, 3.684717888349839*^9, 
  3.6847182194048424`*^9, 3.684718310938424*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"53.640625`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.684717888365464*^9, 3.6847182194219575`*^9, 
  3.68471831095405*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "419.72601285399264`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "4.073519365267041`"}], ",", 
     RowBox[{"d", "\[Rule]", "0.056280538501742416`"}], ",", 
     RowBox[{"r0", "\[Rule]", "0.04967234993452443`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.684717888365464*^9, 3.6847182194219575`*^9, 
  3.68471831095405*^9}],

Cell["Plot over time ", "WolframAlphaShort",
 CellChangeTimes->{{3.6833082964207516`*^9, 3.6833082983831882`*^9}, {
  3.6833084968033295`*^9, 3.683308499457444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotStuff", "[", 
     RowBox[{"fitr0_", ",", "fita_", ",", "fitd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        StyleBox["years",
         FontWeight->"Plain"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["res",
         FontWeight->"Plain"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["time",
         FontWeight->"Plain"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["r0",
         FontWeight->"Plain"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["a",
         FontWeight->"Plain"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["d",
         FontWeight->"Plain"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["modelFit",
         FontWeight->"Plain"], ",", 
        StyleBox["plot1",
         FontWeight->"Plain"], ",", "plot2"}], "}"}], ",", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      RowBox[{
       RowBox[{
        StyleBox["years",
         FontWeight->"Plain"], 
        StyleBox["=",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox["Range",
          FontWeight->"Plain"], 
         StyleBox["[",
          FontWeight->"Bold"], 
         StyleBox[
          RowBox[{"2005", ",", "2014"}],
          FontWeight->"Plain"], 
         StyleBox["]",
          FontWeight->"Plain"]}]}], 
       StyleBox[";",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       RowBox[{"res", 
        StyleBox["=",
         FontWeight->"Plain"], 
        StyleBox[
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"years", ",", "rData"}], "}"}], "]"}],
         FontWeight->"Plain"]}], 
       StyleBox[";",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "10"}], "]"}]}], ";", 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{"modelFit", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"t", ",", "fitr0", ",", "fita", ",", "fitd"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "time"}], "}"}]}], "]"}]}],
        FontWeight->"Plain"], 
       StyleBox[";",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       RowBox[{
        StyleBox["plot1",
         FontWeight->"Plain"], 
        StyleBox["=",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox["ListLinePlot",
          FontWeight->"Plain"], 
         StyleBox["[",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox[
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"years", ",", "modelFit"}], "}"}], "]"}],
           FontWeight->"Plain"], 
          StyleBox[",",
           FontWeight->"Plain"], 
          StyleBox[
           RowBox[{"PlotStyle", "\[Rule]", " ", 
            RowBox[{"{", "Black", "}"}]}],
           FontWeight->"Plain"], 
          StyleBox[",",
           FontWeight->"Plain"], 
          StyleBox[
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Years\>\"", ",", "\"\<Resistance\>\""}], "}"}]}],
           FontWeight->"Plain"], 
          StyleBox[",",
           FontWeight->"Plain"], 
          RowBox[{
           StyleBox["PlotLabel",
            FontWeight->"Plain"], 
           StyleBox["\[Rule]",
            FontWeight->"Plain"], " ", "\"\<France\>\""}], ",", 
          StyleBox[" ",
           FontWeight->"Plain"], 
          StyleBox[
           RowBox[{"PlotRange", "\[Rule]", " ", "All"}],
           FontWeight->"Plain"]}], 
         StyleBox["]",
          FontWeight->"Plain"]}]}], 
       StyleBox[";",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"plot2", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", "res", "}"}], ",", " ", 
           RowBox[{"PlotStyle", "\[Rule]", " ", 
            RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}],
        FontWeight->"Plain"], 
       StyleBox[";",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"Show", "[", 
         RowBox[{"plot1", ",", "plot2"}], "]"}],
        FontWeight->"Plain"]}]}], 
     StyleBox["\[IndentingNewLine]",
      FontWeight->"Plain"], 
     StyleBox["]",
      FontWeight->"Plain"]}]}], 
   StyleBox[";",
    FontWeight->"Plain"]}], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Plain"]}]], "Input",
 CellChangeTimes->{
  3.683301416115432*^9, {3.68330283169864*^9, 3.683302993239018*^9}, {
   3.6833055910794373`*^9, 3.683305636170422*^9}, {3.6833060530293636`*^9, 
   3.6833060632715893`*^9}, {3.6833061142942333`*^9, 
   3.6833061227687674`*^9}, {3.6833063897605376`*^9, 
   3.6833063986934624`*^9}, {3.683308080002949*^9, 3.683308086552434*^9}, {
   3.683308506387912*^9, 3.6833085480807533`*^9}, {3.683308648991184*^9, 
   3.6833086520620613`*^9}, {3.6833086926488714`*^9, 
   3.6833086935110874`*^9}, {3.6833087964396143`*^9, 
   3.6833087982845883`*^9}, {3.6833088393199663`*^9, 
   3.6833088647096834`*^9}, {3.683308899388898*^9, 3.683308914020029*^9}, {
   3.683308985722557*^9, 3.6833090053830585`*^9}, {3.683309065087839*^9, 
   3.6833091018819323`*^9}, {3.683309257098646*^9, 3.683309287030099*^9}, 
   3.6833093257983055`*^9, {3.6833093700122876`*^9, 3.6833093789610586`*^9}, {
   3.683309417684349*^9, 3.683309476007949*^9}, 3.683309945564055*^9, {
   3.6833105665320864`*^9, 3.683310577583398*^9}, {3.6833121895816307`*^9, 
   3.6833122200850763`*^9}, 3.6833809394104614`*^9, {3.6839925413322287`*^9, 
   3.6839925905921373`*^9}, {3.683992754925949*^9, 3.683992756908931*^9}, 
   3.68425081946772*^9, {3.6842574253914456`*^9, 3.6842574311637917`*^9}, 
   3.6847126637765007`*^9, 3.684712801374279*^9, {3.684712946407284*^9, 
   3.68471297535554*^9}, {3.684713159133691*^9, 3.6847132707319307`*^9}, {
   3.684713368932089*^9, 3.6847134126140027`*^9}, {3.684713472448628*^9, 
   3.6847135324555473`*^9}, {3.6847135799192*^9, 3.6847136185551744`*^9}, {
   3.6847153690353365`*^9, 3.6847153754737673`*^9}, {3.684715445026603*^9, 
   3.6847154972826014`*^9}, {3.6847155342884736`*^9, 
   3.6847156154588795`*^9}, {3.684715648155302*^9, 3.684715794714611*^9}, 
   3.6847167887149315`*^9, {3.6847168600891523`*^9, 3.6847168920987167`*^9}, {
   3.6847169304033136`*^9, 3.684716930541354*^9}, {3.6847169735933204`*^9, 
   3.684716976511112*^9}, {3.6847170328245096`*^9, 3.6847170431363487`*^9}, {
   3.6847174662464056`*^9, 3.6847174970463862`*^9}, 3.6847177477616653`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"optParams", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r0", ",", "a", ",", "d"}], "}"}], "/.", "params"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotStuff", "@", "optParams"}]}], "Input",
 CellChangeTimes->{{3.6847159394711432`*^9, 3.684715948675987*^9}, {
   3.6847171480536275`*^9, 3.6847172251903753`*^9}, {3.68471726874473*^9, 
   3.6847173107378674`*^9}, 3.6847177436970716`*^9, {3.6847180519097986`*^9, 
   3.6847180893989086`*^9}, {3.684718323328802*^9, 3.684718390940899*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6], 
      LineBox[{{2005., 0.056280538501742416`}, {2006., 0.05628054024840407}, {
       2007., 0.056280542135892266`}, {2008., 0.05628054118081834}, {2009., 
       0.0562805402842367}, {2010., 0.056280539934632313`}, {2011., 
       0.056280539910229035`}, {2012., 0.05628053945671187}, {2013., 
       0.05628053878698089}, {2014., 
       0.05628053809502927}}]}}, {}, {}, {{}, {}}}, {{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
      AbsoluteThickness[1.6], 
      PointBox[{{2005., 0.0013280212483399733`}, {2006., 0.}, {2007., 
       0.000946073793755913}, {2008., 0.0009794319294809011}, {2009., 
       0.00473186119873817}, {2010., 0.002793296089385475}, {2011., 
       0.0012195121951219512`}, {2012., 0.010448678549477565`}, {2013., 
       0.011400651465798045`}, {2014., 
       0.009034712315739421}}]}, {}}, {}, {}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Years\"", TraditionalForm], 
    FormBox["\"Resistance\"", TraditionalForm]},
  AxesOrigin->{2004.8593750000002`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"France\"", TraditionalForm],
  PlotRange->{{2005., 2014.}, {0, 0.11256107619005853`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.684718377848922*^9, 3.684718392156659*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1176},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 145, 2, 34, "Input"],
Cell[706, 24, 644, 16, 45, "Text"],
Cell[1353, 42, 673, 12, 55, "WolframAlphaShort"],
Cell[2029, 56, 1630, 34, 95, "WolframAlphaShort"],
Cell[3662, 92, 2225, 53, 160, "Input"],
Cell[5890, 147, 94, 1, 34, "Input"],
Cell[CellGroupData[{
Cell[6009, 152, 419, 7, 32, "Item"],
Cell[CellGroupData[{
Cell[6453, 163, 498, 8, 26, "Subsubitem"],
Cell[6954, 173, 526, 8, 26, "Subsubitem"]
}, Open  ]],
Cell[7495, 184, 440, 7, 32, "Item"],
Cell[CellGroupData[{
Cell[7960, 195, 479, 7, 26, "Subsubitem"],
Cell[8442, 204, 557, 8, 26, "Subsubitem"],
Cell[9002, 214, 658, 9, 26, "Subsubitem"],
Cell[9663, 225, 771, 12, 26, "Subsubitem"],
Cell[10437, 239, 747, 11, 26, "Subsubitem"]
}, Open  ]]
}, Open  ]],
Cell[11211, 254, 94, 1, 34, "Input"],
Cell[11308, 257, 229, 5, 38, "Input"],
Cell[11540, 264, 289, 7, 40, "Input"],
Cell[11832, 273, 292, 4, 37, "WolframAlphaShort"],
Cell[12127, 279, 928, 15, 110, "Input"],
Cell[CellGroupData[{
Cell[13080, 298, 3997, 104, 311, "Input"],
Cell[17080, 404, 614, 11, 34, "Output"]
}, Open  ]],
Cell[17709, 418, 790, 17, 62, "Input"],
Cell[18502, 437, 3670, 94, 309, "Input"],
Cell[CellGroupData[{
Cell[22197, 535, 264, 7, 34, "Input"],
Cell[22464, 544, 298, 4, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22799, 553, 163, 2, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[22987, 559, 4551, 89, 104, "Input"],
Cell[27541, 650, 527, 8, 34, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28117, 664, 110, 1, 39, "Subsubsection"],
Cell[28230, 667, 2315, 71, 111, "Input"],
Cell[30548, 740, 446, 9, 24, "Message"],
Cell[30997, 751, 175, 4, 34, "Output"],
Cell[31175, 757, 415, 11, 34, "Output"],
Cell[31593, 770, 165, 2, 37, "WolframAlphaShort"],
Cell[31761, 774, 6981, 185, 271, "Input"],
Cell[CellGroupData[{
Cell[38767, 963, 535, 11, 59, "Input"],
Cell[39305, 976, 2348, 49, 270, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

