(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     55922,       1381]
NotebookOptionsPosition[     53207,       1291]
NotebookOutlinePosition[     53571,       1307]
CellTagsIndexPosition[     53528,       1304]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.684671020188943*^9, 3.6846710221771183`*^9}, {
  3.684671267922042*^9, 3.6846712696176577`*^9}}],

Cell[TextData[{
 StyleBox["Carbapenem",
  IgnoreSpellCheck->True,
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[0.5019607843137255, 0., 0.]],
 StyleBox[" resistance Model: ", "Subchapter",
  FontFamily->"Arial",
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[0.5019607843137255, 0., 0.]]
}], "Text",
 CellChangeTimes->{{3.6768904540863285`*^9, 3.676890461169381*^9}, {
   3.683030854794117*^9, 3.6830308835865154`*^9}, {3.683032131761671*^9, 
   3.683032133824201*^9}, 3.683032438777007*^9, {3.683035168869869*^9, 
   3.683035172546686*^9}, {3.683287309412829*^9, 3.6832873106672077`*^9}, 
   3.6847127826127357`*^9}],

Cell["\<\
Objective: Whereas a clear correlation exists between consumption of \
antibiotics and the evolution of resistance in microbial communities, the \
effect of reduction of usage is less clear. To project the future frequency \
of carbapenem resistance, based on yearly surveillance data and consumption \
data. A population genetic model was adapted to retrospectively estimate the \
relationship between evolutionary fitness of carbapenem resistance and \
carbapenem consumption.\
\>", "Text",
 CellChangeTimes->{{3.684755872446123*^9, 3.684755902782219*^9}}],

Cell["\<\
Derivation: We fit the historical selection to consumption via a \
deterministic, continuous-time haploid model of the frequency of resistance. \
See, for reference: 1) Hartl, Daniel L., Andrew G. Clark, and Andrew G. \
Clark. Principles of population genetics. Vol. 116. Sunderland: Sinauer \
associates, 1997\[LongDash]base population genetic model; 2) Nielsen, K. M., \
& Townsend, J. P. (2004). Monitoring and modeling horizontal gene transfer. \
Nature biotechnology, 22(9), 1110-1114\[LongDash]relation of base model to \
novel DNA such as antimicrobial resistance elements; and 3) Johnsen, P. J., \
Townsend, J. P., B\[OSlash]hn, T., Simonsen, G. S., Sundsfjord, A., & \
Nielsen, K. M. (2011). Retrospective evidence for a biological cost of \
vancomycin resistance determinants in the absence of glycopeptide selective \
pressures. Journal of antimicrobial chemotherapy, 66(3), 608-610 \
\[LongDash]application of base model to project future vancomycin resistance \
after ban of use.\
\>", "Text",
 CellChangeTimes->{{3.684755912372621*^9, 3.684755942681704*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox["\[IndentingNewLine]", "Text",
   FontColor->GrayLevel[0]], 
  StyleBox[" ", "Text",
   FontColor->GrayLevel[0]], 
  StyleBox["\[IndentingNewLine]", "Text",
   FontColor->GrayLevel[0]], Cell[TextData[{
   StyleBox[
   "Note that the likelihood function used here will additionally be improved \
from that used in the preliminary model above. Because surveillance is \
conducted by sampling and testing for resistance, likelihood can be \
quantified under better distributional assumptions, with greater accuracy and \
precision. Instead of the observed frequencies of resistance (which are not \
certain), likelihood can be calculated based on the observed cases of \
resistant (",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKresistance, ",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox["above) vs. non-resistant (",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKisolates",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[" \[Dash] ",
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKresistance",
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[
   ", above) measured by surveillance\[LongDash]see for instance, Johnsen, P. \
J., Townsend, J. P., B\[OSlash]hn, T., Simonsen, G. S., Sundsfjord, A., & \
Nielsen, K. M. (2011). Retrospective evidence for a biological cost of \
vancomycin resistance determinants in the absence of glycopeptide selective \
pressures. Journal of antimicrobial chemotherapy, 66(3), 608-610.",
    FontSize->12,
    FontWeight->"Plain"]
  }], "WolframAlphaShort",
   CellChangeTimes->{{3.683289726057184*^9, 3.683289961266238*^9}, {
    3.683290062090114*^9, 3.6832901235745173`*^9}, {3.683290162800928*^9, 
    3.683290243023469*^9}, {3.683290380014368*^9, 
    3.6832903934151173`*^9}}]}]], "Input",
 CellChangeTimes->{{3.6842764127975616`*^9, 3.6842764132519383`*^9}, {
   3.684276445113677*^9, 3.6842764490391874`*^9}, {3.6842783785851593`*^9, 
   3.6842784076253023`*^9}, 3.684521334837637*^9, {3.684581585313509*^9, 
   3.68458159513621*^9}, 3.6845816560655518`*^9, {3.684712767807828*^9, 
   3.6847127829127283`*^9}}],

Cell[BoxData[
 InterpretationBox[Cell[TextData[{
   StyleBox[
   "Note that the likelihood function used here will additionally be improved \
from that used in the preliminary model above. Because surveillance is \
conducted by sampling and testing for resistance, likelihood can be \
quantified under better distributional assumptions, with greater accuracy and \
precision. Instead of the observed frequencies of resistance (which are not \
certain), likelihood can be calculated based on the observed cases of \
resistant (",
    StripOnInput->False,
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKresistance, ",
    StripOnInput->False,
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox["above) vs. non-resistant (",
    StripOnInput->False,
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKisolates",
    StripOnInput->False,
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[" \[Dash] ",
    StripOnInput->False,
    FontSize->12,
    FontWeight->"Plain"],
   StyleBox["UKresistance",
    StripOnInput->False,
    FontSize->12,
    FontWeight->"Plain",
    FontSlant->"Italic"],
   StyleBox[
   ", above) measured by surveillance\[LongDash]see for instance, Johnsen, P. \
J., Townsend, J. P., B\[OSlash]hn, T., Simonsen, G. S., Sundsfjord, A., & \
Nielsen, K. M. (2011). Retrospective evidence for a biological cost of \
vancomycin resistance determinants in the absence of glycopeptide selective \
pressures. Journal of antimicrobial chemotherapy, 66(3), 608-610.",
    StripOnInput->False,
    FontSize->12,
    FontWeight->"Plain"]
  }], "WolframAlphaShort",
   CellChangeTimes->{{3.683289726057184*^9, 3.683289961266238*^9}, {
    3.683290062090114*^9, 3.6832901235745173`*^9}, {3.683290162800928*^9, 
    3.683290243023469*^9}, {3.683290380014368*^9, 3.6832903934151173`*^9}}],
  TextCell[
   Row[{
     Style[
     "Note that the likelihood function used here will additionally be \
improved from that used in the preliminary model above. Because surveillance \
is conducted by sampling and testing for resistance, likelihood can be \
quantified under better distributional assumptions, with greater accuracy and \
precision. Instead of the observed frequencies of resistance (which are not \
certain), likelihood can be calculated based on the observed cases of \
resistant (", FontSize -> 12, FontWeight -> "Plain"], 
     Style[
     "UKresistance, ", FontSize -> 12, FontWeight -> "Plain", FontSlant -> 
      "Italic"], 
     Style[
     "above) vs. non-resistant (", FontSize -> 12, FontWeight -> "Plain"], 
     Style[
     "UKisolates", FontSize -> 12, FontWeight -> "Plain", FontSlant -> 
      "Italic"], 
     Style[" \[Dash] ", FontSize -> 12, FontWeight -> "Plain"], 
     Style[
     "UKresistance", FontSize -> 12, FontWeight -> "Plain", FontSlant -> 
      "Italic"], 
     Style[
     ", above) measured by surveillance\[LongDash]see for instance, Johnsen, \
P. J., Townsend, J. P., B\[OSlash]hn, T., Simonsen, G. S., Sundsfjord, A., & \
Nielsen, K. M. (2011). Retrospective evidence for a biological cost of \
vancomycin resistance determinants in the absence of glycopeptide selective \
pressures. Journal of antimicrobial chemotherapy, 66(3), 608-610.", FontSize -> 
      12, FontWeight -> "Plain"]}], "WolframAlphaShort", 
   CellChangeTimes -> {{3.683289726057184*^9, 3.683289961266238*^9}, {
    3.683290062090114*^9, 3.6832901235745173`*^9}, {3.683290162800928*^9, 
    3.683290243023469*^9}, {3.683290380014368*^9, 
    3.6832903934151173`*^9}}]]], "Output",
 CellChangeTimes->{3.684748707373191*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.684276369550303*^9, 3.6842763706987057`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["First, we test the simple model with two selection \
coefficients:", "Text",
 FontSize->12,
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.684250252606157*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["(1) a = the growth rate of resistant Klebsiella that \
are exposed to carbapenems--i.e. under positive selection conditions, ", \
"Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
   3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
   3.6842494396675725`*^9}, {3.6842499835106816`*^9, 
   3.6842500799092245`*^9}, {3.6842501329781685`*^9, 3.6842502523153934`*^9}, 
   3.6842503011757836`*^9}],

Cell[TextData[StyleBox["(2) d = the growth rate of nonresistant Klebsiella \
that are not exposed to carbapenems--i.e. natural growth rate with no \
selection.", "Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.6842503444819756`*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["We make the following assumptions:", "Text",
 FontSize->12,
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.6842503519367795`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["(1) All nonresistant Klebsiella that are exposed to \
carbapenems will die (growth rate=0)", "Text",
 FontSize->12]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250420720542*^9}}],

Cell[TextData[StyleBox["(2) Resistant Klebsiella that are not exposed to \
carbapenems will also have a growth rate of 0", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.6842505098820148`*^9}}],

Cell[TextData[StyleBox["(3) Alternative treatments are not effective ", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.6842527004125986`*^9}}],

Cell[TextData[StyleBox["(4) All consumption data is for the community sector \
only", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.68425270950678*^9}, {
  3.684257529624141*^9, 3.6842575298888445`*^9}, {3.684274813223451*^9, 
  3.6842748132239523`*^9}}],

Cell[TextData[StyleBox["(5) No co-selection of resistance", "Text",
 FontSize->12,
 FontWeight->"Plain"]], "Subsubitem",
 CellChangeTimes->{{3.6842490972629056`*^9, 3.684249165330814*^9}, {
  3.6842493447416973`*^9, 3.684249381094158*^9}, {3.6842494365192027`*^9, 
  3.6842494396675725`*^9}, {3.6842499835106816`*^9, 3.6842500799092245`*^9}, {
  3.6842501329781685`*^9, 3.6842502961875916`*^9}, {3.684250330085392*^9, 
  3.684250431264572*^9}, {3.6842504958464603`*^9, 3.684250539873622*^9}, {
  3.6842505788654423`*^9, 3.684250579084069*^9}, {3.6842507069774714`*^9, 
  3.6842507069774714`*^9}, {3.6842526955576906`*^9, 3.68425270950678*^9}, {
  3.684257529624141*^9, 3.6842575298888445`*^9}, {3.6842748137558994`*^9, 
  3.6842748213602905`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6842764046032205`*^9, 3.6842766068918996`*^9}],

Cell[BoxData[
 StyleBox[
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}],
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.6842575509197516`*^9, 3.684257556710144*^9}, {
  3.684522190991454*^9, 3.684522192998961*^9}, {3.6847585992920923`*^9, 
  3.6847586204127483`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6847559756856823`*^9, 3.684755977380233*^9}}],

Cell["\<\
Number of resistant isolates recovered, each year 2005\[Dash]2014; Number of \
isolates tested, each year 2005\[Dash]2014, estimated frequencies of \
resistance, 2005\[Dash]2014.\
\>", "Text",
 CellChangeTimes->{{3.684755955808798*^9, 3.6847559608177347`*^9}}],

Cell[BoxData[
 RowBox[{Cell[TextData[StyleBox[
  "Where c = country-wide consumption of carbapenems (DDD/1000 patient-days); \
totalAb = country-wide total antibiotic consumption (DDD/1000 patient-days); \
isolates = number of K. pneumoniae isolates tested for resistance; resistance \
= number of isolates resistant; p = prescription guideline for carbapenems = \
[c(t) * of carbapenems used how many are prescribed to Klebsiella] / [total \
antibiotic use * of antibiotics used how many are prescribed to Klebsiella] = \
(c * fc) / (totalAb * fa); note that fc and fa will be informed by data, but \
for now we're just assuming values",
   FontSize->12,
   FontWeight->"Plain"]], "WolframAlphaShort",
   CellChangeTimes->{{3.684275162081479*^9, 3.684275259387556*^9}}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.684276626087678*^9, 3.684276633866375*^9}, {
  3.6847127564364915`*^9, 3.6847127830125775`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"countryName", "=", "\"\<United States\>\""}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<DataSheet.xlsx\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Data\>\"", ",", "countryName"}], "}"}]}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 RowBox[{
  RowBox[{"p", 
   StyleBox["=",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}],
    FontWeight->"Plain"]}], 
  StyleBox[";",
   FontWeight->"Plain"]}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"totalAb", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "5", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"isolates", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"resistance", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"rData", "=", 
    RowBox[{"resistance", "/", "isolates"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{"p", "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.683312400324967*^9, 3.6833124031150155`*^9}, {
   3.683312480037506*^9, 3.6833124823054457`*^9}, {3.683379752371278*^9, 
   3.6833797696750727`*^9}, {3.683379810011568*^9, 3.683379819174758*^9}, {
   3.6833802080536895`*^9, 3.6833802276010804`*^9}, 3.683380425541297*^9, {
   3.68338106054252*^9, 3.6833810607194576`*^9}, {3.6839883916115713`*^9, 
   3.683988392688233*^9}, {3.683989219571862*^9, 3.683989221574518*^9}, {
   3.6839892986858616`*^9, 3.6839893015491314`*^9}, {3.6839893392827463`*^9, 
   3.6839893583118525`*^9}, 3.683990839221222*^9, {3.683992475254762*^9, 
   3.6839924771674805`*^9}, {3.683993284011052*^9, 3.6839932846493635`*^9}, {
   3.6839933150984974`*^9, 3.683993315176551*^9}, {3.683993349236903*^9, 
   3.6839933493165665`*^9}, {3.6839935683808355`*^9, 
   3.6839935700088077`*^9}, {3.6842495880641026`*^9, 
   3.6842496185009174`*^9}, {3.684249966061616*^9, 3.68424997889145*^9}, {
   3.684250586265329*^9, 3.6842506241309433`*^9}, {3.684251332412817*^9, 
   3.6842514327996097`*^9}, 3.684251464663023*^9, {3.684251599960285*^9, 
   3.6842516061667867`*^9}, {3.684251742393967*^9, 3.6842517971766634`*^9}, {
   3.6842518642219057`*^9, 3.6842520155127025`*^9}, {3.6842520757261124`*^9, 
   3.6842521362095737`*^9}, {3.6842527775857663`*^9, 3.68425290136173*^9}, {
   3.6842529330553384`*^9, 3.684252984028108*^9}, {3.6842531653414726`*^9, 
   3.684253219263065*^9}, 3.684257588496031*^9, {3.684258797957877*^9, 
   3.6842588200158367`*^9}, 3.6842748273961296`*^9, {3.6842751423648367`*^9, 
   3.6842751434955735`*^9}, 3.684514548120756*^9, {3.6847126637548494`*^9, 
   3.684712666740281*^9}, {3.684712756336339*^9, 3.6847128013586345`*^9}, {
   3.6847128666578245`*^9, 3.6847128667581215`*^9}, {3.6847149231923056`*^9, 
   3.6847149246778936`*^9}, {3.684758406746221*^9, 3.684758408113759*^9}, {
   3.684758514370184*^9, 3.6847585287502337`*^9}, {3.6847586470307703`*^9, 
   3.684758652633279*^9}, {3.684759062024127*^9, 3.684759062351591*^9}, {
   3.6847599403163033`*^9, 3.684759940532423*^9}},
 TextJustification->1.],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.001085061034683201`", ",", "0.0012212723437326524`", ",", 
   "0.0015312177008766222`", ",", "0.0015869329617587862`", ",", 
   "0.0018724201029831056`", ",", "0.0019771800469580263`", ",", 
   "0.0021899016610197504`", ",", "0.002404897245299519`", ",", 
   "0.002616872172447441`", ",", "0.002691906912122265`", ",", 
   "0.002848358802785062`", ",", "0.0029876420261645015`", ",", 
   "0.003330682044143965`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.684758529187467*^9, 3.684758623251889*^9, 3.6847586532930613`*^9, 
   3.6847590636415873`*^9, 3.684759941231434*^9, 3.6847601677848787`*^9, 
   3.6847631994513206`*^9, {3.684763933587813*^9, 3.684763956313725*^9}, 
   3.6847736281225224`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox["Model", "Subsubsection"], Cell[TextData[{
   StyleBox["Definitions: ", "Text",
    FontSize->12],
   StyleBox[
   "r is the frequency of resistance at time t, r0 is the initial frequency \
of resistance, p is the proportion of carbapenems prescribed, and m is the \
continuous time Malthusian selection coefficients for resistant K. pneumoniae \
relative to non-resistant.  [Make them work]", "Text",
    FontSize->12,
    FontWeight->"Plain"]
  }], "WolframAlphaShort",
   CellChangeTimes->{{3.6842495100738378`*^9, 3.684249559065999*^9}, {
    3.6842574951877213`*^9, 3.684257521641042*^9}, {3.6842763811833735`*^9, 
    3.684276385688826*^9}}]}]], "Input",
 CellChangeTimes->{
  3.6845818049499826`*^9, {3.684581846370564*^9, 3.6845818741796207`*^9}}],

Cell[BoxData[
 RowBox[{"Model", " ", 
  InterpretationBox[Cell[TextData[{
    StyleBox["Definitions: ", "Text",
     StripOnInput->False,
     FontSize->12],
    StyleBox[
    "r is the frequency of resistance at time t, r0 is the initial frequency \
of resistance, p is the proportion of carbapenems prescribed, and m is the \
continuous time Malthusian selection coefficients for resistant K. pneumoniae \
relative to non-resistant.  [Make them work]", "Text",
     StripOnInput->False,
     FontSize->12,
     FontWeight->"Plain"]
   }], "WolframAlphaShort",
    CellChangeTimes->{{3.6842495100738378`*^9, 3.684249559065999*^9}, {
     3.6842574951877213`*^9, 3.684257521641042*^9}, {3.6842763811833735`*^9, 
     3.684276385688826*^9}}],
   TextCell[
    Row[{
      Style["Definitions: ", "Text", FontSize -> 12], 
      Style[
      "r is the frequency of resistance at time t, r0 is the initial \
frequency of resistance, p is the proportion of carbapenems prescribed, and m \
is the continuous time Malthusian selection coefficients for resistant K. \
pneumoniae relative to non-resistant.  [Make them work]", "Text", FontSize -> 
       12, FontWeight -> "Plain"]}], "WolframAlphaShort", 
    CellChangeTimes -> {{3.6842495100738378`*^9, 3.684249559065999*^9}, {
     3.6842574951877213`*^9, 3.684257521641042*^9}, {3.6842763811833735`*^9, 
     3.684276385688826*^9}}]]}]], "Output",
 CellChangeTimes->{3.684748720527856*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"r", "[", 
     RowBox[{"t_", ",", "a_", ",", "d_", ",", "r0_"}], "]"}],
    FontWeight->"Plain"], 
   StyleBox[":=",
    FontWeight->"Plain"], 
   StyleBox[" ",
    FontWeight->"Plain"], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eqn", ",", "initcon", ",", "expr", ",", "md", ",", "n", ",", 
       "output"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", "==", "1"}], ",", "r0", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqn", "=", " ", 
         RowBox[{
          RowBox[{"md", "[", 
           RowBox[{"n", "+", "1"}], "]"}], "==", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "t", "]"}], "]"}], "*", 
                 RowBox[{"md", "[", "n", "]"}], "*", "a"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"1", " ", "-", " ", 
                   RowBox[{
                    RowBox[{"md", "[", "n", "]"}], "*", "d"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"n", "+", "1"}], ")"}]}], ")"}]}], ")"}]], " "}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "r0"}], ")"}], "-", "1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "t", "]"}], "]"}], "*", 
                  RowBox[{"md", "[", "n", "]"}], "*", "a"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"md", "[", "n", "]"}]}], ")"}], "*", "d"}], 
                 ")"}]}], "*", 
               RowBox[{"(", 
                RowBox[{"n", "+", "1"}], ")"}]}], ")"}]], " "}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"initcon", "=", 
         RowBox[{
          RowBox[{"md", "[", "1", "]"}], "\[Equal]", " ", "r0"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"expr", "=", "md"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"RecurrenceTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"eqn", ",", "initcon"}], "}"}], ",", "expr", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "t"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6847117917271023`*^9, 3.6847117995168715`*^9}, {
   3.6847118370781827`*^9, 3.6847119126375446`*^9}, {3.6847119453016634`*^9, 
   3.684712029380983*^9}, {3.684712080680929*^9, 3.6847121829462233`*^9}, {
   3.6847123173274937`*^9, 3.6847123226084642`*^9}, {3.6847162624709215`*^9, 
   3.6847162853647017`*^9}, 3.684754266037208*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"r", "[", 
   RowBox[{"10", ",", "0.990494", ",", "1", ",", "0.8"}], "]"}],
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{
  3.684712219228715*^9, {3.684716145726966*^9, 3.6847161555997496`*^9}, 
   3.6847162921545672`*^9, {3.684754284572249*^9, 3.6847542924473352`*^9}, {
   3.684758554485441*^9, 3.684758587746249*^9}, {3.6847586361452923`*^9, 
   3.684758636549971*^9}, 3.684759074968453*^9, {3.684763225260632*^9, 
   3.684763225889821*^9}, {3.684763918567232*^9, 3.684763922279744*^9}}],

Cell[BoxData["0.7495623918505359`"], "Output",
 CellChangeTimes->{3.6847639737641087`*^9, 3.684773635125564*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Likelihood function", "Subsubsection",
 CellChangeTimes->{{3.6847142236522264`*^9, 3.684714232208269*^9}, {
  3.6847143646186657`*^9, 3.684714365503598*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"lik", "[", 
     RowBox[{"a_", ",", "d_", ",", "r0_"}], "]"}], ":=", " ", 
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"isolates", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"resistance", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"resistance", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "a", ",", "d", ",", "r0"}], "]"}], 
          "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"isolates", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"resistance", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"r", "[", 
            RowBox[{
             RowBox[{"j", "-", "1"}], ",", "a", ",", "d", ",", "r0"}], 
            "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "13"}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"lik", "[", 
   RowBox[{"0.900494", ",", "1.", ",", "0.9"}], "]"}],
  FontWeight->"Plain"]}], "Input",
 CellChangeTimes->{{3.683030947375723*^9, 3.683030957812204*^9}, {
   3.683031003865847*^9, 3.683031046232802*^9}, {3.6830311098417034`*^9, 
   3.6830311611831536`*^9}, {3.6830312194008975`*^9, 
   3.6830312515377655`*^9}, {3.6830316928710737`*^9, 
   3.6830317163915825`*^9}, {3.6830318667734737`*^9, 3.683031869592007*^9}, {
   3.683031913604512*^9, 3.6830319392299347`*^9}, {3.6830320790088243`*^9, 
   3.683032146983918*^9}, {3.6830322588628626`*^9, 3.683032301254314*^9}, {
   3.6830323316889925`*^9, 3.6830323963446293`*^9}, {3.683034887878422*^9, 
   3.6830348948500004`*^9}, {3.6830349506857595`*^9, 
   3.6830349621523547`*^9}, {3.6830350335086546`*^9, 3.683035070552723*^9}, {
   3.6830351213904047`*^9, 3.683035163958578*^9}, {3.68303519619243*^9, 
   3.683035459545751*^9}, {3.683035509334259*^9, 3.6830355463684144`*^9}, {
   3.6830356639722323`*^9, 3.683035770868371*^9}, {3.683036385577299*^9, 
   3.6830363966056995`*^9}, {3.6830364327680287`*^9, 
   3.6830364347743673`*^9}, {3.6830365224937134`*^9, 
   3.6830365352715435`*^9}, {3.683036702256081*^9, 3.683036704357623*^9}, 
   3.6830367527530813`*^9, {3.6830392004357843`*^9, 3.683039225121022*^9}, {
   3.683039520622929*^9, 3.6830395497446313`*^9}, {3.6830397989857607`*^9, 
   3.683039805086981*^9}, {3.6830401360681567`*^9, 3.683040143665327*^9}, {
   3.683041363452187*^9, 3.683041366375439*^9}, {3.6830433629055405`*^9, 
   3.6830433753306084`*^9}, {3.6830453841421323`*^9, 3.683045385373238*^9}, {
   3.683286539007884*^9, 3.6832865413676167`*^9}, {3.683286571723649*^9, 
   3.6832865735875263`*^9}, {3.6833012740307302`*^9, 
   3.6833013690917635`*^9}, {3.6833024062245913`*^9, 
   3.6833024065060987`*^9}, {3.683303978402192*^9, 3.683303988908411*^9}, {
   3.6833125533026915`*^9, 3.683312560807563*^9}, {3.6833810185649223`*^9, 
   3.6833810198201427`*^9}, {3.683989318168479*^9, 3.6839893298075542`*^9}, {
   3.6839893673194885`*^9, 3.6839893673976536`*^9}, {3.683990817309511*^9, 
   3.683990827773164*^9}, {3.6839912130182624`*^9, 3.683991218852002*^9}, {
   3.6839916027343764`*^9, 3.6839916142562222`*^9}, {3.68399172996832*^9, 
   3.6839917386510878`*^9}, {3.6839922519901714`*^9, 
   3.6839922552887535`*^9}, {3.6839922931173306`*^9, 
   3.6839922993389845`*^9}, {3.6839923304528055`*^9, 
   3.6839923634181767`*^9}, {3.6839924963196344`*^9, 3.683992496670576*^9}, {
   3.6842506328994355`*^9, 3.684250668303567*^9}, {3.684250804898382*^9, 
   3.6842508086219015`*^9}, {3.6842565639448905`*^9, 3.684256569561823*^9}, {
   3.6845845328361998`*^9, 3.684584548735821*^9}, {3.684584831480036*^9, 
   3.6845848516748257`*^9}, {3.68458490135155*^9, 3.684584909022703*^9}, {
   3.684585319937443*^9, 3.684585320090437*^9}, {3.684586634581026*^9, 
   3.684586634909132*^9}, {3.6845946014325323`*^9, 3.684594625686656*^9}, {
   3.6845960607569027`*^9, 3.6845960608050632`*^9}, 3.684712476380311*^9, {
   3.6847127676923895`*^9, 3.6847127825285845`*^9}, {3.684714190300474*^9, 
   3.684714190300474*^9}, {3.684757066538742*^9, 3.684757067671795*^9}, {
   3.6847590812840347`*^9, 3.684759081844746*^9}}],

Cell[BoxData[
 RowBox[{"-", "75422.79766295418`"}]], "Output",
 CellChangeTimes->{3.684763992034418*^9, 3.684773637725546*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Maximize likelihood", "Subsubsection",
 CellChangeTimes->{{3.684714370984742*^9, 3.684714375923484*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox[
      RowBox[{"{", 
       RowBox[{"max", ",", "params"}], "}"}],
      FontWeight->"Plain"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{"NMaximize", 
      StyleBox["[",
       FontWeight->"Plain"], 
      RowBox[{
       RowBox[{
        StyleBox["{",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox[
          RowBox[{"lik", "[", 
           RowBox[{"a", ",", "d", ",", "r0"}], "]"}],
          FontWeight->"Plain"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox["{",
           FontWeight->"Plain"], 
          RowBox[{
           StyleBox[
            RowBox[{"0.005", "\[LessEqual]", "r0", "\[LessEqual]", "1"}],
            FontWeight->"Plain"], 
           StyleBox["&&",
            FontWeight->"Plain"], 
           RowBox[{
            StyleBox["0",
             FontWeight->"Plain"], 
            StyleBox["\[LessEqual]",
             FontWeight->"Plain"], "a"}], "&&", 
           RowBox[{"0", "\[LessEqual]", "d"}]}], "}"}]}], "}"}], ",", 
       RowBox[{
        StyleBox["{",
         FontWeight->"Bold"], 
        RowBox[{
         RowBox[{
          StyleBox["{",
           FontWeight->"Bold"], 
          StyleBox[
           RowBox[{"a", ",", "0.09", ",", "0.11"}],
           FontWeight->"Plain"], 
          StyleBox["}",
           FontWeight->"Plain"]}], 
         StyleBox[",",
          FontWeight->"Plain"], 
         StyleBox[
          RowBox[{"{", 
           RowBox[{"d", ",", "0.49", ",", "0.51"}], "}"}],
          FontWeight->"Plain"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         StyleBox[
          RowBox[{"{", 
           RowBox[{"r0", ",", "0.09", ",", "0.11"}], "}"}],
          FontWeight->"Plain"]}], 
        StyleBox["}",
         FontWeight->"Plain"]}], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       RowBox[{"MaxIterations", "\[Rule]", "10"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<Automatic\>\""}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "3"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "6"}]}], "*)"}], 
      StyleBox["]",
       FontWeight->"Plain"]}]}], 
    StyleBox[";",
     FontWeight->"Plain"]}], 
   StyleBox["//",
    FontWeight->"Plain"], "Timing"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
    "Automatic", ",", "DifferentialEvolution", ",", "NelderMead", ",", 
     "SimulatedAnnealing", ",", "RandomSearch", ",", 
     "NonlinearInteriorPoint"}], "}"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"{", 
   RowBox[{"max", ",", "params"}], "}"}],
  FontWeight->"Plain"]}], "Input",
 CellChangeTimes->{{3.684714989305957*^9, 3.6847149952766247`*^9}, {
   3.6847150978285046`*^9, 3.6847151006332607`*^9}, {3.6847163924922075`*^9, 
   3.684716464554061*^9}, {3.68471778751972*^9, 3.684717858753607*^9}, {
   3.6847181556483526`*^9, 3.684718164992643*^9}, {3.684718249603449*^9, 
   3.6847182548225856`*^9}, 3.68474901068795*^9, {3.6847508595678062`*^9, 
   3.684750871323802*^9}, {3.684750965274091*^9, 3.684751018606447*^9}, {
   3.684751074014058*^9, 3.684751081550191*^9}, {3.684751123723503*^9, 
   3.684751125315388*^9}, {3.684751178959073*^9, 3.6847511838658843`*^9}, {
   3.684751416041897*^9, 3.6847514425400896`*^9}, 3.6847514760584345`*^9, {
   3.684754592259658*^9, 3.6847545936509733`*^9}, {3.6847571552993*^9, 
   3.684757160966194*^9}, {3.684757327043892*^9, 3.6847573367054443`*^9}, {
   3.684758456733872*^9, 3.684758468881755*^9}, {3.684759449587144*^9, 
   3.6847594592666397`*^9}, {3.6847599225809727`*^9, 3.684759931044311*^9}, {
   3.684760226205064*^9, 3.684760228020488*^9}, {3.6847755701951427`*^9, 
   3.6847755708986692`*^9}, {3.684775890995133*^9, 3.684775895905734*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.684766355194799*^9, 3.6847755579120607`*^9, 
  3.68477588532559*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"max", ",", "params"}], "}"}]], "Output",
 CellChangeTimes->{3.684766355194799*^9, 3.6847755579120607`*^9, 
  3.6847758853264723`*^9}]
}, Open  ]],

Cell["Plot over time ", "WolframAlphaShort",
 CellChangeTimes->{{3.6833082964207516`*^9, 3.6833082983831882`*^9}, {
  3.6833084968033295`*^9, 3.683308499457444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"plotStuff", "[", 
    RowBox[{"{", 
     RowBox[{"fita_", ",", "fitd_", ",", "fitr0_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       StyleBox["years",
        FontWeight->"Plain"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["res",
        FontWeight->"Plain"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["time",
        FontWeight->"Plain"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["modelFit",
        FontWeight->"Plain"], ",", 
       StyleBox["plot1",
        FontWeight->"Plain"], ",", "plot2"}], "}"}], ",", 
     StyleBox["\[IndentingNewLine]",
      FontWeight->"Plain"], 
     RowBox[{
      RowBox[{
       StyleBox["years",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       RowBox[{
        StyleBox["Range",
         FontWeight->"Plain"], 
        StyleBox["[",
         FontWeight->"Bold"], 
        StyleBox[
         RowBox[{"2000", ",", "2012"}],
         FontWeight->"Plain"], 
        StyleBox["]",
         FontWeight->"Plain"]}]}], 
      StyleBox[";",
       FontWeight->"Plain"], "\[IndentingNewLine]", 
      RowBox[{"res", 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"years", ",", "rData"}], "}"}], "]"}],
        FontWeight->"Plain"]}], 
      StyleBox[";",
       FontWeight->"Plain"], "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "13"}], "]"}]}], ";", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{"modelFit", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"t", ",", "fita", ",", "fitd", ",", "fitr0"}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"t", ",", "time"}], "}"}]}], "]"}]}],
       FontWeight->"Plain"], 
      StyleBox[";",
       FontWeight->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      RowBox[{
       StyleBox["plot1",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       RowBox[{
        StyleBox["ListLinePlot",
         FontWeight->"Plain"], 
        StyleBox["[",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox[
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"years", ",", "modelFit"}], "}"}], "]"}],
          FontWeight->"Plain"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         StyleBox[
          RowBox[{"PlotStyle", "\[Rule]", " ", 
           RowBox[{"{", "Black", "}"}]}],
          FontWeight->"Plain"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         StyleBox[
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Years\>\"", ",", "\"\<Resistance frequency\>\""}], 
            "}"}]}],
          FontWeight->"Plain"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox["PlotLabel",
           FontWeight->"Plain"], 
          StyleBox["\[Rule]",
           FontWeight->"Plain"], " ", "\"\<United States\>\""}], ",", 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox[
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}],
          FontWeight->"Plain"], ",", 
         RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"2000", ",", "0"}], "}"}]}]}], 
        StyleBox["]",
         FontWeight->"Plain"]}]}], 
      StyleBox[";",
       FontWeight->"Plain"], "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"plot2", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", "res", "}"}], ",", " ", 
          RowBox[{"PlotStyle", "\[Rule]", " ", 
           RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"2000", ",", "0"}], "}"}]}]}], "]"}]}],
       FontWeight->"Plain"], 
      StyleBox[";",
       FontWeight->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"plot1", ",", "plot2"}], "}"}],
       FontWeight->"Plain"]}]}], 
    StyleBox["\[IndentingNewLine]",
     FontWeight->"Plain"], 
    StyleBox["]",
     FontWeight->"Plain"]}]}], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Plain"]}]], "Input",
 CellChangeTimes->{
  3.683301416115432*^9, {3.68330283169864*^9, 3.683302993239018*^9}, {
   3.6833055910794373`*^9, 3.683305636170422*^9}, {3.6833060530293636`*^9, 
   3.6833060632715893`*^9}, {3.6833061142942333`*^9, 
   3.6833061227687674`*^9}, {3.6833063897605376`*^9, 
   3.6833063986934624`*^9}, {3.683308080002949*^9, 3.683308086552434*^9}, {
   3.683308506387912*^9, 3.6833085480807533`*^9}, {3.683308648991184*^9, 
   3.6833086520620613`*^9}, {3.6833086926488714`*^9, 
   3.6833086935110874`*^9}, {3.6833087964396143`*^9, 
   3.6833087982845883`*^9}, {3.6833088393199663`*^9, 
   3.6833088647096834`*^9}, {3.683308899388898*^9, 3.683308914020029*^9}, {
   3.683308985722557*^9, 3.6833090053830585`*^9}, {3.683309065087839*^9, 
   3.6833091018819323`*^9}, {3.683309257098646*^9, 3.683309287030099*^9}, 
   3.6833093257983055`*^9, {3.6833093700122876`*^9, 3.6833093789610586`*^9}, {
   3.683309417684349*^9, 3.683309476007949*^9}, 3.683309945564055*^9, {
   3.6833105665320864`*^9, 3.683310577583398*^9}, {3.6833121895816307`*^9, 
   3.6833122200850763`*^9}, 3.6833809394104614`*^9, {3.6839925413322287`*^9, 
   3.6839925905921373`*^9}, {3.683992754925949*^9, 3.683992756908931*^9}, 
   3.68425081946772*^9, {3.6842574253914456`*^9, 3.6842574311637917`*^9}, 
   3.6847126637765007`*^9, 3.684712801374279*^9, {3.684712946407284*^9, 
   3.68471297535554*^9}, {3.684713159133691*^9, 3.6847132707319307`*^9}, {
   3.684713368932089*^9, 3.6847134126140027`*^9}, {3.684713472448628*^9, 
   3.6847135324555473`*^9}, {3.6847135799192*^9, 3.6847136185551744`*^9}, {
   3.6847153690353365`*^9, 3.6847153754737673`*^9}, {3.684715445026603*^9, 
   3.6847154972826014`*^9}, {3.6847155342884736`*^9, 
   3.6847156154588795`*^9}, {3.684715648155302*^9, 3.684715794714611*^9}, 
   3.6847167887149315`*^9, {3.6847168600891523`*^9, 3.6847168920987167`*^9}, {
   3.6847169304033136`*^9, 3.684716930541354*^9}, {3.6847169735933204`*^9, 
   3.684716976511112*^9}, {3.6847170328245096`*^9, 3.6847170431363487`*^9}, {
   3.6847174662464056`*^9, 3.6847174970463862`*^9}, 3.6847177477616653`*^9, 
   3.684748853162888*^9, {3.6847488896139393`*^9, 3.6847488918537583`*^9}, {
   3.684749308186734*^9, 3.684749312570588*^9}, {3.6847493616147327`*^9, 
   3.6847493892978907`*^9}, {3.6847494225389194`*^9, 3.684749485611208*^9}, {
   3.684750159890588*^9, 3.684750166800682*^9}, {3.6847515397903757`*^9, 
   3.684751545841715*^9}, {3.684758814613533*^9, 3.6847588561892242`*^9}, {
   3.6847588865135727`*^9, 3.684758886713138*^9}, {3.684758938385379*^9, 
   3.684758938520418*^9}, {3.684758968885189*^9, 3.684759017553097*^9}, {
   3.684775524771964*^9, 3.6847755324517813`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"optParams", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "d", ",", "r0"}], "}"}], "/.", "params"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"{", 
     RowBox[{"plot1", ",", "plot2"}], "}"}],
    FontWeight->"Plain"], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{"plotStuff", "@", "optParams"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   StyleBox[
    RowBox[{"{", 
     RowBox[{"plot1", ",", "plot2"}], "}"}],
    FontWeight->"Plain"], 
   StyleBox[",",
    FontWeight->"Plain"], 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6847159394711432`*^9, 3.684715948675987*^9}, {
   3.6847171480536275`*^9, 3.6847172251903753`*^9}, {3.68471726874473*^9, 
   3.6847173107378674`*^9}, 3.6847177436970716`*^9, {3.6847180519097986`*^9, 
   3.6847180893989086`*^9}, {3.684718323328802*^9, 3.684718390940899*^9}, {
   3.684749453884059*^9, 3.684749454009437*^9}, {3.6847501689064293`*^9, 
   3.684750173433612*^9}, {3.684751528841665*^9, 3.684751549979269*^9}, 
   3.6847544973868303`*^9, 3.6847561267458982`*^9, 3.684759028604398*^9, 
   3.684759105892377*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6], 
      LineBox[{{2000., 0.022927425384837205`}, {2001., 
       0.022927425385029548`}, {2002., 0.02292742538496233}, {2003., 
       0.02292742538489562}, {2004., 0.0229274253848452}, {2005., 
       0.02292742538479351}, {2006., 0.022927425384738787`}, {2007., 
       0.022927425384679484`}, {2008., 0.0229274253846154}, {2009., 
       0.02292742538456021}, {2010., 0.022927425384494545`}, {2011., 
       0.022927425384427477`}, {2012., 
       0.022927425384325666`}}]}}, {}, {}, {{}, {}}}, {{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
      AbsoluteThickness[1.6], 
      PointBox[{{2000., 0.}, {2001., 0.}, {2002., 0.}, {2003., 0.}, {2004., 
       0.}, {2005., 0.01}, {2006., 0.01}, {2007., 0.02}, {2008., 0.05}, {
       2009., 0.05}, {2010., 0.05}, {2011., 0.07}, {2012., 
       0.1}}]}, {}}, {}, {}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Years\"", TraditionalForm], 
    FormBox["\"Resistance\"", TraditionalForm]},
  AxesOrigin->{2000., 0.},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->500,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"United States\"", TraditionalForm],
  PlotRange->All,
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.684771795111167*^9}]
}, Open  ]],

Cell["Projections:", "Text",
 CellChangeTimes->{{3.6847730457746*^9, 3.684773049502564*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"orig", " ", "=", 
  RowBox[{"p", "[", 
   RowBox[{"[", 
    RowBox[{"-", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"red", " ", "=", " ", 
  RowBox[{"0.5", "*", 
   RowBox[{"p", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"po", " ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{"p", ",", "21", ",", "orig"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "carpanem", " ", "prescription", " ", "proportion", " ", "is", 
    " ", "same", " ", "as", " ", "2012", " ", "levels"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pr", " ", "=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{"p", ",", "21", ",", "red"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "carpanem", " ", "prescription", " ", "proportion", " ", "is", 
    " ", "same", " ", "as", " ", "2012", " ", "levels"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", "p", "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.684771997437739*^9, {3.6847720374024677`*^9, 3.684772069067829*^9}, {
   3.6847726151994457`*^9, 3.684772685826805*^9}, {3.684772802379149*^9, 
   3.684772831750696*^9}, {3.684772875350904*^9, 3.684772887160892*^9}, {
   3.68477293855124*^9, 3.684772940447349*^9}, {3.684772972755328*^9, 
   3.684773073666026*^9}, {3.68477332846308*^9, 3.684773418807166*^9}, {
   3.6847734517539186`*^9, 3.684773460924369*^9}, {3.684773511795575*^9, 
   3.684773611057685*^9}}],

Cell[BoxData["0.003330682044143965`"], "Output",
 CellChangeTimes->{
  3.684773467182111*^9, 3.6847735183771343`*^9, {3.684773569533621*^9, 
   3.6847736114909973`*^9}}],

Cell[BoxData["0.0016653410220719826`"], "Output",
 CellChangeTimes->{
  3.684773467182111*^9, 3.6847735183771343`*^9, {3.684773569533621*^9, 
   3.684773611491706*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.001085061034683201`", ",", "0.0012212723437326524`", ",", 
   "0.0015312177008766222`", ",", "0.0015869329617587862`", ",", 
   "0.0018724201029831056`", ",", "0.0019771800469580263`", ",", 
   "0.0021899016610197504`", ",", "0.002404897245299519`", ",", 
   "0.002616872172447441`", ",", "0.002691906912122265`", ",", 
   "0.002848358802785062`", ",", "0.0029876420261645015`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.684773467182111*^9, 3.6847735183771343`*^9, {3.684773569533621*^9, 
   3.6847736114925003`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.001085061034683201`", ",", "0.0012212723437326524`", ",", 
   "0.0015312177008766222`", ",", "0.0015869329617587862`", ",", 
   "0.0018724201029831056`", ",", "0.0019771800469580263`", ",", 
   "0.0021899016610197504`", ",", "0.002404897245299519`", ",", 
   "0.002616872172447441`", ",", "0.002691906912122265`", ",", 
   "0.002848358802785062`", ",", "0.0029876420261645015`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.684773467182111*^9, 3.6847735183771343`*^9, {3.684773569533621*^9, 
   3.6847736114932737`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.001085061034683201`", ",", "0.0012212723437326524`", ",", 
   "0.0015312177008766222`", ",", "0.0015869329617587862`", ",", 
   "0.0018724201029831056`", ",", "0.0019771800469580263`", ",", 
   "0.0021899016610197504`", ",", "0.002404897245299519`", ",", 
   "0.002616872172447441`", ",", "0.002691906912122265`", ",", 
   "0.002848358802785062`", ",", "0.0029876420261645015`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`", ",", "0.003330682044143965`", ",", 
   "0.003330682044143965`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.684773467182111*^9, 3.6847735183771343`*^9, {3.684773569533621*^9, 
   3.684773611494052*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "d", ",", "r0"}], "}"}], " ", "=", " ", "optParams"}], 
   "\[IndentingNewLine]", 
   RowBox[{"r", "[", 
    RowBox[{"11", ",", "a", ",", "d", ",", "r0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6847731135750103`*^9, 3.684773313846958*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6.948547906603899`*^-7", ",", "0.613661459822737`", ",", 
   "0.022927425384837205`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.684773195678629*^9, {3.684773275695244*^9, 3.684773314501463*^9}}],

Cell[BoxData["0.022927425384494545`"], "Output",
 CellChangeTimes->{
  3.684773195678629*^9, {3.684773275695244*^9, 3.684773314502727*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1855, 1176},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 145, 2, 34, "Input"],
Cell[706, 24, 644, 16, 45, "Text"],
Cell[1353, 42, 568, 9, 82, "Text"],
Cell[1924, 53, 1082, 16, 129, "Text"],
Cell[CellGroupData[{
Cell[3031, 73, 2225, 53, 160, "Input"],
Cell[5259, 128, 3622, 82, 105, "Output"]
}, Open  ]],
Cell[8896, 213, 94, 1, 34, "Input"],
Cell[CellGroupData[{
Cell[9015, 218, 419, 7, 32, "Item"],
Cell[CellGroupData[{
Cell[9459, 229, 498, 8, 26, "Subsubitem"],
Cell[9960, 239, 526, 8, 26, "Subsubitem"]
}, Open  ]],
Cell[10501, 250, 440, 7, 32, "Item"],
Cell[CellGroupData[{
Cell[10966, 261, 479, 7, 26, "Subsubitem"],
Cell[11448, 270, 557, 8, 26, "Subsubitem"],
Cell[12008, 280, 658, 9, 26, "Subsubitem"],
Cell[12669, 291, 771, 12, 26, "Subsubitem"],
Cell[13443, 305, 747, 11, 26, "Subsubitem"]
}, Open  ]]
}, Open  ]],
Cell[14217, 320, 94, 1, 34, "Input"],
Cell[14314, 323, 282, 6, 38, "Input"],
Cell[14599, 331, 94, 1, 34, "Input"],
Cell[14696, 334, 270, 5, 35, "Text"],
Cell[14969, 341, 928, 15, 110, "Input"],
Cell[CellGroupData[{
Cell[15922, 360, 3816, 89, 288, "Input"],
Cell[19741, 451, 744, 14, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20522, 470, 790, 17, 87, "Input"],
Cell[21315, 489, 1435, 30, 84, "Output"]
}, Open  ]],
Cell[22765, 522, 3696, 94, 309, "Input"],
Cell[CellGroupData[{
Cell[26486, 620, 533, 10, 34, "Input"],
Cell[27022, 632, 112, 1, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27171, 638, 163, 2, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[27359, 644, 4615, 89, 104, "Input"],
Cell[31977, 735, 126, 2, 34, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32152, 743, 110, 1, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[32287, 748, 4072, 110, 180, "Input"],
Cell[36362, 860, 125, 2, 34, "Output"],
Cell[36490, 864, 173, 4, 34, "Output"]
}, Open  ]],
Cell[36678, 871, 165, 2, 37, "WolframAlphaShort"],
Cell[36846, 875, 7502, 191, 305, "Input"],
Cell[CellGroupData[{
Cell[44373, 1070, 1220, 32, 83, "Input"],
Cell[45596, 1104, 2277, 50, 369, "Output"]
}, Open  ]],
Cell[47888, 1157, 92, 1, 35, "Text"],
Cell[CellGroupData[{
Cell[48005, 1162, 1504, 35, 154, "Input"],
Cell[49512, 1199, 169, 3, 34, "Output"],
Cell[49684, 1204, 168, 3, 34, "Output"],
Cell[49855, 1209, 854, 16, 58, "Output"],
Cell[50712, 1227, 854, 16, 58, "Output"],
Cell[51569, 1245, 852, 16, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52458, 1266, 337, 9, 60, InheritFromParent],
Cell[52798, 1277, 239, 6, 45, "Output"],
Cell[53040, 1285, 139, 2, 34, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

